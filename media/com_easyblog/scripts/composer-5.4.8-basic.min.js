function createSafeFragment(a){var b=nodeNames.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function fixDefaultChecked(a){rcheckableType.test(a.type)&&(a.defaultChecked=a.checked)}function getAll(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==strundefined?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==strundefined?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||jQuery.nodeName(d,b)?f.push(d):jQuery.merge(f,getAll(d,b));
return void 0===b||b&&jQuery.nodeName(a,b)?jQuery.merge([a],f):f}function setGlobalEval(a,b){for(var c,d=0;null!=(c=a[d]);d++)jQuery._data(c,"globalEval",!b||jQuery._data(b[d],"globalEval"))}!function(a){var c,d,b=function(a){var b=[],c=1,d=0,a=a,e=function(){b.push([this,arguments]),c||e.execute()};return e.execute=function(){if(!d){d=1,c=0;for(var e;e=b.shift();)a.apply(e[0],e[1]);d=0}},e.lock=function(){c=0},e},e={},f=0,g=[],h=window[a]={setup:function(a){d=a,h.init()},jquery:function(a){c||(c=a,h.init())
},init:function(){f||c&&d&&(h.$=c.initialize(d),h.plugin.execute(),f=1)},plugin:b(function(a,b){b.apply(h,[c])}),module:b(function(a,b){c.module(a,b)}),installer:function(a,b,c){if(g[a]||(g[a]=[]),!b)return g[a];var d=e[a];return d.registered?d.install(b,c):(g[a].push([b,c]),void 0)},component:function(a,b){if(!a)return e;if(!b)return e[a];if("function"==typeof b){var d=b;return d.registered=!0,e[a]=d}var g=[],h=function(a,b,c){return{method:a,context:this,args:c}},i=function(a,b,c){return function(){return(c||g).push(h(a,this,arguments)),b
}},j=function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d];a[e]=i(e,a,c)}return a},k=function(a,b){return function(){var c=[h(a,this,arguments)];return g.push(c),j({},b,c)}};g.execute=function(){for(var b=e[a],c=0;c<g.length;c++){var d=g[c];if("[object Array]"===Object.prototype.toString.call(d))for(var f=d,h=b,i=0;i<f.length;i++)h=h[f[i].method].apply(h,f[i].args);else b[d.method].apply(b,d.args)}};var d=j(function(){d.run.apply(this.arguments)},["run","ready","template","dialog"]);return d.className=a,d.options=b,d.queue=g,d.module=k("module",["done","always","fail","progress"]),d.require=k("require",["library","script","stylesheet","language","template","app","view","done","always","fail","progress"]),window[a]=e[a]=d,f&&c.Component.register(d),d
}}}("FD50"),FD50.setup({environment:window.ezb.environment,source:"local",mode:"production"==window.ezb.environment?"compressed":"uncompressed",path:window.ezb.rootUrl+"/media/com_easyblog/scripts/vendors",cdn:"",extension:".js",cdnPath:"",rootPath:window.ezb.rootUrl,basePath:window.ezb.rootUrl,indexUrl:window.ezb.rootUrl+"/index.php",token:window.ezb.token,locale:{lang:window.ezb.locale}}),FD50.component("EasyBlog",{environment:window.ezb.environment,source:"local",mode:"production"==window.ezb.environment?"compressed":"uncompressed",mode:"compressed",baseUrl:window.ezb.baseUrl,version:"2.0",momentLang:window.ezb.momentLang,ajaxUrl:window.ezb.ajaxUrl}),jQuery.version="5.0",jQuery.long_version="5.0.10";
var support={};!function(){function h(){var a,b,c,h;b=document.getElementsByTagName("body")[0],b&&b.style&&(a=document.createElement("div"),c=document.createElement("div"),c.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",b.appendChild(c).appendChild(a),a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",d=e=!1,g=!0,window.getComputedStyle&&(d="1%"!==(window.getComputedStyle(a,null)||{}).top,e="4px"===(window.getComputedStyle(a,null)||{width:"4px"}).width,h=a.appendChild(document.createElement("div")),h.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",h.style.marginRight=h.style.width="0",a.style.width="1px",g=!parseFloat((window.getComputedStyle(h,null)||{}).marginRight),a.removeChild(h)),a.innerHTML="<table><tr><td></td><td>t</td></tr></table>",h=a.getElementsByTagName("td"),h[0].style.cssText="margin:0;border:0;padding:0;display:none",f=0===h[0].offsetHeight,f&&(h[0].style.display="",h[1].style.display="none",f=0===h[0].offsetHeight),b.removeChild(c))
}var a,b,c,d,e,f,g;a=document.createElement("div"),a.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=a.getElementsByTagName("a")[0],b=c&&c.style,b&&(b.cssText="float:left;opacity:.5",support.opacity="0.5"===b.opacity,support.cssFloat=!!b.cssFloat,a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===a.style.backgroundClip,support.boxSizing=""===b.boxSizing||""===b.MozBoxSizing||""===b.WebkitBoxSizing,jQuery.extend(support,{reliableHiddenOffsets:function(){return null==f&&h(),f
},boxSizingReliable:function(){return null==e&&h(),e},pixelPosition:function(){return null==d&&h(),d},reliableMarginRight:function(){return null==g&&h(),g}}))}();var strundefined="undefined",rcheckableType=/^(?:checkbox|radio)$/i,nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));
wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.uid=function(a,b){return(a?a:"")+Math.random().toString().replace(".","")+(b?b:"")},jQuery.globalNamespace=jQuery.uid("EasyBlog"),window[jQuery.globalNamespace]=jQuery,jQuery.run=function(a){return jQuery.isFunction(a)?a(jQuery):null},jQuery.initialize=function(a){if(!jQuery.initialized){if(jQuery.buildFragment=function(a,b,c,d){for(var e,f,g,h,i,j,k,l=a.length,m=createSafeFragment(b),n=[],o=0;l>o;o++)if(f=a[o],f||0===f)if("object"===jQuery.type(f))jQuery.merge(n,f.nodeType?[f]:f);
else if(rhtml.test(f)){for(h=h||m.appendChild(b.createElement("div")),i=(rtagName.exec(f)||["",""])[1].toLowerCase(),k=wrapMap[i]||wrapMap._default,h.innerHTML=k[1]+f.replace(rxhtmlTag,"<$1></$2>")+k[2],e=k[0];e--;)h=h.lastChild;if(!support.leadingWhitespace&&rleadingWhitespace.test(f)&&n.push(b.createTextNode(rleadingWhitespace.exec(f)[0])),!support.tbody)for(f="table"!==i||rtbody.test(f)?"<table>"!==k[1]||rtbody.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;e--;)jQuery.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j);
for(jQuery.merge(n,h.childNodes),h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=m.lastChild}else n.push(b.createTextNode(f));for(h&&m.removeChild(h),support.appendChecked||jQuery.grep(getAll(n,"input"),fixDefaultChecked),o=0;f=n[o++];)if((!d||-1===jQuery.inArray(f,d))&&(g=jQuery.contains(f.ownerDocument,f),h=getAll(m.appendChild(f),"script"),g&&setGlobalEval(h),c))for(e=0;f=h[e++];)rscriptType.test(f.type||"")&&c.push(f);return h=null,m},jQuery.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];
return{browser:b[1]||"",version:b[2]||"0"}},!jQuery.browser){var b=jQuery.uaMatch(navigator.userAgent),c={};b.browser&&(c[b.browser]=!0,c.version=b.version),c.chrome?c.webkit=!0:c.webkit&&(c.safari=!0),jQuery.browser=c}jQuery.extend(jQuery,a),"development"==jQuery.environment&&(window.F=jQuery),jQuery.initialized=!0,FD50.module.execute()}},FD50.jquery(jQuery),"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery}),FD50.plugin("lodash",function(a){function hc(a,b){return a.set(b[0],b[1]),a
}function ic(a,b){return a.add(b),a}function jc(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function kc(a,b){for(var c=-1,d=null==a?0:a.length;++c<d&&b(a[c],c,a)!==!1;);return a}function lc(a,b){for(var c=-1,d=null==a?0:a.length,e=0,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[e++]=g)}return f}function mc(a,b){var c=null==a?0:a.length;return!!c&&uc(a,b,0)>-1}function nc(a,b,c){for(var d=-1,e=null==a?0:a.length;++d<e;)if(c(b,a[d]))return!0;
return!1}function oc(a,b){for(var c=-1,d=null==a?0:a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function pc(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function qc(a,b,c,d){var e=-1,f=null==a?0:a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function rc(a,b){for(var c=-1,d=null==a?0:a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function sc(a){return a.split("")}function tc(a,b,c,d){for(var e=a.length,f=c+(d?1:-1);d?f--:++f<e;)if(b(a[f],f,a))return f;return-1}function uc(a,b,c){return b===b?Lc(a,b,c):tc(a,wc,c)
}function vc(a,b,c,d){for(var e=c-1,f=a.length;++e<f;)if(d(a[e],b))return e;return-1}function wc(a){return a!==a}function xc(a){return function(c){return null==c?b:c[a]}}function yc(a,b){var c=a.length;for(a.sort(b);c--;)a[c]=a[c].value;return a}function zc(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}function Ac(a){return function(b){return a(b)}}function Bc(a,b){return oc(b,function(b){return a[b]})}function Cc(a,b){return a.has(b)}function Dc(a,b){for(var c=a.length,d=0;c--;)a[c]===b&&++d;return d
}function Ec(a,c){return null==a?b:a[c]}function Fc(a){return Vb.test(a)}function Gc(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function Hc(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}function Ic(a,b){return function(c){return a(b(c))}}function Jc(a,b){for(var c=-1,d=a.length,e=0,f=[];++c<d;){var g=a[c];(g===b||g===h)&&(a[c]=h,f[e++]=c)}return f}function Kc(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}function Lc(a,b,c){for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;
return-1}function Mc(a){return Fc(a)?Nc(a):sc(a)}function Nc(a){return a.match(Ub)||[]}var b,c="4.17.4",d=200,e="Expected a function",f="__lodash_hash_undefined__",g=500,h="__lodash_placeholder__",i=1,j=2,k=4,l=1,m=2,n=1,o=2,p=4,q=8,r=16,s=32,t=64,u=128,v=256,w=512,x=800,y=16,z=1,A=2,B=3,C=1/0,D=9007199254740991,E=1.7976931348623157e308,F=0/0,G=4294967295,H=[["ary",u],["bind",n],["bindKey",o],["curry",q],["curryRight",r],["flip",w],["partial",s],["partialRight",t],["rearg",v]],I="[object Arguments]",J="[object Array]",K="[object AsyncFunction]",L="[object Boolean]",M="[object Date]",N="[object Error]",O="[object Function]",P="[object GeneratorFunction]",Q="[object Map]",R="[object Number]",S="[object Null]",T="[object Object]",U="[object Promise]",V="[object Proxy]",W="[object RegExp]",X="[object Set]",Y="[object String]",Z="[object Symbol]",$="[object Undefined]",_="[object WeakMap]",ab="[object ArrayBuffer]",bb="[object DataView]",cb="[object Float32Array]",db="[object Float64Array]",eb="[object Int8Array]",fb="[object Int16Array]",gb="[object Int32Array]",hb="[object Uint8Array]",ib="[object Uint8ClampedArray]",jb="[object Uint16Array]",kb="[object Uint32Array]",lb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mb=/^\w*$/,nb=/^\./,ob=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pb=/[\\^$.*+?()[\]{}|]/g,qb=/^\s+|\s+$/g,rb=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,sb=/\{\n\/\* \[wrapped with (.+)\] \*/,tb=/,? & /,ub=/\\(\\)?/g,vb=/\w*$/,wb=/^[-+]0x[0-9a-f]+$/i,xb=/^0b[01]+$/i,yb=/^\[object .+?Constructor\]$/,zb=/^0o[0-7]+$/i,Ab=/^(?:0|[1-9]\d*)$/,Bb="\\ud800-\\udfff",Cb="\\u0300-\\u036f",Db="\\ufe20-\\ufe2f",Eb="\\u20d0-\\u20ff",Fb=Cb+Db+Eb,Gb="\\ufe0e\\ufe0f",Hb="["+Bb+"]",Ib="["+Fb+"]",Jb="\\ud83c[\\udffb-\\udfff]",Kb="(?:"+Ib+"|"+Jb+")",Lb="[^"+Bb+"]",Mb="(?:\\ud83c[\\udde6-\\uddff]){2}",Nb="[\\ud800-\\udbff][\\udc00-\\udfff]",Ob="\\u200d",Pb=Kb+"?",Qb="["+Gb+"]?",Rb="(?:"+Ob+"(?:"+[Lb,Mb,Nb].join("|")+")"+Qb+Pb+")*",Sb=Qb+Pb+Rb,Tb="(?:"+[Lb+Ib+"?",Ib,Mb,Nb,Hb].join("|")+")",Ub=RegExp(Jb+"(?="+Jb+")|"+Tb+Sb,"g"),Vb=RegExp("["+Ob+Bb+Fb+Gb+"]"),Wb=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xb={};
Xb[cb]=Xb[db]=Xb[eb]=Xb[fb]=Xb[gb]=Xb[hb]=Xb[ib]=Xb[jb]=Xb[kb]=!0,Xb[I]=Xb[J]=Xb[ab]=Xb[L]=Xb[bb]=Xb[M]=Xb[N]=Xb[O]=Xb[Q]=Xb[R]=Xb[T]=Xb[W]=Xb[X]=Xb[Y]=Xb[_]=!1;var Yb={};Yb[I]=Yb[J]=Yb[ab]=Yb[bb]=Yb[L]=Yb[M]=Yb[cb]=Yb[db]=Yb[eb]=Yb[fb]=Yb[gb]=Yb[Q]=Yb[R]=Yb[T]=Yb[W]=Yb[X]=Yb[Y]=Yb[Z]=Yb[hb]=Yb[ib]=Yb[jb]=Yb[kb]=!0,Yb[N]=Yb[O]=Yb[_]=!1;var Zb=parseInt,$b="object"==typeof global&&global&&global.Object===Object&&global,_b="object"==typeof self&&self&&self.Object===Object&&self,ac=$b||_b||Function("return this")(),bc="object"==typeof exports&&exports&&!exports.nodeType&&exports,cc=bc&&"object"==typeof module&&module&&!module.nodeType&&module,dc=cc&&cc.exports===bc,ec=dc&&$b.process,fc=function(){try{return ec&&ec.binding&&ec.binding("util")
}catch(a){}}(),gc=fc&&fc.isTypedArray,Oc=function Qc(a){function sd(a){if(bh(a)&&!Ug(a)&&!(a instanceof wd)){if(a instanceof vd)return a;if(Nb.call(a,"__wrapped__"))return og(a)}return new vd(a)}function ud(){}function vd(a,c){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!c,this.__index__=0,this.__values__=b}function wd(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function xd(){var a=new wd(this.__wrapped__);
return a.__actions__=hf(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=hf(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=hf(this.__views__),a}function yd(){if(this.__filtered__){var a=new wd(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function zd(){var a=this.__wrapped__.value(),b=this.__dir__,c=Ug(a),d=0>b,e=c?a.length:0,f=Kf(0,e,this.__views__),g=f.start,h=f.end,i=h-g,j=d?h:g-1,k=this.__iteratees__,l=k.length,m=0,n=Zc(i,this.__takeCount__);
if(!c||!d&&e==i&&n==i)return Te(a,this.__actions__);var o=[];a:for(;i--&&n>m;){j+=b;for(var p=-1,q=a[j];++p<l;){var r=k[p],s=r.iteratee,t=r.type,u=s(q);if(t==A)q=u;else if(!u){if(t==z)continue a;break a}}o[m++]=q}return o}function Ad(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Bd(){this.__data__=hd?hd(null):{},this.size=0}function Cd(a){var b=this.has(a)&&delete this.__data__[a];return this.size-=b?1:0,b}function Dd(a){var c=this.__data__;if(hd){var d=c[a];
return d===f?b:d}return Nb.call(c,a)?c[a]:b}function Ed(a){var c=this.__data__;return hd?c[a]!==b:Nb.call(c,a)}function Fd(a,c){var d=this.__data__;return this.size+=this.has(a)?0:1,d[a]=hd&&c===b?f:c,this}function Gd(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Hd(){this.__data__=[],this.size=0}function Id(a){var b=this.__data__,c=be(b,a);if(0>c)return!1;var d=b.length-1;return c==d?b.pop():fc.call(b,c,1),--this.size,!0}function Jd(a){var c=this.__data__,d=be(c,a);
return 0>d?b:c[d][1]}function Kd(a){return be(this.__data__,a)>-1}function Ld(a,b){var c=this.__data__,d=be(c,a);return 0>d?(++this.size,c.push([a,b])):c[d][1]=b,this}function Md(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Nd(){this.size=0,this.__data__={hash:new Ad,map:new(dd||Gd),string:new Ad}}function Od(a){var b=Df(this,a)["delete"](a);return this.size-=b?1:0,b}function Pd(a){return Df(this,a).get(a)}function Qd(a){return Df(this,a).has(a)}function Rd(a,b){var c=Df(this,a),d=c.size;
return c.set(a,b),this.size+=c.size==d?0:1,this}function Sd(a){var b=-1,c=null==a?0:a.length;for(this.__data__=new Md;++b<c;)this.add(a[b])}function Td(a){return this.__data__.set(a,f),this}function Ud(a){return this.__data__.has(a)}function Vd(a){var b=this.__data__=new Gd(a);this.size=b.size}function Wd(){this.__data__=new Gd,this.size=0}function Xd(a){var b=this.__data__,c=b["delete"](a);return this.size=b.size,c}function Yd(a){return this.__data__.get(a)}function Zd(a){return this.__data__.has(a)}function $d(a,b){var c=this.__data__;
if(c instanceof Gd){var e=c.__data__;if(!dd||e.length<d-1)return e.push([a,b]),this.size=++c.size,this;c=this.__data__=new Md(e)}return c.set(a,b),this.size=c.size,this}function _d(a,b){var c=Ug(a),d=!c&&Tg(a),e=!c&&!d&&Yg(a),f=!c&&!d&&!e&&eh(a),g=c||d||e||f,h=g?zc(a.length,Gb):[],i=h.length;for(var j in a)!b&&!Nb.call(a,j)||g&&("length"==j||e&&("offset"==j||"parent"==j)||f&&("buffer"==j||"byteLength"==j||"byteOffset"==j)||Sf(j,i))||h.push(j);return h}function ae(a,c,d){var e=a[c];Nb.call(a,c)&&Sg(e,d)&&(d!==b||c in a)||ee(a,c,d)
}function be(a,b){for(var c=a.length;c--;)if(Sg(a[c][0],b))return c;return-1}function ce(a,b){return a&&jf(b,qh(b),a)}function de(a,b){return a&&jf(b,rh(b),a)}function ee(a,b,c){"__proto__"==b&&Fc?Fc(a,b,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[b]=c}function fe(a,c){for(var d=-1,e=c.length,f=h(e),g=null==a;++d<e;)f[d]=g?b:nh(a,c[d]);return f}function ge(a,c,d,e,f,g){var h,l=c&i,m=c&j,n=c&k;if(d&&(h=f?d(a,e,f,g):d(a)),h!==b)return h;if(!ah(a))return a;var o=Ug(a);if(o){if(h=Nf(a),!l)return hf(a,h)
}else{var p=Jf(a),q=p==O||p==P;if(Yg(a))return Xe(a,l);if(p==T||p==I||q&&!f){if(h=m||q?{}:Of(a),!l)return m?lf(a,de(h,a)):kf(a,ce(h,a))}else{if(!Yb[p])return f?a:{};h=Pf(a,p,ge,l)}}g||(g=new Vd);var r=g.get(a);if(r)return r;g.set(a,h);var s=n?m?yf:xf:m?rh:qh,t=o?b:s(a);return kc(t||a,function(b,e){t&&(e=b,b=a[e]),ae(h,e,ge(b,c,d,e,a,g))}),h}function he(a,c,d){if("function"!=typeof a)throw new Hb(e);return gg(function(){a.apply(b,d)},c)}function ie(a,b,c,e){var f=-1,g=mc,h=!0,i=a.length,j=[],k=b.length;if(!i)return j;
c&&(b=oc(b,Ac(c))),e?(g=nc,h=!1):b.length>=d&&(g=Cc,h=!1,b=new Sd(b));a:for(;++f<i;){var l=a[f],m=null==c?l:c(l);if(l=e||0!==l?l:0,h&&m===m){for(var n=k;n--;)if(b[n]===m)continue a;j.push(l)}else g(b,m,e)||j.push(l)}return j}function ke(a,b){var c=[];return je(a,function(a,d,e){b(a,d,e)&&c.push(a)}),c}function le(a,b,c,d,e){var f=-1,g=a.length;for(c||(c=Rf),e||(e=[]);++f<g;){var h=a[f];b>0&&c(h)?b>1?le(h,b-1,c,d,e):pc(e,h):d||(e[e.length]=h)}return e}function ne(a,b){return a&&me(a,b,qh)}function oe(a,b){return lc(b,function(b){return $g(a[b])
})}function pe(a,c){c=Ve(c,a);for(var d=0,e=c.length;null!=a&&e>d;)a=a[lg(c[d++])];return d&&d==e?a:b}function qe(a,b,c){var d=b(a);return Ug(a)?d:pc(d,c(a))}function re(a){return null==a?a===b?$:S:wc&&wc in Eb(a)?Gf(a):bg(a)}function se(a,b){return null!=a&&Nb.call(a,b)}function te(a,b){return null!=a&&b in Eb(a)}function ue(a,c,d){for(var e=d?nc:mc,f=a[0].length,g=a.length,i=g,j=h(g),k=1/0,l=[];i--;){var m=a[i];i&&c&&(m=oc(m,Ac(c))),k=Zc(m.length,k),j[i]=!d&&(c||f>=120&&m.length>=120)?new Sd(i&&m):b}m=a[0];
var n=-1,o=j[0];a:for(;++n<f&&l.length<k;){var p=m[n],q=c?c(p):p;if(p=d||0!==p?p:0,!(o?Cc(o,q):e(l,q,d))){for(i=g;--i;){var r=j[i];if(!(r?Cc(r,q):e(a[i],q,d)))continue a}o&&o.push(q),l.push(p)}}return l}function ve(a,c,d){c=Ve(c,a),a=dg(a,c);var e=null==a?a:a[lg(sg(c))];return null==e?b:jc(e,a,d)}function we(a){return bh(a)&&re(a)==I}function xe(a,b,c,d,e){return a===b?!0:null==a||null==b||!bh(a)&&!bh(b)?a!==a&&b!==b:ye(a,b,c,d,xe,e)}function ye(a,b,c,d,e,f){var g=Ug(a),h=Ug(b),i=g?J:Jf(a),j=h?J:Jf(b);i=i==I?T:i,j=j==I?T:j;
var k=i==T,m=j==T,n=i==j;if(n&&Yg(a)){if(!Yg(b))return!1;g=!0,k=!1}if(n&&!k)return f||(f=new Vd),g||eh(a)?tf(a,b,c,d,e,f):uf(a,b,i,c,d,e,f);if(!(c&l)){var o=k&&Nb.call(a,"__wrapped__"),p=m&&Nb.call(b,"__wrapped__");if(o||p){var q=o?a.value():a,r=p?b.value():b;return f||(f=new Vd),e(q,r,c,d,f)}}return n?(f||(f=new Vd),vf(a,b,c,d,e,f)):!1}function ze(a,c,d,e){var f=d.length,g=f,h=!e;if(null==a)return!g;for(a=Eb(a);f--;){var i=d[f];if(h&&i[2]?i[1]!==a[i[0]]:!(i[0]in a))return!1}for(;++f<g;){i=d[f];var j=i[0],k=a[j],n=i[1];
if(h&&i[2]){if(k===b&&!(j in a))return!1}else{var o=new Vd;if(e)var p=e(k,n,j,a,c,o);if(!(p===b?xe(n,k,l|m,e,o):p))return!1}}return!0}function Ae(a){if(!ah(a)||Xf(a))return!1;var b=$g(a)?Tb:yb;return b.test(mg(a))}function Be(a){return bh(a)&&_g(a.length)&&!!Xb[re(a)]}function Ce(a){return"function"==typeof a?a:null==a?vh:"object"==typeof a?Ug(a)?He(a[0],a[1]):Ge(a):zh(a)}function De(a){if(!Yf(a))return Xc(a);var b=[];for(var c in Eb(a))Nb.call(a,c)&&"constructor"!=c&&b.push(c);return b}function Ee(a){if(!ah(a))return ag(a);
var b=Yf(a),c=[];for(var d in a)("constructor"!=d||!b&&Nb.call(a,d))&&c.push(d);return c}function Fe(a,b){var c=-1,d=Vg(a)?h(a.length):[];return je(a,function(a,e,f){d[++c]=b(a,e,f)}),d}function Ge(a){var b=Ef(a);return 1==b.length&&b[0][2]?$f(b[0][0],b[0][1]):function(c){return c===a||ze(c,a,b)}}function He(a,c){return Uf(a)&&Zf(c)?$f(lg(a),c):function(d){var e=nh(d,a);return e===b&&e===c?ph(d,a):xe(c,e,l|m)}}function Ie(a,b,c){var d=-1;b=oc(b.length?b:[vh],Ac(Cf()));var e=Fe(a,function(a){var f=oc(b,function(b){return b(a)
});return{criteria:f,index:++d,value:a}});return yc(e,function(a,b){return ef(a,b,c)})}function Je(a,b){return Ke(a,b,function(b,c){return ph(a,c)})}function Ke(a,b,c){for(var d=-1,e=b.length,f={};++d<e;){var g=b[d],h=pe(a,g);c(h,g)&&Oe(f,Ve(g,a),h)}return f}function Le(a){return function(b){return pe(b,a)}}function Me(a,b,c,d){var e=d?vc:uc,f=-1,g=b.length,h=a;for(a===b&&(b=hf(b)),c&&(h=oc(a,Ac(c)));++f<g;)for(var i=0,j=b[f],k=c?c(j):j;(i=e(h,k,i,d))>-1;)h!==a&&fc.call(h,i,1),fc.call(a,i,1);return a}function Ne(a,b){return hg(cg(a,b,vh),a+"")
}function Oe(a,c,d,e){if(!ah(a))return a;c=Ve(c,a);for(var f=-1,g=c.length,h=g-1,i=a;null!=i&&++f<g;){var j=lg(c[f]),k=d;if(f!=h){var l=i[j];k=e?e(l,j,i):b,k===b&&(k=ah(l)?l:Sf(c[f+1])?[]:{})}ae(i,j,k),i=i[j]}return a}function Re(a,b,c){var d=-1,e=a.length;0>b&&(b=-b>e?0:e+b),c=c>e?e:c,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=h(e);++d<e;)f[d]=a[d+b];return f}function Se(a){if("string"==typeof a)return a;if(Ug(a))return oc(a,Se)+"";if(dh(a))return rd?rd.call(a):"";var b=a+"";return"0"==b&&1/a==-C?"-0":b}function Te(a,b){var c=a;
return c instanceof wd&&(c=c.value()),qc(b,function(a,b){return b.func.apply(b.thisArg,pc([a],b.args))},c)}function Ue(a){return Wg(a)?a:[]}function Ve(a,b){return Ug(a)?a:Uf(a,b)?[a]:kg(kh(a))}function Xe(a,b){if(b)return a.slice();var c=a.length,d=_b?_b(c):new a.constructor(c);return a.copy(d),d}function Ye(a){var b=new a.constructor(a.byteLength);return new $b(b).set(new $b(a)),b}function Ze(a,b){var c=b?Ye(a.buffer):a.buffer;return new a.constructor(c,a.byteOffset,a.byteLength)}function $e(a,b,c){var d=b?c(Hc(a),i):Hc(a);
return qc(d,hc,new a.constructor)}function _e(a){var b=new a.constructor(a.source,vb.exec(a));return b.lastIndex=a.lastIndex,b}function af(a,b,c){var d=b?c(Kc(a),i):Kc(a);return qc(d,ic,new a.constructor)}function bf(a){return qd?Eb(qd.call(a)):{}}function cf(a,b){var c=b?Ye(a.buffer):a.buffer;return new a.constructor(c,a.byteOffset,a.length)}function df(a,c){if(a!==c){var d=a!==b,e=null===a,f=a===a,g=dh(a),h=c!==b,i=null===c,j=c===c,k=dh(c);if(!i&&!k&&!g&&a>c||g&&h&&j&&!i&&!k||e&&h&&j||!d&&j||!f)return 1;if(!e&&!g&&!k&&c>a||k&&d&&f&&!e&&!g||i&&d&&f||!h&&f||!j)return-1
}return 0}function ef(a,b,c){for(var d=-1,e=a.criteria,f=b.criteria,g=e.length,h=c.length;++d<g;){var i=df(e[d],f[d]);if(i){if(d>=h)return i;var j=c[d];return i*("desc"==j?-1:1)}}return a.index-b.index}function ff(a,b,c,d){for(var e=-1,f=a.length,g=c.length,i=-1,j=b.length,k=Yc(f-g,0),l=h(j+k),m=!d;++i<j;)l[i]=b[i];for(;++e<g;)(m||f>e)&&(l[c[e]]=a[e]);for(;k--;)l[i++]=a[e++];return l}function gf(a,b,c,d){for(var e=-1,f=a.length,g=-1,i=c.length,j=-1,k=b.length,l=Yc(f-i,0),m=h(l+k),n=!d;++e<l;)m[e]=a[e];for(var o=e;++j<k;)m[o+j]=b[j];
for(;++g<i;)(n||f>e)&&(m[o+c[g]]=a[e++]);return m}function hf(a,b){var c=-1,d=a.length;for(b||(b=h(d));++c<d;)b[c]=a[c];return b}function jf(a,c,d,e){var f=!d;d||(d={});for(var g=-1,h=c.length;++g<h;){var i=c[g],j=e?e(d[i],a[i],i,d,a):b;j===b&&(j=a[i]),f?ee(d,i,j):ae(d,i,j)}return d}function kf(a,b){return jf(a,Hf(a),b)}function lf(a,b){return jf(a,If(a),b)}function mf(a){return Ne(function(c,d){var e=-1,f=d.length,g=f>1?d[f-1]:b,h=f>2?d[2]:b;for(g=a.length>3&&"function"==typeof g?(f--,g):b,h&&Tf(d[0],d[1],h)&&(g=3>f?b:g,f=1),c=Eb(c);++e<f;){var i=d[e];
i&&a(c,i,e,g)}return c})}function nf(a,b){return function(c,d){if(null==c)return c;if(!Vg(c))return a(c,d);for(var e=c.length,f=b?e:-1,g=Eb(c);(b?f--:++f<e)&&d(g[f],f,g)!==!1;);return c}}function of(a){return function(b,c,d){for(var e=-1,f=Eb(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}function pf(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);
case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=td(a.prototype),d=a.apply(c,b);return ah(d)?d:c}}function qf(a,c,d,e,f,g,i,j,k,l){function y(){for(var b=arguments.length,n=h(b),o=b;o--;)n[o]=arguments[o];if(t)var q=Bf(y),r=Dc(n,q);if(e&&(n=ff(n,e,f,t)),g&&(n=gf(n,g,i,t)),b-=r,t&&l>b){var u=Jc(n,q);return rf(a,c,qf,y.placeholder,d,n,u,j,k,l-b)}var w=p?d:this,z=s?w[a]:a;return b=n.length,j?n=eg(n,j):v&&b>1&&n.reverse(),m&&b>k&&(n.length=k),this&&this!==ac&&this instanceof y&&(z=x||pf(z)),z.apply(w,n)
}var m=c&u,p=c&n,s=c&o,t=c&(q|r),v=c&w,x=s?b:pf(a);return y}function rf(a,c,d,e,f,g,h,i,j,k){var l=c&q,m=l?h:b,r=l?b:h,u=l?g:b,v=l?b:g;c|=l?s:t,c&=~(l?t:s),c&p||(c&=~(n|o));var w=[a,c,f,u,m,v,r,i,j,k],x=d.apply(b,w);return Wf(a)&&fg(x,w),x.placeholder=e,ig(x,a,c)}function sf(a,c,d,e){return a===b||Sg(a,Kb[d])&&!Nb.call(e,d)?c:a}function tf(a,c,d,e,f,g){var h=d&l,i=a.length,j=c.length;if(i!=j&&!(h&&j>i))return!1;var k=g.get(a);if(k&&g.get(c))return k==c;var n=-1,o=!0,p=d&m?new Sd:b;for(g.set(a,c),g.set(c,a);++n<i;){var q=a[n],r=c[n];
if(e)var s=h?e(r,q,n,c,a,g):e(q,r,n,a,c,g);if(s!==b){if(s)continue;o=!1;break}if(p){if(!rc(c,function(a,b){return Cc(p,b)||q!==a&&!f(q,a,d,e,g)?void 0:p.push(b)})){o=!1;break}}else if(q!==r&&!f(q,r,d,e,g)){o=!1;break}}return g["delete"](a),g["delete"](c),o}function uf(a,b,c,d,e,f,g){switch(c){case bb:if(a.byteLength!=b.byteLength||a.byteOffset!=b.byteOffset)return!1;a=a.buffer,b=b.buffer;case ab:return a.byteLength==b.byteLength&&f(new $b(a),new $b(b))?!0:!1;case L:case M:case R:return Sg(+a,+b);case N:return a.name==b.name&&a.message==b.message;
case W:case Y:return a==b+"";case Q:var h=Hc;case X:var i=d&l;if(h||(h=Kc),a.size!=b.size&&!i)return!1;var j=g.get(a);if(j)return j==b;d|=m,g.set(a,b);var k=tf(h(a),h(b),d,e,f,g);return g["delete"](a),k;case Z:if(qd)return qd.call(a)==qd.call(b)}return!1}function vf(a,c,d,e,f,g){var h=d&l,i=xf(a),j=i.length,k=xf(c),m=k.length;if(j!=m&&!h)return!1;for(var n=j;n--;){var o=i[n];if(!(h?o in c:Nb.call(c,o)))return!1}var p=g.get(a);if(p&&g.get(c))return p==c;var q=!0;g.set(a,c),g.set(c,a);for(var r=h;++n<j;){o=i[n];
var s=a[o],t=c[o];if(e)var u=h?e(t,s,o,c,a,g):e(s,t,o,a,c,g);if(!(u===b?s===t||f(s,t,d,e,g):u)){q=!1;break}r||(r="constructor"==o)}if(q&&!r){var v=a.constructor,w=c.constructor;v!=w&&"constructor"in a&&"constructor"in c&&!("function"==typeof v&&v instanceof v&&"function"==typeof w&&w instanceof w)&&(q=!1)}return g["delete"](a),g["delete"](c),q}function wf(a){return hg(cg(a,b,pg),a+"")}function xf(a){return qe(a,qh,Hf)}function yf(a){return qe(a,rh,If)}function Af(a){for(var b=a.name+"",c=jd[b],d=Nb.call(jd,b)?c.length:0;d--;){var e=c[d],f=e.func;
if(null==f||f==a)return e.name}return b}function Bf(a){var b=Nb.call(sd,"placeholder")?sd:a;return b.placeholder}function Cf(){var a=sd.iteratee||wh;return a=a===wh?Ce:a,arguments.length?a(arguments[0],arguments[1]):a}function Df(a,b){var c=a.__data__;return Vf(b)?c["string"==typeof b?"string":"hash"]:c.map}function Ef(a){for(var b=qh(a),c=b.length;c--;){var d=b[c],e=a[d];b[c]=[d,e,Zf(e)]}return b}function Ff(a,c){var d=Ec(a,c);return Ae(d)?d:b}function Gf(a){var c=Nb.call(a,wc),d=a[wc];try{a[wc]=b;var e=!0}catch(f){}var g=Qb.call(a);
return e&&(c?a[wc]=d:delete a[wc]),g}function Kf(a,b,c){for(var d=-1,e=c.length;++d<e;){var f=c[d],g=f.size;switch(f.type){case"drop":a+=g;break;case"dropRight":b-=g;break;case"take":b=Zc(b,a+g);break;case"takeRight":a=Yc(a,b-g)}}return{start:a,end:b}}function Lf(a){var b=a.match(sb);return b?b[1].split(tb):[]}function Mf(a,b,c){b=Ve(b,a);for(var d=-1,e=b.length,f=!1;++d<e;){var g=lg(b[d]);if(!(f=null!=a&&c(a,g)))break;a=a[g]}return f||++d!=e?f:(e=null==a?0:a.length,!!e&&_g(e)&&Sf(g,e)&&(Ug(a)||Tg(a)))}function Nf(a){var b=a.length,c=a.constructor(b);
return b&&"string"==typeof a[0]&&Nb.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function Of(a){return"function"!=typeof a.constructor||Yf(a)?{}:td(bc(a))}function Pf(a,b,c,d){var e=a.constructor;switch(b){case ab:return Ye(a);case L:case M:return new e(+a);case bb:return Ze(a,d);case cb:case db:case eb:case fb:case gb:case hb:case ib:case jb:case kb:return cf(a,d);case Q:return $e(a,d,c);case R:case Y:return new e(a);case W:return _e(a);case X:return af(a,d,c);case Z:return bf(a)}}function Qf(a,b){var c=b.length;
if(!c)return a;var d=c-1;return b[d]=(c>1?"& ":"")+b[d],b=b.join(c>2?", ":" "),a.replace(rb,"{\n/* [wrapped with "+b+"] */\n")}function Rf(a){return Ug(a)||Tg(a)||!!(sc&&a&&a[sc])}function Sf(a,b){return b=null==b?D:b,!!b&&("number"==typeof a||Ab.test(a))&&a>-1&&a%1==0&&b>a}function Tf(a,b,c){if(!ah(c))return!1;var d=typeof b;return("number"==d?Vg(c)&&Sf(b,c.length):"string"==d&&b in c)?Sg(c[b],a):!1}function Uf(a,b){if(Ug(a))return!1;var c=typeof a;return"number"==c||"symbol"==c||"boolean"==c||null==a||dh(a)?!0:mb.test(a)||!lb.test(a)||null!=b&&a in Eb(b)
}function Vf(a){var b=typeof a;return"string"==b||"number"==b||"symbol"==b||"boolean"==b?"__proto__"!==a:null===a}function Wf(a){var b=Af(a),c=sd[b];if("function"!=typeof c||!(b in wd.prototype))return!1;if(a===c)return!0;var d=zf(c);return!!d&&a===d[0]}function Xf(a){return!!Pb&&Pb in a}function Yf(a){var b=a&&a.constructor,c="function"==typeof b&&b.prototype||Kb;return a===c}function Zf(a){return a===a&&!ah(a)}function $f(a,c){return function(d){return null==d?!1:d[a]===c&&(c!==b||a in Eb(d))}}function _f(a){var b=Pg(a,function(a){return c.size===g&&c.clear(),a
}),c=b.cache;return b}function ag(a){var b=[];if(null!=a)for(var c in Eb(a))b.push(c);return b}function bg(a){return Qb.call(a)}function cg(a,c,d){return c=Yc(c===b?a.length-1:c,0),function(){for(var b=arguments,e=-1,f=Yc(b.length-c,0),g=h(f);++e<f;)g[e]=b[c+e];e=-1;for(var i=h(c+1);++e<c;)i[e]=b[e];return i[c]=d(g),jc(a,this,i)}}function dg(a,b){return b.length<2?a:pe(a,Re(b,0,-1))}function eg(a,c){for(var d=a.length,e=Zc(c.length,d),f=hf(a);e--;){var g=c[e];a[e]=Sf(g,d)?f[g]:b}return a}function ig(a,b,c){var d=b+"";
return hg(a,Qf(d,ng(Lf(d),c)))}function jg(a){var c=0,d=0;return function(){var e=$c(),f=y-(e-d);if(d=e,f>0){if(++c>=x)return arguments[0]}else c=0;return a.apply(b,arguments)}}function lg(a){if("string"==typeof a||dh(a))return a;var b=a+"";return"0"==b&&1/a==-C?"-0":b}function mg(a){if(null!=a){try{return Mb.call(a)}catch(b){}try{return a+""}catch(b){}}return""}function ng(a,b){return kc(H,function(c){var d="_."+c[0];b&c[1]&&!mc(a,d)&&a.push(d)}),a.sort()}function og(a){if(a instanceof wd)return a.clone();var b=new vd(a.__wrapped__,a.__chain__);
return b.__actions__=hf(a.__actions__),b.__index__=a.__index__,b.__values__=a.__values__,b}function pg(a){var b=null==a?0:a.length;return b?le(a,1):[]}function qg(a,b,c){var d=null==a?0:a.length;if(!d)return-1;var e=null==c?0:ih(c);return 0>e&&(e=Yc(d+e,0)),uc(a,b,e)}function sg(a){var c=null==a?0:a.length;return c?a[c-1]:b}function ug(a,b){return a&&a.length&&b&&b.length?Me(a,b):a}function vg(a){return null==a?a:bd.call(a)}function xg(a){var b=sd(a);return b.__chain__=!0,b}function yg(a,b){return b(a),a}function zg(a,b){return b(a)
}function Bg(){return xg(this)}function Cg(){return new vd(this.value(),this.__chain__)}function Dg(){this.__values__===b&&(this.__values__=gh(this.value()));var a=this.__index__>=this.__values__.length,c=a?b:this.__values__[this.__index__++];return{done:a,value:c}}function Eg(){return this}function Fg(a){for(var c,d=this;d instanceof ud;){var e=og(d);e.__index__=0,e.__values__=b,c?f.__wrapped__=e:c=e;var f=e;d=d.__wrapped__}return f.__wrapped__=a,c}function Gg(){var a=this.__wrapped__;if(a instanceof wd){var c=a;
return this.__actions__.length&&(c=new wd(this)),c=c.reverse(),c.__actions__.push({func:zg,args:[vg],thisArg:b}),new vd(c,this.__chain__)}return this.thru(vg)}function Hg(){return Te(this.__wrapped__,this.__actions__)}function Ig(a,b){var c=Ug(a)?lc:ke;return c(a,Cf(b,3))}function Jg(a,b){var c=Ug(a)?kc:je;return c(a,Cf(b,3))}function Kg(a,b){var c=Ug(a)?oc:Fe;return c(a,Cf(b,3))}function Ng(a,c,d){function p(c){var d=f,e=g;return f=g=b,l=c,i=a.apply(e,d)}function q(a){return l=a,j=gg(t,c),m?p(a):i}function r(a){var b=a-k,d=a-l,e=c-b;
return n?Zc(e,h-d):e}function s(a){var d=a-k,e=a-l;return k===b||d>=c||0>d||n&&e>=h}function t(){var a=Mg();return s(a)?u(a):(j=gg(t,r(a)),void 0)}function u(a){return j=b,o&&f?p(a):(f=g=b,i)}function v(){j!==b&&We(j),l=0,f=k=g=j=b}function w(){return j===b?i:u(Mg())}function x(){var a=Mg(),d=s(a);if(f=arguments,g=this,k=a,d){if(j===b)return q(k);if(n)return j=gg(t,c),p(k)}return j===b&&(j=gg(t,c)),i}var f,g,h,i,j,k,l=0,m=!1,n=!1,o=!0;if("function"!=typeof a)throw new Hb(e);return c=jh(c)||0,ah(d)&&(m=!!d.leading,n="maxWait"in d,h=n?Yc(jh(d.maxWait)||0,c):h,o="trailing"in d?!!d.trailing:o),x.cancel=v,x.flush=w,x
}function Pg(a,b){if("function"!=typeof a||null!=b&&"function"!=typeof b)throw new Hb(e);var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],f=c.cache;if(f.has(e))return f.get(e);var g=a.apply(this,d);return c.cache=f.set(e,g)||f,g};return c.cache=new(Pg.Cache||Md),c}function Qg(a){if("function"!=typeof a)throw new Hb(e);return function(){var b=arguments;switch(b.length){case 0:return!a.call(this);case 1:return!a.call(this,b[0]);case 2:return!a.call(this,b[0],b[1]);case 3:return!a.call(this,b[0],b[1],b[2])
}return!a.apply(this,b)}}function Rg(a,b,c){var d=!0,f=!0;if("function"!=typeof a)throw new Hb(e);return ah(c)&&(d="leading"in c?!!c.leading:d,f="trailing"in c?!!c.trailing:f),Ng(a,b,{leading:d,maxWait:b,trailing:f})}function Sg(a,b){return a===b||a!==a&&b!==b}function Vg(a){return null!=a&&_g(a.length)&&!$g(a)}function Wg(a){return bh(a)&&Vg(a)}function Xg(a){return a===!0||a===!1||bh(a)&&re(a)==L}function Zg(a){if(null==a)return!0;if(Vg(a)&&(Ug(a)||"string"==typeof a||"function"==typeof a.splice||Yg(a)||eh(a)||Tg(a)))return!a.length;
var b=Jf(a);if(b==Q||b==X)return!a.size;if(Yf(a))return!De(a).length;for(var c in a)if(Nb.call(a,c))return!1;return!0}function $g(a){if(!ah(a))return!1;var b=re(a);return b==O||b==P||b==K||b==V}function _g(a){return"number"==typeof a&&a>-1&&a%1==0&&D>=a}function ah(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}function bh(a){return null!=a&&"object"==typeof a}function ch(a){return"string"==typeof a||!Ug(a)&&bh(a)&&re(a)==Y}function dh(a){return"symbol"==typeof a||bh(a)&&re(a)==Z}function fh(a){return a===b
}function gh(a){if(!a)return[];if(Vg(a))return ch(a)?Mc(a):hf(a);if(tc&&a[tc])return Gc(a[tc]());var b=Jf(a),c=b==Q?Hc:b==X?Kc:th;return c(a)}function hh(a){if(!a)return 0===a?a:0;if(a=jh(a),a===C||a===-C){var b=0>a?-1:1;return b*E}return a===a?a:0}function ih(a){var b=hh(a),c=b%1;return b===b?c?b-c:b:0}function jh(a){if("number"==typeof a)return a;if(dh(a))return F;if(ah(a)){var b="function"==typeof a.valueOf?a.valueOf():a;a=ah(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(qb,"");var c=xb.test(a);
return c||zb.test(a)?Zb(a.slice(2),c?2:8):wb.test(a)?F:+a}function kh(a){return null==a?"":Se(a)}function nh(a,c,d){var e=null==a?b:pe(a,c);return e===b?d:e}function oh(a,b){return null!=a&&Mf(a,b,se)}function ph(a,b){return null!=a&&Mf(a,b,te)}function qh(a){return Vg(a)?_d(a):De(a)}function rh(a){return Vg(a)?_d(a,!0):Ee(a)}function th(a){return null==a?[]:Bc(a,qh(a))}function uh(a){return function(){return a}}function vh(a){return a}function wh(a){return Ce("function"==typeof a?a:ge(a,i))}function xh(a,b,c){var d=qh(b),e=oe(b,d);
null!=c||ah(b)&&(e.length||!d.length)||(c=b,b=a,a=this,e=oe(b,qh(b)));var f=!(ah(c)&&"chain"in c&&!c.chain),g=$g(a);return kc(e,function(c){var d=b[c];a[c]=d,g&&(a.prototype[c]=function(){var b=this.__chain__;if(f||b){var c=a(this.__wrapped__),e=c.__actions__=hf(this.__actions__);return e.push({func:d,args:arguments,thisArg:a}),c.__chain__=b,c}return d.apply(a,pc([this.value()],arguments))})}),a}function yh(){}function zh(a){return Uf(a)?xc(lg(a)):Le(a)}function Ah(){return[]}function Bh(){return!1}a=null==a?ac:Pc.defaults(ac.Object(),a,Pc.pick(ac,Wb));
var h=a.Array,v=a.Date,Cb=(a.Error,a.Function),Db=a.Math,Eb=a.Object,Fb=a.RegExp,Gb=a.String,Hb=a.TypeError,Ib=h.prototype,Jb=Cb.prototype,Kb=Eb.prototype,Lb=a["__core-js_shared__"],Mb=Jb.toString,Nb=Kb.hasOwnProperty,Pb=function(){var a=/[^.]+$/.exec(Lb&&Lb.keys&&Lb.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Qb=Kb.toString,Tb=(Mb.call(Eb),ac._,Fb("^"+Mb.call(Nb).replace(pb,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$")),Ub=dc?a.Buffer:b,Vb=a.Symbol,$b=a.Uint8Array,_b=Ub?Ub.allocUnsafe:b,bc=Ic(Eb.getPrototypeOf,Eb),cc=Eb.create,ec=Kb.propertyIsEnumerable,fc=Ib.splice,sc=Vb?Vb.isConcatSpreadable:b,tc=Vb?Vb.iterator:b,wc=Vb?Vb.toStringTag:b,Fc=function(){try{var a=Ff(Eb,"defineProperty");
return a({},"",{}),a}catch(b){}}(),Lc=a.clearTimeout!==ac.clearTimeout&&a.clearTimeout,Nc=v&&v.now!==ac.Date.now&&v.now,Oc=a.setTimeout!==ac.setTimeout&&a.setTimeout,Tc=(Db.ceil,Db.floor,Eb.getOwnPropertySymbols),Uc=Ub?Ub.isBuffer:b,Xc=(a.isFinite,Ib.join,Ic(Eb.keys,Eb)),Yc=Db.max,Zc=Db.min,$c=v.now,bd=(a.parseInt,Db.random,Ib.reverse),cd=Ff(a,"DataView"),dd=Ff(a,"Map"),ed=Ff(a,"Promise"),fd=Ff(a,"Set"),gd=Ff(a,"WeakMap"),hd=Ff(Eb,"create"),id=gd&&new gd,jd={},kd=mg(cd),ld=mg(dd),md=mg(ed),nd=mg(fd),od=mg(gd),pd=Vb?Vb.prototype:b,qd=pd?pd.valueOf:b,rd=pd?pd.toString:b,td=function(){function a(){}return function(c){if(!ah(c))return{};
if(cc)return cc(c);a.prototype=c;var d=new a;return a.prototype=b,d}}();sd.prototype=ud.prototype,sd.prototype.constructor=sd,vd.prototype=td(ud.prototype),vd.prototype.constructor=vd,wd.prototype=td(ud.prototype),wd.prototype.constructor=wd,Ad.prototype.clear=Bd,Ad.prototype["delete"]=Cd,Ad.prototype.get=Dd,Ad.prototype.has=Ed,Ad.prototype.set=Fd,Gd.prototype.clear=Hd,Gd.prototype["delete"]=Id,Gd.prototype.get=Jd,Gd.prototype.has=Kd,Gd.prototype.set=Ld,Md.prototype.clear=Nd,Md.prototype["delete"]=Od,Md.prototype.get=Pd,Md.prototype.has=Qd,Md.prototype.set=Rd,Sd.prototype.add=Sd.prototype.push=Td,Sd.prototype.has=Ud,Vd.prototype.clear=Wd,Vd.prototype["delete"]=Xd,Vd.prototype.get=Yd,Vd.prototype.has=Zd,Vd.prototype.set=$d;
var je=nf(ne),me=of(),Pe=id?function(a,b){return id.set(a,b),a}:vh,Qe=Fc?function(a,b){return Fc(a,"toString",{configurable:!0,enumerable:!1,value:uh(b),writable:!0})}:vh,We=Lc||function(a){return ac.clearTimeout(a)},zf=id?function(a){return id.get(a)}:yh,Hf=Tc?function(a){return null==a?[]:(a=Eb(a),lc(Tc(a),function(b){return ec.call(a,b)}))}:Ah,If=Tc?function(a){for(var b=[];a;)pc(b,Hf(a)),a=bc(a);return b}:Ah,Jf=re;(cd&&Jf(new cd(new ArrayBuffer(1)))!=bb||dd&&Jf(new dd)!=Q||ed&&Jf(ed.resolve())!=U||fd&&Jf(new fd)!=X||gd&&Jf(new gd)!=_)&&(Jf=function(a){var c=re(a),d=c==T?a.constructor:b,e=d?mg(d):"";
if(e)switch(e){case kd:return bb;case ld:return Q;case md:return U;case nd:return X;case od:return _}return c});var fg=jg(Pe),gg=Oc||function(a,b){return ac.setTimeout(a,b)},hg=jg(Qe),kg=_f(function(a){var b=[];return nb.test(a)&&b.push(""),a.replace(ob,function(a,c,d,e){b.push(d?e.replace(ub,"$1"):c||a)}),b}),rg=Ne(function(a){var b=oc(a,Ue);return b.length&&b[0]===a[0]?ue(b):[]}),tg=Ne(ug),wg=Ne(function(a,b){return Wg(a)?ie(a,b):[]}),Lg=(wf(function(a){var c=a.length,d=c?a[0]:0,e=this.__wrapped__,f=function(b){return fe(b,a)
};return!(c>1||this.__actions__.length)&&e instanceof wd&&Sf(d)?(e=e.slice(d,+d+(c?1:0)),e.__actions__.push({func:zg,args:[f],thisArg:b}),new vd(e,this.__chain__).thru(function(a){return c&&!a.length&&a.push(b),a})):this.thru(f)}),Ne(function(a,b){if(null==a)return[];var c=b.length;return c>1&&Tf(a,b[0],b[1])?b=[]:c>2&&Tf(b[0],b[1],b[2])&&(b=[b[0]]),Ie(a,le(b,1),[])})),Mg=Nc||function(){return ac.Date.now()},Og=Ne(function(a,b,c){return he(a,jh(b)||0,c)});Pg.Cache=Md;var Tg=we(function(){return arguments}())?we:function(a){return bh(a)&&Nb.call(a,"callee")&&!ec.call(a,"callee")
},Ug=h.isArray,Yg=Uc||Bh,eh=gc?Ac(gc):Be,lh=mf(function(a,b,c,d){jf(b,rh(b),a,d)}),mh=Ne(function(a){return a.push(b,sf),jc(lh,b,a)}),sh=wf(function(a,b){return null==a?{}:Je(a,b)});return sd.assignInWith=lh,sd.chain=xg,sd.constant=uh,sd.debounce=Ng,sd.defaults=mh,sd.delay=Og,sd.filter=Ig,sd.flatten=pg,sd.intersection=rg,sd.iteratee=wh,sd.keys=qh,sd.keysIn=rh,sd.map=Kg,sd.memoize=Pg,sd.mixin=xh,sd.negate=Qg,sd.pick=sh,sd.property=zh,sd.pull=tg,sd.pullAll=ug,sd.reverse=vg,sd.sortBy=Lg,sd.tap=yg,sd.throttle=Rg,sd.thru=zg,sd.toArray=gh,sd.values=th,sd.without=wg,sd.extendWith=lh,xh(sd,sd),sd.eq=Sg,sd.forEach=Jg,sd.get=nh,sd.has=oh,sd.hasIn=ph,sd.identity=vh,sd.indexOf=qg,sd.isArguments=Tg,sd.isArray=Ug,sd.isArrayLike=Vg,sd.isArrayLikeObject=Wg,sd.isBoolean=Xg,sd.isBuffer=Yg,sd.isEmpty=Zg,sd.isFunction=$g,sd.isLength=_g,sd.isObject=ah,sd.isObjectLike=bh,sd.isString=ch,sd.isSymbol=dh,sd.isTypedArray=eh,sd.isUndefined=fh,sd.last=sg,sd.stubArray=Ah,sd.stubFalse=Bh,sd.noop=yh,sd.now=Mg,sd.runInContext=Qc,sd.toFinite=hh,sd.toInteger=ih,sd.toNumber=jh,sd.toString=kh,sd.each=Jg,xh(sd,function(){var a={};
return ne(sd,function(b,c){Nb.call(sd.prototype,c)||(a[c]=b)}),a}(),{chain:!1}),sd.VERSION=c,kc(["drop","take"],function(a,c){wd.prototype[a]=function(d){d=d===b?1:Yc(ih(d),0);var e=this.__filtered__&&!c?new wd(this):this.clone();return e.__filtered__?e.__takeCount__=Zc(d,e.__takeCount__):e.__views__.push({size:Zc(d,G),type:a+(e.__dir__<0?"Right":"")}),e},wd.prototype[a+"Right"]=function(b){return this.reverse()[a](b).reverse()}}),kc(["filter","map","takeWhile"],function(a,b){var c=b+1,d=c==z||c==B;wd.prototype[a]=function(a){var b=this.clone();
return b.__iteratees__.push({iteratee:Cf(a,3),type:c}),b.__filtered__=b.__filtered__||d,b}}),kc(["head","last"],function(a,b){var c="take"+(b?"Right":"");wd.prototype[a]=function(){return this[c](1).value()[0]}}),kc(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");wd.prototype[a]=function(){return this.__filtered__?new wd(this):this[c](1)}}),wd.prototype.compact=function(){return this.filter(vh)},wd.prototype.find=function(a){return this.filter(a).head()},wd.prototype.findLast=function(a){return this.reverse().find(a)
},wd.prototype.invokeMap=Ne(function(a,b){return"function"==typeof a?new wd(this):this.map(function(c){return ve(c,a,b)})}),wd.prototype.reject=function(a){return this.filter(Qg(Cf(a)))},wd.prototype.slice=function(a,c){a=ih(a);var d=this;return d.__filtered__&&(a>0||0>c)?new wd(d):(0>a?d=d.takeRight(-a):a&&(d=d.drop(a)),c!==b&&(c=ih(c),d=0>c?d.dropRight(-c):d.take(c-a)),d)},wd.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},wd.prototype.toArray=function(){return this.take(G)
},ne(wd.prototype,function(a,c){var d=/^(?:filter|find|map|reject)|While$/.test(c),e=/^(?:head|last)$/.test(c),f=sd[e?"take"+("last"==c?"Right":""):c],g=e||/^find/.test(c);f&&(sd.prototype[c]=function(){var c=this.__wrapped__,h=e?[1]:arguments,i=c instanceof wd,j=h[0],k=i||Ug(c),l=function(a){var b=f.apply(sd,pc([a],h));return e&&m?b[0]:b};k&&d&&"function"==typeof j&&1!=j.length&&(i=k=!1);var m=this.__chain__,n=!!this.__actions__.length,o=g&&!m,p=i&&!n;if(!g&&k){c=p?c:new wd(this);var q=a.apply(c,h);return q.__actions__.push({func:zg,args:[l],thisArg:b}),new vd(q,m)
}return o&&p?a.apply(this,h):(q=this.thru(l),o?e?q.value()[0]:q.value():q)})}),kc(["pop","push","shift","sort","splice","unshift"],function(a){var b=Ib[a],c=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",d=/^(?:pop|shift)$/.test(a);sd.prototype[a]=function(){var a=arguments;if(d&&!this.__chain__){var e=this.value();return b.apply(Ug(e)?e:[],a)}return this[c](function(c){return b.apply(Ug(c)?c:[],a)})}}),ne(wd.prototype,function(a,b){var c=sd[b];if(c){var d=c.name+"",e=jd[d]||(jd[d]=[]);e.push({name:b,func:c})
}}),jd[qf(b,o).name]=[{name:"wrapper",func:b}],wd.prototype.clone=xd,wd.prototype.reverse=yd,wd.prototype.value=zd,sd.prototype.chain=Bg,sd.prototype.commit=Cg,sd.prototype.next=Dg,sd.prototype.plant=Fg,sd.prototype.reverse=Gg,sd.prototype.toJSON=sd.prototype.valueOf=sd.prototype.value=Hg,sd.prototype.first=sd.prototype.head,tc&&(sd.prototype[tc]=Eg),sd},Pc=Oc(),Pc=a._=Oc();Pc.pluck=Pc.map,a.each(Pc,function(b,c){Object.hasOwnProperty.call(Pc,b)&&!/VERSION/.test(name)&&(a[b]||(a[b]=c))})}),FD50.plugin("bootstrap",function(a){var b=a;
+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]}}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one(a.support.transition.end,function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b()
})}(b),+function(a){"use strict";var b='[data-bp-dismiss="alert"]',c=function(c){a(c).on("click",b,this.close)};c.prototype.close=function(b){function f(){e.trigger("closed.bs.alert").remove()}var c=a(this),d=c.attr("data-target");d||(d=c.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,""));var e=a(d);b&&b.preventDefault(),e.length||(e=c.hasClass("alert")?c:c.parent()),e.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(e.removeClass("in"),a.support.transition&&e.hasClass("fade")?e.one(a.support.transition.end,f).emulateTransitionEnd(150):f())
};var d=a.fn.alert;a.fn.alert=function(b){return this.each(function(){var d=a(this),e=d.data("bs.alert");e||d.data("bs.alert",e=new c(this)),"string"==typeof b&&e[b].call(d)})},a.fn.alert.Constructor=c,a.fn.alert.noConflict=function(){return a.fn.alert=d,this},a(document).on("click.bs.alert.data-api",b,c.prototype.close)}(b),+function(a){"use strict";var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d)};b.DEFAULTS={loadingText:"loading..."},b.prototype.setState=function(a){var b="disabled",c=this.$element,d=c.is("input")?"val":"html",e=c.data();
a+="Text",e.resetText||c.data("resetText",c[d]()),c[d](e[a]||this.options[a]),setTimeout(function(){"loadingText"==a?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},b.prototype.toggle=function(){var a=this.$element.closest('[data-bp-toggle="buttons"]'),b=!0;if(a.length){var c=this.$element.find("input");"radio"===c.prop("type")&&(c.prop("checked")&&this.$element.hasClass("active")?b=!1:a.find(".active").removeClass("active")),b&&c.prop("checked",!this.$element.hasClass("active")).trigger("change")
}b&&this.$element.toggleClass("active")};var c=a.fn.button;a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof c&&c;e||d.data("bs.button",e=new b(this,f)),"toggle"==c?e.toggle():c&&e.setState(c)})},a.fn.button.Constructor=b,a.fn.button.noConflict=function(){return a.fn.button=c,this},a(document).on("click.bs.button.data-api","[data-bp-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle"),b.preventDefault()
})}(b),+function(a){"use strict";var b=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},b.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this
},b.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},b.prototype.to=function(b){var c=this,d=this.getActiveIndex();return b>this.$items.length-1||0>b?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){c.to(b)}):d==b?this.pause().cycle():this.slide(b>d?"next":"prev",a(this.$items[b]))},b.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition.end&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this
},b.prototype.next=function(){return this.sliding?void 0:this.slide("next")},b.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},b.prototype.slide=function(b,c){var d=this.$element.find(".item.active"),e=c||d[b](),f=this.interval,g="next"==b?"left":"right",h="next"==b?"first":"last",i=this;if(!e.length){if(!this.options.wrap)return;e=this.$element.find(".item")[h]()}this.sliding=!0,f&&this.pause();var j=a.Event("slide.bs.carousel",{relatedTarget:e[0],direction:g});if(!e.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var b=a(i.$indicators.children()[i.getActiveIndex()]);
b&&b.addClass("active")})),a.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(j),j.isDefaultPrevented())return;e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),d.one(a.support.transition.end,function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger("slid.bs.carousel")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(j),j.isDefaultPrevented())return;d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger("slid.bs.carousel")
}return f&&this.cycle(),this}};var c=a.fn.carousel;a.fn.carousel=function(c){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c),g="string"==typeof c?c:f.slide;e||d.data("bs.carousel",e=new b(this,f)),"number"==typeof c?e.to(c):g?e[g]():f.interval&&e.pause().cycle()})},a.fn.carousel.Constructor=b,a.fn.carousel.noConflict=function(){return a.fn.carousel=c,this},a(document).on("click.bs.carousel.data-api","[data-bp-slide], [data-bp-slide-to]",function(b){var d,c=a(this),e=a(c.attr("data-target")||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),f=a.extend({},e.data(),c.data()),g=c.attr("data-bp-slide-to");
g&&(f.interval=!1),e.carousel(f),(g=c.attr("data-bp-slide-to"))&&e.data("bs.carousel").to(g),b.preventDefault()}),a(window).on("load",function(){a('[data-bp-ride="carousel"]').each(function(){var b=a(this);b.carousel(b.data())})})}(b),+function(a){"use strict";var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d),this.transitioning=null,this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};b.DEFAULTS={toggle:!0},b.prototype.dimension=function(){var a=this.$element.hasClass("width");
return a?"width":"height"},b.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b=a.Event("show.bs.collapse");if(this.$element.triggerHandler(b),!b.isDefaultPrevented()){var c=this.$parent&&this.$parent.find("> .panel > .in");if(c&&c.length){var d=c.data("bs.collapse");if(d&&d.transitioning)return;c.collapse("hide"),d||c.data("bs.collapse",null)}var e=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[e](0),this.transitioning=1;var f=function(){this.$element.removeClass("collapsing").addClass("in")[e]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")
};if(!a.support.transition)return f.call(this);var g=a.camelCase(["scroll",e].join("-"));this.$element.one(a.support.transition.end,a.proxy(f,this)).emulateTransitionEnd(350)[e](this.$element[0][g])}}},b.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.triggerHandler(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;
var d=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return a.support.transition?(this.$element[c](0).one(a.support.transition.end,a.proxy(d,this)).emulateTransitionEnd(350),void 0):d.call(this)}}},b.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var c=a.fn.collapse;a.fn.collapse=function(c){return this.each(function(){var d=a(this),e=d.data("bs.collapse"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c);
e||d.data("bs.collapse",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.collapse.Constructor=b,a.fn.collapse.noConflict=function(){return a.fn.collapse=c,this},a(document).on("click.bs.collapse.data-api","[data-bp-toggle=collapse]",function(b){var d,c=a(this),e=c.attr("data-target")||b.preventDefault()||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""),f=a(e),g=f.data("bs.collapse"),h=g?"toggle":c.data(),i=c.attr("data-parent"),j=i&&a(i);g&&g.transitioning||(j&&j.find('[data-bp-toggle=collapse][data-parent="'+i+'"]').not(c).addClass("collapsed"),c[f.hasClass("in")?"addClass":"removeClass"]("collapsed")),f.collapse(h)
})}(b),+function(a){"use strict";function e(){window["Foundry/Bootstrap"]||a(b).remove(),a(c).each(function(b){var c=f(a(this));c.hasClass("open")&&(c.triggerHandler(b=a.Event("hide.bs.dropdown")),b.isDefaultPrevented()||c.removeClass("open").trigger("hidden.bs.dropdown"))})}function f(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}var b=".dropdown-backdrop",c="[data-bp-toggle=dropdown]",d=function(b){a(b).on("click.bs.dropdown",this.toggle)
};d.prototype.toggle=function(b){var c=a(this);if(!c.is(".disabled, :disabled")){var d=f(c),g=d.hasClass("open");if(e(),!g){if("ontouchstart"in document.documentElement&&!d.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",e),d.triggerHandler(b=a.Event("show.bs.dropdown")),b.isDefaultPrevented())return;d.toggleClass("open").trigger("shown.bs.dropdown"),c.focus()}return!1}},d.prototype.keydown=function(b){if(/(38|40|27)/.test(b.keyCode)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var e=f(d),g=e.hasClass("open");
if(!g||g&&27==b.keyCode)return 27==b.which&&e.find(c).focus(),d.click();var h=a("[role=menu] li:not(.divider):visible a",e);if(h.length){var i=h.index(h.filter(":focus"));38==b.keyCode&&i>0&&i--,40==b.keyCode&&i<h.length-1&&i++,~i||(i=0),h.eq(i).focus()}}}};var g=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),e=c.data("bs.dropdown");e||c.data("bs.dropdown",e=new d(this)),"string"==typeof b&&e[b].call(c)})},a.fn.dropdown.Constructor=d,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=g,this
},a(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown_ form, .dropdown-static",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",c,d.prototype.toggle).on("keydown.bs.dropdown.data-api",c+", [role=menu]",d.prototype.keydown)}(b),+function(a){"use strict";var b=function(b,c){this.options=c,this.$element=a(b),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};b.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},b.prototype.toggle=function(a){return this[this.isShown?"hide":"show"](a)
},b.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.triggerHandler(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-bp-dismiss="modal"]',a.proxy(this.hide,this)),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(document.body),c.$element.show(),d&&c.$element[0].offsetWidth,c.$element.addClass("in").attr("aria-hidden",!1),c.enforceFocus();
var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$element.find(".modal-dialog").one(a.support.transition.end,function(){c.$element.focus().trigger(e)}).emulateTransitionEnd(300):c.$element.focus().trigger(e)}))},b.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.triggerHandler(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one(a.support.transition.end,a.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())
},b.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.focus()},this))},b.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},b.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.removeBackdrop(),a.$element.trigger("hidden.bs.modal")
})},b.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},b.prototype.backdrop=function(b){var d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;if(this.$backdrop=a('<div class="modal-backdrop '+d+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",a.proxy(function(a){a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))
},this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;e?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()):b&&b()};var c=a.fn.modal;a.fn.modal=function(c,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},b.DEFAULTS,e.data(),"object"==typeof c&&c);
f||e.data("bs.modal",f=new b(this,g)),"string"==typeof c?f[c](d):g.show&&f.show(d)})},a.fn.modal.Constructor=b,a.fn.modal.noConflict=function(){return a.fn.modal=c,this},a(document).on("click.bs.modal.data-api",'[data-bp-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());b.preventDefault(),e.modal(f,this).one("hide",function(){c.is(":visible")&&c.focus()})}),a(document).on("show.bs.modal",".modal.bs",function(){a(document.body).addClass("modal-open")
}).on("hidden.bs.modal",".modal.bs",function(){a(document.body).removeClass("modal-open")})}(b),+function(a){"use strict";var b=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};b.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},b.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d);
for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focus",i="hover"==g?"mouseleave":"blur";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()
},b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},b.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},b.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);
return clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show),void 0):c.show()},b.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide),void 0):c.hide()
},b.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.triggerHandler(b),b.isDefaultPrevented())return;var c=this.tip();this.setContent(),this.options.animation&&c.addClass("fade");var d="function"==typeof this.options.placement?this.options.placement.call(this,c[0],this.$element[0]):this.options.placement,e=/\s?auto?\s?/i,f=e.test(d);f&&(d=d.replace(e,"")||"top"),c.detach().css({top:0,left:0,display:"block"}).addClass(d.split("-")[0]),this.options.container?c.appendTo(this.options.container):c.insertAfter(this.$element);
var g=this.getPosition(),h=c[0].offsetWidth,i=c[0].offsetHeight;if(f){var j=this.$element.parent(),k=d,l=document.documentElement.scrollTop||document.body.scrollTop,m="body"==this.options.container?window.innerWidth:j.outerWidth(),n="body"==this.options.container?window.innerHeight:j.outerHeight(),o="body"==this.options.container?0:j.offset().left;d="bottom"==d&&g.top+g.height+i-l>n?"top":"top"==d&&g.top-l-i<0?"bottom":"right"==d&&g.right+h>m?"left":"left"==d&&g.left-h<o?"right":d,c.removeClass(k).addClass(d)
}var p=this.getCalculatedOffset(d,g,h,i);this.applyPlacement(p,d),this.$element.trigger("shown.bs."+this.type)}},b.prototype.applyPlacement=function(a,b){var c,d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),a.top=a.top+g,a.left=a.left+h,d.offset(a).addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;if("top"==b&&j!=f&&(c=!0,a.top=a.top+f-j),0===["top","bottom"].indexOf(b.split("-")[0])){var k=0;a.left<0&&(k=-2*a.left,a.left=0,d.offset(a),i=d[0].offsetWidth,j=d[0].offsetHeight),this.replaceArrow(k-e+i,i,"left")
}0===["left","right"].indexOf(b.split("-")[0])&&this.replaceArrow(j-f,j,"top"),c&&d.offset(a)},b.prototype.replaceArrow=function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},b.prototype.hide=function(){function e(){"in"!=b.hoverState&&c.detach()}var b=this,c=this.tip(),d=a.Event("hide.bs."+this.type);return this.$element.triggerHandler(d),d.isDefaultPrevented()?void 0:(c.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?c.one(a.support.transition.end,e).emulateTransitionEnd(150):e(),this.$element.trigger("hidden.bs."+this.type),this)
},b.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},b.prototype.hasContent=function(){return this.getTitle()},b.prototype.getPosition=function(){var b=this.$element[0];return a.extend({},"function"==typeof b.getBoundingClientRect?b.getBoundingClientRect():{width:b.offsetWidth,height:b.offsetHeight},this.$element.offset())},b.prototype.getCalculatedOffset=function(a,b,c,d){return"left-top"==a?{top:b.top,left:b.left-c}:"left-bottom"==a?{top:b.top+b.height-d,left:b.left-c}:"right-top"==a?{top:b.top,left:b.left+b.width}:"right-bottom"==a?{top:b.top+b.height-d,left:b.left+b.width}:"top-left"==a?{top:b.top-d,left:b.left}:"top-right"==a?{top:b.top-d,left:b.left+b.width-c}:"bottom-left"==a?{top:b.top+b.height,left:b.left}:"bottom-right"==a?{top:b.top+b.height,left:b.left+b.width-c}:"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}
},b.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},b.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},b.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},b.prototype.enable=function(){this.enabled=!0},b.prototype.disable=function(){this.enabled=!1
},b.prototype.toggleEnabled=function(){this.enabled=!this.enabled},b.prototype.toggle=function(b){var c=b?a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;c.tip().hasClass("in")?c.leave(c):c.enter(c)},b.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var c=a.fn.tooltip;a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof c&&c;e||d.data("bs.tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()
})},a.fn.tooltip.Constructor=b,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=c,this}}(b),+function(a){"use strict";var b=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");b.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div id="eb" class="eb-popover"><div class="arrow"></div><h3 class="eb-popover-title"></h3><div class="eb-popover-content"></div></div>'}),b.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),b.prototype.constructor=b,b.prototype.getDefaults=function(){return b.DEFAULTS
},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".eb-popover-title")[this.options.html?"html":"text"](b),a.find(".eb-popover-content")[this.options.html?"html":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".eb-popover-title").html()||a.find(".eb-popover-title").hide()},b.prototype.hasContent=function(){return this.getTitle()||this.getContent()},b.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)
},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},b.prototype.tip=function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip};var c=a.fn.popover;a.fn.popover=function(c){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof c&&c;e||d.data("bs.popover",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.popover.Constructor=b,a.fn.popover.noConflict=function(){return a.fn.popover=c,this}}(b),+function(a){"use strict";var b=function(b){this.element=a(b)
};b.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a")[0],f=a.Event("show.bs.tab",{relatedTarget:e});if(b.triggerHandler(f),!f.isDefaultPrevented()){var g=a(d);this.activate(b.parent("li"),c),this.activate(g,g.parent(),function(){b.trigger({type:"shown.bs.tab",relatedTarget:e})})}}},b.prototype.activate=function(b,c,d){function g(){e.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),f?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()
}var e=c.find("> .active"),f=d&&a.support.transition&&e.hasClass("fade");f?e.one(a.support.transition.end,g).emulateTransitionEnd(150):g(),e.removeClass("in")};var c=a.fn.tab;a.fn.tab=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new b(this)),"string"==typeof c&&e[c]()})},a.fn.tab.Constructor=b,a.fn.tab.noConflict=function(){return a.fn.tab=c,this},a(document).on("click.bs.tab.data-api",'[data-bp-toggle="tab"], [data-bp-toggle="pill"]',function(b){b.preventDefault(),a(this).tab("show")
})}(b),a(document).on("click.button.data-bp-api","[data-bp-toggle-value]",function(){var b=a(this),d=(b.siblings("[data-bp-toggle-value]"),b.parents('[data-bp-toggle="radio-buttons"]'));if(!d.hasClass("disabled")&&d.length>0){var e=b.data("bp-toggle-value");return d.find("input[type=hidden]").val(e).trigger("change"),void 0}}),a(document).on("change.data-bp-input",'[data-bp-toggle="radio-buttons"] input[type=hidden]',function(){{var b=a(this),c=b.siblings("[data-bp-toggle-value]");b.val()}c.removeClass("active").filter('[data-bp-toggle-value="'+b.val()+'"]').addClass("active")
}),a(document).on("mouseover.tooltip.data-eb-api","[data-eb-provide=tooltip]",function(){var c=a(this),d=c.parents("#eb").is(".w320, .w480");d||c.tooltip({delay:{show:200,hide:100},animation:!1,template:'<div id="eb" class="eb tooltip tooltip-eb"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',container:"body"}).tooltip("show")}),a(document).on("mouseover.popover.data-eb-api","[data-eb-provide=popover]",function(){a(this).popover({delay:{show:200,hide:100},animation:!1,trigger:"hover",container:"body"}).popover("show")
}),!function(a){var b=function(b,c){if(this.$element=a(b),this.$note=a('<div class="alert"></div>'),this.options=a.extend(!0,a.fn.notify.defaults,c),this.options.transition?"fade"==this.options.transition?this.$note.addClass("in").addClass(this.options.transition):this.$note.addClass(this.options.transition):this.$note.addClass("fade").addClass("in"),this.options.type?this.$note.addClass("alert-"+this.options.type):this.$note.addClass("alert-success"),this.options.message||""===this.$element.data("message")?"object"==typeof this.options.message&&(this.options.message.html?this.$note.html(this.options.message.html):this.options.message.text?this.$note.text(this.options.message.text):this.$note.html(this.options.message)):this.$note.html(this.$element.data("message")),this.options.closable)var d=a('<a class="close pull-right" href="javascript: void(0);">&times;</a>');
return a(d).on("click",a.proxy(onClose,this)),this.$note.prepend(d),this};onClose=function(){this.options.onClose(),a(this.$note).remove(),this.options.onClosed()},b.prototype.show=function(){this.options.fadeOut.enabled&&this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",a.proxy(onClose,this)),this.$element.append(this.$note),this.$note.alert()},b.prototype.hide=function(){this.options.fadeOut.enabled?this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",a.proxy(onClose,this)):onClose.call(this)
},a.fn.notify=function(a){return new b(this,a)},a.fn.notify.defaults={type:"success",closable:!0,transition:"fade",fadeOut:{enabled:!0,delay:3e3},message:null,onClose:function(){},onClosed:function(){}}}(a)}),FD50.plugin("utils",function(a){!function(){var b=function(a){this.items=a,this.start=0,this.end=a.length-1,this.node=null,this.stopped=!1};a.extend(b.prototype,{isLooping:function(){return this.stopped?!1:Math.abs(this.start-this.end)>1?(this.node=Math.floor((this.start+this.end)/2),!0):!1},flip:function(a){a?this.end=this.node-1:this.start=this.node+1
},stop:function(){this.stop=!0}}),a.Bloop=function(a){return new b(a)}}(),function(b){var c=function(){this.lastId=0};c.prototype.queue=function(c){var d=this,e=a.uid();return d.lastId=e,function(){if(d.lastId===e){var a=arguments,a=b(c)?c.apply(this,a):a;return b(d.fn)?d.fn.apply(this,a):a}}},a.Enqueue=function(d){var e=new c;b(d)&&(e.fn=d);var f=a.proxy(e.queue,e);return f.reset=function(){e.lastId=0},f}}(a.isFunction),function(){var b={error:"error",warning:"warn",success:"log",info:"info"};a.Exception=function(c){var d=arguments,e=1==d.length,f=3==d.length;
return c=a.isPlainObject(c)?c:{type:e?"error":d[0],message:e?d[0]:d[1]},f&&a.extend(c,d[2]),"development"==a.environment&&console[b[c.type]](c.message,c),c}}(),a.IE=function(){var a=navigator.userAgent;if(a.match(/MSIE 9/))return 9;if(a.match(/MSIE 10/))return 10;if(a.match(/rv:11/i))return 11;for(var b,c=3,d=document.createElement("div"),e=d.getElementsByTagName("i");c++,d.innerHTML="<!--[if gt IE "+c+"]><i></i><![endif]-->",e[0];);return c>4?c:b}(),a.Task=function(b){var c=a.extend(a.Deferred(),{data:{},list:[],add:function(b){var d=a.extend(a.Deferred(),{name:b,item:d});
return c.list.push(d),d},process:function(){return c._promise||(c._promise=a.when.apply(a,c.list).then(c.resolve,c.reject,c.progress)),c}},b);return c},function(){var b=function(a){this.threads=[],this.threadCount=0,this.threadLimit=a.threadLimit||1,this.threadDelay=a.threadDelay||0};a.extend(b.prototype,{add:function(b,c){a.isFunction(b)&&(b.type=c||"normal","deferred"==c&&(b.deferred=a.Deferred().always(a.proxy(this.next,this))),this.threads.push(b),this.run())},addDeferred:function(a){return this.add(a,"deferred")
},next:function(){this.threadCount--,this.run()},run:function(){var a=this;setTimeout(function(){if(!(a.threads.length<1)&&a.threadCount<a.threadLimit){a.threadCount++;var b=a.threads.shift();try{b.call(b,b.deferred)}catch(c){console.error(c)}!b.deferred&&a.next()}},a.threadDelay)}}),a.Threads=function(a){return new b(a)}}(),a.callback=function(b,c){if(a.isFunction(b)){var d=a.uid("cb");return window[d]=function(){return c||delete window[d],b.apply(null,arguments)},d}if(a.isString(b))switch(b){case"destroy":var d=c;
delete window[d]}},a.fn.switchClass=function(b,c){var c=c||"-",d=b.split(c)[0]+c,e=d.length;return this.each(function(){var c=a(this),f=a.map((c.attr("class")||"").split(" "),function(a){return a.slice(0,e)==d||""==a?null:a});f.push(b),c.attr("class",f.join(" "))})},a.fn.activateClass=function(b){return this.prevObject.removeClass(b),a(this).addClass(b)},function(){var b=function(a){var a=parseInt(a.indexOf("#")>-1?a.substring(1):a,16);return{r:a>>16,g:(65280&a)>>8,b:255&a}},c=function(a){return d(b(a))},d=function(a){var b={h:0,s:0,b:0},c=Math.min(a.r,a.g,a.b),d=Math.max(a.r,a.g,a.b),e=d-c;
return b.b=d,b.s=0!=d?255*e/d:0,0!=b.s?(b.h=a.r==d?(a.g-a.b)/e:a.g==d?2+(a.b-a.r)/e:4+(a.r-a.g)/e,b.h*=60):b.h=360,b.h<0&&(b.h+=360),b.s*=100/255,b.b*=100/255,b},e=function(a){var b={},c=a.h,d=255*a.s/100,e=255*a.b/100;if(0==d)b.r=b.g=b.b=e;else{var f=e,g=(255-d)*e/255,h=(f-g)*(c%60)/60;360==c&&(c=0),60>c?(b.r=f,b.b=g,b.g=g+h):120>c?(b.g=f,b.b=g,b.r=f-h):180>c?(b.g=f,b.r=g,b.b=g+h):240>c?(b.b=f,b.r=g,b.g=f-h):300>c?(b.b=f,b.g=g,b.r=g+h):360>c?(b.r=f,b.g=g,b.b=f-h):(b.r=0,b.g=0,b.b=0)}return{r:Math.round(b.r),g:Math.round(b.g),b:Math.round(b.b)}
},f=function(b){var c=[b.r.toString(16),b.g.toString(16),b.b.toString(16)];return a.each(c,function(a,b){1==b.length&&(c[a]="0"+b)}),c.join("")},g=function(a){return f(e(a))},h=function(a){return{h:Math.min(360,Math.max(0,a.h)),s:Math.min(100,Math.max(0,a.s)),b:Math.min(100,Math.max(0,a.b))}},i=function(a){return{r:Math.min(255,Math.max(0,a.r)),g:Math.min(255,Math.max(0,a.g)),b:Math.min(255,Math.max(0,a.b))}},j=function(a){var b=6-a.length;if(3==b)for(var d,c=a.split(""),a="";d=c.shift();)a+=d+d;else for(;b--;)a="0"+a;
return a.replace(/[^A-Fa-f0-9]/g,"0"),a};a.extend(a,{hexToRgb:b,hexToHsb:c,rgbToHsb:d,hsbToRgb:e,rgbToHex:f,hsbToHex:g,fixHsb:h,fixRgb:i,fixHex:j})}(),a.fn.htmlData=function(b,c){var e,c=void 0===c?!0:c,d=new RegExp("^data-"+(b?b+"-":"")+"(.*)","i"),f={};return a.each(this[0].attributes,function(a,b){if(b.specified&&(e=b.name.match(d))&&e[1])if(c){var a,h,g=e[1].split("-"),i=f;for(max=g.length-1,a=0;max>=a;a++)h=g[a],a==max?i[h]=b.value:(!i[h]&&(i[h]={}),i=i[h])}else f[e[1]]=b.value}),f},a.fn.defineData=function(a,b){return void 0===this.data(a)&&this.data(a,b),this
},a.deletes=function(b,c){a.each(c,function(a,c){delete b[c]})},a.fn.disabled=function(a){return void 0===a?this.is(":disabled")||this.hasClass("disabled"):this.prop("disabled",!!a).toggleClass("disabled",!!a)},a.fn.enabled=function(a){return void 0===a?!this.disabled():this.disabled(!a)},a.fn.tagName=function(){return(this[0]||{}).tagName},a.create=function(b){return a(document.createElement(b))},a.fn.editable=function(b){return a.isUndefined(b)?"true"===this.prop("contenteditable"):(this.prop("contenteditable",b),b===!1&&this.removeAttr("contenteditable"),this)
},a.ns=function(a,b){return a.split(" ").join(b+" ")+b},a.getPointerPosition=function(a){return a.type.match("touch")?{x:a.originalEvent.changedTouches[0].pageX,y:a.originalEvent.changedTouches[0].pageY}:{x:a.pageX,y:a.pageY}},function(){var b="___eventable",c=["on","off","fire"],d=function(a){return a.split(".")[0]},e=function(a){this.fnList={},this.events={},this.mode=a};a.extend(e.prototype,{createEvent:function(b){return this.events[b]=a.Callbacks(this.mode)},on:function(b,c){if(!b||!a.isFunction(c))return this;
var e=this.fnList;(e[b]||(e[b]=[])).push(c);var f=d(b);return(this.events[f]||this.createEvent(f)).add(c),this},off:function(b){if(!b)return this;var c=d(b),e=this.events[c];if(!e)return this;var f=function(b){a.each(b,function(a,b){e.remove(b)})};return c!==b?a.each(this.fnList,function(a,b){a.indexOf(c)>-1&&f(b)}):f(this.fnList[b]),this},fire:function(b){var c=this.events[b];if(c)return c.fire.apply(c,a.makeArray(arguments).slice(1)),this},destroy:function(){for(name in this.events)this.events[name].disable()
}}),a.eventable=function(d,f){var g=d[b];return g&&"destroy"===f?(g.destroy(),a.deletes(d,c),delete d[b]):(g=d[b]=new e(f),d.on=a.proxy(g.on,g),d.off=a.proxy(g.off,g),d.fire=a.proxy(g.fire,g),d)}}(),a.fn.checked=function(b,c){return arguments.length<1?this.is(":checked"):(this.each(function(){var e=a(this);return"boolean"==typeof b?(e.attr("checked",b).trigger("change"),void 0):((e.is("input[type=checkbox]")||e.is("input[type=radio]"))&&e.off("change.checked").on("change.checked",function(){try{return e.is(":checked")?b.apply(e):c.apply(e)
}catch(a){}}),void 0)}),this)},a.fn.locate=function(b){var c="data";return a.each(this[0].attributes,function(a,b){return b.specified&&"$"===b.value?(c=b.name,!1):void 0}),this.find("["+c+"-"+b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"]")},function(){var b=["overflow","overflow-x","overflow-y"];a.fn.noscroll=function(c){return void 0===c&&(c=!0),this.each(function(){var d=a(this),e=d.data("noscroll");!e&&c&&(e={},a.each(b,function(a,b){e[b]=d.css(b)}),d.data("noscroll",e)),c?a.each(b,function(a,b){d.css(b,"hidden")
}):e&&d.css(e)})}}(),a.fn.visible=function(b){var c=a(this),d=a(window);if(!(c.length<1)){var e=d.scrollTop(),f=e+d.height(),g=c.offset().top,h=g+c.height(),i=b===!0?h:g,j=b===!0?g:h;return f>=j&&i>=e}},a.fn.where=a.fn.filterBy=function(a,b,c){var c=c||"=",d="[data-"+a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+c+b+"]";return this.filter(d)},a.fn.checked=function(b,c){return arguments.length<1?this.is(":checked"):(this.each(function(){var e=a(this);return"boolean"==typeof b?(e.attr("checked",b).trigger("change"),void 0):((e.is("input[type=checkbox]")||e.is("input[type=radio]"))&&e.off("change.checked").on("change.checked",function(){try{return e.is(":checked")?b.apply(e):c.apply(e)
}catch(a){}}),void 0)}),this)},a.fn.selectAll=function(){return this.each(function(){this.select()})},a.fn.unselect=function(){return this.each(function(){var a=this,b=a.value;a.value+=" ",a.value=b})},a.fn.toObject=a.fn.serializeObject=function(){var b={};return a.each(a(this).serializeArray(),function(c,d){b.hasOwnProperty(d.name)?(a.isArray(b[d.name])||(b[d.name]=[b[d.name]]),b[d.name].push(d.value)):b[d.name]=d.value}),b},a.fn.toJSON=a.fn.serializeJSON=function(){return JSON.stringify(a(this).serializeObject())
},a.sanitizeHTML=function(b){return a(a.parseHTML(b,document,!0)).toHTML()},a.toHTML=function(b){return a("<div>").html(b).html()},a.fn.toHTML=function(){return a.toHTML(this.clone())},a.toXHTML=function(a,b){var c=a.innerHTML?String(a.innerHTML):a,d=c.match(/(<.+[^>])/g);if(d)for(var e=0;e<d.length;e+=1){var f,g=d[e],h=/\=[a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+[?\s+|?>]/g;if(d[e]=d[e].replace(/([<|<\/].+?\w+).+[^>]/,function(a){return a}),f=d[e].match(h))for(var i=0,j=f.length;j>i;){var k=/(\=)([a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+)?([\s+|?>])/g,l=function(){var a=Array.prototype.slice.call(arguments);
return'="'+(b?a[2]:a[2].toLowerCase())+'"'+a[3]};d[e]=d[e].replace(f[i],f[i].replace(k,l)),i+=1}c=c.replace(g,d[e])}return c},a.fn.xhtml=function(){return a.IE?a.toXHTML(this[0]):this.html()},a.buildHTML=function(b,c){if(b instanceof a)return b;var d=document;if(window.CloudFlare){var e=a.buildHTML.iframe;if(!e||!e.contentDocument){var e=a.buildHTML.iframe=document.createElement("iframe");e.style.display="none",document.body.appendChild(e)}d=e.contentDocument}var b=a.trim(b),f=[],g=a.buildFragment([b],d,f),h=a.merge([],g.childNodes);
if(!c&&f.length>0){var i=d.createElement("script");i.text="try{"+a.callback(function(){a(f).remove()})+"();}catch(e){}";for(var k,l,j=h.length-1;(k=h[j--])&&("SCRIPT"===k.nodeName?l=h.push(i):1===k.nodeType&&(l=k.appendChild(i)),!l););l||h.push(i),f.push(i)}return a(h)},a.isDeferred=function(b){return b&&a.isFunction(b.always)},a.isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},a.regExpEscape=function(a){return a.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},function(){var b=a.Ajax=function(c){c.autostart=!1;
var d=a.ajax(c);return"function"==typeof d.send&&b.queue.addDeferred(function(a){d.send(),setTimeout(a.resolve,b.interval)}),d};b.queue=a.Threads({threadLimit:1}),b.interval=1200,b.interval=0}(),function(){a.cssUrl=function(a){return'url("'+encodeURI(a)+'")'}}(),function(){a.fn.addTransitoryClass=function(a,b){var c=this.addClass(a);return setTimeout(function(){c.removeClass(a)},b||1),this};var b=function(a,b,c){var d=this;return setTimeout(function(){d[a+"Class"](b)},c||50),this};a.fn.addClassAfter=function(a,c){return b.call(this,"add",a,c)
},a.fn.removeClassAfter=function(a,c){return b.call(this,"remove",a,c)};var c=function(a,b,c,d){var e=a?"-in":"-out";return this.addTransitoryClass(b.replace(/ /g,e+" ")+e,c||1e3)[(a?"add":"remove")+"ClassAfter"](b),d&&setTimeout(d,c),this};a.fn.addTransitionClass=function(a,b,d){return c.call(this,!0,a,b,d)},a.fn.removeTransitionClass=function(a,b,d){return c.call(this,!1,a,b,d)}}()}),FD50.plugin("uri",function(a){a.isUrl=function(a){var b=/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;
return b.test(a)};var b=function(a){"use strict";var b=function(a){var c,d,e,f,g,h,b=[];if("undefined"==typeof a||null===a||""===a)return b;for(0===a.indexOf("?")&&(a=a.substring(1)),d=a.toString().split(/[&;]/),c=0;c<d.length;c++)e=d[c],f=e.split("="),g=f[0],h=-1===e.indexOf("=")?null:null===f[1]?"":f[1],b.push([g,h]);return b},c=b(a),d=function(){var b,d,a="";for(b=0;b<c.length;b++)d=c[b],a.length>0&&(a+="&"),a+=null===d[1]?d[0]:d.join("=");return a.length>0?"?"+a:a},e=function(a){return a=decodeURIComponent(a),a=a.replace("+"," ")
},f=function(a){var b,d;for(d=0;d<c.length;d++)if(b=c[d],e(a)===e(b[0]))return b[1]},g=function(a){var d,f,b=[];for(d=0;d<c.length;d++)f=c[d],e(a)===e(f[0])&&b.push(f[1]);return b},h=function(a,b){var f,g,h,i,d=[];for(f=0;f<c.length;f++)g=c[f],h=e(g[0])===e(a),i=e(g[1])===e(b),(1===arguments.length&&!h||2===arguments.length&&!h&&!i)&&d.push(g);return c=d,this},i=function(a,b,d){return 3===arguments.length&&-1!==d?(d=Math.min(d,c.length),c.splice(d,0,[a,b])):arguments.length>0&&c.push([a,b]),this},j=function(a,b,d){var g,j,f=-1;
if(3===arguments.length){for(g=0;g<c.length;g++)if(j=c[g],e(j[0])===e(a)&&decodeURIComponent(j[1])===e(d)){f=g;break}h(a,d).addParam(a,b,f)}else{for(g=0;g<c.length;g++)if(j=c[g],e(j[0])===e(a)){f=g;break}h(a),i(a,b,f)}return this};return{getParamValue:f,getParamValues:g,deleteParam:h,addParam:i,replaceParam:j,toString:d}},c=function(a){"use strict";var d=!1,e=/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi,f=function(a){for(var b={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},c=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],e={name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},f=b[d?"strict":"loose"].exec(a),g={},h=14;h--;)g[c[h]]=f[h]||"";
return g[e.name]={},g[c[12]].replace(e.parser,function(a,b,c){b&&(g[e.name][b]=c)}),g},g=f(a||""),h=new b(g.query),i=function(a){return"undefined"!=typeof a&&(g.protocol=a),g.protocol},j=null,k=function(a){return"undefined"!=typeof a&&(j=a),null===j?-1!==g.source.indexOf("//"):j},l=function(a){return"undefined"!=typeof a&&(g.userInfo=a),g.userInfo},m=function(a){return"undefined"!=typeof a&&(g.host=a),g.host},n=function(a){return"undefined"!=typeof a&&(g.port=a),g.port},o=function(a){return"undefined"!=typeof a&&(g.path=a),g.path
},p=function(a){return"undefined"!=typeof a&&(h=new b(a)),h},q=function(a){return"undefined"!=typeof a&&(g.anchor=a),g.anchor},r=function(a){return i(a),this},s=function(a){return k(a),this},t=function(a){return l(a),this},u=function(a){return m(a),this},v=function(a){return n(a),this},w=function(a){return o(a),this},x=function(a){return p(a),this},y=function(a){return q(a),this},z=function(a){return p().getParamValue(a)},A=function(a){return p().getParamValues(a)},B=function(a,b){return 2===arguments.length?p().deleteParam(a,b):p().deleteParam(a),this
},C=function(a,b,c){return 3===arguments.length?p().addParam(a,b,c):p().addParam(a,b),this},D=function(a,b,c){return 3===arguments.length?p().replaceParam(a,b,c):p().replaceParam(a,b),this},E=function(a){if(void 0===a)return g.path;if("/"==a.substring(0,1))return g.path=a;var b=g.path.split("/"),c=a.split("/");""===b.slice(-1)[0]&&b.pop();for(var d;d=c.shift();)switch(d){case"..":b.length>1&&b.pop();break;case".":break;default:b.push(d)}return g.path=b.join("/"),this},F=function(){var a="",b=function(a){return null!==a&&""!==a
};return b(i())?(a+=i(),i().indexOf(":")!==i().length-1&&(a+=":"),a+="//"):k()&&b(m())&&(a+="//"),b(l())&&b(m())&&(a+=l(),l().indexOf("@")!==l().length-1&&(a+="@")),b(m())&&(a+=m(),b(n())&&(a+=":"+n())),b(o())?a+=o():b(m())&&(b(p().toString())||b(q()))&&(a+="/"),b(p().toString())&&(0!==p().toString().indexOf("?")&&(a+="?"),a+=p().toString()),b(q())&&(0!==q().indexOf("#")&&(a+="#"),a+=q()),a},G=function(b){var c=a.match(e)||[];return void 0===b?c:c[b]||""},H=function(){return new c(F())};return{protocol:i,hasAuthorityPrefix:k,userInfo:l,host:m,port:n,path:o,query:p,anchor:q,setProtocol:r,setHasAuthorityPrefix:s,setUserInfo:t,setHost:u,setPort:v,setPath:w,setQuery:x,setAnchor:y,getQueryParamValue:z,getQueryParamValues:A,deleteQueryParam:B,addQueryParam:C,replaceQueryParam:D,extract:G,toPath:E,toString:F,clone:H}
};a.uri=function(a){return new c(a)}}),FD50.plugin("mvc",function($){!function(){var d,a={undHash:/_|-/,colons:/::/,words:/([A-Z]+)([A-Z][a-z])/g,lowUp:/([a-z\d])([A-Z])/g,dash:/([a-z\d])([A-Z])/g,replacer:/\{([^\}]+)\}/g,dot:/\./},b=function(a,b,c){return void 0!==a[b]?a[b]:c&&(a[b]={})},c=function(a){var b=typeof a;return a&&("function"==b||"object"==b)},e=$.String=$.extend($.String||{},{getObject:d=function(d,e,f){var i,j,k,g=d?d.split(a.dot):[],h=g.length,l=0;if(e=$.isArray(e)?e:[e||window],0==h)return e[0];
for(;i=e[l++];){for(k=0;h-1>k&&c(i);k++)i=b(i,g[k],f);if(c(i)&&(j=b(i,g[k],f),void 0!==j))return f===!1&&delete i[g[k]],j}},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},camelize:function(a){return a=e.classize(a),a.charAt(0).toLowerCase()+a.substr(1)},classize:function(b,c){for(var d=b.split(a.undHash),f=0;f<d.length;f++)d[f]=e.capitalize(d[f]);return d.join(c||"")},niceName:function(a){return e.classize(a," ")},underscore:function(b){return b.replace(a.colons,"/").replace(a.words,"$1_$2").replace(a.lowUp,"$1_$2").replace(a.dash,"_").toLowerCase()
},sub:function(b,c,e){var f=[];return f.push(b.replace(a.replacer,function(a,b){var g=d(a,c,"boolean"==typeof e?!e:e)||d(b,c,"boolean"==typeof e?!e:e),h=typeof g;return"object"!==h&&"function"!==h||null===h?""+g:(f.push(g),"")})),f.length<=1?f[0]:f},_regs:a});$.extend($,e)}(),function(){$.String.rsplit=function(a,b){for(var e,f,c=b.exec(a),d=[];null!==c;)e=c.index,f=b.lastIndex,0!==e&&(d.push(a.substring(0,e)),a=a.slice(e)),d.push(c[0]),a=a.slice(c[0].length),c=b.exec(a);return""!==a&&d.push(a),d}}(),function(){var a=/^\d+$/,b=/([^\[\]]+)|(\[\])/g,c=/\+/g,d=/([^?#]*)(#.*)?$/;
$.String=$.extend($.String||{},{deparam:function(e){if(!e||!d.test(e))return{};for(var h,f={},g=e.split("&"),i=0;i<g.length;i++){h=f;var j=g[i].split("=");2!=j.length&&(j=[j[0],j.slice(1).join("=")]);for(var k=decodeURIComponent(j[0].replace(c," ")),l=decodeURIComponent(j[1].replace(c," ")),m=k.match(b),n=0;n<m.length-1;n++){var o=m[n];h[o]||(h[o]=a.test(m[n+1])||"[]"==m[n+1]?[]:{}),h=h[o]}lastPart=m[m.length-1],"[]"==lastPart?h.push(l):h[lastPart]=l}return f}})}(),function(){var a=$.cleanData;$.cleanData=function(b){for(var d,c=0;void 0!==(d=b[c]);c++)$(d).triggerHandler("destroyed");
a(b)}}(),function(){$.cookie=function(a,b,c){if("undefined"==typeof b){var i=null;if(document.cookie&&""!=document.cookie)for(var j=document.cookie.split(";"),k=0;k<j.length;k++){var l=jQuery.trim(j[k]);if(l.substring(0,a.length+1)==a+"="){i=decodeURIComponent(l.substring(a.length+1));break}}if(jQuery.evalJSON&&i&&i.match(/^\s*\{/))try{i=jQuery.evalJSON(i)}catch(m){}return i}c=c||{},null===b&&(b="",c.expires=-1),"object"==typeof b&&jQuery.toJSON&&(b=jQuery.toJSON(b));var d="";if(c.expires&&("number"==typeof c.expires||c.expires.toUTCString)){var e;
"number"==typeof c.expires?(e=new Date,e.setTime(e.getTime()+24*c.expires*60*60*1e3)):e=c.expires,d="; expires="+e.toUTCString()}var f=c.path?"; path="+c.path:"",g=c.domain?"; domain="+c.domain:"",h=c.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(b),d,f,g,h].join("")}}(),function(){var a=!1,b=$.makeArray,c=$.isFunction,d=$.isArray,e=$.extend,f=$.String.getObject,g=function(a,c){return a.concat(b(c))},h=/xyz/.test(function(){})?/\b_super\b/:/.*/,i=function(a,b,d){d=d||a;for(var e in a)d[e]=c(a[e])&&c(b[e])&&h.test(a[e])?function(a,c){return function(){var e,d=this._super;
return this._super=b[a],e=c.apply(this,arguments),this._super=d,e}}(e,a[e]):a[e]},j="prototype";clss=$.Class=function(){arguments.length&&clss.extend.apply(clss,arguments)},e(clss,{proxy:function(a){var e,c=b(arguments);return a=c.shift(),d(a)||(a=[a]),e=this,function(){for(var f,j,b=g(c,arguments),h=a.length,i=0;h>i;i++)j=a[i],j&&(f="string"==typeof j,f&&e._set_called&&(e.called=j),b=(f?e[j]:j).apply(e,b||[]),h-1>i&&(b=!d(b)||b._use_call?[b]:b));return b}},newInstance:function(){var b,a=this.rawInstance();return a.setup&&(b=a.setup.apply(a,arguments)),a.init&&a.init.apply(a,d(b)?b:arguments),a
},setup:function(a){return this.defaults=e(!0,{},a.defaults,this.defaults),arguments},rawInstance:function(){a=!0;var b=new this;return a=!1,b},extend:function(b,c,d){function p(){return a?void 0:this.constructor!==p&&arguments.length?arguments.callee.extend.apply(arguments.callee,arguments):this.Class.newInstance.apply(this.Class,arguments)}"string"!=typeof b&&(d=c,c=b,b=null),d||(d=c,c=null),d=d||{};var l,m,n,o,h=this,k=this[j];a=!0,o=new this,a=!1,i(d,k,o);for(l in this)this.hasOwnProperty(l)&&(p[l]=this[l]);
if(i(c,this,p),b){var q;c&&c.root&&(q=c.root,$.isString(q)&&(q=f(q,window,!0)));var r=b.split(/\./),m=r.pop(),s=f(r.join("."),q||window,!0),n=s;e(!0,p,s[m]),s[m]=p}e(p,{prototype:o,namespace:n,shortName:m,constructor:p,fullName:b}),p[j].Class=p[j].constructor=p;var t=p.setup.apply(p,g([h],arguments));return p.init&&p.init.apply(p,t||g([h],arguments)),p}}),clss.callback=clss[j].callback=clss[j].proxy=clss.proxy}(),function(){var w,a=function(a,b,c,e){var f,g=a.bind&&a.unbind?a:$(d(a)?[a]:a);return 0===b.indexOf(">")&&(b=b.substr(1),f=function(b){b.target===a&&c.apply(this,arguments)
}),e?g.bind(b,e,f||c):g.bind(b,f||c),function(){g.unbind(b,f||c),a=b=c=f=null}},b=$.makeArray,c=$.isArray,d=$.isFunction,e=$.isString,f=$.extend,g=$.String,h=$.each,i=g.getObject,j="prototype",k="constructor",l=Array[j].slice,m=function(a,b,c,e,f){0===b.indexOf(">")&&(b=(a.data("directSelector")+" "||"")+b);var g=a.delegate&&a.undelegate?a:$(d(a)?[a]:a);return f?g.delegate(b,c,f,e):g.delegate(b,c,e),function(){g.undelegate(b,c,e),g=a=c=e=b=null}},n=function(b,c,d,e,f){return e?m(b,e,c,d,f):a(b,c,d,f)},o=function(a,b){var e="string"==typeof b?a[b]:b;
return c(e)&&d(e[1])&&(e=e[1]),function(){return a.called=b,e.apply(a,[this.nodeName?$(this):this].concat(l.call(arguments,0)))}},p=/\./g,q=/_?controllers?/gi,r=function(a){return g.underscore(a.replace($.globalNamespace+".","").replace(p,"_").replace(q,""))},s=/^\S(.*)\s(.*)/,t=/\{([^\}]+)\}/g,u=/\{([^\.]+[\.][^\.]+)\}/g,v=/^(?:(.*?)\s)?([\w\.\:>]+)$/,x=function(a,b){return $.data(a,"controllers",b)},y=$.globalNamespace+".Controller";$.Controller=function(a){var e,c=b(arguments),d={root:y};return c.length>2?(d=$.extend(d,c[1]),e=c[2]):e=c[1],d.namespace&&(a=d.namespace+"."+a),$.Controller.Class(a,d,e)
};var z=y+".Class";$.Class(z,{setup:function(a,f){if(this._super.apply(this,arguments),this.shortName&&this.fullName!=z){for(var g=this.elements||[],h=0,i=this.defaults;element=g[h++];){var k=element.indexOf("{"),l=element.indexOf("}"),n=(element.length,element.slice(0,k)),o=element.slice(l+1),p=element.slice(k+1,l).split("|"),q=0,s=n.match(/^\^(\S*)\s(.*)/),t="";for(s&&(t=s[1]+"-",n=s[2]);f=p[q++];){var u="{"+$.camelize(t+f)+"}";!$.has(i,u)&&(i[u]=n+f+o)}}this._fullName=r(this.fullName),this._shortName=r(this.shortName);
var w,v=this;if(e(this.pluginName)){var A=this._fullName,B=this.pluginName;$.fn[B]||($.fn[B]=function(a){var c=b(arguments);if($.isString(a)&&"controller"===a){var d=x(this[0]),e=d&&d[A];return e}return this.each(function(){var b=x(this),d=b&&b[A];if(d){if($.isString(a)){var e=d[a];return $.isFunction(e)&&e.apply(d,c.slice(1)),void 0}d.update.apply(d,c)}else v.newInstance.apply(v,[this].concat(c))})})}var C=b(arguments),D=this[j],E=C[C.length>3?3:2];d(E)&&(this.protoFactory=E,D=this.protoFactory.call(this,null)),this.actions={};
for(w in D)if("constructor"!=w&&this._isAction(w)){var F=D[w],G=d(F)||c(F)&&d(F[1]);if(!G)continue;this.actions[w]=this._action(w)}$.module("$:/Controllers/"+this.fullName).resolve(this)}},hookup:function(a){return new this(a)},_isAction:function(a){return s.test(a)?!0:$.inArray(a,this.listensTo)>-1||$.event.special[a]||A[a]},_action:function(a,b){if(t.lastIndex=0,!b&&t.test(a))return null;a=a.replace("{self} ","");var d=a;if(b){var e=!1;if(u.test(a)){var f,h="";d=a.replace(u,function(a,c){var d=c.split(".");
return f=b["{"+d[0]+"}"]||{},$.isControllerInstance(f)&&(h=(f[d[1]]||{}).selector),h}).match(v),e=!!h,d=[f.element].concat(d||[])}e||(d=g.sub(a,[b,window]))}var i=c(d),j=(i?d[1]:d).match(v),k=j[2],l=A[k]||w;return{processor:l,parts:j,delegate:i?d[0]:void 0}},processors:{},listensTo:[],defaults:{},hostname:"parent"},{setup:function(a,c){var d=this,g=d[k],i=d[j],l=g._fullName;d.instanceId=$.uid(l+"_");var m=d.options=f(!0,{},g.defaults,g.defaultOptions,c),n=d.element=$(a);if(g.protoFactory&&(i=g.protoFactory.apply(g,[d,m,n]),f(!0,d,i)),(x(a)||x(a,{}))[l]=d,!n.data("directSelector")){var o=$.uid("DS");
n.addClass(o).data("directSelector","."+o)}d.selectors={};for(var p in m)if(p.match(/^\{.+\}$/)){var q=p.replace(/^\{|\}$/g,""),r=m[p];if(e(r)){var s=d[q];d[q]=d.selectors[q]=function(a,b,c){b=/^(\.|\#)$/.test(b)?b+c:b;var d=function(c){var e=(d.baseElement||a.element).find(b);return $.isString(c)&&(e=e.filter(c)),$.isPlainObject(c)&&$.each(c,function(a,b){e=e.filterBy(a,b)}),e};return d.selector=b,d.css=function(){var a=d.cssRule;if(!a){var c=n.data("directSelector"),e=$.map(b.split(","),function(a){return c+" "+a
});a=d.cssRule=$.cssRule(e),a.important=!0}return arguments.length?a.css.apply(a,arguments):a},d.inside=function(a){return $(a).find(b)},d.of=function(a){return $(a).parents(b).eq(0)},d.under=function(a){var b=[];return d().each(function(){$(this).parents().filter(a).length&&b.push(this)}),$(b)},$.isPlainObject(s)&&$.extend(d,s),d}(d,r,q)}else d[q]=r}var t=m.view,u=d.view;d.view=function(){return u.apply(this,arguments)},h(t||{},function(a){d.view[a]=function(c){var e=b(arguments);return $.isBoolean(c)?e=e.slice(1):c=!1,d.view.apply(d,[c,a].concat(e))
}}),$.extend(d,m.controller),d.pluginInstances={},d.called="init",d._bind();var v=d.init||$.noop;return d.init=function(){return d.init=v,result=v.apply(d,arguments),d.trigger("init."+g.fullName.toLowerCase(),[d]),result},[n,m].concat(b(arguments).slice(2))},on:function(a){var c=b(arguments),d=this.element,f=c.length;return 2==f?this._binder(d,a,c[1]):3==f&&e(c[1])?this._binder(d,a,c[2],c[1]):this._binder(c[1],a,c[2])},_bind:function(){var a=this,b=a[k],c=b.actions,d=a._bindings=[],e=a.element;h(c||{},function(f){if(c.hasOwnProperty(f)){var h=b.actions[f]||b._action(f,a.options);
$.isControllerInstance(h.delegate)&&(h.delegate=h.delegate.element),d.push(h.processor(h.delegate||e,h.parts[2],h.parts[1],f,a))}});var f=o(this,"destroy");return e.bind("destroyed",f),d.push(function(a){$(a).unbind("destroyed",f)}),d.length},_binder:function(a,b,c,d){return"string"==typeof c&&(c=o(this,c)),this._bindings.push(n(a,b,c,d)),this._bindings.length},_unbind:function(){var a=this.element[0];h(this._bindings,function(b,c){c(a)}),this._bindings=[]},trigger:function(a){var b=this.element;if(b){var c=$.Event(a);
return b.trigger.apply(b,[c].concat($.makeArray(arguments).slice(1))),c}},delegate:function(a,b,c,d){return"string"==typeof a&&(d=c,c=b,b=a,a=this.element),this._binder(a,c,d,b)},update:function(a){f(this.options,a),this._unbind(),this._bind()},destroy:function(){if(!this._destroyed){var a=this[k]._fullName;for(pname in this.pluginInstances)this.removePlugin(pname);this._destroyed=!0,this.element.removeClass(a),this._unbind(),delete this._actions,delete this.element.data("controllers")[a],$(this).triggerHandler("destroyed"),this.element=$()
}},find:function(a){return this.element.find(a)},view:function(){var c,a=b(arguments),d=a,e=!1,f=this[k].component||$,g="",h=this.options.view||{};return"boolean"==typeof a[0]&&(e=a[0],d=a.slice(1)),c=d[0]=h[d[0]],void 0==c?e?"":$(""):(g=f.View.apply(f,d),e?g:$($.parseHTML($.trim(g))))},getPlugin:function(a){return this.pluginInstances[a]},addSubscriber:function(a){var b=$.isArray(a)?a:[a||{}],c=this,d=this.Class.hostname,e={};return e["{"+d+"}"]=c,$.map(b,function(a){return $.isControllerInstance(a)?a.options[d]===this?a:(a[d]=c,a.update(e)):!1
}),b},addPlugin:function(a,b,c){if(a){(!b&&!c||$.isPlainObject(b))&&(c=b,b=[this.Class.root,this.Class.fullName,$.String.capitalize(a)].join(".")),$.isString(b)&&(b=$.getController(b));var e=$.isControllerInstance(b);if(d(b)||e){var f=this.Class.pluginExtendsInstance?this.options[a]:(this.options.plugin||{})[a];c=$.extend(!0,{element:this.element},c,f);var g=e?"instance":$.isController(b)?"controller":"function";this.trigger("addPlugin",[a,b,c,g]);var h=this.Class.hostname;c["{"+h+"}"]=this;var i;switch(g){case"instance":i=b,b.update(c),b[h]=this;
break;case"controller":i=c.element.addController(b,c);break;case"function":i=b(this,c)}if(i){if(this.pluginInstances[a]=i,this.Class.pluginExtendsInstance&&(this[a]=i),"function"!==g){var j={};j["{"+a+"}"]=i,this.update(j)}return this.trigger("registerPlugin",[a,i,c,g]),i}}}},removePlugin:function(a){var b=this.getPlugin(a);if(b)return this.trigger("removePlugin",[a,b]),delete this.pluginInstances[a],$.isFunction(b.destroy)?b.destroy():null},invokePlugin:function(a,b,c){var d=this.getPlugin(a);if(d&&$.isFunction(d[b]))return this.trigger("invokePlugin",[a,d,c]),d[b].apply(this,c)
},getMessageGroup:function(){var a=$.isFunction(this.messageGroup)?this.messageGroup():this.element.find("[data-message-group]");return a.length<1&&(a=$("<div data-message-group></div>").prependTo(this.element)),a},setMessage:function(a,b){var c={type:"warning",message:"",parent:this.getMessageGroup(),element:$('<div class="alert fade in"><button type="button" class="close" data-bs-dismiss="alert">\xd7</button></div>')},d={},e=$.isDeferred(a);d=$.isPlainObject(a)&&!e?a:{message:a,type:b||"warning"};var f=$.extend({},c,d),g=f.element;
if($.isDeferred(a)){var h=arguments.callee,i=this;a.done(function(a,b){f.message=a,f.type=b||"warning",h.call(i,f),g.show()})}else g.addClass("alert-"+f.type).append(f.message),$("html").has(g).length<1&&g.appendTo(f.parent);return g},clearMessage:function(){this.getMessageGroup().empty()},_set_called:!0});var A=$.Controller.Class.processors,w=function(a,b,e,f,g){var i,h=g[f];return c(h)&&d(h[1])&&(i=h[0]),n(a,b,o(g,f),e,i)};h("change click contextmenu dblclick keydown keyup keypress mousedown mousemove mouseout mouseover mouseup reset resize scroll select submit focusin focusout mouseenter mouseleave".split(" "),function(a,b){A[b]=w
});var B=function(a){return a.replace("$.Controller",y)},C=function(a){return e(a)&&(a=B(a),a=i(a)||i(y+"."+a)),D(a)?a:void 0},D=function(a){return d(a)&&a.hasOwnProperty("_fullName")},E=function(a){return $.map(a,function(a){return c(a)?E(a):C(a)})};$.getController=C,$.isController=function(a){return!!C(a)},$.isControllerInstance=function(a){return a&&a[k]&&D(a[k])},$.isControllerOf=function(a,b){if(!b)return!1;c(b)||(b=[b]);for(var d=0;d<b.length;d++){var e=C(b[d]);if(a instanceof e)return!0}return!1},$.fn.extend({controllers:function(){var a=E(b(arguments)),c=[];
return this.each(function(){var b=$.data(this,"controllers");h(b||{},function(d,e){b.hasOwnProperty(d)&&(!a.length||$.isControllerOf(e,a))&&c.push(e)})}),c},controller:function(a,b){return void 0===b?this.controllers(a)[0]:(this.addController.apply(this,arguments),this)},hasController:function(a){var b=(C(a)||{})._fullName||(e(a)?r(B(a)):"");return b?($(this).data("controllers")||{}).hasOwnProperty(b):!1},addController:function(a,b,c){var e=C(a);if(e){var f=[];return this.each(function(){if(1===this.nodeType&&"SCRIPT"!=this.nodeName){var g=$(this).controller(a);
if(g)return f.push(g),void 0;var h=new e(this,b);d(c)&&c.apply(h,[$(this),h]),f.push(h)}}),f.length>1?f:f[0]}},removeController:function(a){return this.each(function(){for(var b=$(this).controllers(a);b.length;)b.shift().destroy()}),this},addControllerWhenAvailable:function(a){var b=this,c=arguments,d=$.Deferred();return $.isController(a)&&(a=a.fullName),e(a)?($.module("$:/Controllers/"+a).pipe(function(){var a=b.addController.apply(b,c);d.resolveWith(a,[b,a])},d.reject,d.fail),d):d.reject()},implement:function(){return this.addController.apply(this,arguments),this
}}),function(){for(var c,a=["is","find"],b={};c=a.shift();)b[c]=$.fn[c],$.fn[c]=function(a){return function(c){return b[a].apply(this,(c||{}).hasOwnProperty("of")?[c.selector]:arguments)}}(c)}()}(),function(){var a=function(a){return a.replace(/^\/\//,"").replace(/[\/\.]/g,"_")},b=$.makeArray,c=1,d=$.View=function(a,c,d,e){"function"==typeof d&&(e=d,d=void 0);var j=h(c);if(j.length){var k=$.Deferred();return j.push(f(a,!0)),$.when.apply($,j).then(function(a){var j,f=b(arguments),h=f.pop()[0];if(g(c))c=i(a);else for(var l in c)g(c[l])&&(c[l]=i(f.shift()));
j=h(c,d),k.resolve(j),e&&e(j)}),k.promise()}var l,m="function"==typeof e,k=f(a,m);return m?(l=k,k.done(function(a){e(a(c,d))})):k.done(function(a){l=a(c,d)}),l},e=function(a,b){if(!a.match(/[^\s]/))throw"$.View ERROR: There is no template or an empty template at "+b},f=function(a,b){return $.ajax({url:a,dataType:"view",async:b})},g=function(a){return a&&$.isFunction(a.always)},h=function(a){var b=[];if(g(a))return[a];for(var c in a)g(a[c])&&b.push(a[c]);return b},i=function(a){return $.isArray(a)&&3===a.length&&"success"===a[1]?a[0]:a
};$.ajaxTransport("view",function(b,c){var h,i,j,k,f=c.url,g=f.match(/\.[\w\d]+$/),l=function(a){var b=h.renderer(j,a);return d.cache&&(d.cached[j]=b),{view:b}};if((i=document.getElementById(f))&&(g="."+i.type.match(/\/(x\-)?(.+)/)[2]),g||(g=d.ext,f+=d.ext),j=a(f),f.match(/^\/\//)){var m=f.substr(2);f="undefined"==typeof steal?f="/"+m:steal.root.mapJoin(m)+""}h=d.types[g];var n=$.template()[c.url];return{send:function(a,b){return n?(h=d.types["."+n.type],b(200,"success",l(n.content))):d.cached[j]?b(200,"success",{view:d.cached[j]}):(i?b(200,"success",l(i.innerHTML)):k=$.ajax({async:c.async,url:f,dataType:"text",error:function(){e("",f),b(404)
},success:function(a){e(a,f),b(200,"success",l(a))}}),void 0)},abort:function(){k&&k.abort()}}}),$.extend(d,{hookups:{},hookup:function(a){var b=++c;return d.hookups[b]=a,b},cached:{},cache:!0,register:function(b){this.types["."+b.suffix]=b,window.steal&&steal.type(b.suffix+" view js",function(b,c){var f=d.types["."+b.type],g=a(b.rootSrc+"");b.text=f.script(g,b.text),c()})},types:{},ext:".ejs",registerScript:function(a,b,c){return"$.View.preload('"+b+"',"+d.types["."+a].script(b,c)+");"},preload:function(a,b){d.cached[a]=function(a,c){return b.call(a,a,c)
}}}),window.steal&&steal.type("view js",function(b,c){var f=d.types["."+b.type],g=a(b.rootSrc+"");b.text="steal('"+(f.plugin||"jquery/view/"+b.type)+"').then(function($){$.View.preload('"+g+"',"+b.text+");\n})",c()});var j,k,l,m,n,o,p,r={val:!0,text:!0};j=function(a){var c=$.fn[a];$.fn[a]=function(){var f,h,j,e=b(arguments),i=this;if(g(e[0]))return e[0].done(function(a){k.call(i,[a],c)}),this;if(l(e)){if(f=o(e))return h=e[f],e[f]=function(a){k.call(i,[a],c),h.call(i,a)},d.apply(d,e),this;if(j=d.apply(d,e),g(j))return j.done(function(a){k.call(i,[a],c)
}),this;e=[j]}return r[a]?c.apply(this,e):k.call(this,e,c)}},k=function(a,b){var c,f;for(var g in d.hookups)break;return g&&a[0]&&m(a[0])&&(f=d.hookups,d.hookups={},a[0]=$(a[0])),c=b.apply(this,a),f&&p(a[0],f),c},l=function(a){var b=typeof a[1];return"string"==typeof a[0]&&("object"==b||"function"==b)&&!n(a[1])},n=function(a){return a.nodeType||a.jquery},m=function(a){return n(a)?!0:"string"==typeof a?(a=$.trim(a),"<"===a.substr(0,1)&&">"===a.substr(a.length-1,1)&&a.length>=3):!1},o=function(a){return"function"==typeof a[3]?3:"function"==typeof a[2]&&2
},p=function(a,b){var c,e,g,h,f=0;for(a=a.filter(function(){return 3!=this.nodeType}),c=a.add("[data-view-id]",a),e=c.length;e>f;f++)c[f].getAttribute&&(g=c[f].getAttribute("data-view-id"))&&(h=b[g])&&(h(c[f],g),delete b[g],c[f].removeAttribute("data-view-id"));$.extend(d.hookups,b)},$.fn.hookup=function(){var a=d.hookups;return d.hookups={},p(this,a),this},$.each(["prepend","append","after","before","text","html","replaceWith","val"],function(a,b){j(b)})}(),function(){var myEval=function(script){eval(script)
},rSplit=$.String.rsplit,extend=$.extend,isArray=$.isArray,returnReg=/\r\n/g,retReg=/\r/g,newReg=/\n/g,nReg=/\n/,slashReg=/\\/g,quoteReg=/"/g,singleQuoteReg=/'/g,tabReg=/\t/g,leftBracket=/\{/g,rightBracket=/\}/g,quickFunc=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,clean=function(a){return a.replace(slashReg,"\\\\").replace(newReg,"\\n").replace(quoteReg,'\\"').replace(tabReg,"\\t")},escapeHTML=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(quoteReg,"&#34;").replace(singleQuoteReg,"&#39;")
},$View=$.View,bracketNum=function(a){var b=a.match(leftBracket),c=a.match(rightBracket);return(b?b.length:0)-(c?c.length:0)},EJS=function(a){if(this.constructor!=EJS){var b=new EJS(a);return function(a,c){return b.render(a,c)}}return"function"==typeof a?(this.template={fn:a},void 0):(extend(this,EJS.options,a),this.template=compile(this.text,this.type,this.name),void 0)};$&&($.EJS=EJS),EJS.prototype.render=function(a,b){a=a||{},this._extra_helpers=b;var c=new EJS.Helpers(a,b||{});return this.template.fn.call(a,a,c)
},extend(EJS,{text:function(a){if("string"==typeof a)return a;if(null===a||void 0===a)return"";var b=a.hookup&&function(b,c){a.hookup.call(a,b,c)}||"function"==typeof a&&a||isArray(a)&&function(b,c){for(var d=0;d<a.length;d++)a[d].hookup?a[d].hookup(b,c):a[d](b,c)};return b?"data-view-id='"+$View.hookup(b)+"'":a.toString?a.toString():""},clean:function(a){return"string"==typeof a?escapeHTML(a):"number"==typeof a?a:EJS.text(a)},options:{type:"[",ext:".ejs"}});var scan=function(a,b,c){for(var d=rSplit(b,nReg),e=0;e<d.length;e++)scanline(a,d[e],c)
},scanline=function(a,b,c){a.lines++;for(var e,d=rSplit(b,a.splitter),f=0;f<d.length;f++)e=d[f],null!==e&&c(e,a)},makeScanner=function(a,b){var c={};return extend(c,{left:a+"%",right:"%"+b,dLeft:a+"%%",dRight:"%%"+b,eeLeft:a+"%==",eLeft:a+"%=",cmnt:a+"%#",cleanLeft:a+"%~",scan:scan,lines:0}),c.splitter=new RegExp("("+[c.dLeft,c.dRight,c.eeLeft,c.eLeft,c.cmnt,c.left,c.right+"\n",c.right,"\n"].join(")|(").replace(/\[/g,"\\[").replace(/\]/g,"\\]")+")"),c},compile=function(a,b){a=a.replace(returnReg,"\n").replace(retReg,"\n"),b=b||"[";
var d="___v1ew.push(",e=d,f="var ___v1ew = [];",g="return ___v1ew.join('')",h=new EJS.Buffer([f],[]),i="",j=function(a){h.push(d,'"',clean(a),'");')},k=null,l=function(){i=""},m="));",n=[];scan(makeScanner(b,"["===b?"]":">"),a||"",function(a,b){var c;if(null===k)switch(a){case"\n":i+="\n",j(i),h.cr(),l();break;case b.left:case b.eLeft:case b.eeLeft:case b.cmnt:k=a,i.length>0&&j(i),l();break;case b.dLeft:i+=b.left;break;default:i+=a}else switch(a){case b.right:switch(k){case b.left:c=bracketNum(i);var d=n.length&&-1==c?n.pop():";";
d===m&&h.push(g),h.push(i,d),1===c&&n.push(";");break;case b.eLeft:if(c=bracketNum(i),c&&n.push(m),quickFunc.test(i)){var o=i.match(quickFunc);i="function(__){var "+o[1]+"=$(__);"+o[2]+"}"}h.push(e,$.globalNamespace+".EJS.clean(",i,c?f:m);break;case b.eeLeft:c=bracketNum(i),c&&n.push(m),h.push(e,$.globalNamespace+".EJS.text(",i,c?f:m)}k=null,l();break;case b.dRight:i+=b.right;break;default:i+=a}}),i.length>0&&h.push(d,'"',clean(i)+'");');var o=h.close(),p={out:"try { with(_VIEW) { with (_CONTEXT) {"+o+" "+g+"}}}catch(e){e.lineNumber=null;throw e;}"};
return myEval.call(p,"this.fn = (function(_CONTEXT,_VIEW){ var $ = "+$.globalNamespace+";"+p.out+"});"),p};EJS.Buffer=function(a,b){this.line=[],this.script=[],this.post=b,this.push.apply(this,a)},EJS.Buffer.prototype={push:function(){this.line.push.apply(this.line,arguments)},cr:function(){this.script.push(this.line.join(""),"\n"),this.line=[]},close:function(){return this.line.length>0&&(this.script.push(this.line.join("")),this.line=[]),this.post.length&&this.push.apply(this,this.post),this.script.push(";"),this.script.join("")
}},EJS.Helpers=function(a,b){this._data=a,this._extras=b,extend(this,b)},EJS.Helpers.prototype={plugin:function(){var b=$.makeArray(arguments),c=b.shift();return function(a){var d=$(a);d[c].apply(d,b)}},view:function(a,b,c){return c=c||this._extras,b=b||this._data,$View(a,b,c)}},$View.register({suffix:"ejs",script:function(a,b){return $.globalNamespace+".EJS(function(_CONTEXT,_VIEW) { "+new EJS({text:b,name:a}).template.out+" })"},renderer:function(a,b){return EJS({text:b,name:a})}})}(),function(){var a=$.isArray,b=function(a){return"object"==typeof a&&null!==a&&a
},c=$.makeArray,d=$.each,e=function(b,c,d){return b instanceof $.Observe?f([b],d._namespace):b=a(b)?new $.Observe.List(b):new $.Observe(b),b.bind("change"+d._namespace,function(a){var f=$.makeArray(arguments),a=f.shift();f[0]="*"===c?d.indexOf(b)+"."+f[0]:c+"."+f[0],$.event.trigger(a,f,d)}),b},f=function(a,b){for(var c,d=0;d<a.length;d++)c=a[d],c&&c.unbind&&c.unbind("change"+b)},g=0,h=null,i=function(){return h?void 0:(h=[],!0)},j=function(a,b,c){return a._init?void 0:h?(h.push({t:a,ev:b,args:c}),void 0):$.event.trigger(b,c,a,!0)
},k=0,l=function(){var c,a=h.length,b=h.slice(0);h=null,k++;for(var d=0;a>d;d++)c=b[d],$.event.trigger({type:c.ev,batchNum:k},c.args,c.t)},m=function(a,c,d){return a.each(function(a,e){d[a]=b(e)&&"function"==typeof e[c]?e[c]():e}),d};$.Class($.globalNamespace+".Observe",{init:function(a){this._data={},this._namespace=".observe"+ ++g,this._init=!0,this.attrs(a),delete this._init},attr:function(a,b){return void 0===b?this._get(a):(this._set(a,b),this)},each:function(){return d.apply(null,[this.__get()].concat(c(arguments)))
},removeAttr:function(b){var c=a(b)?b:b.split("."),d=c.shift(),e=this._data[d];return c.length?e.removeAttr(c):(delete this._data[d],j(this,"change",[d,"remove",void 0,e]),e)},_get:function(b){var c=a(b)?b:(""+b).split("."),d=this.__get(c.shift());return c.length?d?d._get(c):void 0:d},__get:function(a){return a?this._data[a]:this._data},_set:function(c,d){var g=a(c)?c:(""+c).split("."),h=g.shift(),i=this.__get(h);if(b(i)&&g.length)i._set(g,d);else{if(g.length)throw"jQuery.Observe: set a property on an object that does not exist";
if(d!==i){var k=this.__get().hasOwnProperty(h)?"set":"add";this.__set(h,b(d)?e(d,h,this):d),j(this,"change",[h,k,d,i]),i&&f([i],this._namespace)}}},__set:function(a,b){this._data[a]=b,a in this.constructor.prototype||(this[a]=b)},bind:function(){return $.fn.bind.apply($([this]),arguments),this},unbind:function(){return $.fn.unbind.apply($([this]),arguments),this},serialize:function(){return m(this,"serialize",{})},attrs:function(a,c){if(void 0===a)return m(this,"attrs",{});a=$.extend(!0,{},a);var d,e=i();for(d in this._data){var f=this._data[d],g=a[d];
void 0!==g?(b(f)&&b(g)?f.attrs(g,c):f!=g&&this._set(d,g),delete a[d]):c&&this.removeAttr(d)}for(var d in a)g=a[d],this._set(d,g);e&&l()}});var n=$.Observe($.globalNamespace+".Observe.List",{init:function(a,b){this.length=0,this._namespace=".list"+ ++g,this._init=!0,this.bind("change",this.proxy("_changes")),this.push.apply(this,c(a||[])),$.extend(this,b),this.comparator&&this.sort(),delete this._init},_changes:function(a,b,c,d,e){if(this.comparator&&/^\d+./.test(b)){var f=+/^\d+/.exec(b)[0],g=this[f],h=this.sortedIndex(g);
if(h!==f)return[].splice.call(this,f,1),[].splice.call(this,h,0,g),j(this,"move",[g,h,f]),a.stopImmediatePropagation(),j(this,"change",[b.replace(/^\d+/,h),c,d,e]),void 0}-1===b.indexOf(".")&&("add"===c?j(this,c,[d,+b]):"remove"===c&&j(this,c,[e,+b]))},sortedIndex:function(a){for(var d,b=a.attr(this.comparator),c=0,d=0;d<this.length;d++)if(a!==this[d]){if(b<=this[d].attr(this.comparator))return d+c}else c=-1;return d+c},__get:function(a){return a?this[a]:this},__set:function(a,b){this[a]=b},serialize:function(){return m(this,"serialize",[])
},splice:function(a,d){var h,g=c(arguments);for(h=2;h<g.length;h++){var i=g[h];b(i)&&(g[h]=e(i,"*",this))}void 0===d&&(d=g[1]=this.length-a);var k=[].splice.apply(this,g);return d>0&&(j(this,"change",[""+a,"remove",void 0,k]),f(k,this._namespace)),g.length>2&&j(this,"change",[""+a,"add",g.slice(2),k]),k},attrs:function(a,c){if(void 0===a)return m(this,"attrs",[]);a=a.slice(0);for(var d=Math.min(a.length,this.length),e=i(),f=0;d>f;f++){var g=this[f],h=a[f];b(g)&&b(h)?g.attrs(h,c):g!=h&&this._set(f,h)}a.length>this.length?this.push(a.slice(this.length)):a.length<this.length&&c&&this.splice(a.length),e&&l()
},sort:function(a,b){{var c=this.comparator,d=c?[function(a,b){return a=a[c],b=b[c],a===b?0:b>a?-1:1}]:[];[].sort.apply(this,d)}!b&&j(this,"reset")}}),o=function(a){return a[0]&&$.isArray(a[0])?a[0]:c(a)};d({push:"length",unshift:0},function(a,c){n.prototype[a]=function(){for(var d=o(arguments),f=c?this.length:0,g=0;g<d.length;g++){var h=d[g];b(h)&&(d[g]=e(h,"*",this))}if(1==d.length&&this.comparator){var i=this.sortedIndex(d[0]);return this.splice(i,0,d[0]),this.length}var k=[][a].apply(this,d);return this.comparator&&d.length>1?(this.sort(null,!0),j(this,"reset",[d])):j(this,"change",[""+f,"add",d,void 0]),k
}}),d({pop:"length",shift:0},function(a,b){n.prototype[a]=function(){var c=o(arguments),d=b&&this.length?this.length-1:0,e=[][a].apply(this,c);return j(this,"change",[""+d,"remove",void 0,[e]]),e&&e.unbind&&e.unbind("change"+this._namespace),e}}),n.prototype.indexOf=[].indexOf||function(a){return $.inArray(a,this)},$.O=function(b,c){return a(b)||b instanceof $.Observe.List?new $.Observe.List(b,c):new $.Observe(b,c)}}()}),FD50.plugin("joomla",function(a){var b=a.Joomla=function(b,c){if(a.isFunction(c)){var d=c;
return window.Joomla[b]=d,void 0}var b=window.Joomla[b];return a.isFunction(b)?b.apply(window,c):void 0};b.isJoomla30=!0}),FD50.plugin("module",function(a){var b=function(b){var c=this,d=a.Callbacks("once memory");a.extend(this,a.Deferred(),{name:b,status:"pending",ready:function(b){b===!0&&d.fire.call(c,a),a.isFunction(b)&&d.add(b)}}),c.then(function(){c.exports=this,c.status="resolved"},function(){c.status="rejected"});var e=c.done;c.done=function(){c.required=!0;var b=c.factory;return b&&"ready"===c.status&&b.call(c,a),c.done=e,c.done.apply(this,arguments)
}};a.module=function(){var c=function(b,d){var e;if("string"==typeof b){if(e=c.get(b),void 0===d)return e;if(a.isFunction(d))return"resolved"==e.status?e:(e.factory=d,e.status="ready",e.ready("true"),e.required&&(e.status="executing",d.call(e,a)),e)}if(a.isArray(b)){var f=a.map(b,function(b){var d=c.get(a.isString(b)?b:b.name);if(d)return"pending"===d.status&&(d.status="ready"),a.isPlainObject(b)?b:void 0});a.each(f,function(a,b){c(b.name,b.factory)})}};return a.extend(c,{registry:{},get:function(b){return b?(a.isModule(b)&&(b=b.replace("module://","")),c.registry[b]||c.create(b)):void 0
},create:function(a){return c.registry[a]=new b(a)},remove:function(a){delete c.registry[a]}}),c}(),a.isModule=function(c){return a.isString(c)?!!c.match("module://"):c&&c instanceof b}}),FD50.plugin("script",function(a){a.Script=function(b){var c=document.createElement("script");return c.text=a.isString(b)?b:a.callback(b)+"();",a(c)},a.script=function(){{var b=function(a){if(void 0!==a){"string"==typeof a&&(a={url:a});var b=new c(a);return b}},c=function(b){var c=a.extend(this,b);c.manager=a.Deferred(),a.extend(c,c.manager.promise()),c.load()
},d=document.getElementsByTagName("head")[0];document.getElementsByTagName("base")[0]}return a.extend(c.prototype,{timeout:7e3,retry:3,retryCount:1,type:"text/javascript",async:!1,charset:"UTF-8",verbose:!1,head:d,insert:function(){var a=this.node;this.head.appendChild(a)},remove:function(){var a=this.node;setTimeout(function(){a.onload=a.onerror=a.onreadystatechange=null;try{d.removeChild(a)}catch(b){}},1e3)},load:function(){var c,b=this;b.endTime=void 0,b.startTime=new Date,b.node=c=document.createElement("script"),b.insert(),b._ready=a.proxy(b.ready,b),b._error=a.proxy(b.error,b),c.attachEvent&&!a.browser.opera?(c.attachEvent("onreadystatechange",b._ready),c.attachEvent("onerror",b._error)):(c.addEventListener("load",b._ready,!1),c.addEventListener("error",b._error,!1)),a(c).attr({type:b.type,async:b.async,charset:b.charset,src:b.url}),b.monitor()
},monitor:function(){var a=this;return a.retryCount>a.retry?(a._error(),void 0):(setTimeout(function(){"resolved"!==a.state()&&(a.verbose&&console.warn("$.script: Load timeout. [Retry: "+a.retryCount+"]",a),a.remove(),a.retryCount++,a.load())},a.timeout*a.retryCount),void 0)},ready:function(a){var b=this,c=b.node;("load"===a.type||/loaded|complete/.test(c.readyState))&&(b.complete.call(b,a),b.manager.resolve(b))},error:function(a){var b=this;b.verbose&&console.error("$.script: Unable to load ",b),b.complete.call(b,a),b.remove(),b.manager.reject(b)
},complete:function(){var c=this,d=c.node;c.endTime=new Date,d.detachEvent&&!a.browser.opera?(d.detachEvent("onreadystatechange",c._ready),d.detachEvent("onerror",c._error)):(d.removeEventListener("load",c._ready,!1),d.removeEventListener("error",c._error,!1))}}),b}()}),FD50.plugin("template",function(a){a.template=function(){var b={content:"",type:"ejs"},c=function(d,e){if(void 0===d)return c.templates;var f;return"string"==typeof e?(f=a.isPlainObject(e)?e:a.extend({},b,{name:d,content:e}),c.templates[d]=f,f):(f=c.templates[d]||{},f.content||"")
};return a.extend(c,{templates:{},remove:function(a){delete c.templates[a]}}),c}()}),FD50.plugin("require",function(a){a.require=function(){var b=function(b){return a.uri(b).setAnchor("").setQuery("").toPath("../").toString()},c=function(a){var b=new e(a);return c.batches[b.id]=b,b};a.extend(c,{defaultOptions:{path:function(){var c=a.path||a("[require-path]").attr("require-path")||b(a("script:last").attr("src"))||b(window.location.href);return/^(\/|\.)/.test(c)&&(c=a.uri(window.location.href).toPath(c).toString()),c
}(),timeout:1e4,retry:3,verbose:"development"==a.environment},setup:function(b){a.extend(c.defaultOptions,b)},batches:{},status:function(b){return a.each(c.batches,function(c,d){var e={pending:0,resolved:0,rejected:0,ready:0,total:0},f=[];a.each(d.tasks,function(a,b){state=b.module&&"ready"==b.module.status?"ready":b.state(),e[state]++,e.total++,f.push({state:state,content:"["+state+"] "+b.name})});var g=d.id+": "+d.state()+" ["+e.resolved+"/"+e.total+"]";b&&e[b]<1||(a.IE?(console.log('$.require.batches["'+d.id+'"]'),a.each(f,function(a,b){console.log(b.content)
}),console.log("")):(console.groupCollapsed(g),console.log('$.require.batches["'+d.id+'"]',d),a.each(f,function(a,c){var d=c.state,e=c.content;if(!b||d==b)switch(d){case"pending":console.warn(e);break;case"rejected":console.error(e);break;default:console.info(e)}}),console.groupEnd(g)))}),"$.require.status(pending|resolved|rejected|ready);"},loaders:{},addLoader:function(a,b){c[a]=b,e.prototype[a]=function(){var a=this;return a.autoFinalize(),b.apply(a,arguments),a},c.loaders[a]=c[a]=b},removeLoader:function(a){delete e.prototype[a],delete c[a]
}});var d=0,e=function(b){var e=a.Callbacks("once memory"),f=!1,g=a.extend(this,{id:++d,tasks:[],options:a.extend({},c.defaultOptions,b),autoFinalizeDuration:300,finalized:!1,required:function(b){return b===!0&&(f=!0&&e.fire()),a.isFunction(b)&&e.add(b),f}});return g};return a.extend(e.prototype,{addTask:function(b){var c=this;a.isDeferred(b)&&(c.finalized||(c.tasks.push(b),b.batch=c))},autoFinalize:function(){var a=this,b=a.autoFinalizeDuration;b!==!1&&(clearTimeout(a.autoFinalizeTimer),a.autoFinalizeTimer=setTimeout(function(){a.finalize()
},b))},finalize:function(){var b=this;if(!b.finalized){b.finalized=!0;var c=b.manager=a.when.apply(null,b.tasks),d=c.promise(),e=a.Callbacks();a.extend(b,d,{progress:e.add,notify:e.fire,done:function(){return b.required(!0),b.done=d.done,b.done.apply(b,arguments)}});var f=b.options.verbose;c.progress(function(a,b){f&&"rejected"==a&&console.warn("Require: Task "+b.name+" failed to load.",b)}).fail(function(){f&&console.warn("Require: Batch "+b.id+" failed.",b)}),setTimeout(function(){a.each(b.tasks,function(a,c){c.then(function(){b.notify("resolved",c)
},function(){b.notify("rejected",c)},function(){b.notify("progress",c)})})},1)}},expand:function(b,c){var b=a.makeArray(b),d=c||{},e=[];return a.isPlainObject(b[0])?(d=a.extend(b[0],c),e=b.slice(1)):e=b,{options:d,names:e}}}),a.each(["done","fail","progress","always","then"],function(a,b){e.prototype[b]=function(){var a=this;return a.finalize(),a[b].apply(a,arguments)}}),c}(),a.require.addLoader("script",function(){var b=a.uri(a.indexUrl).host(),c=a.uri(document.location.href).host();b!==c&&b.match("xn--")&&(a.support.cors=!0);
var e=(document.createElement("script").async===!0||"MozAppearance"in document.documentElement.style||window.opera,function(){var d,f,b=this,c=a.makeArray(arguments);a.isPlainObject(c[0])?(d=c[0],f=c.slice(1)):f=c,d=a.extend({},e.defaultOptions,b.options,d,{batch:b});var g;a.each(f,function(a,c){var f=new e.task(c,d,g);b.addTask(f),d.serial&&void 0!==g?g.always(f.start):f.start(),g=f})});return a.extend(e,{defaultOptions:{path:"",extension:"compressed"==a.mode?"min.js":"js",serial:!1,async:!1,xhr:!1},setup:function(){a.extend(e.defaultOptions,options)
},scripts:{},task:function(b,c,d){var e=a.extend(this,a.Deferred());if(e.name=b,e.options=c,e.taskBefore=d,a.isArray(b)){e.name=b[0]+"@"+b[1],e.moduleName=b[0];var f=b[2];f||(e.defineModule=!0,a.module.registry[e.moduleName]&&console.warn("$.require.script: "+e.moduleName+" exists! Using existing module instead."),e.options.xhr=!0),b=b[1],e.module=a.module(e.moduleName)}a.isUrl(b)?e.url=b:/^(\/|\.)/.test(b)?e.url=a.uri(e.options.path).toPath(b).toString():(e.url=a.uri(e.options.path).toPath("./"+b+"."+e.options.extension).toString(),e.module=a.module(b))
}}),a.extend(e.task.prototype,{start:function(){var a=this,b=a.module;return b&&"pending"!==b.status?(a.waitForModule(),void 0):(a.load(),void 0)},waitForModule:function(){var a=this,b=a.module;b.then(a.resolve,a.reject,a.notify),a.batch.required(function(){b.done(a.resolve)})},load:function(){var b=this,c=b.taskBefore;b.script=e.scripts[b.url]||function(){var c=b.options.xhr?a.ajax({url:b.url,dataType:"text"}):a.script({url:b.url,type:"text/javascript",async:b.options.async,timeout:b.batch.options.timeout,retry:b.batch.options.retry,verbose:b.batch.options.verbose});
return e.scripts[b.url]=c}(),b.script.done(function(d){var e=function(){b.module?b.waitForModule():b.resolve()};return b.options.xhr&&(b.defineModule&&(b.module=a.module(b.moduleName,function(){var b=this;a.globalEval(d),b.resolveWith(d)})),!b.options.async||c)?(c.done(function(){a.globalEval(d),e()}),void 0):(e(),void 0)}).fail(function(){b.reject()})}}),e}()),a.require.addLoader("template",function(){var b=function(){var e,f,c=this,d=a.makeArray(arguments);a.isPlainObject(d[0])?(e=d[0],f=d.slice(1)):f=d,e=a.extend({},b.defaultOptions,c.options,e,{batch:c}),a.each(f,function(a,d){var f=new b.task(d,e);
c.addTask(f),f.start()})};return a.extend(b,{defaultOptions:{path:"",extension:"htm"},setup:function(){a.extend(b.defaultOptions,options)},task:function(b,c){var d=a.extend(this,a.Deferred());d.name=b,d.options=c,a.isArray(b)&&(d.name=b[0],b=b[1]),d.url=a.isUrl(b)?b:/^(\/|\.)/.test(b)?a.uri(d.options.path).toPath(b).toString():a.uri(d.options.path).toPath("./"+b+"."+d.options.extension).toString()},loaders:{},loader:function(c){if(a.isArray(c))return a.map(c,function(a){return b.loader(a)});if(a.isPlainObject(c))return a.map(c,function(a,c){return b.loader(c).resolve(a)
});var d=b.loaders[c];return d||(d=b.loaders[c]=a.Deferred().done(function(b){a.template(c,b)})),d}}),a.extend(b.task.prototype,{start:function(){var c=this,d=b.loaders[c.name];return d||(d=b.loader(c.name),d.xhr=a.Ajax({url:c.url,dataType:"text"}).then(d.resolve,d.reject).then(c.resolve,c.reject)),c.loader=d,c}}),b}()),a.require.addLoader("language",function(){var b=function(){var e,f,c=this,d=a.makeArray(arguments);a.isPlainObject(d[0])?(e=d[0],f=d.slice(1)):f=d,e=a.extend({},b.defaultOptions,c.options,e,{batch:c});
var g=new b.task(f,e);c.addTask(g),g.start()};return a.extend(b,{defaultOptions:{path:""},setup:function(){a.extend(b.defaultOptions,options)},loaders:{},task:function(b,c){var d=a.extend(this,a.Deferred());d.name=b.join(","),d.options=c,d.url=c.path,d.names=b},loaders:{},loader:function(c){if(a.isArray(c))return a.map(c,function(a){return b.loader(a)});if(a.isPlainObject(c))return a.map(c,function(a,c){return b.loader(c).resolve(a)});var d=b.loaders[c];return d||(d=b.loaders[c]=a.Deferred().done(function(b){a.language.add(c,b)
})),d}}),a.extend(b.task.prototype,{start:function(){var c=this,d=[],e=a.map(c.names,function(a){var c=b.loader(a);return c.push(c),/resolved|rejected/.test(c.state())?null:a});return c.fail(function(){a.each(e,function(a,c){b.loader(c).reject()})}),a.when.apply(null,d).then(c.resolve,c.reject),e.length<1?c:(c.xhr=a.Ajax({url:c.url,type:"POST",data:{keys:e}}).done(function(d){a.isPlainObject(d)?b.loader(d):c.reject()}).fail(function(){c.reject()}),c)}}),b}()),a.require.addLoader("library",function(){var e,b=this,c=a.makeArray(arguments),d={};
return a.isPlainObject(c[0])?(d=c[0],e=c.slice(1)):e=c,a.extend(d,{path:a.scriptPath}),b.script.apply(b,[d].concat(e))}),a.require.addLoader("image",function(){var b=function(){var e,f,c=this,d=a.makeArray(arguments);a.isPlainObject(d[0])?(e=d[0],f=d.slice(1)):f=d,e=a.extend({},b.defaultOptions,c.options,e,{batch:c}),a.each(f,function(a,d){var f=new b.task(d,e),g=b.images[f.url];f=g||f,c.addTask(f),g||(b.images[f.url]=f,f.start())})};return a.extend(b,{defaultOptions:{path:""},setup:function(){a.extend(b.defaultOptions,options)
},images:{},task:function(b,c){var d=a.extend(this,a.Deferred());d.name=b,d.options=c,d.url=a.isUrl(b)?b:/^(\/|\.)/.test(b)?a.uri(d.options.path).toPath(b).toString():a.uri(d.options.path).toPath("./"+b).toString(),d.options.url=d.url}}),a.extend(b.task.prototype,{start:function(){var b=this;b.image=a(new Image).load(function(){b.resolve()}).error(function(){b.reject()}).attr("src",b.options.url)}}),b}())}),FD50.plugin("iframe-transport",function(a){a.ajaxPrefilter(function(a){return a.iframe?"iframe":void 0
}),a.ajaxTransport("iframe",function(b){function k(){i&&j.replaceWith(function(a){return h.get(a)}),e.remove(),f.attr("src","javascript:false;").remove()}var e=null,f=null,g="iframe-"+a.now(),h=a(b.files).filter(":file:enabled"),i=h.length>0,j=null;return b.dataTypes.shift(),e=a("<form enctype='multipart/form-data' method='post'></form>").hide().attr({action:b.url,target:g}),"string"==typeof b.data&&b.data.length>0&&a.error("data must not be serialized"),a.each(b.data||{},function(b,c){a.isPlainObject(c)&&(b=c.name,c=c.value),a.isArray(c)||(c=[c]),a.each(c,function(c,d){a("<input type='hidden' />").attr({name:b,value:d}).appendTo(e)
})}),a("<input type='hidden' value='IFrame' name='X-Requested-With' />").appendTo(e),i&&(j=h.after(function(){return a(this).clone().prop("disabled",!0)}).next(),h.appendTo(e)),{send:function(b,c){f=a("<iframe src='javascript:false;' name='"+g+"' id='"+g+"' style='display:none'></iframe>"),f.bind("load",function(){f.unbind("load").bind("load",function(){var a=this.contentWindow?this.contentWindow.document:this.contentDocument?this.contentDocument:this.document,b=a.documentElement?a.documentElement:a.body,d=b.getElementsByTagName("textarea")[0],e=d?d.getAttribute("data-type"):null,f=d?d.getAttribute("data-status"):200,g=d?d.getAttribute("data-statusText"):"OK",h={html:b.innerHTML,text:e?d.value:b?b.textContent||b.innerText:null};
k(),c(f,g,h,e?"Content-Type: "+e:null)}),e[0].submit()}),a("body").append(e,f)},abort:function(){null!==f&&(f.unbind("load").attr("src","javascript:false;"),k())}}})}),FD50.plugin("server",function($){var self=$.server=function(a){var b=$.Deferred(),c=$.extend(!0,{},self.defaultOptions,a,{success:function(){}}),d=b.xhr=$.Ajax(c).done(function(c){if("string"==typeof c)try{c=$.parseJSON(c)}catch(d){b.rejectWith(b,["Unable to parse Ajax commands.","error"])}if($.isArray(c)){var e=function(c){var d=c.type,e=self.parsers[d]||a[d];
return $.isFunction(e)?e.apply(b,c.data):void 0},c=$.map(c,function(a){return"notify"!=a.type?a:(e(a),void 0)});$.each(c,function(a,b){e(b)})}else b.rejectWith(b,["Invalid ajax commands.","error"]);"pending"===b.state()&&b.resolveWith(b)}).fail(function(a,c,d){b.rejectWith(b,[d,c])});return b.abort=d.abort,b};self.defaultOptions={type:"POST",data:{tmpl:"component",format:"ajax",no_html:1},cache:!1,contentType:"application/x-www-form-urlencoded",dataType:"json"},self.parsers={script:function(){var data=$.makeArray(arguments);
if("string"!=typeof data[0]){var chain=window,chainBroken=!1;$.each(data,function(a,b){"Foundry"===b.property&&(b.property=$.globalNamespace),"Foundry"===b.method&&(b.method=$.globalNamespace);try{switch(b.type){case"get":chain=chain[b.property];break;case"set":chain[b.property]=b.value,chainBroken=!0;break;case"call":chain=chain[b.method].apply(chain,b.args)}}catch(c){chainBroken=!0}})}else try{eval(data[0])}catch(err){}},resolve:function(){this.resolveWith(this,arguments)},reject:function(){this.rejectWith(this,arguments)
},notify:function(){this.notifyWith(this,arguments)},redirect:function(a){window.location=a}}}),FD50.plugin("component",function(a){var b=a.Component=function(a,c){return arguments.length<1?b.registry:arguments.length<2?b.registry[a]:b.register(a,c)};b.registry={},b.proxy=function(b,c,d){b[c]=a.isFunction(d)?a.proxy(d,b):d},b.register=function(c,d){var e;a.isFunction(c)&&(e=c,c=e.className,d=e.options);var f=b.registry[c]=window[c]=function(b){return a.isFunction(b)?b(a):component};if(a.each(b.prototype,function(a,c){b.proxy(f,a,c)
}),f.$=a,f.options=d,f.className=c,f.identifier=c.toLowerCase(),f.componentName="com_"+f.identifier,f.prefix=f.identifier+"/",f.version=d.version,f.safeVersion=f.version.replace(/\./g,""),f.environment=d.environment||a.environment,f.mode=d.mode||a.mode,f.debug="development"===f.environment,f.console=b.console(f),f.language=d.language||a.locale.lang||"en",f.baseUrl=d.baseUrl||a.indexUrl+"?option="+f.componentName,f.ajaxUrl=d.ajaxUrl||a.basePath+"/?option="+f.componentName,f.scriptPath=d.scriptPath||a.rootPath+"/media/"+f.componentName+"/scripts/",f.stylePath=d.stylePath||a.rootPath+"/media/"+f.componentName+"/styles/",f.templatePath=d.templatePath||d.scriptPath,f.languagePath=d.languagePath||f.ajaxUrl+"&tmpl=component&no_html=1&controller=lang&task=getLanguage",f.viewPath=d.viewPath||f.ajaxUrl+"&tmpl=component&no_html=1&controller=themes&task=getAjaxTemplate",f.optimizeResources=!0,f.resourcePath=d.resourcePath||f.ajaxUrl+"&tmpl=component&no_html=1&controller=foundry&task=getResource",f.resourceInterval=1200,f.scriptVersioning=d.scriptVersioning||!1,f.tasks=[],FD50.component(c,f),e)if(f.debug)e.queue.execute();
else{for(var g,h=FD50.installer(c);g=h.shift();)f.install.apply(f,g);a.when(f.install("definitions"),f.install("scripts")).done(function(){e.queue.execute()})}},b.extend=function(c,d){b.prototype[c]=d,a.each(b.registry,function(a,e){b.proxy(e,c,d)})},a.template("component/console",'<div id="[%== component.identifier %]-console" class="foundry-console" style="display: none; z-index: 999999;"><div class="console-header"><div class="console-title">[%= component.className %] [%= component.version %]</div><div class="console-remove-button">x</div></div><div class="console-log-item-group"></div><style type="text/css">.foundry-console{position:fixed;width:50%;height:50%;bottom:0;left:0;background:white;box-shadow: 0 0 5px 0;margin-left: 25px;}.console-log-item-group{width: 100%;height: 100%;overflow-y:scroll;}.console-header{position: absolute;background:red;color:white;font-weight:bold;top:-24px;left: 0;line-height:24px;width:100%}.console-remove-button{text-align:center;cursor: pointer;display:block;width: 24px;float:right}.console-remove-button:hover{color: yellow}.console-title{padding: 0 5px;float:left}.console-log-item{padding: 5px}.console-log-item + .console-log-item{border-top: 1px solid #ccc}</style></div>'),b.console=function(b){return function(b){var d,c=function(a){return arguments.length<1?c.toggle():c[a]&&c[a].apply(c,arguments)
};return c.selector="#"+b.identifier+"-console",c.init=function(){return d=a(c.selector),d.length<1&&(d=a(a.View("component/console",{component:b})).appendTo("body"),d.find(".console-remove-button").click(function(){d.hide()})),c.element=d,arguments.callee},c.methods={log:function(c,e,f){e=e||"info";var g=d.find(".console-log-item-group"),h=a(document.createElement("div")).addClass("console-log-item type-"+e).attr("data-code",f).html(c);g.append(h),g[0].scrollTop=g[0].scrollHeight,b.debug&&d.show()},toggle:function(){d.toggle()
},reset:function(){d.find(".console-log-item-group").empty()}},a.each(c.methods,function(a,b){c[a]=function(){return c.init(),b.apply(c,arguments)}}),c}(b)};var c=a(document),d=b.prototype;a.extend(d,{run:function(b){return a.isFunction(b)?b(a):this},ready:function(){return c.ready(function(){d.ready=d.run}),function(b){a.isFunction(b)&&c.ready(function(){b(a)})}}(),install:function(b,c){var d=this,e=d.tasks[b]||(d.tasks[b]=a.Deferred());if(!c)return e;var f=function(){return c(a,d),e.resolve()};return"definitions"==b?f():(a.when(d.install("definitions")).done(f),void 0)
},token:function(){return window.ezb.token},template:function(b){var c=this;return void 0==b?a.grep(a.template(),function(a){return 0==a.indexOf(c.prefix)}):(arguments[0]=c.prefix+b,a.template.apply(null,arguments))},require:function(b){var c=this,b=b||{},d=a.require(b),e={};return a.each(["library","script","language","template","done"],function(a,b){e[b]=d[b]}),d.resource=function(b){if(a.isPlainObject(b)&&b.type&&b.name&&a.isDeferred(b.loader)){var f=c.resourceCollector;f||(f=c.resourceCollector=a.Deferred(),a.extend(f,{name:a.uid("ResourceCollector"),manifest:[],loaderList:[],loaders:[],load:function(){if(delete c.resourceCollector,f.manifest.length<0)return f.resolve(),void 0;
var b=0,d=function(){b++,a.Ajax({type:"POST",url:c.resourcePath,dataType:"json",data:{resource:f.manifest}}).done(function(d){return a.isArray(d)?(a.each(d,function(a,b){var c=b.content;f.loaders[b.id][void 0!==c?"resolve":"reject"](c)}),b>1&&c.debug&&console.info("Attempt to try and get resources again was successful!"),void 0):(f.reject("Server did not return a valid resource manifest."),void 0)}).fail(function(){return b>2?(c.debug&&console.error("Unable to get resource again. Giving up!"),void 0):(c.debug&&console.warn("Unable to get resource. Trying again..."),d(),void 0)
})};d(),a.when.apply(null,f.loaderList).done(f.resolve).fail(f.reject)}}),setTimeout(f.load,c.resourceCollectionInterval));var g=b.id=a.uid("Resource");return f.loaders[g]=b.loader,f.loaderList.push(b.loader),delete b.loader,f.manifest.push(b),d}},d.library=function(){return e.script.apply(this,arguments),d},d.script=function(){var b=this,f=b.expand(arguments,{path:c.scriptPath}),g=a.map(f.names,function(b){if(a.isArray(b)||a.isUrl(b)||/^(\/|\.)/.test(b))return b;var d=c.prefix+b,e=a.uri(f.options.path).toPath("./"+b+"."+(f.options.extension||"js")+(c.scriptVersioning?"?version="+c.safeVersion:"")).toString();
return[[d,e,!0]]});return e.script.apply(d,[f.options].concat(g)),d},d.template=function(){var b=this,f=b.expand(arguments,{path:c.templatePath});return e.template.apply(d,[f.options].concat(a.map(f.names,function(a){return[[c.prefix+a,a]]}))),d},d.done=function(a){return e.done.call(d,function(){c.ready(a)})},d},module:function(b,c){var d=this;if(!a.isArray(b)){var e=d.prefix+b;return c?a.module.apply(null,[e,function(){var b=this;c.call(b,a)}]):a.module(e)}}}),a.Component.extend("ajax",function(b,c,d){var e=this,f=new Date,g={url:e.ajaxUrl+"&_ts="+f.getTime(),data:a.extend(c,{option:e.componentName,namespace:b})};
if(g=a.extend(!0,g,e.options.ajax),g.data[e.token()]=1,g.data.hasOwnProperty("args")&&(g.data.args=a.toJSON(g.data.args)),a.isPlainObject(d)){if(d.type){switch(d.type){case"jsonp":d.dataType="jsonp",d.crossDomain=!0,g.data.transport="jsonp";break;case"iframe":d.iframe=!0,d.processData=!1,d.files=g.data.files,delete g.data.files,g.data.transport="iframe"}delete d.type}a.extend(g,d)}a.isFunction(d)&&(g.success=d);var h=a.server(g);return h.progress(function(a,b,c){e.debug&&"debug"==b&&e.console.log(a,b,c)}),h}),a.Component.extend("Controller",function(){var e,f,b=this,c=a.makeArray(arguments),d=c[0];
return 1==c.length?a.String.getObject(d):(c.length>2?(e=c[1],f=c[2]):(e={},f=c[1]),a.extend(e,{root:b.className+".Controller",component:b}),a.Controller.apply(this,[d,e,f]))}),a.Component.extend("View",function(){var c=this;return arguments.length<1?c.template():(arguments[0]=c.prefix+arguments[0],a.View.apply(this,arguments))}),FD50.module.execute(),a.each(FD50.component(),function(b,c){c.registered||a.Component.register(c)})}),FD50.plugin("static",function($){$.module(["accordion","autosize.input","daterangepicker","dialog","image","label","leaflet","scrollTo","textboxlist"]),function(){var a=function(a){var b=this,d=function(){!function(){"use strict";
var a=function(b){return NodeList.prototype.isPrototypeOf(b.node)?(b.node.forEach(function(c){var d=b;d.node=c,new a(d)}),void 0):(b.node instanceof HTMLElement?(this.node=b.node,this.eventNode=b.eventNode?this.node.querySelector(b.eventNode):this.node,this.isCollapsed="undefined"!=typeof this.node.dataset.collapsibleCollapsed?!0:null,this.isCollapsed||(this.isCollapsed=b.isCollapsed&&"boolean"==typeof b.isCollapsed?b.isCollapsed:!1),this.observe="boolean"==typeof b.observe?b.observe:!1,this.expandCallback="function"==typeof b.expandCallback?b.expandCallback:null,this.collapseCallback="function"==typeof b.collapseCallback?b.collapseCallback:null,this.observeCallback="function"==typeof b.observeCallback?b.observeCallback:null,this.mutationCallback="function"==typeof b.mutationCallback?b.mutationCallback:null,this.init()):console.error(b.node,"is not a NodeList or an instance of HTMLElement"),void 0)
};a.prototype.init=function(){this.updateHeights(),this.isCollapsed?(this.node.style.height=this.collapsedHeight+"px",this.node.classList.add("is-collapsed")):this.node.classList.contains("is-expanded")&&this.node.classList.add("is-active"),this.eventNode.addEventListener("click",function(){this.toggleCollapse()}.bind(this)),window.addEventListener("resize",this.updateHeights.bind(this,null)),this.observe&&this.initObserver(),this.node.collapsible=this},a.prototype.updateHeights=function(b){b=b||0,this.collapsedHeight=a.parseNumber(window.getComputedStyle(this.eventNode).height),this.node.style.height="auto",this.expandedHeight=a.parseNumber(window.getComputedStyle(this.node).height),this.expandedHeight+=b,this.expandedHeight=Math.max(this.expandedHeight,this.collapsedHeight),(this.isCollapsed||this.node.classList.contains("is-collapsed"))&&(this.node.style.height=this.collapsedHeight+"px"),this.updateParentNode(this.expandedHeight-this.collapsedHeight)
},a.prototype.toggleCollapse=function(){this.isCollapsed||this.node.classList.contains("is-collapsed")?this.expand():this.collapse()},a.prototype.expand=function(){this.updateHeights(),void this.node.offsetWidth,this.node.style.height="auto",this.node.style.height=this.expandedHeight+"px",this.node.classList.remove("is-collapsed"),this.node.classList.add("is-expanded"),this.node.classList.add("is-active"),this.isCollapsed=!1;var a=new CustomEvent("toggle",{bubbles:!0,detail:{action:"expand",origin:this.eventNode}});
this.node.dispatchEvent(a),this.expandCallback&&this.expandCallback.bind(this,a)(),this.updateParentNode(this.expandedHeight-this.collapsedHeight)},a.prototype.collapse=function(){this.node.style.height=window.getComputedStyle(this.node).height,void this.node.offsetWidth,this.node.style.height=this.collapsedHeight+"px",this.node.classList.remove("is-expanded"),this.node.classList.remove("is-active"),this.node.classList.add("is-collapsed"),this.isCollapsed=!0;var a=new CustomEvent("toggle",{bubbles:!0,detail:{action:"collapse",origin:this.eventNode}});
this.node.dispatchEvent(a),this.collapseCallback&&this.collapseCallback.bind(this,a)(),this.updateParentNode(-(this.expandedHeight-this.collapsedHeight))},a.prototype.updateParentNode=function(a){this.node.parentNode&&this.node.parentNode.collapsible&&this.node.parentNode.collapsible.updateHeights(a)},a.prototype.initObserver=function(){this.mutationObserver=new window.MutationObserver(function(b){var c,d;if(b[0].addedNodes.length>0?(d="add",c=b[0].addedNodes[0]):(d="remove",c=b[0].removedNodes[0]),!this.isCollapsed){var e=window.getComputedStyle(c),f=a.parseNumber(e.height)+a.parseNumber(e["margin-top"])+a.parseNumber(e["margin-bottom"]);
this.node.style.height="auto";var g=a.parseNumber(window.getComputedStyle(this.node).height);"add"==d?(this.node.style.height=g-f+"px",void this.node.offsetWidth,this.node.style.height=g+"px"):(this.node.style.height=this.expandedHeight+"px",void this.node.offsetWidth,this.node.style.height=g+"px")}this.expandedHeight=g;var h=new CustomEvent("mutate",{bubbles:!0,detail:{action:d,node:c}});this.node.dispatchEvent(h),this.mutationCallback&&this.mutationCallback.bind(this,h)()}.bind(this)),this.mutationObserver.observe(this.node,{childList:!0})
},a.parseNumber=function(a){return Number.parseInt(a.slice(0,-2))},window.Collapsible=a}()};d(),b.resolveWith(d)};FD50.module("accordion",a)}(),function(){var a=function(a){var b=this,c=function(){var b=function(c,d){var e=this;e.input=a(c),e.options=a.extend(b.defaultOptions,d),e.mirror=a('<span style="position:absolute; top:-999px; left:0; white-space:pre;"/>'),a.each(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],function(a,b){e.mirror[0].style[b]=e.input.css(b)
}),a("body").append(e.mirror),e.input.bind("keydown keyup input",function(){e.update()}),e.update()};b.defaultOptions={space:30},b.validTypes=["text","password","search","url","tel","email"],b.prototype.update=function(){var a=this,b=a.input,c=a.mirror,d=b.val();if(d||(d=b.attr("placeholder")),d!==c.text()){c.text(d);var e=c.width()+a.options.space;b.width(e)}},a.fn.autosizeInput=function(c){return this.each(function(){if("INPUT"==this.tagName&&a.inArray(this.type,b.validTypes)>-1){var d=a(this);d.data("autosizeInputInstance")||d.data("autosizeInputInstance",new b(this,c))
}})},a(function(){a("input[data-autosize-input]").autosizeInput()})};c(),b.resolveWith(c)};FD50.module("autosize.input",a)}(),function(){var a=function(a){var b=this;a.require().script("moment").done(function(){var c=function(){var b=a.moment,c=function(c,d,e){if(this.parentEl="body",this.element=a(c),this.startDate=b().startOf("day"),this.endDate=b().endOf("day"),this.minDate=!1,this.maxDate=!1,this.dateLimit=!1,this.autoApply=!1,this.singleDatePicker=!1,this.showDropdowns=!1,this.showWeekNumbers=!1,this.showISOWeekNumbers=!1,this.showCustomRangeLabel=!0,this.timePicker=!1,this.timePicker24Hour=!1,this.timePickerIncrement=1,this.timePickerSeconds=!1,this.linkedCalendars=!0,this.autoUpdateInput=!0,this.alwaysShowCalendars=!1,this.ranges={},this.opens="right",this.element.hasClass("pull-right")&&(this.opens="left"),this.drops="down",this.element.hasClass("dropup")&&(this.drops="up"),this.buttonClasses="btn btn-sm",this.applyClass="btn-success",this.cancelClass="btn-default",this.locale={direction:"ltr",format:"DD/MM/YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:b.weekdaysMin(),monthNames:b.monthsShort(),firstDay:0},this.callback=function(){},this.isShowing=!1,this.leftCalendar={},this.rightCalendar={},("object"!=typeof d||null===d)&&(d={}),d=a.extend(this.element.data(),d),"string"==typeof d.template||d.template instanceof a||(d.template='<div id="eb" class="daterangepicker dropdown-menu"><div class="calendar left"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_start" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="calendar right"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_end" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="ranges"><div class="range_inputs"><button class="applyBtn" disabled="disabled" type="button"></button> <button class="cancelBtn" type="button"></button></div></div></div>'),this.parentEl=d.parentEl&&a(d.parentEl).length?a(d.parentEl):a(this.parentEl),this.container=a(d.template).appendTo(this.parentEl),"object"==typeof d.locale&&("string"==typeof d.locale.direction&&(this.locale.direction=d.locale.direction),"string"==typeof d.locale.format&&(this.locale.format=d.locale.format),"string"==typeof d.locale.separator&&(this.locale.separator=d.locale.separator),"object"==typeof d.locale.daysOfWeek&&(this.locale.daysOfWeek=d.locale.daysOfWeek.slice()),"object"==typeof d.locale.monthNames&&(this.locale.monthNames=d.locale.monthNames.slice()),"number"==typeof d.locale.firstDay&&(this.locale.firstDay=d.locale.firstDay),"string"==typeof d.locale.applyLabel&&(this.locale.applyLabel=d.locale.applyLabel),"string"==typeof d.locale.cancelLabel&&(this.locale.cancelLabel=d.locale.cancelLabel),"string"==typeof d.locale.weekLabel&&(this.locale.weekLabel=d.locale.weekLabel),"string"==typeof d.locale.customRangeLabel)){var f=document.createElement("textarea");
f.innerHTML=d.locale.customRangeLabel;var g=f.value;this.locale.customRangeLabel=g}if(this.container.addClass(this.locale.direction),"string"==typeof d.startDate&&(this.startDate=b(d.startDate,this.locale.format)),"string"==typeof d.endDate&&(this.endDate=b(d.endDate,this.locale.format)),"string"==typeof d.minDate&&(this.minDate=b(d.minDate,this.locale.format)),"string"==typeof d.maxDate&&(this.maxDate=b(d.maxDate,this.locale.format)),"object"==typeof d.startDate&&(this.startDate=b(d.startDate)),"object"==typeof d.endDate&&(this.endDate=b(d.endDate)),"object"==typeof d.minDate&&(this.minDate=b(d.minDate)),"object"==typeof d.maxDate&&(this.maxDate=b(d.maxDate)),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone()),"string"==typeof d.applyClass&&(this.applyClass=d.applyClass),"string"==typeof d.cancelClass&&(this.cancelClass=d.cancelClass),"object"==typeof d.dateLimit&&(this.dateLimit=d.dateLimit),"string"==typeof d.opens&&(this.opens=d.opens),"string"==typeof d.drops&&(this.drops=d.drops),"boolean"==typeof d.showWeekNumbers&&(this.showWeekNumbers=d.showWeekNumbers),"boolean"==typeof d.showISOWeekNumbers&&(this.showISOWeekNumbers=d.showISOWeekNumbers),"string"==typeof d.buttonClasses&&(this.buttonClasses=d.buttonClasses),"object"==typeof d.buttonClasses&&(this.buttonClasses=d.buttonClasses.join(" ")),"boolean"==typeof d.showDropdowns&&(this.showDropdowns=d.showDropdowns),"boolean"==typeof d.showCustomRangeLabel&&(this.showCustomRangeLabel=d.showCustomRangeLabel),"boolean"==typeof d.singleDatePicker&&(this.singleDatePicker=d.singleDatePicker,this.singleDatePicker&&(this.endDate=this.startDate.clone())),"boolean"==typeof d.timePicker&&(this.timePicker=d.timePicker),"boolean"==typeof d.timePickerSeconds&&(this.timePickerSeconds=d.timePickerSeconds),"number"==typeof d.timePickerIncrement&&(this.timePickerIncrement=d.timePickerIncrement),"boolean"==typeof d.timePicker24Hour&&(this.timePicker24Hour=d.timePicker24Hour),"boolean"==typeof d.autoApply&&(this.autoApply=d.autoApply),"boolean"==typeof d.autoUpdateInput&&(this.autoUpdateInput=d.autoUpdateInput),"boolean"==typeof d.linkedCalendars&&(this.linkedCalendars=d.linkedCalendars),"function"==typeof d.isInvalidDate&&(this.isInvalidDate=d.isInvalidDate),"function"==typeof d.isCustomDate&&(this.isCustomDate=d.isCustomDate),"boolean"==typeof d.alwaysShowCalendars&&(this.alwaysShowCalendars=d.alwaysShowCalendars),0!=this.locale.firstDay)for(var h=this.locale.firstDay;h>0;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),h--;
var i,j,k;if("undefined"==typeof d.startDate&&"undefined"==typeof d.endDate&&a(this.element).is("input[type=text]")){var l=a(this.element).val(),m=l.split(this.locale.separator);i=j=null,2==m.length?(i=b(m[0],this.locale.format),j=b(m[1],this.locale.format)):this.singleDatePicker&&""!==l&&(i=b(l,this.locale.format),j=b(l,this.locale.format)),null!==i&&null!==j&&(this.setStartDate(i),this.setEndDate(j))}if("object"==typeof d.ranges){for(k in d.ranges){i="string"==typeof d.ranges[k][0]?b(d.ranges[k][0],this.locale.format):b(d.ranges[k][0]),j="string"==typeof d.ranges[k][1]?b(d.ranges[k][1],this.locale.format):b(d.ranges[k][1]),this.minDate&&i.isBefore(this.minDate)&&(i=this.minDate.clone());
var n=this.maxDate;if(this.dateLimit&&n&&i.clone().add(this.dateLimit).isAfter(n)&&(n=i.clone().add(this.dateLimit)),n&&j.isAfter(n)&&(j=n.clone()),!(this.minDate&&j.isBefore(this.minDate,this.timepicker?"minute":"day")||n&&i.isAfter(n,this.timepicker?"minute":"day"))){var f=document.createElement("textarea");f.innerHTML=k;var g=f.value;this.ranges[g]=[i,j]}}var o="<ul>";for(k in this.ranges)o+='<li data-range-key="'+k+'">'+k+"</li>";this.showCustomRangeLabel&&(o+='<li data-range-key="'+this.locale.customRangeLabel+'">'+this.locale.customRangeLabel+"</li>"),o+="</ul>",this.container.find(".ranges").prepend(o)
}"function"==typeof e&&(this.callback=e),this.timePicker||(this.startDate=this.startDate.startOf("day"),this.endDate=this.endDate.endOf("day"),this.container.find(".calendar-time").hide()),this.timePicker&&this.autoApply&&(this.autoApply=!1),this.autoApply&&"object"!=typeof d.ranges?this.container.find(".ranges").hide():this.autoApply&&this.container.find(".applyBtn, .cancelBtn").addClass("hide"),this.singleDatePicker&&(this.container.addClass("single"),this.container.find(".calendar.left").addClass("single"),this.container.find(".calendar.left").show(),this.container.find(".calendar.right").hide(),this.container.find(".daterangepicker_input input, .daterangepicker_input > i").hide(),this.timePicker?this.container.find(".ranges ul").hide():this.container.find(".ranges").hide()),("undefined"==typeof d.ranges&&!this.singleDatePicker||this.alwaysShowCalendars)&&this.container.addClass("show-calendar"),this.container.addClass("opens"+this.opens),"undefined"!=typeof d.ranges&&"right"==this.opens&&this.container.find(".ranges").prependTo(this.container.find(".calendar.left").parent()),this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses),this.applyClass.length&&this.container.find(".applyBtn").addClass(this.applyClass),this.cancelClass.length&&this.container.find(".cancelBtn").addClass(this.cancelClass),this.container.find(".applyBtn").html(this.locale.applyLabel),this.container.find(".cancelBtn").html(this.locale.cancelLabel),this.container.find(".calendar").on("click.daterangepicker",".prev",a.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",a.proxy(this.clickNext,this)).on("mousedown.daterangepicker","td.available",a.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",a.proxy(this.hoverDate,this)).on("mouseleave.daterangepicker","td.available",a.proxy(this.updateFormInputs,this)).on("change.daterangepicker","select.yearselect",a.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.monthselect",a.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",a.proxy(this.timeChanged,this)).on("click.daterangepicker",".daterangepicker_input input",a.proxy(this.showCalendars,this)).on("focus.daterangepicker",".daterangepicker_input input",a.proxy(this.formInputsFocused,this)).on("blur.daterangepicker",".daterangepicker_input input",a.proxy(this.formInputsBlurred,this)).on("change.daterangepicker",".daterangepicker_input input",a.proxy(this.formInputsChanged,this)),this.container.find(".ranges").on("click.daterangepicker","button.applyBtn",a.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",a.proxy(this.clickCancel,this)).on("click.daterangepicker","li",a.proxy(this.clickRange,this)).on("mouseenter.daterangepicker","li",a.proxy(this.hoverRange,this)).on("mouseleave.daterangepicker","li",a.proxy(this.updateFormInputs,this)),this.element.is("input")||this.element.is("button")?this.element.on({"click.daterangepicker":a.proxy(this.show,this),"focus.daterangepicker":a.proxy(this.show,this),"keyup.daterangepicker":a.proxy(this.elementChanged,this),"keydown.daterangepicker":a.proxy(this.keydown,this)}):this.element.on("click.daterangepicker",a.proxy(this.toggle,this)),this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))
};return c.prototype={constructor:c,setStartDate:function(a){"string"==typeof a&&(this.startDate=b(a,this.locale.format)),"object"==typeof a&&(this.startDate=b(a)),this.timePicker||(this.startDate=this.startDate.startOf("day")),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement)),this.maxDate&&this.startDate.isAfter(this.maxDate)&&(this.startDate=this.maxDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.floor(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement)),this.isShowing||this.updateElement(),this.updateMonthsInView()
},setEndDate:function(a){"string"==typeof a&&(this.endDate=b(a,this.locale.format)),"object"==typeof a&&(this.endDate=b(a)),this.timePicker||(this.endDate=this.endDate.endOf("day")),this.timePicker&&this.timePickerIncrement&&this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.endDate.isBefore(this.startDate)&&(this.endDate=this.startDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone()),this.dateLimit&&this.startDate.clone().add(this.dateLimit).isBefore(this.endDate)&&(this.endDate=this.startDate.clone().add(this.dateLimit)),this.previousRightTime=this.endDate.clone(),this.isShowing||this.updateElement(),this.updateMonthsInView()
},isInvalidDate:function(){return!1},isCustomDate:function(){return!1},updateView:function(){this.timePicker&&(this.renderTimePicker("left"),this.renderTimePicker("right"),this.endDate?this.container.find(".right .calendar-time select").removeAttr("disabled").removeClass("disabled"):this.container.find(".right .calendar-time select").attr("disabled","disabled").addClass("disabled")),this.endDate?(this.container.find('input[name="daterangepicker_end"]').removeClass("active"),this.container.find('input[name="daterangepicker_start"]').addClass("active")):(this.container.find('input[name="daterangepicker_end"]').addClass("active"),this.container.find('input[name="daterangepicker_start"]').removeClass("active")),this.updateMonthsInView(),this.updateCalendars(),this.updateFormInputs()
},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.startDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM"))&&(this.endDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.endDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM")))return;this.leftCalendar.month=this.startDate.clone().date(2),this.rightCalendar.month=this.linkedCalendars||this.endDate.month()==this.startDate.month()&&this.endDate.year()==this.startDate.year()?this.startDate.clone().date(2).add(1,"month"):this.endDate.clone().date(2)
}else this.leftCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&this.rightCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&(this.leftCalendar.month=this.startDate.clone().date(2),this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"));this.maxDate&&this.linkedCalendars&&!this.singleDatePicker&&this.rightCalendar.month>this.maxDate&&(this.rightCalendar.month=this.maxDate.clone().date(2),this.leftCalendar.month=this.maxDate.clone().date(2).subtract(1,"month"))
},updateCalendars:function(){if(this.timePicker){var a,b,c;if(this.endDate){if(a=parseInt(this.container.find(".left .hourselect").val(),10),b=parseInt(this.container.find(".left .minuteselect").val(),10),c=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,!this.timePicker24Hour){var d=this.container.find(".left .ampmselect").val();"PM"===d&&12>a&&(a+=12),"AM"===d&&12===a&&(a=0)}}else if(a=parseInt(this.container.find(".right .hourselect").val(),10),b=parseInt(this.container.find(".right .minuteselect").val(),10),c=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,!this.timePicker24Hour){var d=this.container.find(".right .ampmselect").val();
"PM"===d&&12>a&&(a+=12),"AM"===d&&12===a&&(a=0)}this.leftCalendar.month.hour(a).minute(b).second(c),this.rightCalendar.month.hour(a).minute(b).second(c)}this.renderCalendar("left"),this.renderCalendar("right"),this.container.find(".ranges li").removeClass("active"),null!=this.endDate&&this.calculateChosenLabel()},renderCalendar:function(c){var d="left"==c?this.leftCalendar:this.rightCalendar,e=d.month.month(),f=d.month.year(),g=d.month.hour(),h=d.month.minute(),i=d.month.second(),j=b([f,e]).daysInMonth(),k=b([f,e,1]),l=b([f,e,j]),m=b(k).subtract(1,"month").month(),n=b(k).subtract(1,"month").year(),o=b([n,m]).daysInMonth(),p=k.day(),d=[];
d.firstDay=k,d.lastDay=l;for(var q=0;6>q;q++)d[q]=[];var r=o-p+this.locale.firstDay+1;r>o&&(r-=7),p==this.locale.firstDay&&(r=o-6);for(var t,u,s=b([n,m,r,12,h,i]),q=0,t=0,u=0;42>q;q++,t++,s=b(s).add(24,"hour"))q>0&&t%7===0&&(t=0,u++),d[u][t]=s.clone().hour(g).minute(h).second(i),s.hour(12),this.minDate&&d[u][t].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&d[u][t].isBefore(this.minDate)&&"left"==c&&(d[u][t]=this.minDate.clone()),this.maxDate&&d[u][t].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&d[u][t].isAfter(this.maxDate)&&"right"==c&&(d[u][t]=this.maxDate.clone());
"left"==c?this.leftCalendar.calendar=d:this.rightCalendar.calendar=d;var v="left"==c?this.minDate:this.startDate,w=this.maxDate,y=("left"==c?this.startDate:this.endDate,"ltr"==this.locale.direction?{left:"chevron-left",right:"chevron-right"}:{left:"chevron-right",right:"chevron-left"}),z='<table class="table-condensed">';z+="<thead>",z+="<tr>",(this.showWeekNumbers||this.showISOWeekNumbers)&&(z+="<th></th>"),z+=v&&!v.isBefore(d.firstDay)||this.linkedCalendars&&"left"!=c?"<th></th>":'<th class="prev available"><i class="fa fa-'+y.left+" glyphicon glyphicon-"+y.left+'"></i></th>';
var A=this.locale.monthNames[d[1][1].month()]+d[1][1].format(" YYYY");if(this.showDropdowns){for(var B=d[1][1].month(),C=d[1][1].year(),D=w&&w.year()||C+5,E=v&&v.year()||C-50,F=C==E,G=C==D,H='<select class="monthselect">',I=0;12>I;I++)H+=(!F||I>=v.month())&&(!G||I<=w.month())?"<option value='"+I+"'"+(I===B?" selected='selected'":"")+">"+this.locale.monthNames[I]+"</option>":"<option value='"+I+"'"+(I===B?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[I]+"</option>";H+="</select>";for(var J='<select class="yearselect">',K=E;D>=K;K++)J+='<option value="'+K+'"'+(K===C?' selected="selected"':"")+">"+K+"</option>";
J+="</select>",A=H+J}if(z+='<th colspan="5" class="month">'+A+"</th>",z+=w&&!w.isAfter(d.lastDay)||this.linkedCalendars&&"right"!=c&&!this.singleDatePicker?"<th></th>":'<th class="next available"><i class="fa fa-'+y.right+" glyphicon glyphicon-"+y.right+'"></i></th>',z+="</tr>",z+="<tr>",(this.showWeekNumbers||this.showISOWeekNumbers)&&(z+='<th class="week">'+this.locale.weekLabel+"</th>"),a.each(this.locale.daysOfWeek,function(a,b){z+="<th>"+b+"</th>"}),z+="</tr>",z+="</thead>",z+="<tbody>",null==this.endDate&&this.dateLimit){var L=this.startDate.clone().add(this.dateLimit).endOf("day");
(!w||L.isBefore(w))&&(w=L)}for(var u=0;6>u;u++){z+="<tr>",this.showWeekNumbers?z+='<td class="week">'+d[u][0].week()+"</td>":this.showISOWeekNumbers&&(z+='<td class="week">'+d[u][0].isoWeek()+"</td>");for(var t=0;7>t;t++){var M=[];d[u][t].isSame(new Date,"day")&&M.push("today"),d[u][t].isoWeekday()>5&&M.push("weekend"),d[u][t].month()!=d[1][1].month()&&M.push("off"),this.minDate&&d[u][t].isBefore(this.minDate,"day")&&M.push("off","disabled"),w&&d[u][t].isAfter(w,"day")&&M.push("off","disabled"),this.isInvalidDate(d[u][t])&&M.push("off","disabled"),d[u][t].format("YYYY-MM-DD")==this.startDate.format("YYYY-MM-DD")&&M.push("active","start-date"),null!=this.endDate&&d[u][t].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&M.push("active","end-date"),null!=this.endDate&&d[u][t]>this.startDate&&d[u][t]<this.endDate&&M.push("in-range");
var N=this.isCustomDate(d[u][t]);N!==!1&&("string"==typeof N?M.push(N):Array.prototype.push.apply(M,N));for(var O="",P=!1,q=0;q<M.length;q++)O+=M[q]+" ","disabled"==M[q]&&(P=!0);P||(O+="available"),z+='<td class="'+O.replace(/^\s+|\s+$/g,"")+'" data-title="r'+u+"c"+t+'">'+d[u][t].date()+"</td>"}z+="</tr>"}z+="</tbody>",z+="</table>",this.container.find(".calendar."+c+" .calendar-table").html(z)},renderTimePicker:function(a){if("right"!=a||this.endDate){var b,c,d,e=this.maxDate;if(!this.dateLimit||this.maxDate&&!this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)||(e=this.startDate.clone().add(this.dateLimit)),"left"==a)c=this.startDate.clone(),d=this.minDate;
else if("right"==a){c=this.endDate.clone(),d=this.startDate;var f=this.container.find(".calendar.right .calendar-time div");if(""!=f.html()&&(c.hour(f.find(".hourselect option:selected").val()||c.hour()),c.minute(f.find(".minuteselect option:selected").val()||c.minute()),c.second(f.find(".secondselect option:selected").val()||c.second()),!this.timePicker24Hour)){var g=f.find(".ampmselect option:selected").val();"PM"===g&&c.hour()<12&&c.hour(c.hour()+12),"AM"===g&&12===c.hour()&&c.hour(0)}c.isBefore(this.startDate)&&(c=this.startDate.clone()),e&&c.isAfter(e)&&(c=e.clone())
}b='<select class="hourselect">';for(var h=this.timePicker24Hour?0:1,i=this.timePicker24Hour?23:12,j=h;i>=j;j++){var k=j;this.timePicker24Hour||(k=c.hour()>=12?12==j?12:j+12:12==j?0:j);var l=c.clone().hour(k),m=!1;d&&l.minute(59).isBefore(d)&&(m=!0),e&&l.minute(0).isAfter(e)&&(m=!0),b+=k!=c.hour()||m?m?'<option value="'+j+'" disabled="disabled" class="disabled">'+j+"</option>":'<option value="'+j+'">'+j+"</option>":'<option value="'+j+'" selected="selected">'+j+"</option>"}b+="</select> ",b+=': <select class="minuteselect">';
for(var j=0;60>j;j+=this.timePickerIncrement){var n=10>j?"0"+j:j,l=c.clone().minute(j),m=!1;d&&l.second(59).isBefore(d)&&(m=!0),e&&l.second(0).isAfter(e)&&(m=!0),b+=c.minute()!=j||m?m?'<option value="'+j+'" disabled="disabled" class="disabled">'+n+"</option>":'<option value="'+j+'">'+n+"</option>":'<option value="'+j+'" selected="selected">'+n+"</option>"}if(b+="</select> ",this.timePickerSeconds){b+=': <select class="secondselect">';for(var j=0;60>j;j++){var n=10>j?"0"+j:j,l=c.clone().second(j),m=!1;d&&l.isBefore(d)&&(m=!0),e&&l.isAfter(e)&&(m=!0),b+=c.second()!=j||m?m?'<option value="'+j+'" disabled="disabled" class="disabled">'+n+"</option>":'<option value="'+j+'">'+n+"</option>":'<option value="'+j+'" selected="selected">'+n+"</option>"
}b+="</select> "}if(!this.timePicker24Hour){b+='<select class="ampmselect">';var o="",p="";d&&c.clone().hour(12).minute(0).second(0).isBefore(d)&&(o=' disabled="disabled" class="disabled"'),e&&c.clone().hour(0).minute(0).second(0).isAfter(e)&&(p=' disabled="disabled" class="disabled"'),b+=c.hour()>=12?'<option value="AM"'+o+'>AM</option><option value="PM" selected="selected"'+p+">PM</option>":'<option value="AM" selected="selected"'+o+'>AM</option><option value="PM"'+p+">PM</option>",b+="</select>"}this.container.find(".calendar."+a+" .calendar-time div").html(b)
}},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.locale.format)),this.endDate&&this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.locale.format)),this.singleDatePicker||this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate))?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled"))
},move:function(){var c,b={top:0,left:0},d=a(window).width();this.parentEl.is("body")||(b={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()},d=this.parentEl[0].clientWidth+this.parentEl.offset().left),c="up"==this.drops?this.element.offset().top-this.container.outerHeight()-b.top:this.element.offset().top+this.element.outerHeight()-b.top,this.container["up"==this.drops?"addClass":"removeClass"]("dropup"),"left"==this.opens?(this.container.css({top:c,right:d-this.element.offset().left-this.element.outerWidth(),left:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):"center"==this.opens?(this.container.css({top:c,left:this.element.offset().left-b.left+this.element.outerWidth()/2-this.container.outerWidth()/2,right:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):(this.container.css({top:c,left:this.element.offset().left-b.left,right:"auto"}),this.container.offset().left+this.container.outerWidth()>a(window).width()&&this.container.css({left:"auto",right:0}))
},show:function(){this.isShowing||(this._outsideClickProxy=a.proxy(function(a){this.outsideClick(a)},this),a(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy),a(window).on("resize.daterangepicker",a.proxy(function(a){this.move(a)},this)),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.previousRightTime=this.endDate.clone(),this.updateView(),this.container.show(),this.move(),this.element.trigger("show.daterangepicker",this),this.isShowing=!0)
},hide:function(){this.isShowing&&(this.endDate||(this.startDate=this.oldStartDate.clone(),this.endDate=this.oldEndDate.clone()),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.callback(this.startDate,this.endDate,this.chosenLabel),this.updateElement(),a(document).off(".daterangepicker"),a(window).off(".daterangepicker"),this.container.hide(),this.element.trigger("hide.daterangepicker",this),this.isShowing=!1)},toggle:function(){this.isShowing?this.hide():this.show()},outsideClick:function(b){var c=a(b.target);
"focusin"==b.type||c.closest(this.element).length||c.closest(this.container).length||c.closest(".calendar-table").length||(this.hide(),this.element.trigger("outsideClick.daterangepicker",this))},showCalendars:function(){this.container.addClass("show-calendar"),this.move(),this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar"),this.element.trigger("hideCalendar.daterangepicker",this)},hoverRange:function(a){if(!this.container.find("input[name=daterangepicker_start]").is(":focus")&&!this.container.find("input[name=daterangepicker_end]").is(":focus")){var b=a.target.getAttribute("data-range-key");
if(b==this.locale.customRangeLabel)this.updateView();else{var c=this.ranges[b];this.container.find("input[name=daterangepicker_start]").val(c[0].format(this.locale.format)),this.container.find("input[name=daterangepicker_end]").val(c[1].format(this.locale.format))}}},clickRange:function(a){var b=a.target.getAttribute("data-range-key");if(this.chosenLabel=b,b==this.locale.customRangeLabel)this.showCalendars();else{var c=this.ranges[b];this.startDate=c[0],this.endDate=c[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.alwaysShowCalendars||this.hideCalendars(),this.clickApply()
}},clickPrev:function(b){var c=a(b.target).parents(".calendar");c.hasClass("left")?(this.leftCalendar.month.subtract(1,"month"),this.linkedCalendars&&this.rightCalendar.month.subtract(1,"month")):this.rightCalendar.month.subtract(1,"month"),this.updateCalendars()},clickNext:function(b){var c=a(b.target).parents(".calendar");c.hasClass("left")?this.leftCalendar.month.add(1,"month"):(this.rightCalendar.month.add(1,"month"),this.linkedCalendars&&this.leftCalendar.month.add(1,"month")),this.updateCalendars()},hoverDate:function(b){if(a(b.target).hasClass("available")){var c=a(b.target).attr("data-title"),d=c.substr(1,1),e=c.substr(3,1),f=a(b.target).parents(".calendar"),g=f.hasClass("left")?this.leftCalendar.calendar[d][e]:this.rightCalendar.calendar[d][e];
this.endDate&&!this.container.find("input[name=daterangepicker_start]").is(":focus")?this.container.find("input[name=daterangepicker_start]").val(g.format(this.locale.format)):this.endDate||this.container.find("input[name=daterangepicker_end]").is(":focus")||this.container.find("input[name=daterangepicker_end]").val(g.format(this.locale.format));var h=this.leftCalendar,i=this.rightCalendar,j=this.startDate;this.endDate||this.container.find(".calendar tbody td").each(function(b,c){if(!a(c).hasClass("week")){var d=a(c).attr("data-title"),e=d.substr(1,1),f=d.substr(3,1),k=a(c).parents(".calendar"),l=k.hasClass("left")?h.calendar[e][f]:i.calendar[e][f];
l.isAfter(j)&&l.isBefore(g)||l.isSame(g,"day")?a(c).addClass("in-range"):a(c).removeClass("in-range")}})}},clickDate:function(b){if(a(b.target).hasClass("available")){var c=a(b.target).attr("data-title"),d=c.substr(1,1),e=c.substr(3,1),f=a(b.target).parents(".calendar"),g=f.hasClass("left")?this.leftCalendar.calendar[d][e]:this.rightCalendar.calendar[d][e];if(this.endDate||g.isBefore(this.startDate,"day")){if(this.timePicker){var h=parseInt(this.container.find(".left .hourselect").val(),10);if(!this.timePicker24Hour){var i=this.container.find(".left .ampmselect").val();
"PM"===i&&12>h&&(h+=12),"AM"===i&&12===h&&(h=0)}var j=parseInt(this.container.find(".left .minuteselect").val(),10),k=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0;g=g.clone().hour(h).minute(j).second(k)}this.endDate=null,this.setStartDate(g.clone())}else if(!this.endDate&&g.isBefore(this.startDate))this.setEndDate(this.startDate.clone());else{if(this.timePicker){var h=parseInt(this.container.find(".right .hourselect").val(),10);if(!this.timePicker24Hour){var i=this.container.find(".right .ampmselect").val();
"PM"===i&&12>h&&(h+=12),"AM"===i&&12===h&&(h=0)}var j=parseInt(this.container.find(".right .minuteselect").val(),10),k=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0;g=g.clone().hour(h).minute(j).second(k)}this.setEndDate(g.clone()),this.autoApply&&(this.calculateChosenLabel(),this.clickApply())}this.singleDatePicker&&(this.setEndDate(this.startDate),this.timePicker||this.clickApply()),this.updateView(),b.stopPropagation()}},calculateChosenLabel:function(){var a=!0,b=0;
for(var c in this.ranges){if(this.timePicker){if(this.startDate.isSame(this.ranges[c][0])&&this.endDate.isSame(this.ranges[c][1])){a=!1,this.chosenLabel=this.container.find(".ranges li:eq("+b+")").addClass("active").html();break}}else if(this.startDate.format("YYYY-MM-DD")==this.ranges[c][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[c][1].format("YYYY-MM-DD")){a=!1,this.chosenLabel=this.container.find(".ranges li:eq("+b+")").addClass("active").html();break}b++}a&&(this.chosenLabel=this.showCustomRangeLabel?this.container.find(".ranges li:last").addClass("active").html():null,this.showCalendars())
},clickApply:function(){this.hide(),this.element.trigger("apply.daterangepicker",this)},clickCancel:function(){this.startDate=this.oldStartDate,this.endDate=this.oldEndDate,this.hide(),this.element.trigger("cancel.daterangepicker",this)},monthOrYearChanged:function(b){var c=a(b.target).closest(".calendar").hasClass("left"),d=c?"left":"right",e=this.container.find(".calendar."+d),f=parseInt(e.find(".monthselect").val(),10),g=e.find(".yearselect").val();c||(g<this.startDate.year()||g==this.startDate.year()&&f<this.startDate.month())&&(f=this.startDate.month(),g=this.startDate.year()),this.minDate&&(g<this.minDate.year()||g==this.minDate.year()&&f<this.minDate.month())&&(f=this.minDate.month(),g=this.minDate.year()),this.maxDate&&(g>this.maxDate.year()||g==this.maxDate.year()&&f>this.maxDate.month())&&(f=this.maxDate.month(),g=this.maxDate.year()),c?(this.leftCalendar.month.month(f).year(g),this.linkedCalendars&&(this.rightCalendar.month=this.leftCalendar.month.clone().add(1,"month"))):(this.rightCalendar.month.month(f).year(g),this.linkedCalendars&&(this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,"month"))),this.updateCalendars()
},timeChanged:function(b){var c=a(b.target).closest(".calendar"),d=c.hasClass("left"),e=parseInt(c.find(".hourselect").val(),10),f=parseInt(c.find(".minuteselect").val(),10),g=this.timePickerSeconds?parseInt(c.find(".secondselect").val(),10):0;if(!this.timePicker24Hour){var h=c.find(".ampmselect").val();"PM"===h&&12>e&&(e+=12),"AM"===h&&12===e&&(e=0)}if(d){var i=this.startDate.clone();i.hour(e),i.minute(f),i.second(g),this.setStartDate(i),this.singleDatePicker?this.endDate=this.startDate.clone():this.endDate&&this.endDate.format("YYYY-MM-DD")==i.format("YYYY-MM-DD")&&this.endDate.isBefore(i)&&this.setEndDate(i.clone())
}else if(this.endDate){var j=this.endDate.clone();j.hour(e),j.minute(f),j.second(g),this.setEndDate(j)}this.updateCalendars(),this.updateFormInputs(),this.renderTimePicker("left"),this.renderTimePicker("right")},formInputsChanged:function(c){var d=a(c.target).closest(".calendar").hasClass("right"),e=b(this.container.find('input[name="daterangepicker_start"]').val(),this.locale.format),f=b(this.container.find('input[name="daterangepicker_end"]').val(),this.locale.format);e.isValid()&&f.isValid()&&(d&&f.isBefore(e)&&(e=f.clone()),this.setStartDate(e),this.setEndDate(f),d?this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format)):this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format))),this.updateView()
},formInputsFocused:function(b){this.container.find('input[name="daterangepicker_start"], input[name="daterangepicker_end"]').removeClass("active"),a(b.target).addClass("active");var c=a(b.target).closest(".calendar").hasClass("right");c&&(this.endDate=null,this.setStartDate(this.startDate.clone()),this.updateView())},formInputsBlurred:function(){if(!this.endDate){var c=this.container.find('input[name="daterangepicker_end"]').val(),d=b(c,this.locale.format);d.isValid()&&(this.setEndDate(d),this.updateView())
}},elementChanged:function(){if(this.element.is("input")&&this.element.val().length&&!(this.element.val().length<this.locale.format.length)){var a=this.element.val().split(this.locale.separator),c=null,d=null;2===a.length&&(c=b(a[0],this.locale.format),d=b(a[1],this.locale.format)),(this.singleDatePicker||null===c||null===d)&&(c=b(this.element.val(),this.locale.format),d=c),c.isValid()&&d.isValid()&&(this.setStartDate(c),this.setEndDate(d),this.updateView())}},keydown:function(a){(9===a.keyCode||13===a.keyCode)&&this.hide()
},updateElement:function(){this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))},remove:function(){this.container.remove(),this.element.off(".daterangepicker"),this.element.removeData()}},a.fn.daterangepicker=function(b,d){return this.each(function(){var e=a(this);
e.data("daterangepicker")&&e.data("daterangepicker").remove(),e.data("daterangepicker",new c(e,b,d))}),this},c};c(),b.resolveWith(c)})};FD50.module("daterangepicker",a)}(),function(){var moduleFactory=function($){var module=this,exports=function(){var dialogHtml='<div id="eb" class="eb-dialog has-footer"><div class="eb-dialog-modal"><div class="eb-dialog-header"><div class="eb-dialog-header__grid"><div class="eb-dialog-header__cell"><span class="eb-dialog-title"></span></div><div class="eb-dialog-close-button"><i class="fa fa-close"></i></div></div></div><div class="eb-dialog-body"><div class="eb-dialog-container"><div class="eb-dialog-content"></div><div class="eb-hint hint-loading layout-overlay style-gray size-sm"><div><i class="eb-hint-icon"><span class="eb-loader-o size-lg"></span></i></div></div><div class="eb-hint hint-failed layout-overlay style-gray size-sm"><div><i class="eb-hint-icon fa fa-warning"></i><span class="eb-hint-text"><span class="eb-dialog-error-message"></span></span></div></div></div></div><div class="eb-dialog-footer"><div class=""><div class="eb-dialog-footer-content"></div></div></div></div></div>',dialog_=".eb-dialog",dialogModal_=".eb-dialog-modal",dialogContent_=".eb-dialog-content",dialogHeader_=".eb-dialog-header",dialogFooter_=".eb-dialog-footer",dialogFooterContent_=".eb-dialog-footer-content",dialogCloseButton_=".eb-dialog-close-button",dialogTitle_=".eb-dialog-title",dialogErrorMessage_=".eb-dialog-error-message",isFailed="is-failed",isLoading="is-loading",rxBraces=/\{|\}/gi,self=EasyBlog.dialog=function(a){if(void 0===a)return self;
$.isString(a)&&(a={content:a});var b=self.open;return window.parentEasyBlogDialog&&(b=window.parentEasyBlogDialog.open),b.apply(self,[a]),self};$.extend(self,{defaultOptions:{title:"",content:"",buttons:"",classname:"",width:"auto",height:"auto",escapeKey:!0},open:function(a){var b=$(dialog_);b.length<1&&(dialogHtml=$(dialogHtml),window.ezb.mobile&&dialogHtml.addClass("is-mobile"),window.ezb.ios&&dialogHtml.addClass("is-iphone"),b=dialogHtml.appendTo("body"));var a=$.extend({},self.defaultOptions,a),c=$(dialogTitle_);
c.html(a.title);var d=$(dialogFooterContent_);d.html(a.buttons),b.toggleClass("has-footer",!!a.buttons),self.setBindings(a);var e=$(dialogContent_).empty(),f=a.content,g=self.getContentType(f);b.switchClass("type-"+g);var h=$(dialogModal_),i=a.width,j=a.height;if($.isNumeric(j)){var k=$(dialogHeader_),l=$(dialogFooter_);j+=k.height()+l.height()}switch(h.css({width:i,height:j}),b.addClassAfter("active"),g){case"html":e.html(f),b.trigger("init");break;case"iframe":var m=$("<iframe>"),n=$("<div />").html(f).text();
m.appendTo(e).one("load",function(){try{m[0].contentWindow.parentEasyBlogDialog=self}catch(a){}}).attr("src",n);break;case"deferred":return b.switchClass(isLoading),f.done(function(c){$.isPlainObject(c)?self.reopen($.extend(!0,a,c)):$.isString(c)?(a.content=c,self.reopen(a)):b.switchClass(isFailed)}).fail(function(a){b.switchClass(isFailed);var c=$(dialogErrorMessage_);$.isString(a)&&c.html(a),$.isPlainObject(a)&&a.message&&c.html(a.message)}).always(function(){b.removeClass(isLoading)}),void 0;case"dialog":var o=self.parseXMLOptions(f);
return self.open($.extend(!0,a,o)),void 0}},reopen:function(a){self.close(),self.open(a)},close:function(){self.unsetBindings();var a=$(dialog_);a.remove()},getContentType:function(a){return/<dialog>(.*?)/.test(a)?"dialog":$.isUrl(a)?"iframe":$.isDeferred(a)?"deferred":"html"},parseXMLOptions:function(xml){var xmlOptions=$.buildHTML(xml),newOptions={};return $.each(xmlOptions.children(),function(i,node){var node=$(node),key=$.String.camelize(this.nodeName.toLowerCase()),val=node.html(),type=node.attr("type");
switch(type){case"json":try{val=$.parseJSON(val)}catch(e){}break;case"javascript":try{val=eval("(function($){ return "+$.trim(val)+" })("+$.globalNamespace+")")}catch(e){}break;case"text":val=node.text()}$.isNumeric(val)&&(val=parseFloat(val)),newOptions[key]=val}),newOptions},bindings:{},setBindings:function(a){self.unsetBindings();var b=a.selectors,c=a.bindings;if(b&&c){var d={parent:self},e=$(dialog_);$.each(b,function(a,b){var a=a.replace(rxBraces,""),c=d[a]=function(){return e.find(b)};c.selector=b}),$.each(c,function(a,b){var c=a.split(" "),f=c[0].replace(rxBraces,""),g=c[1]+".eb.dialog",h=d[f];
if("init"==f&&e.on(f,function(){var a=[this].concat(arguments);b.apply(d,a)}),h){var i=h.selector;e.on(g,i,function(){b.apply(d,[this].concat(arguments))}),self.bindings[g]=b}})}a.escapeKey&&$(document).on("keydown.eb.dialog",function(a){27==a.keyCode&&self.close()})},unsetBindings:function(){var a=$(dialog_);$.each(self.bindings,function(b){a.off(b)}),$(document).off("keydown.eb.dialog")}}),$(document).on("click",dialogCloseButton_,function(){self.close()}).on("click",dialog_,function(a){var b=$(dialog_);a.target==b[0]&&self.close()
})};exports(),module.resolveWith(exports)};FD50.module("dialog",moduleFactory)}(),function(){var a=function(a){var b=this,c=function(){a.fn.image=function(b){var b=a.Image[b];return b&&b.apply(this[0],a.makeArray(arguments).slice(1))},a.Image={get:function(b){var c="IMG"===this.nodeName,d=a(c?this:new Image),e=a.Deferred();return d.on("load",function(){var a,b,f,g;c||d.appendTo("body");var h={width:a=d.width(),height:b=d.height(),aspectRatio:f=a/b,orientation:g=1===f?"square":1>f?"tall":"wide"};d.css({position:"absolute",left:"-99999px"}).data(h).addClass("orientation-"+g).removeAttr("style"),c||d.detach(),e.resolve(d,h)
}).on("error",function(){e.reject()}).attr("src",b),e},aspectRatio:function(b,c){return a.isPlainObject(b)&&(b=b.width,c=b.height),b/c},orientation:function(b,c){return a.isPlainObject(b)&&(b=b.width,c=b.height),b===c?"square":b>c?"wide":"tall"},resizeProportionate:function(a,b,c,d,e){var f=a,g=b,h=c/a;f=a*h,g=b*h;var i=g>d;return"outer"==e&&(i=d>g),i&&(h=d/b,f=a*h,g=b*h),{top:(d-g)/2,left:(c-f)/2,width:f,height:g}},resizeWithin:function(b,c,d,e){return a.Image.resizeProportionate(b,c,d,e,"inner")},resizeToFill:function(b,c,d,e){return a.Image.resizeProportionate(b,c,d,e,"outer")
}}};c(),b.resolveWith(c)};FD50.module("image",a)}(),function(){var a=function(a){var b=this,c=function(){var b="[data-eb-label] > input[type=text], [data-eb-label] > input[type=password]";a(document).on("focus.eb.label change.eb.label",b,function(){var b=a(this),c=b.parent();c.addClass("is-focused")}),a(document).on("blur.eb.label",b,function(){var b=a(this),c=b.parent(),d=b.val();""===a.trim(d)&&c.removeClass("is-focused")})};c(),b.resolveWith(c)};FD50.module("label",a)}(),function(){var a=function(a){var b=this,d=function(){!function(a,c){"object"==typeof d&&"undefined"!=typeof b?c(d):"function"==typeof define&&define.amd?define(["exports"],c):c(a.L={})
}(this,function(a){"use strict";function d(a){var b,c,d,e;for(c=1,d=arguments.length;d>c;c++){e=arguments[c];for(b in e)a[b]=e[b]}return a}function f(a,b){var c=Array.prototype.slice;if(a.bind)return a.bind.apply(a,c.call(arguments,1));var d=c.call(arguments,2);return function(){return a.apply(b,d.length?d.concat(c.call(arguments)):arguments)}}function h(a){return a._leaflet_id=a._leaflet_id||++g,a._leaflet_id}function i(a,b,c){var d,e,f,g;return g=function(){d=!1,e&&(f.apply(c,e),e=!1)},f=function(){d?e=arguments:(a.apply(c,arguments),setTimeout(g,b),d=!0)
}}function j(a,b,c){var d=b[1],e=b[0],f=d-e;return a===d&&c?a:((a-e)%f+f)%f+e}function k(){return!1}function l(a,b){var c=Math.pow(10,void 0===b?6:b);return Math.round(a*c)/c}function m(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function n(a){return m(a).split(/\s+/)}function o(a,b){a.hasOwnProperty("options")||(a.options=a.options?e(a.options):{});for(var c in b)a.options[c]=b[c];return a.options}function p(a,b,c){var d=[];for(var e in a)d.push(encodeURIComponent(c?e.toUpperCase():e)+"="+encodeURIComponent(a[e]));
return(b&&-1!==b.indexOf("?")?"&":"?")+d.join("&")}function r(a,b){return a.replace(q,function(a,c){var d=b[c];if(void 0===d)throw new Error("No value provided for variable "+a);return"function"==typeof d&&(d=d(b)),d})}function t(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}function v(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}function x(a){var b=+new Date,c=Math.max(0,16-(b-w));return w=b+c,window.setTimeout(a,c)}function A(a,b,c){return c&&y===x?(a.call(b),void 0):y.call(window,f(a,b))
}function B(a){a&&z.call(window,a)}function D(){}function E(a){if("undefined"!=typeof L&&L&&L.Mixin){a=s(a)?a:[a];for(var b=0;b<a.length;b++)a[b]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}function H(a,b,c){this.x=c?Math.round(a):a,this.y=c?Math.round(b):b}function J(a,b,c){return a instanceof H?a:s(a)?new H(a[0],a[1]):void 0===a||null===a?a:"object"==typeof a&&"x"in a&&"y"in a?new H(a.x,a.y):new H(a,b,c)
}function K(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;e>d;d++)this.extend(c[d])}function M(a,b){return!a||a instanceof K?a:new K(a,b)}function N(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;e>d;d++)this.extend(c[d])}function O(a,b){return a instanceof N?a:new N(a,b)}function P(a,b,c){if(isNaN(a)||isNaN(b))throw new Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=+a,this.lng=+b,void 0!==c&&(this.alt=+c)}function Q(a,b,c){return a instanceof P?a:s(a)&&"object"!=typeof a[0]?3===a.length?new P(a[0],a[1],a[2]):2===a.length?new P(a[0],a[1]):null:void 0===a||null===a?a:"object"==typeof a&&"lat"in a?new P(a.lat,"lng"in a?a.lng:a.lon,a.alt):void 0===b?null:new P(a,b,c)
}function V(a,b,c,d){return s(a)?(this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3],void 0):(this._a=a,this._b=b,this._c=c,this._d=d,void 0)}function W(a,b,c,d){return new V(a,b,c,d)}function Z(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function $(a,b){var d,e,f,g,h,i,c="";for(d=0,f=a.length;f>d;d++){for(h=a[d],e=0,g=h.length;g>e;e++)i=h[e],c+=(e?"L":"M")+i.x+" "+i.y;c+=b?Eb?"z":"x":""}return c||"M0 0"}function Gb(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}function Qb(a,b,c,d){return"touchstart"===b?Sb(a,c,d):"touchmove"===b?Xb(a,c,d):"touchend"===b&&Yb(a,c,d),this
}function Rb(a,b,c){var d=a["_leaflet_"+b+c];return"touchstart"===b?a.removeEventListener(Ib,d,!1):"touchmove"===b?a.removeEventListener(Jb,d,!1):"touchend"===b&&(a.removeEventListener(Kb,d,!1),a.removeEventListener(Lb,d,!1)),this}function Sb(a,b,c){var d=f(function(a){if("mouse"!==a.pointerType&&a.MSPOINTER_TYPE_MOUSE&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE){if(!(Mb.indexOf(a.target.tagName)<0))return;Sc(a)}Wb(a,b)});a["_leaflet_touchstart"+c]=d,a.addEventListener(Ib,d,!1),Ob||(document.documentElement.addEventListener(Ib,Tb,!0),document.documentElement.addEventListener(Jb,Ub,!0),document.documentElement.addEventListener(Kb,Vb,!0),document.documentElement.addEventListener(Lb,Vb,!0),Ob=!0)
}function Tb(a){Nb[a.pointerId]=a,Pb++}function Ub(a){Nb[a.pointerId]&&(Nb[a.pointerId]=a)}function Vb(a){delete Nb[a.pointerId],Pb--}function Wb(a,b){a.touches=[];for(var c in Nb)a.touches.push(Nb[c]);a.changedTouches=[a],b(a)}function Xb(a,b,c){var d=function(a){(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons)&&Wb(a,b)};a["_leaflet_touchmove"+c]=d,a.addEventListener(Jb,d,!1)}function Yb(a,b,c){var d=function(a){Wb(a,b)};a["_leaflet_touchend"+c]=d,a.addEventListener(Kb,d,!1),a.addEventListener(Lb,d,!1)
}function ac(a,b,c){function h(a){var b;if(xb){if(!cb||"mouse"===a.pointerType)return;b=Pb}else b=a.touches.length;if(!(b>1)){var c=Date.now(),h=c-(d||c);e=a.touches?a.touches[0]:a,f=h>0&&g>=h,d=c}}function i(a){if(f&&!e.cancelBubble){if(xb){if(!cb||"mouse"===a.pointerType)return;var g,h,c={};for(h in e)g=e[h],c[h]=g&&g.bind?g.bind(e):g;e=c}e.type="dblclick",e.button=0,b(e),d=null}}var d,e,f=!1,g=250;return a[_b+Zb+c]=h,a[_b+$b+c]=i,a[_b+"dblclick"+c]=b,a.addEventListener(Zb,h,Cb?{passive:!1}:!1),a.addEventListener($b,i,Cb?{passive:!1}:!1),a.addEventListener("dblclick",b,!1),this
}function bc(a,b){var c=a[_b+Zb+b],d=a[_b+$b+b],e=a[_b+"dblclick"+b];return a.removeEventListener(Zb,c,Cb?{passive:!1}:!1),a.removeEventListener($b,d,Cb?{passive:!1}:!1),cb||a.removeEventListener("dblclick",e,!1),this}function fc(a){return"string"==typeof a?document.getElementById(a):a}function gc(a,b){var c=a.style[b]||a.currentStyle&&a.currentStyle[b];if((!c||"auto"===c)&&document.defaultView){var d=document.defaultView.getComputedStyle(a,null);c=d?d[b]:null}return"auto"===c?null:c}function hc(a,b,c){var d=document.createElement(a);
return d.className=b||"",c&&c.appendChild(d),d}function ic(a){var b=a.parentNode;b&&b.removeChild(a)}function jc(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function kc(a){var b=a.parentNode;b&&b.lastChild!==a&&b.appendChild(a)}function lc(a){var b=a.parentNode;b&&b.firstChild!==a&&b.insertBefore(a,b.firstChild)}function mc(a,b){if(void 0!==a.classList)return a.classList.contains(b);var c=qc(a);return c.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(c)}function nc(a,b){if(void 0!==a.classList)for(var c=n(b),d=0,e=c.length;e>d;d++)a.classList.add(c[d]);
else if(!mc(a,b)){var f=qc(a);pc(a,(f?f+" ":"")+b)}}function oc(a,b){void 0!==a.classList?a.classList.remove(b):pc(a,m((" "+qc(a)+" ").replace(" "+b+" "," ")))}function pc(a,b){void 0===a.className.baseVal?a.className=b:a.className.baseVal=b}function qc(a){return a.correspondingElement&&(a=a.correspondingElement),void 0===a.className.baseVal?a.className:a.className.baseVal}function rc(a,b){"opacity"in a.style?a.style.opacity=b:"filter"in a.style&&sc(a,b)}function sc(a,b){var c=!1,d="DXImageTransform.Microsoft.Alpha";
try{c=a.filters.item(d)}catch(e){if(1===b)return}b=Math.round(100*b),c?(c.Enabled=100!==b,c.Opacity=b):a.style.filter+=" progid:"+d+"(opacity="+b+")"}function tc(a){for(var b=document.documentElement.style,c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1}function uc(a,b,c){var d=b||new H(0,0);a.style[cc]=(pb?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(c?" scale("+c+")":"")}function vc(a,b){a._leaflet_pos=b,sb?uc(a,b):(a.style.left=b.x+"px",a.style.top=b.y+"px")}function wc(a){return a._leaflet_pos||new H(0,0)
}function Bc(){Kc(window,"dragstart",Sc)}function Cc(){Mc(window,"dragstart",Sc)}function Fc(a){for(;-1===a.tabIndex;)a=a.parentNode;a.style&&(Gc(),Dc=a,Ec=a.style.outline,a.style.outline="none",Kc(window,"keydown",Gc))}function Gc(){Dc&&(Dc.style.outline=Ec,Dc=void 0,Ec=void 0,Mc(window,"keydown",Gc))}function Hc(a){do a=a.parentNode;while(!(a.offsetWidth&&a.offsetHeight||a===document.body));return a}function Ic(a){var b=a.getBoundingClientRect();return{x:b.width/a.offsetWidth||1,y:b.height/a.offsetHeight||1,boundingClientRect:b}
}function Kc(a,b,c,d){if("object"==typeof b)for(var e in b)Nc(a,e,b[e],c);else{b=n(b);for(var f=0,g=b.length;g>f;f++)Nc(a,b[f],c,d)}return this}function Mc(a,b,c,d){if("object"==typeof b)for(var e in b)Oc(a,e,b[e],c);else if(b){b=n(b);for(var f=0,g=b.length;g>f;f++)Oc(a,b[f],c,d)}else{for(var h in a[Lc])Oc(a,h,a[Lc][h]);delete a[Lc]}return this}function Nc(a,b,c,d){var e=b+h(c)+(d?"_"+h(d):"");if(a[Lc]&&a[Lc][e])return this;var f=function(b){return c.call(d||a,b||window.event)},g=f;xb&&0===b.indexOf("touch")?Qb(a,b,f,e):!yb||"dblclick"!==b||!ac||xb&&jb?"addEventListener"in a?"mousewheel"===b?a.addEventListener("onwheel"in a?"wheel":"mousewheel",f,Cb?{passive:!1}:!1):"mouseenter"===b||"mouseleave"===b?(f=function(b){b=b||window.event,$c(a,b)&&g(b)
},a.addEventListener("mouseenter"===b?"mouseover":"mouseout",f,!1)):("click"===b&&eb&&(f=function(a){ad(a,g)}),a.addEventListener(b,f,!1)):"attachEvent"in a&&a.attachEvent("on"+b,f):ac(a,f,e),a[Lc]=a[Lc]||{},a[Lc][e]=f}function Oc(a,b,c,d){var e=b+h(c)+(d?"_"+h(d):""),f=a[Lc]&&a[Lc][e];return f?(xb&&0===b.indexOf("touch")?Rb(a,b,e):!yb||"dblclick"!==b||!bc||xb&&jb?"removeEventListener"in a?"mousewheel"===b?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",f,Cb?{passive:!1}:!1):a.removeEventListener("mouseenter"===b?"mouseover":"mouseleave"===b?"mouseout":b,f,!1):"detachEvent"in a&&a.detachEvent("on"+b,f):bc(a,e),a[Lc][e]=null,void 0):this
}function Pc(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,Zc(a),this}function Qc(a){return Nc(a,"mousewheel",Pc),this}function Rc(a){return Kc(a,"mousedown touchstart dblclick",Pc),Nc(a,"click",Yc),this}function Sc(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function Tc(a){return Sc(a),Pc(a),this}function Uc(a,b){if(!b)return new H(a.clientX,a.clientY);var c=Ic(b),d=c.boundingClientRect;return new H((a.clientX-d.left)/c.x-b.clientLeft,(a.clientY-d.top)/c.y-b.clientTop)
}function Wc(a){return cb?a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/Vc:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?20*-a.detail:a.detail?a.detail/-32765*60:0}function Yc(a){Xc[a.type]=!0}function Zc(a){var b=Xc[a.type];return Xc[a.type]=!1,b}function $c(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(d){return!1}return c!==a}function ad(a,b){var c=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,d=_c&&c-_c;
return d&&d>100&&500>d||a.target._simulatedClick&&!a._simulated?(Tc(a),void 0):(_c=c,b(a),void 0)}function ed(a,b){return new dd(a,b)}function vd(a,b){if(!b||!a.length)return a.slice();var c=b*b;return a=Ad(a,c),a=yd(a,c)}function wd(a,b,c){return Math.sqrt(Gd(a,b,c,!0))}function xd(a,b,c){return Gd(a,b,c)}function yd(a,b){var c=a.length,d=typeof Uint8Array!=void 0+""?Uint8Array:Array,e=new d(c);e[0]=e[c-1]=1,zd(a,e,b,0,c-1);var f,g=[];for(f=0;c>f;f++)e[f]&&g.push(a[f]);return g}function zd(a,b,c,d,e){var g,h,i,f=0;
for(h=d+1;e-1>=h;h++)i=Gd(a[h],a[d],a[e],!0),i>f&&(g=h,f=i);f>c&&(b[g]=1,zd(a,b,c,d,g),zd(a,b,c,g,e))}function Ad(a,b){for(var c=[a[0]],d=1,e=0,f=a.length;f>d;d++)Fd(a[d],a[e])>b&&(c.push(a[d]),e=d);return f-1>e&&c.push(a[f-1]),c}function Cd(a,b,c,d,e){var h,i,j,f=d?Bd:Ed(a,c),g=Ed(b,c);for(Bd=g;;){if(!(f|g))return[a,b];if(f&g)return!1;h=f||g,i=Dd(a,b,h,c,e),j=Ed(i,c),h===f?(a=i,f=j):(b=i,g=j)}}function Dd(a,b,c,d,e){var j,k,f=b.x-a.x,g=b.y-a.y,h=d.min,i=d.max;return 8&c?(j=a.x+f*(i.y-a.y)/g,k=i.y):4&c?(j=a.x+f*(h.y-a.y)/g,k=h.y):2&c?(j=i.x,k=a.y+g*(i.x-a.x)/f):1&c&&(j=h.x,k=a.y+g*(h.x-a.x)/f),new H(j,k,e)
}function Ed(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c}function Fd(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d}function Gd(a,b,c,d){var j,e=b.x,f=b.y,g=c.x-e,h=c.y-f,i=g*g+h*h;return i>0&&(j=((a.x-e)*g+(a.y-f)*h)/i,j>1?(e=c.x,f=c.y):j>0&&(e+=g*j,f+=h*j)),g=a.x-e,h=a.y-f,d?g*g+h*h:new H(e,f)}function Hd(a){return!s(a[0])||"object"!=typeof a[0][0]&&"undefined"!=typeof a[0][0]}function Id(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Hd(a)
}function Kd(a,b,c){var d,f,g,h,i,j,k,l,m,e=[1,4,2,8];for(f=0,k=a.length;k>f;f++)a[f]._code=Ed(a[f],b);for(h=0;4>h;h++){for(l=e[h],d=[],f=0,k=a.length,g=k-1;k>f;g=f++)i=a[f],j=a[g],i._code&l?j._code&l||(m=Dd(j,i,l,b,c),m._code=Ed(m,b),d.push(m)):(j._code&l&&(m=Dd(j,i,l,b,c),m._code=Ed(m,b),d.push(m)),d.push(i));a=d}return a}function Yd(a){return new Xd(a)}function ae(a,b){return new _d(a,b)}function de(a,b){return new ce(a,b)}function fe(a,b,c){return new ee(a,b,c)}function he(a,b){return new ge(a,b)}function je(a,b){return new ie(a,b)
}function le(a,b){var h,i,j,k,c="Feature"===a.type?a.geometry:a,d=c?c.coordinates:null,e=[],f=b&&b.pointToLayer,g=b&&b.coordsToLatLng||ne;if(!d&&!c)return null;switch(c.type){case"Point":return h=g(d),me(f,a,h,b);case"MultiPoint":for(j=0,k=d.length;k>j;j++)h=g(d[j]),e.push(me(f,a,h,b));return new Vd(e);case"LineString":case"MultiLineString":return i=oe(d,"LineString"===c.type?0:1,g),new ge(i,b);case"Polygon":case"MultiPolygon":return i=oe(d,"Polygon"===c.type?1:2,g),new ie(i,b);case"GeometryCollection":for(j=0,k=c.geometries.length;k>j;j++){var l=le({geometry:c.geometries[j],type:"Feature",properties:a.properties},b);
l&&e.push(l)}return new Vd(e);default:throw new Error("Invalid GeoJSON object.")}}function me(a,b,c,d){return a?a(b,c):new _d(c,d&&d.markersInheritOptions&&d)}function ne(a){return new P(a[1],a[0],a[2])}function oe(a,b,c){for(var g,d=[],e=0,f=a.length;f>e;e++)g=b?oe(a[e],b-1,c):(c||ne)(a[e]),d.push(g);return d}function pe(a,b){return b="number"==typeof b?b:6,void 0!==a.alt?[l(a.lng,b),l(a.lat,b),l(a.alt,b)]:[l(a.lng,b),l(a.lat,b)]}function qe(a,b,c,d){for(var e=[],f=0,g=a.length;g>f;f++)e.push(b?qe(a[f],b-1,c,d):pe(a[f],d));
return!b&&c&&e.push(e[0]),e}function re(a,b){return a.feature?d({},a.feature,{geometry:b}):se(b)}function se(a){return"Feature"===a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}function ue(a,b){return new ke(a,b)}function ze(a,b,c){return new ye(a,b,c)}function Be(a,b,c){return new Ae(a,b,c)}function Ie(a){return new He(a)}function Ke(a){return new Je(a)}function Me(a,b){return new Le(a,b)}function Oe(a,b){return new Ne(a,b)}function Re(a){return Db?new Qe(a):null}function We(a){return Eb||Fb?new Ve(a):null
}function Ye(a,b){return new Xe(a,b)}var b="1.6.0+HEAD.0c81bdf",c=Object.freeze;Object.freeze=function(a){return a};var e=Object.create||function(){function a(){}return function(b){return a.prototype=b,new a}}(),g=0,q=/\{ *([\w_-]+) *\}/g,s=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},u="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",w=0,y=window.requestAnimationFrame||v("RequestAnimationFrame")||x,z=window.cancelAnimationFrame||v("CancelAnimationFrame")||v("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)
},C=(Object.freeze||Object)({freeze:c,extend:d,create:e,bind:f,lastId:g,stamp:h,throttle:i,wrapNum:j,falseFn:k,formatNum:l,trim:m,splitWords:n,setOptions:o,getParamString:p,template:r,isArray:s,indexOf:t,emptyImageUrl:u,requestFn:y,cancelFn:z,requestAnimFrame:A,cancelAnimFrame:B});D.extend=function(a){var b=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},c=b.__super__=this.prototype,f=e(c);f.constructor=b,b.prototype=f;for(var g in this)this.hasOwnProperty(g)&&"prototype"!==g&&"__super__"!==g&&(b[g]=this[g]);
return a.statics&&(d(b,a.statics),delete a.statics),a.includes&&(E(a.includes),d.apply(null,[f].concat(a.includes)),delete a.includes),f.options&&(a.options=d(e(f.options),a.options)),d(f,a),f._initHooks=[],f.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var a=0,b=f._initHooks.length;b>a;a++)f._initHooks[a].call(this)}},b},D.include=function(a){return d(this.prototype,a),this},D.mergeOptions=function(a){return d(this.prototype.options,a),this
},D.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1),c="function"==typeof a?a:function(){this[a].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this};var F={on:function(a,b,c){if("object"==typeof a)for(var d in a)this._on(d,a[d],b);else{a=n(a);for(var e=0,f=a.length;f>e;e++)this._on(a[e],b,c)}return this},off:function(a,b,c){if(a)if("object"==typeof a)for(var d in a)this._off(d,a[d],b);else{a=n(a);for(var e=0,f=a.length;f>e;e++)this._off(a[e],b,c)
}else delete this._events;return this},_on:function(a,b,c){this._events=this._events||{};var d=this._events[a];d||(d=[],this._events[a]=d),c===this&&(c=void 0);for(var e={fn:b,ctx:c},f=d,g=0,h=f.length;h>g;g++)if(f[g].fn===b&&f[g].ctx===c)return;f.push(e)},_off:function(a,b,c){var d,e,f;if(this._events&&(d=this._events[a])){if(!b){for(e=0,f=d.length;f>e;e++)d[e].fn=k;return delete this._events[a],void 0}if(c===this&&(c=void 0),d)for(e=0,f=d.length;f>e;e++){var g=d[e];if(g.ctx===c&&g.fn===b)return g.fn=k,this._firingCount&&(this._events[a]=d=d.slice()),d.splice(e,1),void 0
}}},fire:function(a,b,c){if(!this.listens(a,c))return this;var e=d({},b,{type:a,target:this,sourceTarget:b&&b.sourceTarget||this});if(this._events){var f=this._events[a];if(f){this._firingCount=this._firingCount+1||1;for(var g=0,h=f.length;h>g;g++){var i=f[g];i.fn.call(i.ctx||this,e)}this._firingCount--}}return c&&this._propagateEvent(e),this},listens:function(a,b){var c=this._events&&this._events[a];if(c&&c.length)return!0;if(b)for(var d in this._eventParents)if(this._eventParents[d].listens(a,b))return!0;return!1
},once:function(a,b,c){if("object"==typeof a){for(var d in a)this.once(d,a[d],b);return this}var e=f(function(){this.off(a,b,c).off(a,e,c)},this);return this.on(a,b,c).on(a,e,c)},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[h(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[h(a)],this},_propagateEvent:function(a){for(var b in this._eventParents)this._eventParents[b].fire(a.type,d({layer:a.target,propagatedFrom:a.target},a),!0)
}};F.addEventListener=F.on,F.removeEventListener=F.clearAllEventListeners=F.off,F.addOneTimeEventListener=F.once,F.fireEvent=F.fire,F.hasEventListeners=F.listens;var G=D.extend(F),I=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};H.prototype={clone:function(){return new H(this.x,this.y)},add:function(a){return this.clone()._add(J(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(J(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this
},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new H(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new H(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()
},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=I(this.x),this.y=I(this.y),this},distanceTo:function(a){a=J(a);var b=a.x-this.x,c=a.y-this.y;return Math.sqrt(b*b+c*c)},equals:function(a){return a=J(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=J(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)
},toString:function(){return"Point("+l(this.x)+", "+l(this.y)+")"}},K.prototype={extend:function(a){return a=J(a),this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone()),this},getCenter:function(a){return new H((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new H(this.min.x,this.max.y)},getTopRight:function(){return new H(this.max.x,this.min.y)
},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var b,c;return a="number"==typeof a[0]||a instanceof H?J(a):M(a),a instanceof K?(b=a.min,c=a.max):b=c=a,b.x>=this.min.x&&c.x<=this.max.x&&b.y>=this.min.y&&c.y<=this.max.y},intersects:function(a){a=M(a);var b=this.min,c=this.max,d=a.min,e=a.max,f=e.x>=b.x&&d.x<=c.x,g=e.y>=b.y&&d.y<=c.y;return f&&g},overlaps:function(a){a=M(a);var b=this.min,c=this.max,d=a.min,e=a.max,f=e.x>b.x&&d.x<c.x,g=e.y>b.y&&d.y<c.y;
return f&&g},isValid:function(){return!(!this.min||!this.max)}},N.prototype={extend:function(a){var d,e,b=this._southWest,c=this._northEast;if(a instanceof P)d=a,e=a;else{if(!(a instanceof N))return a?this.extend(Q(a)||O(a)):this;if(d=a._southWest,e=a._northEast,!d||!e)return this}return b||c?(b.lat=Math.min(d.lat,b.lat),b.lng=Math.min(d.lng,b.lng),c.lat=Math.max(e.lat,c.lat),c.lng=Math.max(e.lng,c.lng)):(this._southWest=new P(d.lat,d.lng),this._northEast=new P(e.lat,e.lng)),this},pad:function(a){var b=this._southWest,c=this._northEast,d=Math.abs(b.lat-c.lat)*a,e=Math.abs(b.lng-c.lng)*a;
return new N(new P(b.lat-d,b.lng-e),new P(c.lat+d,c.lng+e))},getCenter:function(){return new P((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new P(this.getNorth(),this.getWest())},getSouthEast:function(){return new P(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat
},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"==typeof a[0]||a instanceof P||"lat"in a?Q(a):O(a);var d,e,b=this._southWest,c=this._northEast;return a instanceof N?(d=a.getSouthWest(),e=a.getNorthEast()):d=e=a,d.lat>=b.lat&&e.lat<=c.lat&&d.lng>=b.lng&&e.lng<=c.lng},intersects:function(a){a=O(a);var b=this._southWest,c=this._northEast,d=a.getSouthWest(),e=a.getNorthEast(),f=e.lat>=b.lat&&d.lat<=c.lat,g=e.lng>=b.lng&&d.lng<=c.lng;
return f&&g},overlaps:function(a){a=O(a);var b=this._southWest,c=this._northEast,d=a.getSouthWest(),e=a.getNorthEast(),f=e.lat>b.lat&&d.lat<c.lat,g=e.lng>b.lng&&d.lng<c.lng;return f&&g},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,b){return a?(a=O(a),this._southWest.equals(a.getSouthWest(),b)&&this._northEast.equals(a.getNorthEast(),b)):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},P.prototype={equals:function(a,b){if(!a)return!1;
a=Q(a);var c=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return(void 0===b?1e-9:b)>=c},toString:function(a){return"LatLng("+l(this.lat,a)+", "+l(this.lng,a)+")"},distanceTo:function(a){return S.distance(this,Q(a))},wrap:function(){return S.wrapLatLng(this)},toBounds:function(a){var b=180*a/40075017,c=b/Math.cos(Math.PI/180*this.lat);return O([this.lat-b,this.lng-c],[this.lat+b,this.lng+c])},clone:function(){return new P(this.lat,this.lng,this.alt)}};var R={latLngToPoint:function(a,b){var c=this.projection.project(a),d=this.scale(b);
return this.transformation._transform(c,d)},pointToLatLng:function(a,b){var c=this.scale(b),d=this.transformation.untransform(a,c);return this.projection.unproject(d)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var b=this.projection.bounds,c=this.scale(a),d=this.transformation.transform(b.min,c),e=this.transformation.transform(b.max,c);
return new K(d,e)},infinite:!1,wrapLatLng:function(a){var b=this.wrapLng?j(a.lng,this.wrapLng,!0):a.lng,c=this.wrapLat?j(a.lat,this.wrapLat,!0):a.lat,d=a.alt;return new P(c,b,d)},wrapLatLngBounds:function(a){var b=a.getCenter(),c=this.wrapLatLng(b),d=b.lat-c.lat,e=b.lng-c.lng;if(0===d&&0===e)return a;var f=a.getSouthWest(),g=a.getNorthEast(),h=new P(f.lat-d,f.lng-e),i=new P(g.lat-d,g.lng-e);return new N(h,i)}},S=d({},R,{wrapLng:[-180,180],R:6371e3,distance:function(a,b){var c=Math.PI/180,d=a.lat*c,e=b.lat*c,f=Math.sin((b.lat-a.lat)*c/2),g=Math.sin((b.lng-a.lng)*c/2),h=f*f+Math.cos(d)*Math.cos(e)*g*g,i=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h));
return this.R*i}}),T=6378137,U={R:T,MAX_LATITUDE:85.0511287798,project:function(a){var b=Math.PI/180,c=this.MAX_LATITUDE,d=Math.max(Math.min(c,a.lat),-c),e=Math.sin(d*b);return new H(this.R*a.lng*b,this.R*Math.log((1+e)/(1-e))/2)},unproject:function(a){var b=180/Math.PI;return new P((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*b,a.x*b/this.R)},bounds:function(){var a=T*Math.PI;return new K([-a,-a],[a,a])}()};V.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a
},untransform:function(a,b){return b=b||1,new H((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}};var xc,yc,zc,X=d({},S,{code:"EPSG:3857",projection:U,transformation:function(){var a=.5/(Math.PI*U.R);return W(a,.5,-a,.5)}()}),Y=d({},X,{code:"EPSG:900913"}),_=document.documentElement.style,ab="ActiveXObject"in window,bb=ab&&!document.addEventListener,cb="msLaunchUri"in navigator&&!("documentMode"in document),db=Gb("webkit"),eb=Gb("android"),fb=Gb("android 2")||Gb("android 3"),gb=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),hb=eb&&Gb("Google")&&537>gb&&!("AudioNode"in window),ib=!!window.opera,jb=Gb("chrome"),kb=Gb("gecko")&&!db&&!ib&&!ab,lb=!jb&&Gb("safari"),mb=Gb("phantom"),nb="OTransition"in _,ob=0===navigator.platform.indexOf("Win"),pb=ab&&"transition"in _,qb="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!fb,rb="MozPerspective"in _,sb=!window.L_DISABLE_3D&&(pb||qb||rb)&&!nb&&!mb,tb="undefined"!=typeof orientation||Gb("mobile"),ub=tb&&db,vb=tb&&qb,wb=!window.PointerEvent&&window.MSPointerEvent,xb=!(db||!window.PointerEvent&&!wb),yb=!window.L_NO_TOUCH&&(xb||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),zb=tb&&ib,Ab=tb&&kb,Bb=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Cb=function(){var a=!1;
try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",k,b),window.removeEventListener("testPassiveEventSupport",k,b)}catch(c){}return a},Db=function(){return!!document.createElement("canvas").getContext}(),Eb=!(!document.createElementNS||!Z("svg").createSVGRect),Fb=!Eb&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var b=a.firstChild;return b.style.behavior="url(#default#VML)",b&&"object"==typeof b.adj}catch(c){return!1
}}(),Hb=(Object.freeze||Object)({ie:ab,ielt9:bb,edge:cb,webkit:db,android:eb,android23:fb,androidStock:hb,opera:ib,chrome:jb,gecko:kb,safari:lb,phantom:mb,opera12:nb,win:ob,ie3d:pb,webkit3d:qb,gecko3d:rb,any3d:sb,mobile:tb,mobileWebkit:ub,mobileWebkit3d:vb,msPointer:wb,pointer:xb,touch:yb,mobileOpera:zb,mobileGecko:Ab,retina:Bb,passiveEvents:Cb,canvas:Db,svg:Eb,vml:Fb}),Ib=wb?"MSPointerDown":"pointerdown",Jb=wb?"MSPointerMove":"pointermove",Kb=wb?"MSPointerUp":"pointerup",Lb=wb?"MSPointerCancel":"pointercancel",Mb=["INPUT","SELECT","OPTION"],Nb={},Ob=!1,Pb=0,Zb=wb?"MSPointerDown":xb?"pointerdown":"touchstart",$b=wb?"MSPointerUp":xb?"pointerup":"touchend",_b="_leaflet_",cc=tc(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),dc=tc(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ec="webkitTransition"===dc||"OTransition"===dc?dc+"End":"transitionend";
if("onselectstart"in document)xc=function(){Kc(window,"selectstart",Sc)},yc=function(){Mc(window,"selectstart",Sc)};else{var Ac=tc(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);xc=function(){if(Ac){var a=document.documentElement.style;zc=a[Ac],a[Ac]="none"}},yc=function(){Ac&&(document.documentElement.style[Ac]=zc,zc=void 0)}}var Dc,Ec,_c,Jc=(Object.freeze||Object)({TRANSFORM:cc,TRANSITION:dc,TRANSITION_END:ec,get:fc,getStyle:gc,create:hc,remove:ic,empty:jc,toFront:kc,toBack:lc,hasClass:mc,addClass:nc,removeClass:oc,setClass:pc,getClass:qc,setOpacity:rc,testProp:tc,setTransform:uc,setPosition:vc,getPosition:wc,disableTextSelection:xc,enableTextSelection:yc,disableImageDrag:Bc,enableImageDrag:Cc,preventOutline:Fc,restoreOutline:Gc,getSizedParentNode:Hc,getScale:Ic}),Lc="_leaflet_events",Vc=ob&&jb?2*window.devicePixelRatio:kb?window.devicePixelRatio:1,Xc={},bd=(Object.freeze||Object)({on:Kc,off:Mc,stopPropagation:Pc,disableScrollPropagation:Qc,disableClickPropagation:Rc,preventDefault:Sc,stop:Tc,getMousePosition:Uc,getWheelDelta:Wc,fakeStop:Yc,skipped:Zc,isExternalTarget:$c,addListener:Kc,removeListener:Mc}),cd=G.extend({run:function(a,b,c,d){this.stop(),this._el=a,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(d||.5,.2),this._startPos=wc(a),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()
},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=A(this._animate,this),this._step()},_step:function(a){var b=+new Date-this._startTime,c=1e3*this._duration;c>b?this._runFrame(this._easeOut(b/c),a):(this._runFrame(1),this._complete())},_runFrame:function(a,b){var c=this._startPos.add(this._offset.multiplyBy(a));b&&c._round(),vc(this._el,c),this.fire("step")},_complete:function(){B(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)
}}),dd=G.extend({options:{crs:X,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,b){b=o(this,b),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=f(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),void 0!==b.zoom&&(this._zoom=this._limitZoom(b.zoom)),b.center&&void 0!==b.zoom&&this.setView(Q(b.center),b.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=dc&&sb&&!zb&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Kc(this._proxy,ec,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)
},setView:function(a,b,c){if(b=void 0===b?this._zoom:this._limitZoom(b),a=this._limitCenter(Q(a),b,this.options.maxBounds),c=c||{},this._stop(),this._loaded&&!c.reset&&c!==!0){void 0!==c.animate&&(c.zoom=d({animate:c.animate},c.zoom),c.pan=d({animate:c.animate,duration:c.duration},c.pan));var e=this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,b,c.zoom):this._tryAnimatedPan(a,c.pan);if(e)return clearTimeout(this._sizeTimer),this}return this._resetView(a,b),this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=a,this)
},zoomIn:function(a,b){return a=a||(sb?this.options.zoomDelta:1),this.setZoom(this._zoom+a,b)},zoomOut:function(a,b){return a=a||(sb?this.options.zoomDelta:1),this.setZoom(this._zoom-a,b)},setZoomAround:function(a,b,c){var d=this.getZoomScale(b),e=this.getSize().divideBy(2),f=a instanceof H?a:this.latLngToContainerPoint(a),g=f.subtract(e).multiplyBy(1-1/d),h=this.containerPointToLatLng(e.add(g));return this.setView(h,b,{zoom:c})},_getBoundsCenterZoom:function(a,b){b=b||{},a=a.getBounds?a.getBounds():O(a);var c=J(b.paddingTopLeft||b.padding||[0,0]),d=J(b.paddingBottomRight||b.padding||[0,0]),e=this.getBoundsZoom(a,!1,c.add(d));
if(e="number"==typeof b.maxZoom?Math.min(b.maxZoom,e):e,1/0===e)return{center:a.getCenter(),zoom:e};var f=d.subtract(c).divideBy(2),g=this.project(a.getSouthWest(),e),h=this.project(a.getNorthEast(),e),i=this.unproject(g.add(h).divideBy(2).add(f),e);return{center:i,zoom:e}},fitBounds:function(a,b){if(a=O(a),!a.isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(a,b);return this.setView(c.center,c.zoom,b)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})
},panBy:function(a,b){if(a=J(a).round(),b=b||{},!a.x&&!a.y)return this.fire("moveend");if(b.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new cd,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),b.animate!==!1){nc(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,c,b.duration||.25,b.easeLinearity)
}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,b,c){function m(a){var b=a?-1:1,c=a?i:h,d=i*i-h*h+b*l*l*j*j,e=2*c*l*j,f=d/e,g=Math.sqrt(f*f+1)-f,k=1e-9>g?-18:Math.log(g);return k}function n(a){return(Math.exp(a)-Math.exp(-a))/2}function o(a){return(Math.exp(a)+Math.exp(-a))/2}function p(a){return n(a)/o(a)}function r(a){return h*(o(q)/o(q+k*a))}function s(a){return h*(o(q)*p(q+k*a)-n(q))/l}function t(a){return 1-Math.pow(1-a,1.5)}function x(){var c=(Date.now()-u)/w,f=t(c)*v;
1>=c?(this._flyToFrame=A(x,this),this._move(this.unproject(d.add(e.subtract(d).multiplyBy(s(f)/j)),g),this.getScaleZoom(h/r(f),g),{flyTo:!0})):this._move(a,b)._moveEnd(!0)}if(c=c||{},c.animate===!1||!sb)return this.setView(a,b,c);this._stop();var d=this.project(this.getCenter()),e=this.project(a),f=this.getSize(),g=this._zoom;a=Q(a),b=void 0===b?g:b;var h=Math.max(f.x,f.y),i=h*this.getZoomScale(g,b),j=e.distanceTo(d)||1,k=1.42,l=k*k,q=m(0),u=Date.now(),v=(m(1)-q)/k,w=c.duration?1e3*c.duration:1e3*v*.8;return this._moveStart(!0,c.noMoveStart),x.call(this),this
},flyToBounds:function(a,b){var c=this._getBoundsCenterZoom(a,b);return this.flyTo(c.center,c.zoom,b)},setMaxBounds:function(a){return a=O(a),a.isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(a){var b=this.options.minZoom;return this.options.minZoom=a,this._loaded&&b!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this
},setMaxZoom:function(a){var b=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&b!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,b){this._enforcingBounds=!0;var c=this.getCenter(),d=this._limitCenter(c,this._zoom,O(a));return c.equals(d)||this.panTo(d,b),this._enforcingBounds=!1,this},panInside:function(a,b){b=b||{};var c=J(b.paddingTopLeft||b.padding||[0,0]),d=J(b.paddingBottomRight||b.padding||[0,0]),e=this.getCenter(),f=this.project(e),g=this.project(a),h=this.getPixelBounds(),i=h.getSize().divideBy(2),j=M([h.min.add(c),h.max.subtract(d)]);
if(!j.contains(g)){this._enforcingBounds=!0;var k=f.subtract(g),l=J(g.x+k.x,g.y+k.y);(g.x<j.min.x||g.x>j.max.x)&&(l.x=f.x-k.x,k.x>0?l.x+=i.x-c.x:l.x-=i.x-d.x),(g.y<j.min.y||g.y>j.max.y)&&(l.y=f.y-k.y,k.y>0?l.y+=i.y-c.y:l.y-=i.y-d.y),this.panTo(this.unproject(l),b),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=d({animate:!1,pan:!0},a===!0?{animate:!0}:a);var b=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var c=this.getSize(),e=b.divideBy(2).round(),g=c.divideBy(2).round(),h=e.subtract(g);
return h.x||h.y?(a.animate&&a.pan?this.panBy(h):(a.pan&&this._rawPanBy(h),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(f(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:c})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=d({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;
var b=f(this._handleGeolocationResponse,this),c=f(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,c,a):navigator.geolocation.getCurrentPosition(b,c,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var b=a.code,c=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");
this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+c+"."})},_handleGeolocationResponse:function(a){var b=a.coords.latitude,c=a.coords.longitude,d=new P(b,c),e=d.toBounds(2*a.coords.accuracy),f=this._locateOptions;if(f.setView){var g=this.getBoundsZoom(e);this.setView(d,f.maxZoom?Math.min(g,f.maxZoom):g)}var h={latlng:d,bounds:e,timestamp:a.timestamp};for(var i in a.coords)"number"==typeof a.coords[i]&&(h[i]=a.coords[i]);this.fire("locationfound",h)
},addHandler:function(a,b){if(!b)return this;var c=this[a]=new b(this);return this._handlers.push(c),this.options[a]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(a){this._container._leaflet_id=void 0,this._containerId=void 0}void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),ic(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(B(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");
var b;for(b in this._layers)this._layers[b].remove();for(b in this._panes)ic(this._panes[b]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,b){var c="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),d=hc("div",c,b||this._mapPane);return a&&(this._panes[a]=d),d},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom
},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(a.getBottomLeft()),c=this.unproject(a.getTopRight());return new N(b,c)},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,b,c){a=O(a),c=J(c||[0,0]);var d=this.getZoom()||0,e=this.getMinZoom(),f=this.getMaxZoom(),g=a.getNorthWest(),h=a.getSouthEast(),i=this.getSize().subtract(c),j=M(this.project(h,d),this.project(g,d)).getSize(),k=sb?this.options.zoomSnap:1,l=i.x/j.x,m=i.y/j.y,n=b?Math.max(l,m):Math.min(l,m);
return d=this.getScaleZoom(n,d),k&&(d=Math.round(d/(k/100))*(k/100),d=b?Math.ceil(d/k)*k:Math.floor(d/k)*k),Math.max(e,Math.min(f,d))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new H(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,b){var c=this._getTopLeftPoint(a,b);return new K(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(void 0===a?this.getZoom():a)
},getPane:function(a){return"string"==typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,b){var c=this.options.crs;return b=void 0===b?this._zoom:b,c.scale(a)/c.scale(b)},getScaleZoom:function(a,b){var c=this.options.crs;b=void 0===b?this._zoom:b;var d=c.zoom(a*c.scale(b));return isNaN(d)?1/0:d},project:function(a,b){return b=void 0===b?this._zoom:b,this.options.crs.latLngToPoint(Q(a),b)},unproject:function(a,b){return b=void 0===b?this._zoom:b,this.options.crs.pointToLatLng(J(a),b)
},layerPointToLatLng:function(a){var b=J(a).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(a){var b=this.project(Q(a))._round();return b._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(Q(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(O(a))},distance:function(a,b){return this.options.crs.distance(Q(a),Q(b))},containerPointToLayerPoint:function(a){return J(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return J(a).add(this._getMapPanePos())
},containerPointToLatLng:function(a){var b=this.containerPointToLayerPoint(J(a));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Q(a)))},mouseEventToContainerPoint:function(a){return Uc(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var b=this._container=fc(a);
if(!b)throw new Error("Map container not found.");if(b._leaflet_id)throw new Error("Map container is already initialized.");Kc(b,"scroll",this._onScroll,this),this._containerId=h(b)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&sb,nc(a,"leaflet-container"+(yb?" leaflet-touch":"")+(Bb?" leaflet-retina":"")+(bb?" leaflet-oldie":"")+(lb?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=gc(a,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()
},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),vc(this._mapPane,new H(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(nc(a.markerPane,"leaflet-zoom-hide"),nc(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,b){vc(this._mapPane,new H(0,0));var c=!this._loaded;
this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var d=this._zoom!==b;this._moveStart(d,!1)._move(a,b)._moveEnd(d),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(a,b){return a&&this.fire("zoomstart"),b||this.fire("movestart"),this},_move:function(a,b,c){void 0===b&&(b=this._zoom);var d=this._zoom!==b;return this._zoom=b,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),(d||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")
},_stop:function(){return B(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){vc(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[h(this._container)]=this;var b=a?Mc:Kc;
b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&b(window,"resize",this._onResize,this),sb&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){B(this._resizeRequest),this._resizeRequest=A(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();
Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,b){for(var d,c=[],e="mouseout"===b||"mouseover"===b,f=a.target||a.srcElement,g=!1;f;){if(d=this._targets[h(f)],d&&("click"===b||"preclick"===b)&&!a._simulated&&this._draggableMoved(d)){g=!0;break}if(d&&d.listens(b,!0)){if(e&&!$c(f,a))break;if(c.push(d),e)break}if(f===this._container)break;f=f.parentNode}return c.length||g||e||!$c(f,a)||(c=[this]),c},_handleDOMEvent:function(a){if(this._loaded&&!Zc(a)){var b=a.type;
("mousedown"===b||"keypress"===b||"keyup"===b||"keydown"===b)&&Fc(a.target||a.srcElement),this._fireDOMEvent(a,b)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,b,c){if("click"===a.type){var e=d({},a);e.type="preclick",this._fireDOMEvent(e,e.type,c)}if(!a._stopped&&(c=(c||[]).concat(this._findEventTargets(a,b)),c.length)){var f=c[0];"contextmenu"===b&&f.listens(b,!0)&&Sc(a);var g={originalEvent:a};if("keypress"!==a.type&&"keydown"!==a.type&&"keyup"!==a.type){var h=f.getLatLng&&(!f._radius||f._radius<=10);
g.containerPoint=h?this.latLngToContainerPoint(f.getLatLng()):this.mouseEventToContainerPoint(a),g.layerPoint=this.containerPointToLayerPoint(g.containerPoint),g.latlng=h?f.getLatLng():this.layerPointToLatLng(g.layerPoint)}for(var i=0;i<c.length;i++)if(c[i].fire(b,g,!0),g.originalEvent._stopped||c[i].options.bubblingMouseEvents===!1&&-1!==t(this._mouseEvents,b))return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()
},_clearHandlers:function(){for(var a=0,b=this._handlers.length;b>a;a++)this._handlers[a].disable()},whenReady:function(a,b){return this._loaded?a.call(b||this,{target:this}):this.on("load",a,b),this},_getMapPanePos:function(){return wc(this._mapPane)||new H(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,b){var c=a&&void 0!==b?this._getNewPixelOrigin(a,b):this.getPixelOrigin();return c.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,b){var c=this.getSize()._divideBy(2);
return this.project(a,b)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,b,c){var d=this._getNewPixelOrigin(c,b);return this.project(a,b)._subtract(d)},_latLngBoundsToNewLayerBounds:function(a,b,c){var d=this._getNewPixelOrigin(c,b);return M([this.project(a.getSouthWest(),b)._subtract(d),this.project(a.getNorthWest(),b)._subtract(d),this.project(a.getSouthEast(),b)._subtract(d),this.project(a.getNorthEast(),b)._subtract(d)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))
},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,b,c){if(!c)return a;var d=this.project(a,b),e=this.getSize().divideBy(2),f=new K(d.subtract(e),d.add(e)),g=this._getBoundsOffset(f,c,b);return g.round().equals([0,0])?a:this.unproject(d.add(g),b)},_limitOffset:function(a,b){if(!b)return a;var c=this.getPixelBounds(),d=new K(c.min.add(a),c.max.add(a));return a.add(this._getBoundsOffset(d,b))},_getBoundsOffset:function(a,b,c){var d=M(this.project(b.getNorthEast(),c),this.project(b.getSouthWest(),c)),e=d.min.subtract(a.min),f=d.max.subtract(a.max),g=this._rebound(e.x,-f.x),h=this._rebound(e.y,-f.y);
return new H(g,h)},_rebound:function(a,b){return a+b>0?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom(),d=sb?this.options.zoomSnap:1;return d&&(a=Math.round(a/d)*d),Math.max(b,Math.min(c,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){oc(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._trunc();return(b&&b.animate)===!0||this.getSize().contains(c)?(this.panBy(c,b),!0):!1
},_createAnimProxy:function(){var a=this._proxy=hc("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(a){var b=cc,c=this._proxy.style[b];uc(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1)),c===this._proxy.style[b]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ic(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy
},_animMoveEnd:function(){var a=this.getCenter(),b=this.getZoom();uc(this._proxy,this.project(a,b),this.getZoomScale(b,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;
var d=this.getZoomScale(b),e=this._getCenterOffset(a)._divideBy(1-1/d);return c.animate===!0||this.getSize().contains(e)?(A(function(){this._moveStart(!0,!1)._animateZoom(a,b,!0)},this),!0):!1},_animateZoom:function(a,b,c,d){this._mapPane&&(c&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=b,nc(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:b,noUpdate:d}),setTimeout(f(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&oc(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),A(function(){this._moveEnd(!0)
},this))}}),fd=D.extend({options:{position:"topright"},initialize:function(a){o(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var b=this._container=this.onAdd(a),c=this.getPosition(),d=a._controlCorners[c];return nc(b,"leaflet-control"),-1!==c.indexOf("bottom")?d.insertBefore(b,d.firstChild):d.appendChild(b),this._map.on("unload",this.remove,this),this
},remove:function(){return this._map?(ic(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),gd=function(a){return new fd(a)};dd.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){function d(d,e){var f=b+d+" "+b+e;a[d+e]=hc("div",f,c)}var a=this._controlCorners={},b="leaflet-",c=this._controlContainer=hc("div",b+"control-container",this._container);
d("top","left"),d("top","right"),d("bottom","left"),d("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)ic(this._controlCorners[a]);ic(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var hd=fd.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,b,c,d){return d>c?-1:c>d?1:0}},initialize:function(a,b,c){o(this,c),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;
for(var d in a)this._addLayer(a[d],d);for(d in b)this._addLayer(b[d],d,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var b=0;b<this._layers.length;b++)this._layers[b].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return fd.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)
},addBaseLayer:function(a,b){return this._addLayer(a,b),this._map?this._update():this},addOverlay:function(a,b){return this._addLayer(a,b,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var b=this._getLayer(h(a));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){nc(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);
return a<this._section.clientHeight?(nc(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):oc(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return oc(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",b=this._container=hc("div",a),c=this.options.collapsed;b.setAttribute("aria-haspopup",!0),Rc(b),Qc(b);var d=this._section=hc("section",a+"-list");c&&(this._map.on("click",this.collapse,this),eb||Kc(b,{mouseenter:this.expand,mouseleave:this.collapse},this));
var e=this._layersLink=hc("a",a+"-toggle",b);e.href="#",e.title="Layers",yb?(Kc(e,"click",Tc),Kc(e,"click",this.expand,this)):Kc(e,"focus",this.expand,this),c||this.expand(),this._baseLayersList=hc("div",a+"-base",d),this._separator=hc("div",a+"-separator",d),this._overlaysList=hc("div",a+"-overlays",d),b.appendChild(d)},_getLayer:function(a){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&h(this._layers[b].layer)===a)return this._layers[b]},_addLayer:function(a,b,c){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:b,overlay:c}),this.options.sortLayers&&this._layers.sort(f(function(a,b){return this.options.sortFunction(a.layer,b.layer,a.name,b.name)
},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;jc(this._baseLayersList),jc(this._overlaysList),this._layerControlInputs=[];var a,b,c,d,e=0;for(c=0;c<this._layers.length;c++)d=this._layers[c],this._addItem(d),b=b||d.overlay,a=a||!d.overlay,e+=d.overlay?0:1;return this.options.hideSingleBase&&(a=a&&e>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=b&&a?"":"none",this
},_onLayerChange:function(a){this._handlingClick||this._update();var b=this._getLayer(h(a.target)),c=b.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null;c&&this._map.fire(c,b)},_createRadioElement:function(a,b){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(b?' checked="checked"':"")+"/>",d=document.createElement("div");return d.innerHTML=c,d.firstChild},_addItem:function(a){var d,b=document.createElement("label"),c=this._map.hasLayer(a.layer);
a.overlay?(d=document.createElement("input"),d.type="checkbox",d.className="leaflet-control-layers-selector",d.defaultChecked=c):d=this._createRadioElement("leaflet-base-layers_"+h(this),c),this._layerControlInputs.push(d),d.layerId=h(a.layer),Kc(d,"click",this._onInputClick,this);var e=document.createElement("span");e.innerHTML=" "+a.name;var f=document.createElement("div");b.appendChild(f),f.appendChild(d),f.appendChild(e);var g=a.overlay?this._overlaysList:this._baseLayersList;return g.appendChild(b),this._checkDisabledLayers(),b
},_onInputClick:function(){var b,c,a=this._layerControlInputs,d=[],e=[];this._handlingClick=!0;for(var f=a.length-1;f>=0;f--)b=a[f],c=this._getLayer(b.layerId).layer,b.checked?d.push(c):b.checked||e.push(c);for(f=0;f<e.length;f++)this._map.hasLayer(e[f])&&this._map.removeLayer(e[f]);for(f=0;f<d.length;f++)this._map.hasLayer(d[f])||this._map.addLayer(d[f]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var b,c,a=this._layerControlInputs,d=this._map.getZoom(),e=a.length-1;e>=0;e--)b=a[e],c=this._getLayer(b.layerId).layer,b.disabled=void 0!==c.options.minZoom&&d<c.options.minZoom||void 0!==c.options.maxZoom&&d>c.options.maxZoom
},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),id=function(a,b,c){return new hd(a,b,c)},jd=fd.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(a){var b="leaflet-control-zoom",c=hc("div",b+" leaflet-bar"),d=this.options;return this._zoomInButton=this._createButton(d.zoomInText,d.zoomInTitle,b+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(d.zoomOutText,d.zoomOutTitle,b+"-out",c,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),c
},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,b,c,d,e){var f=hc("a",c,d);
return f.innerHTML=a,f.href="#",f.title=b,f.setAttribute("role","button"),f.setAttribute("aria-label",b),Rc(f),Kc(f,"click",Tc),Kc(f,"click",e,this),Kc(f,"click",this._refocusOnMap,this),f},_updateDisabled:function(){var a=this._map,b="leaflet-disabled";oc(this._zoomInButton,b),oc(this._zoomOutButton,b),(this._disabled||a._zoom===a.getMinZoom())&&nc(this._zoomOutButton,b),(this._disabled||a._zoom===a.getMaxZoom())&&nc(this._zoomInButton,b)}});dd.mergeOptions({zoomControl:!0}),dd.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new jd,this.addControl(this.zoomControl))
});var kd=function(a){return new jd(a)},ld=fd.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var b="leaflet-control-scale",c=hc("div",b),d=this.options;return this._addScales(d,b+"-line",c),a.on(d.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),c},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,c){a.metric&&(this._mScale=hc("div",b,c)),a.imperial&&(this._iScale=hc("div",b,c))
},_update:function(){var a=this._map,b=a.getSize().y/2,c=a.distance(a.containerPointToLatLng([0,b]),a.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(c)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var b=this._getRoundNum(a),c=1e3>b?b+" m":b/1e3+" km";this._updateScale(this._mScale,c,b/a)},_updateImperial:function(a){var c,d,e,b=3.2808399*a;b>5280?(c=b/5280,d=this._getRoundNum(c),this._updateScale(this._iScale,d+" mi",d/c)):(e=this._getRoundNum(b),this._updateScale(this._iScale,e+" ft",e/b))
},_updateScale:function(a,b,c){a.style.width=Math.round(this.options.maxWidth*c)+"px",a.innerHTML=b},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1),c=a/b;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,b*c}}),md=function(a){return new ld(a)},nd=fd.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(a){o(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=hc("div","leaflet-control-attribution"),Rc(this._container);
for(var b in a._layers)a._layers[b].getAttribution&&this.addAttribution(a._layers[b].getAttribution());return this._update(),this._container},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var b in this._attributions)this._attributions[b]&&a.push(b);
var c=[];this.options.prefix&&c.push(this.options.prefix),a.length&&c.push(a.join(", ")),this._container.innerHTML=c.join(" | ")}}});dd.mergeOptions({attributionControl:!0}),dd.addInitHook(function(){this.options.attributionControl&&(new nd).addTo(this)});var od=function(a){return new nd(a)};fd.Layers=hd,fd.Zoom=jd,fd.Scale=ld,fd.Attribution=nd,gd.layers=id,gd.zoom=kd,gd.scale=md,gd.attribution=od;var pd=D.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)
},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});pd.addTo=function(a,b){return a.addHandler(b,this),this};var Bd,qd={Events:F},rd=yb?"touchstart mousedown":"mousedown",sd={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},td={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},ud=G.extend({options:{clickTolerance:3},initialize:function(a,b,c,d){o(this,d),this._element=a,this._dragStartTarget=b||a,this._preventOutline=c
},enable:function(){this._enabled||(Kc(this._dragStartTarget,rd,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ud._dragging===this&&this.finishDrag(),Mc(this._dragStartTarget,rd,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!mc(this._element,"leaflet-zoom-anim")&&!(ud._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(ud._dragging=this,this._preventOutline&&Fc(this._element),Bc(),xc(),this._moving)))){this.fire("down");
var b=a.touches?a.touches[0]:a,c=Hc(this._element);this._startPoint=new H(b.clientX,b.clientY),this._parentScale=Ic(c),Kc(document,td[a.type],this._onMove,this),Kc(document,sd[a.type],this._onUp,this)}},_onMove:function(a){if(!a._simulated&&this._enabled){if(a.touches&&a.touches.length>1)return this._moved=!0,void 0;var b=a.touches&&1===a.touches.length?a.touches[0]:a,c=new H(b.clientX,b.clientY)._subtract(this._startPoint);(c.x||c.y)&&(Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||(c.x/=this._parentScale.x,c.y/=this._parentScale.y,Sc(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=wc(this._element).subtract(c),nc(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),nc(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,B(this._animRequest),this._lastEvent=a,this._animRequest=A(this._updatePosition,this,!0)))
}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),vc(this._element,this._newPos),this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){oc(document.body,"leaflet-dragging"),this._lastTarget&&(oc(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in td)Mc(document,td[a],this._onMove,this),Mc(document,sd[a],this._onUp,this);Cc(),yc(),this._moved&&this._moving&&(B(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,ud._dragging=!1
}}),Jd=(Object.freeze||Object)({simplify:vd,pointToSegmentDistance:wd,closestPointOnSegment:xd,clipSegment:Cd,_getEdgeIntersection:Dd,_getBitCode:Ed,_sqClosestPointOnSegment:Gd,isFlat:Hd,_flat:Id}),Ld=(Object.freeze||Object)({clipPolygon:Kd}),Md={project:function(a){return new H(a.lng,a.lat)},unproject:function(a){return new P(a.y,a.x)},bounds:new K([-180,-90],[180,90])},Nd={R:6378137,R_MINOR:6356752.314245179,bounds:new K([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(a){var b=Math.PI/180,c=this.R,d=a.lat*b,e=this.R_MINOR/c,f=Math.sqrt(1-e*e),g=f*Math.sin(d),h=Math.tan(Math.PI/4-d/2)/Math.pow((1-g)/(1+g),f/2);
return d=-c*Math.log(Math.max(h,1e-10)),new H(a.lng*b*c,d)},unproject:function(a){for(var j,b=180/Math.PI,c=this.R,d=this.R_MINOR/c,e=Math.sqrt(1-d*d),f=Math.exp(-a.y/c),g=Math.PI/2-2*Math.atan(f),h=0,i=.1;15>h&&Math.abs(i)>1e-7;h++)j=e*Math.sin(g),j=Math.pow((1-j)/(1+j),e/2),i=Math.PI/2-2*Math.atan(f*j)-g,g+=i;return new P(g*b,a.x*b/c)}},Od=(Object.freeze||Object)({LonLat:Md,Mercator:Nd,SphericalMercator:U}),Pd=d({},S,{code:"EPSG:3395",projection:Nd,transformation:function(){var a=.5/(Math.PI*Nd.R);return W(a,.5,-a,.5)
}()}),Qd=d({},S,{code:"EPSG:4326",projection:Md,transformation:W(1/180,1,-1/180,.5)}),Rd=d({},R,{projection:Md,transformation:W(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,b){var c=b.lng-a.lng,d=b.lat-a.lat;return Math.sqrt(c*c+d*d)},infinite:!0});R.Earth=S,R.EPSG3395=Pd,R.EPSG3857=X,R.EPSG900913=Y,R.EPSG4326=Qd,R.Simple=Rd;var Sd=G.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this
},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[h(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[h(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var b=a.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var c=this.getEvents();
b.on(c,this),this.once("remove",function(){b.off(c,this)},this)}this.onAdd(b),this.getAttribution&&b.attributionControl&&b.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),b.fire("layeradd",{layer:this})}}});dd.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var b=h(a);return this._layers[b]?this:(this._layers[b]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var b=h(a);
return this._layers[b]?(this._loaded&&a.onRemove(this),a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution()),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return!!a&&h(a)in this._layers},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},_addLayers:function(a){a=a?s(a)?a:[a]:[];for(var b=0,c=a.length;c>b;b++)this.addLayer(a[b])
},_addZoomLimit:function(a){(isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[h(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var b=h(a);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,b=-1/0,c=this._getZoomSpan();for(var d in this._zoomBoundLayers){var e=this._zoomBoundLayers[d].options;a=void 0===e.minZoom?a:Math.min(a,e.minZoom),b=void 0===e.maxZoom?b:Math.max(b,e.maxZoom)}this._layersMaxZoom=b===-1/0?void 0:b,this._layersMinZoom=1/0===a?void 0:a,c!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)
}});var Td=Sd.extend({initialize:function(a,b){o(this,b),this._layers={};var c,d;if(a)for(c=0,d=a.length;d>c;c++)this.addLayer(a[c])},addLayer:function(a){var b=this.getLayerId(a);return this._layers[b]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var b=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)
},invoke:function(a){var c,d,b=Array.prototype.slice.call(arguments,1);for(c in this._layers)d=this._layers[c],d[a]&&d[a].apply(d,b);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return h(a)
}}),Ud=function(a,b){return new Td(a,b)},Vd=Td.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),Td.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),Td.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")
},getBounds:function(){var a=new N;for(var b in this._layers){var c=this._layers[b];a.extend(c.getBounds?c.getBounds():c.getLatLng())}return a}}),Wd=function(a){return new Vd(a)},Xd=D.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(a){o(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);if(!c){if("icon"===a)throw new Error("iconUrl not set in Icon options (see the docs).");
return null}var d=this._createImg(c,b&&"IMG"===b.tagName?b:null);return this._setIconStyles(d,a),d},_setIconStyles:function(a,b){var c=this.options,d=c[b+"Size"];"number"==typeof d&&(d=[d,d]);var e=J(d),f=J("shadow"===b&&c.shadowAnchor||c.iconAnchor||e&&e.divideBy(2,!0));a.className="leaflet-marker-"+b+" "+(c.className||""),f&&(a.style.marginLeft=-f.x+"px",a.style.marginTop=-f.y+"px"),e&&(a.style.width=e.x+"px",a.style.height=e.y+"px")},_createImg:function(a,b){return b=b||document.createElement("img"),b.src=a,b
},_getIconUrl:function(a){return Bb&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}}),Zd=Xd.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return Zd.imagePath||(Zd.imagePath=this._detectIconPath()),(this.options.imagePath||Zd.imagePath)+Xd.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=hc("div","leaflet-default-icon-path"),b=document.createElement("div");
b.setAttribute("id","eb"),b.appendChild(a),document.body.appendChild(b);var c=gc(a,"background-image")||gc(a,"backgroundImage");return document.body.removeChild(b),c=null===c||0!==c.indexOf("url")?"":c.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),$d=pd.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new ud(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),nc(a,"leaflet-marker-draggable")
},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&oc(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var b=this._marker,c=b._map,d=this._marker.options.autoPanSpeed,e=this._marker.options.autoPanPadding,f=wc(b._icon),g=c.getPixelBounds(),h=c.getPixelOrigin(),i=M(g.min._subtract(h).add(e),g.max._subtract(h).subtract(e));
if(!i.contains(f)){var j=J((Math.max(i.max.x,f.x)-i.max.x)/(g.max.x-i.max.x)-(Math.min(i.min.x,f.x)-i.min.x)/(g.min.x-i.min.x),(Math.max(i.max.y,f.y)-i.max.y)/(g.max.y-i.max.y)-(Math.min(i.min.y,f.y)-i.min.y)/(g.min.y-i.min.y)).multiplyBy(d);c.panBy(j,{animate:!1}),this._draggable._newPos._add(j),this._draggable._startPos._add(j),vc(b._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=A(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")
},_onPreDrag:function(a){this._marker.options.autoPan&&(B(this._panRequest),this._panRequest=A(this._adjustPan.bind(this,a)))},_onDrag:function(a){var b=this._marker,c=b._shadow,d=wc(b._icon),e=b._map.layerPointToLatLng(d);c&&vc(c,d),b._latlng=e,a.latlng=e,a.oldLatLng=this._oldLatLng,b.fire("move",a).fire("drag",a)},_onDragEnd:function(a){B(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),_d=Sd.extend({options:{icon:new Zd,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,b){o(this,b),this._latlng=Q(a)
},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng
},setLatLng:function(a){var b=this._latlng;return this._latlng=Q(a),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();
this._setPos(a)}return this},_initIcon:function(){var a=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=a.icon.createIcon(this._icon),d=!1;c!==this._icon&&(this._icon&&this._removeIcon(),d=!0,a.title&&(c.title=a.title),"IMG"===c.tagName&&(c.alt=a.alt||"")),nc(c,b),a.keyboard&&(c.tabIndex="0"),this._icon=c,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var e=a.icon.createShadow(this._shadow),f=!1;e!==this._shadow&&(this._removeShadow(),f=!0),e&&(nc(e,b),e.alt=""),this._shadow=e,a.opacity<1&&this._updateOpacity(),d&&this.getPane().appendChild(this._icon),this._initInteraction(),e&&f&&this.getPane(a.shadowPane).appendChild(this._shadow)
},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),ic(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ic(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&vc(this._icon,a),this._shadow&&vc(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();
this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&(nc(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),$d)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new $d(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&rc(this._icon,a),this._shadow&&rc(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)
},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),be=Sd.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)
},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return o(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&a.hasOwnProperty("weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path
},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),ce=be.extend({options:{fill:!0,radius:10},initialize:function(a,b){o(this,b),this._latlng=Q(a),this._radius=this.options.radius},setLatLng:function(a){var b=this._latlng;return this._latlng=Q(a),this.redraw(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()
},getRadius:function(){return this._radius},setStyle:function(a){var b=a&&a.radius||this._radius;return be.prototype.setStyle.call(this,a),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,b=this._radiusY||a,c=this._clickTolerance(),d=[a+c,b+c];this._pxBounds=new K(this._point.subtract(d),this._point.add(d))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)
},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),ee=ce.extend({initialize:function(a,b,c){if("number"==typeof b&&(b=d({},c,{radius:b})),o(this,b),this._latlng=Q(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius
},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new N(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:be.prototype.setStyle,_project:function(){var a=this._latlng.lng,b=this._latlng.lat,c=this._map,d=c.options.crs;if(d.distance===S.distance){var e=Math.PI/180,f=this._mRadius/S.R/e,g=c.project([b+f,a]),h=c.project([b-f,a]),i=g.add(h).divideBy(2),j=c.unproject(i).lat,k=Math.acos((Math.cos(f*e)-Math.sin(b*e)*Math.sin(j*e))/(Math.cos(b*e)*Math.cos(j*e)))/e;
(isNaN(k)||0===k)&&(k=f/Math.cos(Math.PI/180*b)),this._point=i.subtract(c.getPixelOrigin()),this._radius=isNaN(k)?0:i.x-c.project([j,a-k]).x,this._radiusY=i.y-g.y}else{var l=d.unproject(d.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(l).x}this._updateBounds()}}),ge=be.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,b){o(this,b),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()
},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var e,f,b=1/0,c=null,d=Gd,g=0,h=this._parts.length;h>g;g++)for(var i=this._parts[g],j=1,k=i.length;k>j;j++){e=i[j-1],f=i[j];var l=d(a,e,f,!0);b>l&&(b=l,c=d(a,e,f))}return c&&(c.distance=Math.sqrt(b)),c},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var a,b,c,d,e,f,g,h=this._rings[0],i=h.length;if(!i)return null;for(a=0,b=0;i-1>a;a++)b+=h[a].distanceTo(h[a+1])/2;if(0===b)return this._map.layerPointToLatLng(h[0]);
for(a=0,d=0;i-1>a;a++)if(e=h[a],f=h[a+1],c=e.distanceTo(f),d+=c,d>b)return g=(d-b)/c,this._map.layerPointToLatLng([f.x-g*(f.x-e.x),f.y-g*(f.y-e.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,b){return b=b||this._defaultShape(),a=Q(a),b.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new N,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return Hd(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var b=[],c=Hd(a),d=0,e=a.length;e>d;d++)c?(b[d]=Q(a[d]),this._bounds.extend(b[d])):b[d]=this._convertLatLngs(a[d]);
return b},_project:function(){var a=new K;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),b=new H(a,a);this._pxBounds=new K([this._rawPxBounds.min.subtract(b),this._rawPxBounds.max.add(b)])},_projectLatlngs:function(a,b,c){var f,g,d=a[0]instanceof P,e=a.length;if(d){for(g=[],f=0;e>f;f++)g[f]=this._map.latLngToLayerPoint(a[f]),c.extend(g[f]);b.push(g)}else for(f=0;e>f;f++)this._projectLatlngs(a[f],b,c)
},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(a)){if(this.options.noClip)return this._parts=this._rings,void 0;var c,d,e,f,g,h,i,b=this._parts;for(c=0,e=0,f=this._rings.length;f>c;c++)for(i=this._rings[c],d=0,g=i.length;g-1>d;d++)h=Cd(i[d],i[d+1],a,d,!0),h&&(b[e]=b[e]||[],b[e].push(h[0]),(h[1]!==i[d+1]||d===g-2)&&(b[e].push(h[1]),e++))}},_simplifyPoints:function(){for(var a=this._parts,b=this.options.smoothFactor,c=0,d=a.length;d>c;c++)a[c]=vd(a[c],b)
},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,b){var c,d,e,f,g,h,i=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(c=0,f=this._parts.length;f>c;c++)for(h=this._parts[c],d=0,g=h.length,e=g-1;g>d;e=d++)if((b||0!==d)&&wd(a,h[e],h[d])<=i)return!0;return!1}});ge._flat=Id;var ie=ge.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length
},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var a,b,c,d,e,f,g,h,i,j=this._rings[0],k=j.length;if(!k)return null;for(f=g=h=0,a=0,b=k-1;k>a;b=a++)c=j[a],d=j[b],e=c.y*d.x-d.y*c.x,g+=(c.x+d.x)*e,h+=(c.y+d.y)*e,f+=3*e;return i=0===f?j[0]:[g/f,h/f],this._map.layerPointToLatLng(i)},_convertLatLngs:function(a){var b=ge.prototype._convertLatLngs.call(this,a),c=b.length;return c>=2&&b[0]instanceof P&&b[0].equals(b[c-1])&&b.pop(),b},_setLatLngs:function(a){ge.prototype._setLatLngs.call(this,a),Hd(this._latlngs)&&(this._latlngs=[this._latlngs])
},_defaultShape:function(){return Hd(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,b=this.options.weight,c=new H(b,b);if(a=new K(a.min.subtract(c),a.max.add(c)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(a)){if(this.options.noClip)return this._parts=this._rings,void 0;for(var f,d=0,e=this._rings.length;e>d;d++)f=Kd(this._rings[d],a,!0),f.length&&this._parts.push(f)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var c,d,e,f,g,h,i,j,b=!1;
if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(f=0,i=this._parts.length;i>f;f++)for(c=this._parts[f],g=0,j=c.length,h=j-1;j>g;h=g++)d=c[g],e=c[h],d.y>a.y!=e.y>a.y&&a.x<(e.x-d.x)*(a.y-d.y)/(e.y-d.y)+d.x&&(b=!b);return b||ge.prototype._containsPoint.call(this,a,!0)}}),ke=Vd.extend({initialize:function(a,b){o(this,b),this._layers={},a&&this.addData(a)},addData:function(a){var c,d,e,b=s(a)?a:a.features;if(b){for(c=0,d=b.length;d>c;c++)e=b[c],(e.geometries||e.geometry||e.features||e.coordinates)&&this.addData(e);
return this}var f=this.options;if(f.filter&&!f.filter(a))return this;var g=le(a,f);return g?(g.feature=se(a),g.defaultOptions=g.options,this.resetStyle(g),f.onEachFeature&&f.onEachFeature(a,g),this.addLayer(g)):this},resetStyle:function(a){return void 0===a?this.eachLayer(this.resetStyle,this):(a.options=d({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){a.setStyle&&("function"==typeof b&&(b=b(a.feature)),a.setStyle(b))
}}),te={toGeoJSON:function(a){return re(this,{type:"Point",coordinates:pe(this.getLatLng(),a)})}};_d.include(te),ee.include(te),ce.include(te),ge.include({toGeoJSON:function(a){var b=!Hd(this._latlngs),c=qe(this._latlngs,b?1:0,!1,a);return re(this,{type:(b?"Multi":"")+"LineString",coordinates:c})}}),ie.include({toGeoJSON:function(a){var b=!Hd(this._latlngs),c=b&&!Hd(this._latlngs[0]),d=qe(this._latlngs,c?2:b?1:0,!0,a);return b||(d=[d]),re(this,{type:(c?"Multi":"")+"Polygon",coordinates:d})}}),Td.include({toMultiPoint:function(a){var b=[];
return this.eachLayer(function(c){b.push(c.toGeoJSON(a).geometry.coordinates)}),re(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(a){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===b)return this.toMultiPoint(a);var c="GeometryCollection"===b,d=[];return this.eachLayer(function(b){if(b.toGeoJSON){var e=b.toGeoJSON(a);if(c)d.push(e.geometry);else{var f=se(e);"FeatureCollection"===f.type?d.push.apply(d,f.features):d.push(f)}}}),c?re(this,{geometries:d,type:"GeometryCollection"}):{type:"FeatureCollection",features:d}
}});var ve=ue,we=Sd.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,b,c){this._url=a,this._bounds=O(b),o(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(nc(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ic(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)
},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&kc(this._image),this},bringToBack:function(){return this._map&&lc(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=O(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};
return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a="IMG"===this._url.tagName,b=this._image=a?this._url:hc("img");return nc(b,"leaflet-image-layer"),this._zoomAnimated&&nc(b,"leaflet-zoom-animated"),this.options.className&&nc(b,this.options.className),b.onselectstart=k,b.onmousemove=k,b.onload=f(this.fire,this,"load"),b.onerror=f(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a?(this._url=b.src,void 0):(b.src=this._url,b.alt=this.options.alt,void 0)
},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom),c=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;uc(this._image,c,b)},_reset:function(){var a=this._image,b=new K(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=b.getSize();vc(a,b.min),a.style.width=c.x+"px",a.style.height=c.y+"px"},_updateOpacity:function(){rc(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)
},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)}}),xe=function(a,b,c){return new we(a,b,c)},ye=we.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0},_initImage:function(){var a="VIDEO"===this._url.tagName,b=this._image=a?this._url:hc("video");if(nc(b,"leaflet-image-layer"),this._zoomAnimated&&nc(b,"leaflet-zoom-animated"),this.options.className&&nc(b,this.options.className),b.onselectstart=k,b.onmousemove=k,b.onloadeddata=f(this.fire,this,"load"),a){for(var c=b.getElementsByTagName("source"),d=[],e=0;e<c.length;e++)d.push(c[e].src);
return this._url=c.length>0?d:[b.src],void 0}s(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&b.style.hasOwnProperty("objectFit")&&(b.style.objectFit="fill"),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop;for(var g=0;g<this._url.length;g++){var h=hc("source");h.src=this._url[g],b.appendChild(h)}}}),Ae=we.extend({_initImage:function(){var a=this._image=this._url;nc(a,"leaflet-image-layer"),this._zoomAnimated&&nc(a,"leaflet-zoom-animated"),this.options.className&&nc(a,this.options.className),a.onselectstart=k,a.onmousemove=k
}}),Ce=Sd.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,b){o(this,a),this._source=b},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&rc(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&rc(this._container,1),this.bringToFront()},onRemove:function(a){a._fadeAnimated?(rc(this._container,0),this._removeTimeout=setTimeout(f(ic,void 0,this._container),200)):ic(this._container)
},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=Q(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};
return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&kc(this._container),this},bringToBack:function(){return this._map&&lc(this._container),this},_prepareOpen:function(a,b,c){if(b instanceof Sd||(c=b,b=a),b instanceof Vd)for(var d in a._layers){b=a._layers[d];break}if(!c)if(b.getCenter)c=b.getCenter();else{if(!b.getLatLng)throw new Error("Unable to get source layer LatLng.");c=b.getLatLng()}return this._source=b,this.update(),c
},_updateContent:function(){if(this._content){var a=this._contentNode,b="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof b)a.innerHTML=b;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),b=J(this.options.offset),c=this._getAnchor();this._zoomAnimated?vc(this._container,a.add(c)):b=b.add(a).add(c);var d=this._containerBottom=-b.y,e=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;
this._container.style.bottom=d+"px",this._container.style.left=e+"px"}},_getAnchor:function(){return[0,0]}}),De=Ce.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a.openPopup(this),this},onAdd:function(a){Ce.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof be||this._source.on("preclick",Pc))
},onRemove:function(a){Ce.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof be||this._source.off("preclick",Pc))},getEvents:function(){var a=Ce.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this._close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_close:function(){this._map&&this._map.closePopup(this)
},_initLayout:function(){var a="leaflet-popup",b=this._container=hc("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),c=this._wrapper=hc("div",a+"-content-wrapper",b);if(this._contentNode=hc("div",a+"-content",c),Rc(c),Qc(this._contentNode),Kc(c,"contextmenu",Pc),this._tipContainer=hc("div",a+"-tip-container",b),this._tip=hc("div",a+"-tip",this._tipContainer),this.options.closeButton){var d=this._closeButton=hc("a",a+"-close-button",b);d.href="#close",d.innerHTML="&#215;",Kc(d,"click",this._onCloseButtonClick,this)
}},_updateLayout:function(){var a=this._contentNode,b=a.style;b.width="",b.whiteSpace="nowrap";var c=a.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),b.width=c+1+"px",b.whiteSpace="",b.height="";var d=a.offsetHeight,e=this.options.maxHeight,f="leaflet-popup-scrolled";e&&d>e?(b.height=e+"px",nc(a,f)):oc(a,f),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),c=this._getAnchor();vc(this._container,b.add(c))
},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var a=this._map,b=parseInt(gc(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+b,d=this._containerWidth,e=new H(this._containerLeft,-c-this._containerBottom);e._add(wc(this._container));var f=a.layerPointToContainerPoint(e),g=J(this.options.autoPanPadding),h=J(this.options.autoPanPaddingTopLeft||g),i=J(this.options.autoPanPaddingBottomRight||g),j=a.getSize(),k=0,l=0;f.x+d+i.x>j.x&&(k=f.x+d-j.x+i.x),f.x-k-h.x<0&&(k=f.x-h.x),f.y+c+i.y>j.y&&(l=f.y+c-j.y+i.y),f.y-l-h.y<0&&(l=f.y-h.y),(k||l)&&a.fire("autopanstart").panBy([k,l])
}},_onCloseButtonClick:function(a){this._close(),Tc(a)},_getAnchor:function(){return J(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ee=function(a,b){return new De(a,b)};dd.mergeOptions({closePopupOnClick:!0}),dd.include({openPopup:function(a,b,c){return a instanceof De||(a=new De(c).setContent(a)),b&&a.setLatLng(b),this.hasLayer(a)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=a,this.addLayer(a))},closePopup:function(a){return a&&a!==this._popup||(a=this._popup,this._popup=null),a&&this.removeLayer(a),this
}}),Sd.include({bindPopup:function(a,b){return a instanceof De?(o(a,b),this._popup=a,a._source=this):((!this._popup||b)&&(this._popup=new De(b,this)),this._popup.setContent(a)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this
},openPopup:function(a,b){return this._popup&&this._map&&(b=this._popup._prepareOpen(this,a,b),this._map.openPopup(this._popup,b)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(a){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(a)),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){var b=a.layer||a.target;
if(this._popup&&this._map)return Tc(a),b instanceof be?(this.openPopup(a.layer||a.target,a.latlng),void 0):(this._map.hasLayer(this._popup)&&this._popup._source===b?this.closePopup():this.openPopup(b,a.latlng),void 0)},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){13===a.originalEvent.keyCode&&this._openPopup(a)}});var Fe=Ce.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(a){Ce.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)
},onRemove:function(a){Ce.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=Ce.prototype.getEvents.call(this);return yb&&!this.options.permanent&&(a.preclick=this._close),a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var a="leaflet-tooltip",b=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=hc("div",b)
},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var b=this._map,c=this._container,d=b.latLngToContainerPoint(b.getCenter()),e=b.layerPointToContainerPoint(a),f=this.options.direction,g=c.offsetWidth,h=c.offsetHeight,i=J(this.options.offset),j=this._getAnchor();"top"===f?a=a.add(J(-g/2+i.x,-h+i.y+j.y,!0)):"bottom"===f?a=a.subtract(J(g/2-i.x,-i.y,!0)):"center"===f?a=a.subtract(J(g/2+i.x,h/2-j.y+i.y,!0)):"right"===f||"auto"===f&&e.x<d.x?(f="right",a=a.add(J(i.x+j.x,j.y-h/2+i.y,!0))):(f="left",a=a.subtract(J(g+j.x-i.x,h/2-j.y-i.y,!0))),oc(c,"leaflet-tooltip-right"),oc(c,"leaflet-tooltip-left"),oc(c,"leaflet-tooltip-top"),oc(c,"leaflet-tooltip-bottom"),nc(c,"leaflet-tooltip-"+f),vc(c,a)
},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&rc(this._container,a)},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(b)},_getAnchor:function(){return J(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ge=function(a,b){return new Fe(a,b)};dd.include({openTooltip:function(a,b,c){return a instanceof Fe||(a=new Fe(c).setContent(a)),b&&a.setLatLng(b),this.hasLayer(a)?this:this.addLayer(a)
},closeTooltip:function(a){return a&&this.removeLayer(a),this}}),Sd.include({bindTooltip:function(a,b){return a instanceof Fe?(o(a,b),this._tooltip=a,a._source=this):((!this._tooltip||b)&&(this._tooltip=new Fe(b,this)),this._tooltip.setContent(a)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(a||!this._tooltipHandlersAdded){var b=a?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};
this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),yb&&(c.click=this._openTooltip)),this[b](c),this._tooltipHandlersAdded=!a}},openTooltip:function(a,b){return this._tooltip&&this._map&&(b=this._tooltip._prepareOpen(this,a,b),this._map.openTooltip(this._tooltip,b),this._tooltip.options.interactive&&this._tooltip._container&&(nc(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this
},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(oc(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(a){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(a)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip
},_openTooltip:function(a){var b=a.layer||a.target;this._tooltip&&this._map&&this.openTooltip(b,this._tooltip.options.sticky?a.latlng:void 0)},_moveTooltip:function(a){var c,d,b=a.latlng;this._tooltip.options.sticky&&a.originalEvent&&(c=this._map.mouseEventToContainerPoint(a.originalEvent),d=this._map.containerPointToLayerPoint(c),b=this._map.layerPointToLatLng(d)),this._tooltip.setLatLng(b)}});var He=Xd.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var b=a&&"DIV"===a.tagName?a:document.createElement("div"),c=this.options;
if(c.html instanceof Element?(jc(b),b.appendChild(c.html)):b.innerHTML=c.html!==!1?c.html:"",c.bgPos){var d=J(c.bgPos);b.style.backgroundPosition=-d.x+"px "+-d.y+"px"}return this._setIconStyles(b,"icon"),b},createShadow:function(){return null}});Xd.Default=Zd;var Je=Sd.extend({options:{tileSize:256,opacity:1,updateWhenIdle:tb,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){o(this,a)
},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),ic(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(kc(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(lc(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container
},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=i(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a
},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof H?a:new H(a,a)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var f,b=this.getPane().children,c=-a(-1/0,1/0),d=0,e=b.length;e>d;d++)f=b[d].style.zIndex,b[d]!==this._container&&f&&(c=a(c,+f));isFinite(c)&&(this.options.zIndex=c+a(-1,1),this._updateZIndex())
},_updateOpacity:function(){if(this._map&&!bb){rc(this._container,this.options.opacity);var a=+new Date,b=!1,c=!1;for(var d in this._tiles){var e=this._tiles[d];if(e.current&&e.loaded){var f=Math.min(1,(a-e.loaded)/200);rc(e.el,f),1>f?b=!0:(e.active?c=!0:this._onOpaqueTile(e),e.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),b&&(B(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this))}},_onOpaqueTile:k,_initContainer:function(){this._container||(this._container=hc("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))
},_updateLevels:function(){var a=this._tileZoom,b=this.options.maxZoom;if(void 0===a)return void 0;for(var c in this._levels)this._levels[c].el.children.length||c===a?(this._levels[c].el.style.zIndex=b-Math.abs(a-c),this._onUpdateLevel(c)):(ic(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);var d=this._levels[a],e=this._map;return d||(d=this._levels[a]={},d.el=hc("div","leaflet-tile-container leaflet-zoom-animated",this._container),d.el.style.zIndex=b,d.origin=e.project(e.unproject(e.getPixelOrigin()),a).round(),d.zoom=a,this._setZoomTransform(d,e.getCenter(),e.getZoom()),k(d.el.offsetWidth),this._onCreateLevel(d)),this._level=d,d
},_onUpdateLevel:k,_onRemoveLevel:k,_onCreateLevel:k,_pruneTiles:function(){if(this._map){var a,b,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom)return this._removeAllTiles(),void 0;for(a in this._tiles)b=this._tiles[a],b.retain=b.current;for(a in this._tiles)if(b=this._tiles[a],b.current&&!b.active){var d=b.coords;this._retainParent(d.x,d.y,d.z,d.z-5)||this._retainChildren(d.x,d.y,d.z,d.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var b in this._tiles)this._tiles[b].coords.z===a&&this._removeTile(b)
},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)ic(this._levels[a].el),this._onRemoveLevel(a),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,b,c,d){var e=Math.floor(a/2),f=Math.floor(b/2),g=c-1,h=new H(+e,+f);h.z=+g;var i=this._tileCoordsToKey(h),j=this._tiles[i];return j&&j.active?(j.retain=!0,!0):(j&&j.loaded&&(j.retain=!0),g>d?this._retainParent(e,f,g,d):!1)},_retainChildren:function(a,b,c,d){for(var e=2*a;2*a+2>e;e++)for(var f=2*b;2*b+2>f;f++){var g=new H(e,f);
g.z=c+1;var h=this._tileCoordsToKey(g),i=this._tiles[h];i&&i.active?i.retain=!0:(i&&i.loaded&&(i.retain=!0),d>c+1&&this._retainChildren(e,f,c+1,d))}},_resetView:function(a){var b=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var b=this.options;return void 0!==b.minNativeZoom&&a<b.minNativeZoom?b.minNativeZoom:void 0!==b.maxNativeZoom&&b.maxNativeZoom<a?b.maxNativeZoom:a},_setView:function(a,b,c,d){var e=this._clampZoom(Math.round(b));
(void 0!==this.options.maxZoom&&e>this.options.maxZoom||void 0!==this.options.minZoom&&e<this.options.minZoom)&&(e=void 0);var f=this.options.updateWhenZooming&&e!==this._tileZoom;(!d||f)&&(this._tileZoom=e,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==e&&this._update(a),c||this._pruneTiles(),this._noPrune=!!c),this._setZoomTransforms(a,b)},_setZoomTransforms:function(a,b){for(var c in this._levels)this._setZoomTransform(this._levels[c],a,b)},_setZoomTransform:function(a,b,c){var d=this._map.getZoomScale(c,a.zoom),e=a.origin.multiplyBy(d).subtract(this._map._getNewPixelOrigin(b,c)).round();
sb?uc(a.el,e,d):vc(a.el,e)},_resetGrid:function(){var a=this._map,b=a.options.crs,c=this._tileSize=this.getTileSize(),d=this._tileZoom,e=this._map.getPixelWorldBounds(this._tileZoom);e&&(this._globalTileRange=this._pxBoundsToTileRange(e)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,b.wrapLng[0]],d).x/c.x),Math.ceil(a.project([0,b.wrapLng[1]],d).x/c.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([b.wrapLat[0],0],d).y/c.x),Math.ceil(a.project([b.wrapLat[1],0],d).y/c.y)]
},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var b=this._map,c=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),d=b.getZoomScale(c,this._tileZoom),e=b.project(a,this._tileZoom).floor(),f=b.getSize().divideBy(2*d);return new K(e.subtract(f),e.add(f))},_update:function(a){var b=this._map;if(b){var c=this._clampZoom(b.getZoom());if(void 0===a&&(a=b.getCenter()),void 0!==this._tileZoom){var d=this._getTiledPixelBounds(a),e=this._pxBoundsToTileRange(d),f=e.getCenter(),g=[],h=this.options.keepBuffer,i=new K(e.getBottomLeft().subtract([h,-h]),e.getTopRight().add([h,-h]));
if(!(isFinite(e.min.x)&&isFinite(e.min.y)&&isFinite(e.max.x)&&isFinite(e.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var j in this._tiles){var k=this._tiles[j].coords;k.z===this._tileZoom&&i.contains(new H(k.x,k.y))||(this._tiles[j].current=!1)}if(Math.abs(c-this._tileZoom)>1)return this._setView(a,c),void 0;for(var l=e.min.y;l<=e.max.y;l++)for(var m=e.min.x;m<=e.max.x;m++){var n=new H(m,l);if(n.z=this._tileZoom,this._isValidTile(n)){var o=this._tiles[this._tileCoordsToKey(n)];
o?o.current=!0:g.push(n)}}if(g.sort(function(a,b){return a.distanceTo(f)-b.distanceTo(f)}),0!==g.length){this._loading||(this._loading=!0,this.fire("loading"));var p=document.createDocumentFragment();for(m=0;m<g.length;m++)this._addTile(g[m],p);this._level.el.appendChild(p)}}}},_isValidTile:function(a){var b=this._map.options.crs;if(!b.infinite){var c=this._globalTileRange;if(!b.wrapLng&&(a.x<c.min.x||a.x>c.max.x)||!b.wrapLat&&(a.y<c.min.y||a.y>c.max.y))return!1}if(!this.options.bounds)return!0;var d=this._tileCoordsToBounds(a);
return O(this.options.bounds).overlaps(d)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var b=this._map,c=this.getTileSize(),d=a.scaleBy(c),e=d.add(c),f=b.unproject(d,a.z),g=b.unproject(e,a.z);return[f,g]},_tileCoordsToBounds:function(a){var b=this._tileCoordsToNwSe(a),c=new N(b[0],b[1]);return this.options.noWrap||(c=this._map.wrapLatLngBounds(c)),c},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var b=a.split(":"),c=new H(+b[0],+b[1]);
return c.z=+b[2],c},_removeTile:function(a){var b=this._tiles[a];b&&(ic(b.el),delete this._tiles[a],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){nc(a,"leaflet-tile");var b=this.getTileSize();a.style.width=b.x+"px",a.style.height=b.y+"px",a.onselectstart=k,a.onmousemove=k,bb&&this.options.opacity<1&&rc(a,this.options.opacity),eb&&!fb&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,b){var c=this._getTilePos(a),d=this._tileCoordsToKey(a),e=this.createTile(this._wrapCoords(a),f(this._tileReady,this,a));
this._initTile(e),this.createTile.length<2&&A(f(this._tileReady,this,a,null,e)),vc(e,c),this._tiles[d]={el:e,coords:a,current:!0},b.appendChild(e),this.fire("tileloadstart",{tile:e,coords:a})},_tileReady:function(a,b,c){b&&this.fire("tileerror",{error:b,tile:c,coords:a});var d=this._tileCoordsToKey(a);c=this._tiles[d],c&&(c.loaded=+new Date,this._map._fadeAnimated?(rc(c.el,0),B(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),b||(nc(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),bb||!this._map._fadeAnimated?A(this._pruneTiles,this):setTimeout(f(this._pruneTiles,this),250)))
},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var b=new H(this._wrapX?j(a.x,this._wrapX):a.x,this._wrapY?j(a.y,this._wrapY):a.y);return b.z=a.z,b},_pxBoundsToTileRange:function(a){var b=this.getTileSize();return new K(a.min.unscaleBy(b).floor(),a.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}}),Le=Je.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,b){this._url=a,b=o(this,b),b.detectRetina&&Bb&&b.maxZoom>0&&(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom++):(b.zoomOffset++,b.maxZoom--),b.minZoom=Math.max(0,b.minZoom)),"string"==typeof b.subdomains&&(b.subdomains=b.subdomains.split("")),eb||this.on("tileunload",this._onTileRemove)
},setUrl:function(a,b){return this._url===a&&void 0===b&&(b=!0),this._url=a,b||this.redraw(),this},createTile:function(a,b){var c=document.createElement("img");return Kc(c,"load",f(this._tileOnLoad,this,b,c)),Kc(c,"error",f(this._tileOnError,this,b,c)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),c.alt="",c.setAttribute("role","presentation"),c.src=this.getTileUrl(a),c},getTileUrl:function(a){var b={r:Bb?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};
if(this._map&&!this._map.options.crs.infinite){var c=this._globalTileRange.max.y-a.y;this.options.tms&&(b.y=c),b["-y"]=c}return r(this._url,d(b,this.options))},_tileOnLoad:function(a,b){bb?setTimeout(f(a,this,null,b),0):a(null,b)},_tileOnError:function(a,b,c){var d=this.options.errorTileUrl;d&&b.getAttribute("src")!==d&&(b.src=d),a(c,b)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,b=this.options.maxZoom,c=this.options.zoomReverse,d=this.options.zoomOffset;return c&&(a=b-a),a+d
},_getSubdomain:function(a){var b=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var a,b;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(b=this._tiles[a].el,b.onload=k,b.onerror=k,b.complete||(b.src=u,ic(b),delete this._tiles[a]))},_removeTile:function(a){var b=this._tiles[a];if(b)return hb||b.el.setAttribute("src",u),Je.prototype._removeTile.call(this,a)},_tileReady:function(a,b,c){return!this._map||c&&c.getAttribute("src")===u?void 0:Je.prototype._tileReady.call(this,a,b,c)
}}),Ne=Le.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,b){this._url=a;var c=d({},this.defaultWmsParams);for(var e in b)e in this.options||(c[e]=b[e]);b=o(this,b);var f=b.detectRetina&&Bb?2:1,g=this.getTileSize();c.width=g.x*f,c.height=g.y*f,this.wmsParams=c},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";
this.wmsParams[b]=this._crs.code,Le.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this._tileCoordsToNwSe(a),c=this._crs,d=M(c.project(b[0]),c.project(b[1])),e=d.min,f=d.max,g=(this._wmsVersion>=1.3&&this._crs===Qd?[e.y,e.x,f.y,f.x]:[e.x,e.y,f.x,f.y]).join(","),h=Le.prototype.getTileUrl.call(this,a);return h+p(this.wmsParams,h,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+g},setParams:function(a,b){return d(this.wmsParams,a),b||this.redraw(),this}});Le.WMS=Ne,Me.wms=Oe;var Pe=Sd.extend({options:{padding:.1,tolerance:0},initialize:function(a){o(this,a),h(this),this._layers=this._layers||{}
},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&nc(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)
},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,b){var c=this._map.getZoomScale(b,this._zoom),d=wc(this._container),e=this._map.getSize().multiplyBy(.5+this.options.padding),f=this._map.project(this._center,b),g=this._map.project(a,b),h=g.subtract(f),i=e.multiplyBy(-c).add(d).add(e).subtract(h);sb?uc(this._container,i,c):vc(this._container,i)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()
},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,b=this._map.getSize(),c=this._map.containerPointToLayerPoint(b.multiplyBy(-a)).round();this._bounds=new K(c,c.add(b.multiplyBy(1+2*a)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Qe=Pe.extend({getEvents:function(){var a=Pe.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a
},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Pe.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");Kc(a,"mousemove",this._onMouseMove,this),Kc(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Kc(a,"mouseout",this._handleMouseOut,this),this._ctx=a.getContext("2d")},_destroyContainer:function(){B(this._redrawRequest),delete this._ctx,ic(this._container),Mc(this._container),delete this._container
},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var b in this._layers)a=this._layers[b],a._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Pe.prototype._update.call(this);var a=this._bounds,b=this._container,c=a.getSize(),d=Bb?2:1;vc(b,a.min),b.width=d*c.x,b.height=d*c.y,b.style.width=c.x+"px",b.style.height=c.y+"px",Bb&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){Pe.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())
},_initPath:function(a){this._updateDashArray(a),this._layers[h(a)]=a;var b=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=b),this._drawLast=b,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var b=a._order,c=b.next,d=b.prev;c?c.prev=d:this._drawLast=d,d?d.next=c:this._drawFirst=c,delete a._order,delete this._layers[h(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)
},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if("string"==typeof a.options.dashArray){var d,e,b=a.options.dashArray.split(/[, ]+/),c=[];for(e=0;e<b.length;e++){if(d=Number(b[e]),isNaN(d))return;c.push(d)}a.options._dashArray=c}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||A(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var b=(a.options.weight||0)+1;
this._redrawBounds=this._redrawBounds||new K,this._redrawBounds.extend(a._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(a._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var b=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,b.x,b.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)
},_draw:function(){var a,b=this._redrawBounds;if(this._ctx.save(),b){var c=b.getSize();this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,c.x,c.y),this._ctx.clip()}this._drawing=!0;for(var d=this._drawFirst;d;d=d.next)a=d.layer,(!b||a._pxBounds&&a._pxBounds.intersects(b))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,b){if(this._drawing){var c,d,e,f,g=a._parts,h=g.length,i=this._ctx;if(h){for(i.beginPath(),c=0;h>c;c++){for(d=0,e=g[c].length;e>d;d++)f=g[c][d],i[d?"lineTo":"moveTo"](f.x,f.y);
b&&i.closePath()}this._fillStroke(i,a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var b=a._point,c=this._ctx,d=Math.max(Math.round(a._radius),1),e=(Math.max(Math.round(a._radiusY),1)||d)/d;1!==e&&(c.save(),c.scale(1,e)),c.beginPath(),c.arc(b.x,b.y/e,d,0,2*Math.PI,!1),1!==e&&c.restore(),this._fillStroke(c,a)}},_fillStroke:function(a,b){var c=b.options;c.fill&&(a.globalAlpha=c.fillOpacity,a.fillStyle=c.fillColor||c.color,a.fill(c.fillRule||"evenodd")),c.stroke&&0!==c.weight&&(a.setLineDash&&a.setLineDash(b.options&&b.options._dashArray||[]),a.globalAlpha=c.opacity,a.lineWidth=c.weight,a.strokeStyle=c.color,a.lineCap=c.lineCap,a.lineJoin=c.lineJoin,a.stroke())
},_onClick:function(a){for(var c,d,b=this._map.mouseEventToLayerPoint(a),e=this._drawFirst;e;e=e.next)c=e.layer,c.options.interactive&&c._containsPoint(b)&&!this._map._draggableMoved(c)&&(d=c);d&&(Yc(a),this._fireEvent([d],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,b)}},_handleMouseOut:function(a){var b=this._hoveredLayer;b&&(oc(this._container,"leaflet-interactive"),this._fireEvent([b],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)
},_handleMouseHover:function(a,b){if(!this._mouseHoverThrottled){for(var c,d,e=this._drawFirst;e;e=e.next)c=e.layer,c.options.interactive&&c._containsPoint(b)&&(d=c);d!==this._hoveredLayer&&(this._handleMouseOut(a),d&&(nc(this._container,"leaflet-interactive"),this._fireEvent([d],a,"mouseover"),this._hoveredLayer=d)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a),this._mouseHoverThrottled=!0,setTimeout(L.bind(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,b,c){this._map._fireDOMEvent(b,c||b.type,a)
},_bringToFront:function(a){var b=a._order;if(b){var c=b.next,d=b.prev;c&&(c.prev=d,d?d.next=c:c&&(this._drawFirst=c),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(a))}},_bringToBack:function(a){var b=a._order;if(b){var c=b.next,d=b.prev;d&&(d.next=c,c?c.prev=d:d&&(this._drawLast=d),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(a))}}}),Se=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')
}}catch(a){return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),Te={_initContainer:function(){this._container=hc("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Pe.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var b=a._container=Se("shape");nc(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",a._path=Se("path"),b.appendChild(a._path),this._updateStyle(a),this._layers[h(a)]=a
},_addPath:function(a){var b=a._container;this._container.appendChild(b),a.options.interactive&&a.addInteractiveTarget(b)},_removePath:function(a){var b=a._container;ic(b),a.removeInteractiveTarget(b),delete this._layers[h(a)]},_updateStyle:function(a){var b=a._stroke,c=a._fill,d=a.options,e=a._container;e.stroked=!!d.stroke,e.filled=!!d.fill,d.stroke?(b||(b=a._stroke=Se("stroke")),e.appendChild(b),b.weight=d.weight+"px",b.color=d.color,b.opacity=d.opacity,b.dashStyle=d.dashArray?s(d.dashArray)?d.dashArray.join(" "):d.dashArray.replace(/( *, *)/g," "):"",b.endcap=d.lineCap.replace("butt","flat"),b.joinstyle=d.lineJoin):b&&(e.removeChild(b),a._stroke=null),d.fill?(c||(c=a._fill=Se("fill")),e.appendChild(c),c.color=d.fillColor||d.color,c.opacity=d.fillOpacity):c&&(e.removeChild(c),a._fill=null)
},_updateCircle:function(a){var b=a._point.round(),c=Math.round(a._radius),d=Math.round(a._radiusY||c);this._setPath(a,a._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+d+" 0,23592600")},_setPath:function(a,b){a._path.v=b},_bringToFront:function(a){kc(a._container)},_bringToBack:function(a){lc(a._container)}},Ue=Fb?Se:Z,Ve=Pe.extend({getEvents:function(){var a=Pe.prototype.getEvents.call(this);return a.zoomstart=this._onZoomStart,a},_initContainer:function(){this._container=Ue("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ue("g"),this._container.appendChild(this._rootGroup)
},_destroyContainer:function(){ic(this._container),Mc(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){Pe.prototype._update.call(this);var a=this._bounds,b=a.getSize(),c=this._container;this._svgSize&&this._svgSize.equals(b)||(this._svgSize=b,c.setAttribute("width",b.x),c.setAttribute("height",b.y)),vc(c,a.min),c.setAttribute("viewBox",[a.min.x,a.min.y,b.x,b.y].join(" ")),this.fire("update")
}},_initPath:function(a){var b=a._path=Ue("path");a.options.className&&nc(b,a.options.className),a.options.interactive&&nc(b,"leaflet-interactive"),this._updateStyle(a),this._layers[h(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){ic(a._path),a.removeInteractiveTarget(a._path),delete this._layers[h(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var b=a._path,c=a.options;
b&&(c.stroke?(b.setAttribute("stroke",c.color),b.setAttribute("stroke-opacity",c.opacity),b.setAttribute("stroke-width",c.weight),b.setAttribute("stroke-linecap",c.lineCap),b.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?b.setAttribute("stroke-dasharray",c.dashArray):b.removeAttribute("stroke-dasharray"),c.dashOffset?b.setAttribute("stroke-dashoffset",c.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),c.fill?(b.setAttribute("fill",c.fillColor||c.color),b.setAttribute("fill-opacity",c.fillOpacity),b.setAttribute("fill-rule",c.fillRule||"evenodd")):b.setAttribute("fill","none"))
},_updatePoly:function(a,b){this._setPath(a,$(a._parts,b))},_updateCircle:function(a){var b=a._point,c=Math.max(Math.round(a._radius),1),d=Math.max(Math.round(a._radiusY),1)||c,e="a"+c+","+d+" 0 1,0 ",f=a._empty()?"M0 0":"M"+(b.x-c)+","+b.y+e+2*c+",0 "+e+2*-c+",0 ";this._setPath(a,f)},_setPath:function(a,b){a._path.setAttribute("d",b)},_bringToFront:function(a){kc(a._path)},_bringToBack:function(a){lc(a._path)}});Fb&&Ve.include(Te),dd.include({getRenderer:function(a){var b=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;
return b||(b=this._renderer=this._createRenderer()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(a){if("overlayPane"===a||void 0===a)return!1;var b=this._paneRenderers[a];return void 0===b&&(b=this._createRenderer({pane:a}),this._paneRenderers[a]=b),b},_createRenderer:function(a){return this.options.preferCanvas&&Re(a)||We(a)}});var Xe=ie.extend({initialize:function(a,b){ie.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))
},_boundsToLatLngs:function(a){return a=O(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});Ve.create=Ue,Ve.pointsToPath=$,ke.geometryToLayer=le,ke.coordsToLatLng=ne,ke.coordsToLatLngs=oe,ke.latLngToCoords=pe,ke.latLngsToCoords=qe,ke.getFeature=re,ke.asFeature=se,dd.mergeOptions({boxZoom:!0});var Ze=pd.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){Kc(this._container,"mousedown",this._onMouseDown,this)
},removeHooks:function(){Mc(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ic(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){return!a.shiftKey||1!==a.which&&1!==a.button?!1:(this._clearDeferredResetState(),this._resetState(),xc(),Bc(),this._startPoint=this._map.mouseEventToContainerPoint(a),Kc(document,{contextmenu:Tc,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this),void 0)
},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=hc("div","leaflet-zoom-box",this._container),nc(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var b=new K(this._point,this._startPoint),c=b.getSize();vc(this._box,b.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(ic(this._box),oc(this._container,"leaflet-crosshair")),yc(),Cc(),Mc(document,{contextmenu:Tc,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)
},_onMouseUp:function(a){if((1===a.which||1===a.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(f(this._resetState,this),0);var b=new N(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});dd.addInitHook("addHandler","boxZoom",Ze),dd.mergeOptions({doubleClickZoom:!0});var $e=pd.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)
},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom(),d=b.options.zoomDelta,e=a.originalEvent.shiftKey?c-d:c+d;"center"===b.options.doubleClickZoom?b.setZoom(e):b.setZoomAround(a.containerPoint,e)}});dd.addInitHook("addHandler","doubleClickZoom",$e),dd.mergeOptions({dragging:!0,inertia:!fb,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var _e=pd.extend({addHooks:function(){if(!this._draggable){var a=this._map;
this._draggable=new ud(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}nc(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){oc(this._map._container,"leaflet-grab"),oc(this._map._container,"leaflet-touch-drag"),this._draggable.disable()
},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=O(this._map.options.maxBounds);this._offsetLimit=M(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))
}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var b=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(b),this._prunePositions(b)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);
this._initialWorldOffset=b.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,b){return a-(a-b)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;a.x<b.min.x&&(a.x=this._viscousLimit(a.x,b.min.x)),a.y<b.min.y&&(a.y=this._viscousLimit(a.y,b.min.y)),a.x>b.max.x&&(a.x=this._viscousLimit(a.x,b.max.x)),a.y>b.max.y&&(a.y=this._viscousLimit(a.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)
}},_onPreDragWrap:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,e=(d-b+c)%a+b-c,f=(d+b+c)%a-b-c,g=Math.abs(e+c)<Math.abs(f+c)?e:f;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=g},_onDragEnd:function(a){var b=this._map,c=b.options,d=!c.inertia||this._times.length<2;if(b.fire("dragend",a),d)b.fire("moveend");else{this._prunePositions(+new Date);var e=this._lastPos.subtract(this._positions[0]),f=(this._lastTime-this._times[0])/1e3,g=c.easeLinearity,h=e.multiplyBy(g/f),i=h.distanceTo([0,0]),j=Math.min(c.inertiaMaxSpeed,i),k=h.multiplyBy(j/i),l=j/(c.inertiaDeceleration*g),m=k.multiplyBy(-l/2).round();
m.x||m.y?(m=b._limitOffset(m,b.options.maxBounds),A(function(){b.panBy(m,{duration:l,easeLinearity:g,noMoveStart:!0,animate:!0})})):b.fire("moveend")}}});dd.addInitHook("addHandler","dragging",_e),dd.mergeOptions({keyboard:!0,keyboardPanDelta:80});var af=pd.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;
a.tabIndex<=0&&(a.tabIndex="0"),Kc(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Mc(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,b=document.documentElement,c=a.scrollTop||b.scrollTop,d=a.scrollLeft||b.scrollLeft;
this._map._container.focus(),window.scrollTo(d,c)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var d,e,b=this._panKeys={},c=this.keyCodes;for(d=0,e=c.left.length;e>d;d++)b[c.left[d]]=[-1*a,0];for(d=0,e=c.right.length;e>d;d++)b[c.right[d]]=[a,0];for(d=0,e=c.down.length;e>d;d++)b[c.down[d]]=[0,a];for(d=0,e=c.up.length;e>d;d++)b[c.up[d]]=[0,-1*a]},_setZoomDelta:function(a){var d,e,b=this._zoomKeys={},c=this.keyCodes;
for(d=0,e=c.zoomIn.length;e>d;d++)b[c.zoomIn[d]]=a;for(d=0,e=c.zoomOut.length;e>d;d++)b[c.zoomOut[d]]=-a},_addHooks:function(){Kc(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Mc(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var d,b=a.keyCode,c=this._map;if(b in this._panKeys)c._panAnim&&c._panAnim._inProgress||(d=this._panKeys[b],a.shiftKey&&(d=J(d).multiplyBy(3)),c.panBy(d),c.options.maxBounds&&c.panInsideBounds(c.options.maxBounds));
else if(b in this._zoomKeys)c.setZoom(c.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[b]);else{if(27!==b||!c._popup||!c._popup.options.closeOnEscapeKey)return;c.closePopup()}Tc(a)}}});dd.addInitHook("addHandler","keyboard",af),dd.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var bf=pd.extend({addHooks:function(){Kc(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Mc(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var b=Wc(a),c=this._map.options.wheelDebounceTime;
this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var d=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(f(this._performZoom,this),d),Tc(a)},_performZoom:function(){var a=this._map,b=a.getZoom(),c=this._map.options.zoomSnap||0;a._stop();var d=this._delta/(4*this._map.options.wheelPxPerZoomLevel),e=4*Math.log(2/(1+Math.exp(-Math.abs(d))))/Math.LN2,f=c?Math.ceil(e/c)*c:e,g=a._limitZoom(b+(this._delta>0?f:-f))-b;
this._delta=0,this._startTime=null,g&&("center"===a.options.scrollWheelZoom?a.setZoom(b+g):a.setZoomAround(this._lastMousePos,b+g))}});dd.addInitHook("addHandler","scrollWheelZoom",bf),dd.mergeOptions({tap:!0,tapTolerance:15});var cf=pd.extend({addHooks:function(){Kc(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Mc(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches){if(Sc(a),this._fireClick=!0,a.touches.length>1)return this._fireClick=!1,clearTimeout(this._holdTimeout),void 0;
var b=a.touches[0],c=b.target;this._startPos=this._newPos=new H(b.clientX,b.clientY),c.tagName&&"a"===c.tagName.toLowerCase()&&nc(c,"leaflet-active"),this._holdTimeout=setTimeout(f(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",b))},this),1e3),this._simulateEvent("mousedown",b),Kc(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){if(clearTimeout(this._holdTimeout),Mc(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&a&&a.changedTouches){var b=a.changedTouches[0],c=b.target;
c&&c.tagName&&"a"===c.tagName.toLowerCase()&&oc(c,"leaflet-active"),this._simulateEvent("mouseup",b),this._isTapValid()&&this._simulateEvent("click",b)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){var b=a.touches[0];this._newPos=new H(b.clientX,b.clientY),this._simulateEvent("mousemove",b)},_simulateEvent:function(a,b){var c=document.createEvent("MouseEvents");c._simulated=!0,b.target._simulatedClick=!0,c.initMouseEvent(a,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(c)
}});yb&&!xb&&dd.addInitHook("addHandler","tap",cf),dd.mergeOptions({touchZoom:yb&&!fb,bounceAtZoomLimits:!0});var df=pd.extend({addHooks:function(){nc(this._map._container,"leaflet-touch-zoom"),Kc(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){oc(this._map._container,"leaflet-touch-zoom"),Mc(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var b=this._map;if(a.touches&&2===a.touches.length&&!b._animatingZoom&&!this._zooming){var c=b.mouseEventToContainerPoint(a.touches[0]),d=b.mouseEventToContainerPoint(a.touches[1]);
this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),"center"!==b.options.touchZoom&&(this._pinchStartLatLng=b.containerPointToLatLng(c.add(d)._divideBy(2))),this._startDist=c.distanceTo(d),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),Kc(document,"touchmove",this._onTouchMove,this),Kc(document,"touchend",this._onTouchEnd,this),Sc(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var b=this._map,c=b.mouseEventToContainerPoint(a.touches[0]),d=b.mouseEventToContainerPoint(a.touches[1]),e=c.distanceTo(d)/this._startDist;
if(this._zoom=b.getScaleZoom(e,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&1>e||this._zoom>b.getMaxZoom()&&e>1)&&(this._zoom=b._limitZoom(this._zoom)),"center"===b.options.touchZoom){if(this._center=this._startLatLng,1===e)return}else{var g=c._add(d)._divideBy(2)._subtract(this._centerPoint);if(1===e&&0===g.x&&0===g.y)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(g),this._zoom)}this._moved||(b._moveStart(!0,!1),this._moved=!0),B(this._animRequest);
var h=f(b._move,b,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=A(h,this,!0),Sc(a)}},_onTouchEnd:function(){return this._moved&&this._zooming?(this._zooming=!1,B(this._animRequest),Mc(document,"touchmove",this._onTouchMove),Mc(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)),void 0):(this._zooming=!1,void 0)
}});dd.addInitHook("addHandler","touchZoom",df),dd.BoxZoom=Ze,dd.DoubleClickZoom=$e,dd.Drag=_e,dd.Keyboard=af,dd.ScrollWheelZoom=bf,dd.Tap=cf,dd.TouchZoom=df,Object.freeze=c,a.version=b,a.Control=fd,a.control=gd,a.Browser=Hb,a.Evented=G,a.Mixin=qd,a.Util=C,a.Class=D,a.Handler=pd,a.extend=d,a.bind=f,a.stamp=h,a.setOptions=o,a.DomEvent=bd,a.DomUtil=Jc,a.PosAnimation=cd,a.Draggable=ud,a.LineUtil=Jd,a.PolyUtil=Ld,a.Point=H,a.point=J,a.Bounds=K,a.bounds=M,a.Transformation=V,a.transformation=W,a.Projection=Od,a.LatLng=P,a.latLng=Q,a.LatLngBounds=N,a.latLngBounds=O,a.CRS=R,a.GeoJSON=ke,a.geoJSON=ue,a.geoJson=ve,a.Layer=Sd,a.LayerGroup=Td,a.layerGroup=Ud,a.FeatureGroup=Vd,a.featureGroup=Wd,a.ImageOverlay=we,a.imageOverlay=xe,a.VideoOverlay=ye,a.videoOverlay=ze,a.SVGOverlay=Ae,a.svgOverlay=Be,a.DivOverlay=Ce,a.Popup=De,a.popup=Ee,a.Tooltip=Fe,a.tooltip=Ge,a.Icon=Xd,a.icon=Yd,a.DivIcon=He,a.divIcon=Ie,a.Marker=_d,a.marker=ae,a.TileLayer=Le,a.tileLayer=Me,a.GridLayer=Je,a.gridLayer=Ke,a.SVG=Ve,a.svg=We,a.Renderer=Pe,a.Canvas=Qe,a.canvas=Re,a.Path=be,a.CircleMarker=ce,a.circleMarker=de,a.Circle=ee,a.circle=fe,a.Polyline=ge,a.polyline=he,a.Polygon=ie,a.polygon=je,a.Rectangle=Xe,a.rectangle=Ye,a.Map=dd,a.map=ed;
var ef=window.L;a.noConflict=function(){return window.L=ef,this},window.L=a})};d(),b.resolveWith(d)};FD50.module("leaflet",a)}(),function(){var a=function(a){var b=this,d=function(){!function(a){function c(a){return"object"==typeof a?a:{top:a,left:a}}var b=a.scrollTo=function(b,c,d){a(window).scrollTo(b,c,d)};b.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1,limit:!0},b.window=function(){return a(window)._scrollable()},a.fn._scrollable=function(){return this.map(function(){var b=this,c=!b.nodeName||-1!=a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"]);
if(!c)return b;var d=(b.contentWindow||b).document||b.ownerDocument||b;return/webkit/i.test(navigator.userAgent)||"BackCompat"==d.compatMode?d.body:d.documentElement})},a.fn.scrollTo=function(d,e,f){return"object"==typeof e&&(f=e,e=0),"function"==typeof f&&(f={onAfter:f}),"max"==d&&(d=9e9),f=a.extend({},b.defaults,f),e=e||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(e/=2),f.offset=c(f.offset),f.over=c(f.over),this._scrollable().each(function(){function m(a){h.animate(k,e,f.easing,a&&function(){a.call(this,d,f)
})}if(null!=d){var j,g=this,h=a(g),i=d,k={},l=h.is("html,body");switch(typeof i){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(i)){i=c(i);break}if(i=a(i,this),!i.length)return;case"object":(i.is||i.style)&&(j=(i=a(i)).offset())}a.each(f.axis.split(""),function(a,c){var d="x"==c?"Left":"Top",e=d.toLowerCase(),n="scroll"+d,o=g[n],p=b.max(g,c);if(j)k[n]=j[e]+(l?0:o-h.offset()[e]),f.margin&&(k[n]-=parseInt(i.css("margin"+d))||0,k[n]-=parseInt(i.css("border"+d+"Width"))||0),k[n]+=f.offset[e]||0,f.over[e]&&(k[n]+=i["x"==c?"width":"height"]()*f.over[e]);
else{var q=i[e];k[n]=q.slice&&"%"==q.slice(-1)?parseFloat(q)/100*p:q}f.limit&&/^\d+$/.test(k[n])&&(k[n]=k[n]<=0?0:Math.min(k[n],p)),!a&&f.queue&&(o!=k[n]&&m(f.onAfterFirst),delete k[n])}),m(f.onAfter)}}).end()},a.fn.scrollIntoView=function(b){var b=a(b);if(!(b.length<1)){var c=this.offset(),d=this.height(),e=c.top,f=e+d,g=b.offset(),h=b.height(),i=g.top,j=i+h;return j>f?this.scrollTo(b):e>i?this.scrollTo(b,{offset:-1*(d-h)}):void 0}},b.max=function(b,c){var d="x"==c?"Width":"Height",e="scroll"+d;if(!a(b).is("html,body"))return b[e]-a(b)[d.toLowerCase()]();
var f="client"+d,g=b.ownerDocument.documentElement,h=b.ownerDocument.body;return Math.max(g[e],h[e])-Math.min(g[f],h[f])}}(a)};d(),b.resolveWith(d)};FD50.module("scrollTo",a)}(),function(){var a=function(a){var b=this;a.require().script("autosize.input","scrollTo","ui/position").done(function(){var c=function(){var b={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};a.template("textboxlist/item",'<div class="textboxlist-item[%== (this.locked) ? " is-locked" : "" %]" data-textboxlist-item><span class="textboxlist-itemContent" data-textboxlist-itemContent>[%== html %]</span><div class="textboxlist-itemRemoveButton" data-textboxlist-itemRemoveButton><i class="fa fa-times"></i></a></div>'),a.template("textboxlist/itemContent",'[%= title %]<input type="hidden" name="[%= name %]" value="[%= id %]"/>'),a.Controller("Textboxlist",{pluginName:"textboxlist",hostname:"textboxlist",defaultOptions:{view:{item:"textboxlist/item",itemContent:"textboxlist/itemContent"},plugin:{},name:"items[]",unique:!0,caseSensitive:!1,max:null,ignoreLocked:!1,filterItem:null,"{item}":"[data-textboxlist-item]","{itemContent}":"[data-textboxlist-itemContent]","{itemRemoveButton}":"[data-textboxlist-itemRemoveButton]","{textField}":"[data-textboxlist-textField]"}},function(c){return{init:function(){var d=c.textField();
d.autosizeInput(),d.data("placeholderText",d.attr("placeholder"));var e=d.data("textboxlistName");e&&(c.options.name=e),c.item().each(function(){var b=a(this),d=b.find(c.itemContent.selector);c.createItem({id:b.data("id")||function(){var c=a.uid("item-");return b.data("id",c),c}(),title:b.data("title")||a.trim(d.text()),locked:b.hasClass("is-locked"),html:d.html()})}),(c.options.plugin.autocomplete||c.element.data("query"))&&c.addPlugin("autocomplete"),c.on("keypress",c.textField(),function(a){return a.keyCode==b.ENTER?a.preventDefault():void 0
})},setLayout:function(){var a=c.textField(),b=a.data("placeholderText");c.item().length>0&&(b=""),a.attr("placeholder",b).data("autosizeInputInstance").update()},enable:function(){c.element.removeClass("disabled"),c.textField().enabled(!0)},disable:function(){c.element.addClass("disabled"),c.textField().disabled(!0)},items:{},itemsByTitle:{},get:function(a){var b=c.getItemKey(a);return c.itemsByTitle.hasOwnProperty(b)?c.itemsByTitle[b]:void 0},getItemKey:function(a){return c.options.caseSensitive?a:a.toLowerCase()
},filterItem:function(b){var d=c.options,e=d.filterItem;a.isFunction(e)&&(b=e.call(c,b));var f=c.itemsByTitle;if(a.isString(b)&&""!==b){var g=b,h=c.getItemKey(g);b=f.hasOwnProperty(h)?c.itemsByTitle[h]:{id:a.uid("item-"),title:g,key:c.getItemKey(g),locked:!1}}return b.name=b.name||c.options.name,b.html=b.html||c.view.itemContent(!0,b),b},createItem:function(a){a.key=c.getItemKey(a.title),c.items[a.id]=a,c.itemsByTitle[a.key]=a},deleteItem:function(a){var b=c.items[a];c.item().filterBy("id",a).remove(),delete c.items[a];
var d=c.options.caseSensitive?b.title:b.title.toLowerCase();delete c.itemsByTitle[d]},addItem:function(b,d){if(b){var e=c.options,f=e.max;if((d||null===f||!((e.ignoreLocked?c.item(":not(.is-locked)"):c.item()).length>=f))&&(b=c.filterItem(b),a.isPlainObject(b))){var g,h=c.item().filterBy("id",b.id);if(e.unique&&h.length>0&&(g=h),g||(g=c.view.item(b).addClass(b.className||"").attr("data-id",b.id)),c.createItem(b),b.locked){var i=c.item(".is-locked:last");i.length>0?g.insertAfter(i):g.prependTo(c.element)}else g.insertBefore(c.textField());
return c.trigger("addItem",[b]),c.trigger("listChange"),b}}},removeItem:function(a){var b=c.items[a];c.deleteItem(a),c.trigger("removeItem",[b]),c.trigger("listChange")},clearItems:function(){c.item().each(function(){c.removeItem(a(this).data("id"))})},getAddedItems:function(){var b=[];return c.item().each(function(){var d=a(this),e=d.data("id");b.push(c.items[e])}),b},"{self} addItem":function(){c.setLayout()},"{self} removeItem":function(){c.setLayout()},"{itemRemoveButton} click":function(a){var b=a.parents(c.item.selector);
c.removeItem(b.data("id"))},"{textField} keydown":function(a,c){var d=c.keyCode;a.data("realEnterKey",d==b.ENTER)},"{textField} keypress":function(d,e){var f=d.data("realEnterKey"),g=e.keyCode==b.ENTER;d.data("realEnterKey",f&&g);var h=a.trim(c.textField().val());switch(e.keyCode){case b.ENTER:if(d.data("realEnterKey")){var e=c.trigger("useItem",[h]),i=e.item;if(void 0===i&&(i=h),i===!1||null===i)return;if(a.isPlainObject(i))c.addItem(i);else{var i=i.split(",");a.each(i,function(a,b){c.addItem(b)})}d.val("")
}}},"{textField} keyup":function(d,e){var f=a.trim(c.textField().val()),g="canRemoveItemUsingBackspace";switch(e.keyCode){case b.BACKSPACE:if(""===f)if(c[g]){var h=d.prev(c.item.selector);if(h.length>0){var i=h.data("id"),f=c.items[i];!f.locked&&c.removeItem(i)}}else c[g]=!0;break;default:c[g]=!1}},"{self} click":function(a,b){var d=c.textField();d.is(b.target)||d.focus()},"{textField} focusin":function(){c.activated||(c.activated=!0,c.trigger("textboxlistActivate"))},"{self} mousedown":function(){c.focusing=!0
},"{self} mouseup":function(){c.focusing=!1},"{self} focusout":function(){c.focusing||(c.activated=!1,c.deactivateTimer=setTimeout(function(){c.activated||c.trigger("textboxlistDeactivate")},1))}}}),a(document).on("click.textboxlist.data-api","[data-textboxlist]",function(){a(this).addController(a.Controller.Textboxlist).textField().focus()}).on("focus.textboxlist.data-api","[data-textboxlist] [data-textboxlist-textField]",function(){a(this).parents("[data-textboxlist]").addController(a.Controller.Textboxlist)
}),a.template("textboxlist/menu",'<div id="eb" class="eb-textboxlist textboxlist-autocomplete" data-textboxlist-autocomplete><b><b></b></b><div class="textboxlist-autocomplete-inner" data-textboxlist-autocomplete-viewport><div class="textboxlist-autocomplete-loading" data-textboxlist-autocomplete-loading></div><div class="textboxlist-autocomplete-empty" data-textboxlist-autocomplete-empty></div><ul class="textboxlist-menu" data-textboxlist-menu></ul></div></div>'),a.template("textboxlist/menuItem",'<li class="textboxlist-menuItem" data-textboxlist-menuItem>[%== html %]</li>'),a.template("textboxlist/loadingHint",'<i class="textboxlist-autocomplete-loading-indicator"></i>'),a.template("textboxlist/emptyHint",'<span class="textboxlist-autocomplete-empty-text">No items found.</span>'),a.Controller("Textboxlist.Autocomplete",{defaultOptions:{view:{menu:"textboxlist/menu",menuItem:"textboxlist/menuItem",loadingHint:"textboxlist/loadingHint",emptyHint:"textboxlist/emptyHint"},cache:!0,minLength:1,limit:10,highlight:!0,caseSensitive:!1,exclusive:!1,query:null,position:{my:"left top",at:"left bottom",collision:"none"},filterItem:null,showEmptyHint:!1,showLoadingHint:!1,id:"eb",component:"",modifier:"",shadow:!1,sticky:!1,animation:!1,"{menu}":"[data-textboxlist-menu]","{menuItem}":"[data-textboxlist-menuItem]","{viewport}":"[data-textboxlist-autocomplete-viewport]","{loadingHint}":"[data-textboxlist-autocomplete-loading]","{emptyHint}":"[data-textboxlist-autocomplete-empty]"}},function(c,d){return{init:function(){if(!c.element.data(c.Class.fullName))return c.destroy(),c.view.menu().attr("id",d.id).addClass(d.component).addClass(d.modifier).addClass(d.shadow?"has-shadow":"").addClass(d.animation?"has-animation":"").addClass(d.sticky?"is-sticky":"").addClass(c.textboxlist.options.component).appendTo("body").data(c.Class.fullName,!0).addController(c.Class,c.options),void 0;
var a=c.textboxlist;a.autocomplete=c,a.pluginInstances.autocomplete=c,c.options.position.of=c.textboxlist.element,c.initQuery(),c.view.loadingHint().appendTo(c.loadingHint()),c.view.emptyHint().appendTo(c.emptyHint()),c.element.detach()},initQuery:function(){var b=c.options.query||c.textboxlist.element.data("query");if(a.isUrl(b)){var d=b;return c.query=function(b){return a.ajax(d+b)},void 0}if(a.isFunction(b)){var e=b;return c.query=function(a){return e.call(c,a)},void 0}if(a.isArray(b)){var f=b;return c.query=function(b){var c=a.Deferred(),b=b.toLowerCase();
return setTimeout(function(){var d=a.grep(f,function(a){return a.title.toLowerCase().indexOf(b)>-1});c.resolve(d)},0),c},void 0}},setLayout:function(){c.hidden||c.element.css({opacity:1,width:c.textboxlist.element.outerWidth()}).position(c.options.position)},"{window} resize":a.debounce(function(){c.element.css("opacity",0),c.setLayout()},250),"{window} scroll":a.debounce(function(){c.element.css("opacity",0),c.setLayout()},250),"{window} dialogTransitionStart":function(){c.hidden=!0,c.element.css("opacity",0)
},"{window} dialogTransitionEnd":function(){c.hidden=!1,c.setLayout()},show:function(){clearTimeout(c.sleep),c.element.appendTo("body").show(),c.hidden=!1,c.setLayout()},hide:function(){c.element.hide();var b=c.menuItem(),d=b.filter(".active");d.length>0&&(c.lastItem={keyword:a.trim(c.textboxlist.textField().val()),item:d.data("item")}),b.removeClass("active"),c.render.reset(),c.hidden=!0,clearTimeout(c.sleep),c.sleep=setTimeout(function(){c.element.detach()},3e3)},queries:{},populated:!1,populate:function(b){c.populated=!1;
var d=c.element,e=c.options;d.removeClass("loading empty"),e.showLoadingHint&&c.hide();var f=c.trigger("populateKeyword",[b]);f.keyword&&(b=f.keyword);var g=e.caseSensitive?b:b.toLowerCase(),h=c.queries[g],i=!a.isDeferred(h)||!c.options.cache,j=function(){e.showLoadingHint&&(d.addClass("loading"),c.show()),(i||!i&&"rejected"==h.state())&&(h=c.queries[g]=c.query(b)),h.done(c.render(function(a){return[a,b]})).fail(function(){c.hide()}).always(function(){d.removeClass("loading")}),c.trigger("queryKeyword",[h,b])
};i?(clearTimeout(c.queryTask),c.queryTask=setTimeout(j,250)):j()},populateTask:null,populateFromTextField:function(){clearTimeout(c.populateTask),c.populateTask=setTimeout(function(){var b=c.textboxlist.textField(),d=a.trim(b.val());""===d||d.length<c.options.minLength?c.hide():c.populate(d)},1)},render:a.Enqueue(function(b,d){a.isArray(b)||(b=[]);var e=c.textboxlist,f=c,g=c.element,h=c.options,i=c.menu();if(b.length<1)return h.showEmptyHint?(i.empty(),g.addClass("empty"),e.trigger("renderMenu",[i,f,e]),c.show()):c.hide(),void 0;
g.removeClass("empty"),h.cache&&i.data("keyword")===d||(i.empty(),a.each(b,function(b,g){if(!a.isPlainObject(g))var g={html:g};e.trigger("filterItem",[g,f,e]);var j=h.filterItem;if(a.isFunction(j)&&(g=j.call(c,g,d)),a.isPlainObject(g)&&!g.discard){var k=g.menuHtml||g.title;c.view.menuItem({html:k}).addClass(g.className||"").data("item",g).appendTo(i)}}),i.data("keyword",d));var j=c.menuItem();return e.trigger("filterMenu",[i,j,f,e]),j.filter(":not(.hidden)").length<1&&(g.addClass("empty"),!h.showEmptyHint)?c.hide():(h.exclusive&&c.menuItem(":not(.hidden):first").addClass("active"),e.trigger("renderMenu",[i,f,e]),c.show(),void 0)
}),"{textboxlist.textField} keydown":function(a,d){clearTimeout(c.sleep);var e=c.menuItem(".active:not(.hidden)");e.length<1&&(e=!1);c.textboxlist.textField();switch(d.keyCode){case b.UP:c.menuItem().removeClass("active"),e?e.prev(c.menuItem.selector+":not(.hidden)").addClass("active"):c.menuItem(":not(.hidden):last").addClass("active"),d.preventDefault();break;case b.DOWN:c.menuItem().removeClass("active"),e?e.next(c.menuItem.selector+":not(.hidden)").addClass("active"):c.menuItem(":not(.hidden):first").addClass("active"),d.preventDefault();
break;case b.ESCAPE:c.hide();break;case b.ENTER:break;default:c.populateFromTextField()}var e=c.menuItem(".active:not(.hidden)");e.length<1||c.viewport().scrollIntoView(e)},"{textboxlist} textboxlistActivate":function(){c.populateFromTextField()},"{textboxlist} textboxlistDeactivate":function(){setTimeout(function(){c.hide()},150)},"{textboxlist} destroyed":function(){c.element.remove()},"{textboxlist} useItem":function(a,b,d){var e=c.options.exclusive;if(e&&(b.item=!1),c.hidden){var f=c.lastItem;return e&&f&&f.keyword==d&&(b.item=f.item),void 0
}var g=c.menuItem(".active");if(g.length>0){var h=g.data("item");b.item=h}c.hide()},"{menuItem} mousedown":function(){c.textboxlist.focusing=!0},"{menuItem} mouseup":function(){c.textboxlist.focusing=!1},"{menuItem} click":function(a){c.hide();var b=a.data("item");c.textboxlist.addItem(b);var d=c.textboxlist.textField().val("");setTimeout(function(){d.focus()},150)},"{menuItem} mouseover":function(a){c.menuItem().removeClass("active"),a.addClass("active")},"{menuItem} mouseout":function(){c.menuItem().removeClass("active")
}}})};c(),b.resolveWith(c)})};FD50.module("textboxlist",a)}()}),FD50.installer("EasyBlog","definitions",function(a){a.module(["easyblog/shared/comparison","easyblog/shared/datetime","easyblog/shared/gallery","easyblog/shared/mobile","easyblog/shared/nearest","easyblog/shared/toggler","easyblog/shared/usertags","easyblog/composer/blocks","easyblog/composer/blocks/dimensions","easyblog/composer/blocks/droppable","easyblog/composer/blocks/font","easyblog/composer/blocks/guide","easyblog/composer/blocks/handlers/accordion","easyblog/composer/blocks/handlers/audio","easyblog/composer/blocks/handlers/behance","easyblog/composer/blocks/handlers/buttons","easyblog/composer/blocks/handlers/code","easyblog/composer/blocks/handlers/codepen","easyblog/composer/blocks/handlers/columns","easyblog/composer/blocks/handlers/compare","easyblog/composer/blocks/handlers/comparison","easyblog/composer/blocks/handlers/dailymotion","easyblog/composer/blocks/handlers/facebook","easyblog/composer/blocks/handlers/file","easyblog/composer/blocks/handlers/gallery","easyblog/composer/blocks/handlers/gist","easyblog/composer/blocks/handlers/heading","easyblog/composer/blocks/handlers/html","easyblog/composer/blocks/handlers/image","easyblog/composer/blocks/handlers/instagram","easyblog/composer/blocks/handlers/links","easyblog/composer/blocks/handlers/liveleak","easyblog/composer/blocks/handlers/livestream","easyblog/composer/blocks/handlers/metacafe","easyblog/composer/blocks/handlers/module","easyblog/composer/blocks/handlers/mtv","easyblog/composer/blocks/handlers/note","easyblog/composer/blocks/handlers/pagebreak","easyblog/composer/blocks/handlers/pdf","easyblog/composer/blocks/handlers/pinterest","easyblog/composer/blocks/handlers/post","easyblog/composer/blocks/handlers/quotes","easyblog/composer/blocks/handlers/readmore","easyblog/composer/blocks/handlers/rule","easyblog/composer/blocks/handlers/section","easyblog/composer/blocks/handlers/sendy","easyblog/composer/blocks/handlers/slideshare","easyblog/composer/blocks/handlers/soundcloud","easyblog/composer/blocks/handlers/spotify","easyblog/composer/blocks/handlers/table","easyblog/composer/blocks/handlers/tabs","easyblog/composer/blocks/handlers/ted","easyblog/composer/blocks/handlers/text","easyblog/composer/blocks/handlers/thumbnails","easyblog/composer/blocks/handlers/tweet","easyblog/composer/blocks/handlers/video","easyblog/composer/blocks/handlers/vimeo","easyblog/composer/blocks/handlers/youtube","easyblog/composer/blocks/mobile","easyblog/composer/blocks/nestable","easyblog/composer/blocks/panel","easyblog/composer/blocks/removal","easyblog/composer/blocks/resizable","easyblog/composer/blocks/scrollable","easyblog/composer/blocks/search","easyblog/composer/blocks/text","easyblog/composer/blocks/toolbar","easyblog/composer/blocks/tree","easyblog/composer/category","easyblog/composer/composer","easyblog/composer/document","easyblog/composer/document/cover","easyblog/composer/document/maps","easyblog/composer/document/osm","easyblog/composer/document/overlay","easyblog/composer/document/permalink","easyblog/composer/document/toolbar","easyblog/composer/layout/elements","easyblog/composer/media","easyblog/composer/media/uploader","easyblog/composer/mobile","easyblog/composer/panels","easyblog/composer/panels/association","easyblog/composer/panels/authorship","easyblog/composer/panels/autopost","easyblog/composer/panels/category","easyblog/composer/panels/post","easyblog/composer/panels/seo","easyblog/composer/posts","easyblog/composer/revisions","easyblog/composer/shortcuts","easyblog/composer/tags","easyblog/composer/templates","easyblog/composer/vendors/colorpicker","easyblog/composer/vendors/expanding","easyblog/composer/vendors/history","easyblog/composer/vendors/nearest","easyblog/composer/vendors/nouislider","easyblog/composer/vendors/redactor10","easyblog/composer/vendors/scrolly","easyblog/composer/vendors/selectionchange"])
}),FD50.installer("EasyBlog","scripts",function($){EasyBlog.module("shared/comparison",function(){var b=this;EasyBlog.require().script("shared/mobile").done(function(a){a.fn.comparison=function(){function f(b){b.each(function(){var b=a(this);b.addClass("is-visible")}),c=!1}function g(b){b.each(function(){var b=a(this);j(b.find('.cd-image-label[data-type="modified"]'),b.find(".cd-resize-img"),"left"),j(b.find('.cd-image-label[data-type="original"]'),b.find(".cd-resize-img"),"right")}),d=!1}function h(a,c,d,e,f){a.on("mousedown vmousedown",function(g){a.addClass("draggable"),c.addClass("resizable");
var h=a.outerWidth(),j=a.offset().left+h-g.pageX,k=d.offset().left,l=d.outerWidth(),m=k+10,n=k+l-h-10;a.parents().on("mousemove vmousemove",function(a){b||(b=!0,window.requestAnimationFrame?requestAnimationFrame(function(){i(a,j,h,m,n,k,l,c,e,f)}):setTimeout(function(){i(a,j,h,m,n,k,l,c,e,f)},100))}).on("mouseup vmouseup",function(){a.removeClass("draggable"),c.removeClass("resizable")}),g.preventDefault()}).on("mouseup vmouseup",function(){a.removeClass("draggable"),c.removeClass("resizable")})}function i(c,d,e,f,g,h,i,k,l,m){var n=c.pageX+d-e;
f>n?n=f:n>g&&(n=g);var o=100*(n+e/2-h)/i+"%";a(".draggable").css("left",o).on("mouseup vmouseup",function(){a(this).removeClass("draggable"),k.removeClass("resizable")}),a(".resizable").css("width",o),j(m,k,"left"),j(l,k,"right"),b=!1}function j(a,b,c){"left"==c?a.offset().left+a.outerWidth()<b.offset().left+b.outerWidth()?a.removeClass("is-hidden"):a.addClass("is-hidden"):a.offset().left>b.offset().left+b.outerWidth()?a.removeClass("is-hidden"):a.addClass("is-hidden")}var b=!1,c=!1,d=!1,e=a(this).find("> figure.cd-image-container");
f(e),a(window).on("scroll",function(){c||(c=!0,window.requestAnimationFrame?requestAnimationFrame(function(){f(e)}):setTimeout(function(){f(e)},100))}),e.each(function(){var b=a(this);h(b.find(".cd-handle"),b.find(".cd-resize-img"),b,b.find('.cd-image-label[data-type="original"]'),b.find('.cd-image-label[data-type="modified"]'))}),a(window).on("resize",function(){d||(d=!0,window.requestAnimationFrame?requestAnimationFrame(function(){g(e)}):setTimeout(function(){g(e)},100))})},b.resolve()})}),EasyBlog.module("shared/datetime",function(){var b=this;
EasyBlog.require().library("datetimepicker","moment").done(function(a){EasyBlog.Controller("Post.Datetime",{defaultOptions:{format:"Do MMM, YYYY HH:mm",language:"en",originalValue:"","{preview}":"[data-preview]","{calendar}":"[data-calendar]","{cancel}":"[data-cancel]","{remove}":"[data-remove]","{datetime}":"[data-datetime]"}},function(b,c){return{init:function(){b.calendar()._datetimepicker({component:"eb",format:c.format,language:c.language,minDate:c.minDate}),b.datetimepicker=b.calendar().data("DateTimePicker"),c.originalValue=b.datetime().val(),a.isEmpty(c.originalValue)||b.datetimepicker.setDate(a.moment(c.originalValue)),a.isEmpty(c.originalValue)||"publish_down"!=b.datetime().attr("name")||b.remove().show()
},"{calendar} dp.change":function(a,d){b.preview().text(d.date.format(c.format)),d.date.lang("en");var e=d.date.format("YYYY-MM-DD HH:mm:ss");b.datetime().val(e),d.date.lang(c.language);var e=d.date.format("YYYY-MM-DD HH:mm:ss");b.toggleCancelButton()},"{cancel} click":function(){var d=a.isEmpty(c.originalValue);d||"0000-00-00 00:00:00"==c.originalValue?(b.preview().text(c.emptyText),b.datetime().val("")):b.datetimepicker.setDate(a.moment(c.originalValue)),b.toggleCancelButton()},"{remove} click":function(){var d=a.isEmpty(c.originalValue);
d||(b.preview().text(c.emptyText),b.datetime().val("0000-00-00 00:00:00")),b.remove().hide()},toggleCancelButton:function(){b.cancel()[b.datetime().val()==c.originalValue?"hide":"show"]()}}}),b.resolve()})}),EasyBlog.module("shared/gallery",function(a){var b=this,c=".eb-gallery",d=".eb-gallery-viewport",e=".eb-gallery-item",g=".eb-gallery-next-button",i=".eb-gallery-button",k=".eb-gallery-menu-item",l=EasyBlog.ImageGallery={setLayout:function(b){var c=b.find(e);c.each(function(b){var c=a(this),d=100*b,e="rtl"==window.ezb.direction?"right":"left";
c.css(e,d+"%")});var d=b.data("autoplay");d&&this.autoplay.start(b)},autoplay:{start:function(a){var b=1e3*a.data("interval");l.autoplay.stop(a);var c=setTimeout(function(){l.next(a),l.autoplay.start(a)},b);a.data("timer",c)},stop:function(a){var b=a.data("timer");clearTimeout(b)}},checkAutoplay:function(a){var b=1e3*a.data("interval");this.stopMonitoringAutoplay(a),setTimeout(function(){l.next(a),l.startMonitoringAutoplay(a)},b)},go:function(a,b){var c=l.getMenuItems(a).length-1;0>b&&(b=c),b>c&&(b=0),l.setActiveIndex(a,b);
var e=a.find(d),f=-100*b,g="rtl"==window.ezb.direction?"right":"left";e.css(g,f+"%")},next:function(a){var b=l.getActiveIndex(a),c=b+1;l.go(a,c)},prev:function(a){var b=l.getActiveIndex(a),c=b-1;l.go(a,c)},setActiveIndex:function(a,b){var c=l.getMenuItems(a);c.removeClass("active").eq(b).addClass("active")},getActiveIndex:function(a){var b=l.getMenuItems(a),c=b.filter(".active").index();return 0>c&&(c=0),c},getMenuItems:function(a){return a.find(k)}};a(document).on("click.eb.gallery.button",i,function(){var d=a(this),e=d.closest(c);
if(!(e.length<1)){var f=d.is(g)?"next":"prev";l[f](e)}}).on("click.eb.gallery.menuItem",k,function(){var d=a(this),e=d.closest(c);if(!(e.length<1)){var f=e.find(k).index(d);l.go(e,f)}}).ready(function(){a(c).each(function(){var b=a(this);l.setLayout(b)})}),b.resolve()}),EasyBlog.module("shared/mobile",function(a){var b=this;!function(a,b,c){"function"==typeof define&&define.amd?define(["jquery"],function(d){return c(d,a,b),d.mobile}):c(a.jQuery,a,b)}(this,document,function(b,c,d){!function(a,b,c,d){function y(a){for(;a&&"undefined"!=typeof a.originalEvent;)a=a.originalEvent;
return a}function z(b,c){var f,g,i,k,l,m,n,o,p,e=b.type;if(b=a.Event(b),b.type=c,f=b.originalEvent,g=a.event.props,e.search(/^(mouse|click)/)>-1&&(g=j),f)for(n=g.length,k;n;)k=g[--n],b[k]=f[k];if(e.search(/mouse(down|up)|click/)>-1&&!b.which&&(b.which=1),-1!==e.search(/^touch/)&&(i=y(f),e=i.touches,l=i.changedTouches,m=e&&e.length?e[0]:l&&l.length?l[0]:d))for(o=0,p=h.length;p>o;o++)k=h[o],b[k]=m[k];return b}function A(b){for(var d,f,c={};b;){d=a.data(b,e);for(f in d)d[f]&&(c[f]=c.hasVirtualBinding=!0);b=b.parentNode
}return c}function B(b,c){for(var d;b;){if(d=a.data(b,e),d&&(!c||d[c]))return b;b=b.parentNode}return null}function C(){r=!1}function D(){r=!0}function E(){v=0,p.length=0,q=!1,D()}function F(){C()}function G(){H(),l=setTimeout(function(){l=0,E()},a.vmouse.resetTimerDuration)}function H(){l&&(clearTimeout(l),l=0)}function I(b,c,d){var e;return(d&&d[b]||!d&&B(c.target,b))&&(e=z(c,b),a(c.target).trigger(e)),e}function J(b){var d,c=a.data(b.target,f);q||v&&v===c||(d=I("v"+b.type,b),d&&(d.isDefaultPrevented()&&b.preventDefault(),d.isPropagationStopped()&&b.stopPropagation(),d.isImmediatePropagationStopped()&&b.stopImmediatePropagation()))
}function K(b){var d,e,g,c=y(b).touches;c&&1===c.length&&(d=b.target,e=A(d),e.hasVirtualBinding&&(v=u++,a.data(d,f,v),H(),F(),o=!1,g=y(b).touches[0],m=g.pageX,n=g.pageY,I("vmouseover",b,e),I("vmousedown",b,e)))}function L(a){r||(o||I("vmousecancel",a,A(a.target)),o=!0,G())}function M(b){if(!r){var c=y(b).touches[0],d=o,e=a.vmouse.moveDistanceThreshold,f=A(b.target);o=o||Math.abs(c.pageX-m)>e||Math.abs(c.pageY-n)>e,o&&!d&&I("vmousecancel",b,f),I("vmousemove",b,f),G()}}function N(a){if(!r){D();var c,d,b=A(a.target);
I("vmouseup",a,b),o||(c=I("vclick",a,b),c&&c.isDefaultPrevented()&&(d=y(a).changedTouches[0],p.push({touchID:v,x:d.clientX,y:d.clientY}),q=!0)),I("vmouseout",a,b),o=!1,G()}}function O(b){var d,c=a.data(b,e);if(c)for(d in c)if(c[d])return!0;return!1}function P(){}function Q(b){var c=b.substr(1);return{setup:function(){O(this)||a.data(this,e,{});var d=a.data(this,e);d[b]=!0,k[b]=(k[b]||0)+1,1===k[b]&&t.bind(c,J),a(this).bind(c,P),s&&(k.touchstart=(k.touchstart||0)+1,1===k.touchstart&&t.bind("touchstart",K).bind("touchend",N).bind("touchmove",M).bind("scroll",L))
},teardown:function(){--k[b],k[b]||t.unbind(c,J),s&&(--k.touchstart,k.touchstart||t.unbind("touchstart",K).unbind("touchmove",M).unbind("touchend",N).unbind("scroll",L));var d=a(this),f=a.data(this,e);f&&(f[b]=!1),d.unbind(c,P),O(this)||d.removeData(e)}}}a.event.props==d&&(a.event.props=[]);var w,x,e="virtualMouseBindings",f="virtualTouchID",g="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),h="clientX clientY pageX pageY screenX screenY".split(" "),i=a.event.mouseHooks?a.event.mouseHooks.props:[],j=a.event.props.concat(i),k={},l=0,m=0,n=0,o=!1,p=[],q=!1,r=!1,s="addEventListener"in c,t=a(c),u=1,v=0;
for(a.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},x=0;x<g.length;x++)a.event.special[g[x]]=Q(g[x]);s&&c.addEventListener("click",function(b){var e,g,h,i,j,k,c=p.length,d=b.target;if(c)for(e=b.clientX,g=b.clientY,w=a.vmouse.clickDistanceThreshold,h=d;h;){for(i=0;c>i;i++)if(j=p[i],k=0,h===d&&Math.abs(j.x-e)<w&&Math.abs(j.y-g)<w||a.data(h,f)===j.touchID)return b.preventDefault(),b.stopPropagation(),void 0;h=h.parentNode}},!0)}(a,c,d)}),b.resolve()}),EasyBlog.module("shared/nearest",function(a){var b={left:[-1,0],up:[0,-1],right:[1,0],down:[0,1]};
a.distance=function(a,c,d){function e(a,b){return Math.floor(Math.sqrt(a*a+b*b))}d=b[d];var x,y,z,f=a.offset(),g=a.outerWidth(),h=a.outerHeight(),i=f.left,j=f.top,k=i+g,l=j+h,m=i+g/2,n=j+h/2,o=c.offset(),p=c.outerWidth(),q=c.outerHeight(),r=o.left,s=o.top,t=r+p,u=s+q,v=r+p/2,w=s+q/2;return 0==d[1]?(d[0]<0?(i>=t&&(y=i-t),i>=v&&(y=void 0!=y?Math.min(y,i-v):i-v),i>=t&&(y=void 0!=y?Math.min(y,i-t):i-t)):(r>=k&&(y=r-k),v>=k&&(y=void 0!=y?Math.min(y,v-k):v-k),r>i&&(y=void 0!=y?Math.min(y,r-i):r-i)),z=2*Math.min(Math.abs(n-s),Math.abs(n-w),Math.abs(n-u))):0==d[0]&&(d[1]<0?(j>=u&&(z=j-u),j>=w&&(z=void 0!=z?Math.min(z,j-w):j-w),j>=u&&(z=void 0!=z?Math.min(z,j-u):j-u)):(s>=l&&(z=s-l),w>=l&&(z=void 0!=z?Math.min(z,w-l):w-l),s>j&&(z=void 0!=z?Math.min(z,s-j):s-j)),y=2*Math.min(Math.abs(m-r),Math.abs(m-v),Math.abs(m-t))),x=void 0==y||void 0==z?-1:e(y,z)
},a.fn.nearest=function(b,c){for(var e,g,d=this,f=a(),h=null,i=-1,j=b.length;++i<j;)e=a(b[i]),d[0]!=e[0]&&(g=a.distance(d,e,c),g>=0&&(null===h||h>g)&&(h=g,f=e));return f},this.resolve()}),EasyBlog.module("shared/toggler",function(a){var b=this;a(document).on("change.form.toggler","[data-eb-toggler-checkbox]",function(){var b=a(this),c=b.is(":checked"),d=b.parents("[data-eb-toggler]");if(d.length>0){var e=d.find("input[type=hidden]");e.val(c?1:0).trigger("change")}}),a(document).on("change.form.toggler.value","[data-eb-toggler-checkbox] ~ input[type=hidden]",function(){var b=a(this),c=b.val(),d=1==c?!0:!1,e=b.siblings("[data-eb-toggler-checkbox]"),f=e.is(":checked");
return d&&!f?(e.prop("checked",!0),void 0):!d&&f?(e.prop("checked",!1),void 0):void 0}),b.resolve()}),EasyBlog.module("shared/usertags",function(a){var b=this,c={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38},d={38:"up",40:"down",37:"left",39:"right"};EasyBlog.require().library("textboxlist").script("shared/nearest","admin/user/suggest").done(function(){EasyBlog.Controller("Html.Usertags",{defaultOptions:{templates:{},"{userTemplate}":"[data-usertags-template]",readonly:!1,"{usersForm}":"[data-eb-usertags]","{total}":"[data-eb-usertags-total]","{count}":"[data-eb-usertags-count]","{suggestions}":"[data-eb-usertags-suggestions]","{selection}":"[data-eb-usertags-selection]","{toggleButton}":"[data-eb-usertags-toggle-button]","{itemgroup}":"[data-eb-usertags-selection-itemgroup]","{item}":"[data-eb-usertags-selection-itemgroup] > div","{textfield}":"[data-textboxlist-textField]","{textboxlist}":"[data-eb-usertags-textboxlist]","{jsondata}":"[data-eb-usertags-jsondata]"}},function(b,e,f,g,h){return{init:function(){g=b.selection,suggestions=b.suggestions,h=b.taggers,a.template("textboxlist/item",b.userTemplate().detach().html());
var c=parseInt(b.usersForm().attr("data-eb-usertags-max"))||10,d=b.usersForm().attr("data-eb-usertags-fieldName").toString()||"item";b.textboxlist().textboxlist({name:d+"[]",component:"eb",max:c,ignoreLocked:!0,view:{item:"textboxlist/item"}}),h=b.taggers=a.extend(b.textboxlist().textboxlist("controller"),b.taggers);var e=JSON.parse(b.jsondata().val());for(i=0;i<e.length;i++)h.addItem({id:e[i].id,title:e[i].username,key:e[i].id,locked:!1});window.tagz=b},"{textfield} keydown":function(a,e){var f=e.which,h=g.activeItem;
switch(f){case c.UP:case c.DOWN:case c.LEFT:case c.RIGHT:var i=d[f];(h.length>0||"down"==i)&&(suggestions.navigate(i),e.preventDefault());break;case c.ESCAPE:h.length>0?g.deactivate(h):b.suggestions().hasClass("is-showing")?suggestions.collapse():a.val("");break;case c.ENTER:e.preventDefault();break;default:suggestions.populateFromTextfield()}},"{textboxlist} addItem":function(b,c,d){a(g.get(d.title)).addClass("is-used")},"{textboxlist} removeItem":function(b,c,d){d.assigned?tagger.addItem(d.title):a(g.get(d.title)).removeClass("is-used")
},"{textboxlist} listChange":a.debounce(function(){suggestions.refresh();var a=b.taggers.getAddedItems().length;b.count().text(a)},15),"{item} mouseover":function(a){g.deactivate(),g.activate(a)},"{item} mouseout":function(){g.deactivate()},"{item} click":function(a){g.use(a)},suggestions:{usertags:[],pid:0,tick:0,currentQuery:null,populateTimer:null,query:a.memoize(function(a){return EasyBlog.ajax("admin/views/bloggers/suggest",{search:a,max:parseInt(b.usersForm().attr("data-eb-usertags-max"))||10}).fail(function(){})
}),set:function(a){a.length<1?(suggestions.hide(),suggestions.usertags=[]):(suggestions.reset(),suggestions.usertags=a)},collapse:function(){suggestions.tick++,b.suggestions().removeClass("is-showing")},hide:function(){var a=++suggestions.tick;suggestions.collapse(),setTimeout(function(){a===suggestions.tick&&suggestions.reset()},500)},reset:function(){suggestions.usertags=[],suggestions.i=0,b.itemgroup().empty()},refresh:function(){var a=b.item(":not(.is-used)");b.suggestions().toggleClass("is-empty",a.length<1),suggestions.count()
},show:function(){suggestions.tick++,suggestions.refresh(),suggestions.expand()},expand:function(){suggestions.tick++,b.suggestions().addClass("is-showing")},count:function(){var c=a.pluck(suggestions.usertags,"name"),d=a.keys(h.itemsByTitle),e=a.without.apply(null,[c].concat(d)),f=e.length;b.total().text(f+"")},populateFromTextfield:function(){suggestions.tick++,clearTimeout(suggestions.populateTimer),setTimeout(function(){var a=b.textfield(),c=h.sanitize(a.val());""===c?(suggestions.hide(),suggestions.populate("",!0)):suggestions.query.cache.hasOwnProperty(c)?suggestions.populate(c):suggestions.populateTimer=setTimeout(function(){suggestions.populate(c)
},250)},1)},populate:function(a,c){suggestions.tick++;var d=++suggestions.pid;suggestions.currentQuery&&suggestions.currentQuery.abort(),a=h.sanitize(a),b.suggestions().addClass("is-busy"),suggestions.currentQuery=suggestions.query(a).done(function(a){suggestions.pid===d&&(suggestions.set(a),suggestions.suggest(c))}).fail(function(){suggestions.pid!==d}).always(function(){b.suggestions().removeClass("is-busy"),suggestions.currentQuery=null})},suggest:function(c){if(h.getAddedItems().length!=h.options.max){var d=suggestions.usertags;
if(!(d.length<1)){for(var i,l,e=0,f=d.length,k=[];f>e&&(i=d[suggestions.i]);)name=i.name,l=g.get(name)||g.create(i),k.push(l),h.get(name)?a(l).addClass("is-used"):e++,suggestions.i++;b.itemgroup().append(k),c?suggestions.refresh():suggestions.show()}}}},taggers:{sanitize:function(b){return a.trim(b).replace(/,/g,"")}},selection:{items:{},activeItem:a(),create:function(a){var b=document.createElement("div");return b.innerHTML=a.name,b.setAttribute("data-id",a.userId),g.items[a.name]=b},get:function(a){return g.items[a]
},activate:function(a){g.deactivate(),g.activeItem=a.addClass("active")},deactivate:function(){g.activeItem.removeClass("active"),g.activeItem=a()},use:function(c){var c=a(c),d=c.text(),e=c.data("id"),f=h.addItem({id:e,title:d,key:e,locked:!1});f&&(b.textfield().focus(),c.is(g.activeItem)&&(nextItem=c.next(b.item)[0]||c.prev(b.item)[0],g.deactivate(c),nextItem&&g.activate(a(nextItem))),suggestions.refresh(),b.textfield().val(""))}}}}),b.resolve()})}),EasyBlog.module("composer/blocks",function(a){var b=this,c="is-new",d="is-editable",e="is-receiving",f="is-dropping",g="is-releasing",h="is-refocusing",i="is-highlighting",j="is-sorting",k="is-sort-item",l="is-nested",m="is-dragging-block",n="is-dropping-block",o="is-inserting-block",p="is-selected",q="is-highlighting-block";
EasyBlog.require().library("ui/draggable","ui/position","image","scrollTo").script("composer/blocks/panel","composer/blocks/guide","composer/blocks/nestable","composer/blocks/droppable","composer/blocks/resizable","composer/blocks/scrollable","composer/blocks/font","composer/blocks/dimensions","composer/blocks/text","composer/blocks/removal","composer/blocks/tree","composer/blocks/search","composer/blocks/mobile","composer/blocks/toolbar").done(function(){EasyBlog.Controller("Composer.Blocks",{hostname:"blocks",pluginExtendsInstance:!0,elements:["[data-eb-composer-{blocks}]","[data-eb-composer-block-{menu|menu-group|meta}]","[data-eb-composer-{editor}]","[data-ebd-block-{viewport|content}]"],defaultOptions:a.extend({"{view}":"[data-eb-composer-blocks]","{editableContent}":EBD.editableContent,"{immediateBlockViewport}":EBD.immediateBlockViewport,"{immediateBlockContent}":EBD.immediateBlockContent,"{blockActions}":EBD.blockActions,"{sidebar}":"[data-eb-composer-blocks]","{mechswitch}":".mechswitch","{blockSection}":"[data-eb-composer-block-section]","{blockSectionHeader}":"[data-eb-composer-block-section-header]","{blockSectionHeaderIcon}":"[data-eb-composer-block-section-header] > [data-panel-icon]","{blockSectionContent}":"[data-eb-composer-block-section-content]","{searchInput}":"[data-eb-blocks-search]"},EBD.selectors)},function(b,r,s,t){return{init:function(){t=b.composer;
var c=["panel","guide","nestable","droppable","resizable","scrollable","font","dimensions","text","removal","tree","search","mobile","media","toolbar"];if("legacy"==t.getDoctype())var c=["panel","tree","dimensions","media"];a.each(c,function(a,c){b.addPlugin(c)});var d=["post","image","video","file","audio","pdf","gallery"];a.each(d,function(a,c){b.loadBlockHandler(c)})},browser:{highlightSearch:function(){b.searchInput().focus()},isOpen:function(){return t.manager().hasClass("is-composer-blocks-open")},isClosed:function(){return!t.browser.isOpen()
},open:function(){t.manager().addClass("is-composer-blocks-open"),b.browser.highlightSearch()},close:function(){t.manager().removeClass("is-composer-blocks-open")},toggle:function(){t.manager().toggleClass("is-composer-blocks-open"),t.manager().hasClass("is-composer-blocks-open")&&b.browser.highlightSearch()}},getAllBlocks:function(){return b.root().find(EBD.block)},getCurrentBlock:function(){return b.root().find(EBD.block+".active")},getNextBlock:function(){var a=b.getCurrentBlock(),c=a.next();return c.length<=0?!1:c
},getPreviousBlock:function(){var a=b.getCurrentBlock(),c=a.prev();return c.length<=0?!1:c},getParentBlock:function(b){return b.is(EBD.nestedBlock)?a(b).parents(EBD.block).eq(0):a()},getAllParentBlocks:function(a){return a.parentsUntil(EBD.root).filter(EBD.block)},getBlockTree:function(a){return b.getAllParentBlocks(a).add(b.root())},getRootBlocks:function(){return b.root().find(EBD.childBlock)},getChildBlocks:function(a){return a.is(EBD.root)?a.find(EBD.childBlock):a.find(EBD.nestedBlock+":not(.ebd-block[data-uid="+a.data("uid")+"] "+EBD.nest+" "+EBD.nest+" "+EBD.nestedBlock+")")
},getAllChildBlocks:function(a){return a.find(EBD.block)},getBlocksByType:function(a){return b.root().find(EBD.block+"[data-type="+a+"]")},getBlock:function(a){var b=s.find(EBD.block+"[data-uid="+a+"]");return b},getBlockUid:function(a){return a.attr("data-uid")||b.setBlockUid(a)},setBlockUid:function(b){return b.attr("data-uid")||function(){var c=a.uid();return b.attr("data-uid",c),c}()},updateBlockUid:function(a){a.removeAttr("data-uid"),b.setBlockUid(a)},getBlockType:function(b){return a(b).attr("data-type")
},metas:{},getBlockMeta:function(c){return c instanceof a&&(c=b.getBlockType(c)),b.metas[c]||function(){var a=b.meta().where("type",c).val();return a?b.metas[c]=JSON.parse(a):null}()},getBlockViewport:function(a){return b.immediateBlockViewport.inside(a)},getBlockContent:function(a){return b.immediateBlockContent.inside(a)},getBlockActions:function(a){return b.blockActions.inside(a)},setBlockContent:function(a,c){b.immediateBlockContent.inside(a).html(c.html())},getBlockFragment:function(c){var d=function(a){var c=b.getBlockType(a),d=b.getBlockHandler(c),e=b.createBlockContainer(c),f=d.toHTML(a);
return a.is(EBD.nested)&&a.addClass(l),e.append(f),e},e=d(c);return e.find(EBD.nestedBlock).each(function(){var b=a(this),c=d(b);b.replaceWith(c)}),e},getBlockHTML:function(a){return b.getBlockFragment(a).toHTML()},getBlockText:function(){},getBlockNest:function(a){return a.closest(EBD.nest)},getBlockNestType:function(a){return b.getBlockNest(a).data("type")},isBlock:function(a){return a.is(EBD.block)},isNestedBlock:function(a){return a.is(EBD.nestedBlock)},isRootBlock:function(a){return!b.isNestedBlock(a)},isStandaloneBlock:function(a){return a.is(EBD.standaloneBlock)
},restoreInlineBlockData:function(a){var c=a.next();if(c.is("textarea[data-block]")){var d=c.val(),e=JSON.parse(d);b.dataset[b.getBlockUid(a)]=e,c.remove()}},initBlock:function(e){var f=arguments,g=b.getBlockType(e);b.setBlockUid(e),b.restoreInlineBlockData(e),b.loadBlockHandler(g).done(function(a){if(e.hasClass(c)){b.trigger("composerBlockBeforeAdd",f);try{a.reset(e),a.reconstruct(e)}catch(h){EasyBlog.debug&&console.error("Error initializing new block of type '%s'.",g,h)}b.trigger("composerBlockAdd",f),b.release(e),e.removeClass(c).addClass(d),b.trigger("composerBlockInit",f)
}else if(!e.hasClass(d)){try{a.reconstruct(e)}catch(h){EasyBlog.debug&&console.error("Error initializing existing block of type '%s'.",g,h)}e.addClass(d),b.trigger("composerBlockInit",f)}}),b.getChildBlocks(e).each(function(){var c=a(this);b.initBlock(c)})},createBlockContainer:function(c){var e=(b.getBlockMeta(c),a(a("[data-eb-block-template]").clone().html()));return e.attr("data-type",c),e},createBlock:function(c){var d=b.getBlockMeta(c);if(d){var e=a(d.block);return b.setBlockUid(e),b.trigger("composerBlockCreate",[e,d]),e
}},createBlockFromMenu:function(a){var d=a.attr("data-type"),e=b.createBlock(d).addClass(c);return e},createBlockFromMediaFile:function(a){var c=a.data("type"),d=b.getBlockHandler(c),e=d.constructFromMediaFile(a);return e},constructBlock:function(a,c){var d=b.getBlockHandler(a),e=d.construct(c);return b.setBlockUid(e),b.trigger("composerBlockConstruct",[e]),e},constructNestedBlock:function(a,c){var d=b.constructBlock(a,c);return d.addClass(l),d},constructIsolatedBlock:function(a,c){var d=b.constructBlock(a,c);
return d.addClass(l).addClass(isIsolated),d},createBlockNest:function(){return a('<div class="ebd-nest" data-type="block">')},createContentNest:function(b){var c=a('<div class="ebd-nest" data-type="content">'),d={editable:!0},b=a.extend(d,b);return b.editable&&c.editable(!0),c},exportBlock:function(a){var c=b.getBlockUid(a),d=b.getBlockType(a),e=b.getBlockHandler(d),f=a.is(EBD.nestedBlock),g=a.is(EBD.isolatedBlock),h={uid:c,type:d,html:"",data:{},blocks:[],nested:f,isolated:g,style:a.attr("style")};if(EasyBlog.debug&&b.verifyBlockHandler(e,["toData","toText","toHTML"]),e.toData&&(h.data=e.toData(a)||{}),e.toText&&(h.text=e.toText(a)||""),e.toHTML&&(h.html=e.toHTML(a)||""),e.toEditableHTML)h.editableHtml=e.toEditableHTML(a)||"";
else{var i=blocks.getBlockContent(a);h.editableHtml=i.html()}return b.trigger("composerBlockExport",[a,h]),h},addBlock:function(a){b.root().append(a),b.initBlock(a)},removeBlock:function(c,d){d||(d={}),b.trigger("composerBlockBeforeRemove",[c,d]),c.find(EBD.nestedBlock).each(function(){var c=a(this);b.removeBlock(c,d)}),c.remove(),b.trigger("composerBlockRemove",[c,d])},scrollIntoView:function(a){t.viewport();t.viewportContent().stop(!0).scrollIntoView(a)},scrollTo:function(a,b){b||(b=500);var c=t.viewport();
t.viewportContent().stop(!0).scrollTo(a,b,{axis:"y",offset:{top:(c.height()-a.height())/-2,left:0}})},blockHandlers:{},loadBlockHandler:a.memoize(function(c){if(!c)return a.Deferred().reject(a.Exception("Invalid block type given."));var d=b.getBlockMeta(c);if(!d)return a.Deferred().reject(a.Exception("Block of type '"+c+"' is not installed!"));var e=a.Deferred();return EasyBlog.require().script("composer/blocks/handlers/"+c).done(function(){var f="handler/"+c,g="EasyBlog.Controller.Composer.Blocks.Handlers."+a.String.capitalize(c),h={meta:d},i=b.addPlugin(f,g,h);
b.blockHandlers[c]=i,EasyBlog.debug&&b.verifyBlockHandler(i),e.resolve(i,d)}).fail(function(){b.loadBlockHandler.reset(c),e.reject(a.Exception("Could not load block handler for "+c+"."))}),e}),getBlockHandler:function(c){return c instanceof a&&(c=b.getBlockType(c)),b.blockHandlers[c]},verifyBlockHandler:function(b,c){for(var d,c=c||["activate","deactivate","construct","reconstruct","deconstruct","refocus","reset","populate","toHTML","toData","toText"],e=[];d=c.shift();)a.isFunction(b[d])||e.push(d);e.length>0&&console.warn("Block handler of type '%s' is missing the following method: %s.",b.options.meta.type,e.join(", "))
},activateBlock:function(a){if(!b.workarea().hasClass("is-removing")){b.deactivateBlock(),b.browser.close(),b.menu().removeClass(p);var c=b.getBlockType(a);b.loadBlockHandler(c).done(function(c){var d=[a,c];b.trigger("composerBlockBeforeActivate",d),b.initBlock(a),c.activate&&c.activate(a),c.refocus(a),b.trigger("composerBlockActivate",d)}).fail(function(a){b.trigger("composerBlockActivateError",[a])})}},deactivateBlock:function(a){if(a=a||b.getCurrentBlock(),a.length){var c=b.getBlockHandler(a);c&&c.deactivate&&c.deactivate(a),b.trigger("composerBlockDeactivate",[a,c])
}},getBlocksBrowserState:function(){var c=b.blockSection(),d={};return c.each(function(b,c){var c=a(c),e=c.data("id");d[e]=c.hasClass("is-open")?"open":"close"}),d},"{blockSectionHeader} click":function(a){var c=a.parent(b.blockSection.selector);c.toggleClass("is-open");var d=b.getBlocksBrowserState();EasyBlog.ajax("site/views/composer/saveUserBlocksParams",{preferences:d})},"{menu} mouseover":function(c){if(!c.data("uiDraggable")){var d=c.clone();d.find(b.meta.selector).remove();var e=a("html").attr("dir"),f="ltr"==e?{right:165}:{left:165};
c.draggable({helper:function(){return d.css({width:c.outerWidth(),height:c.outerHeight()})},cursorAt:f,appendTo:t.document.ghosts(),connectToSortable:EBD.root})}},selectBlock:function(a){b.menu().removeClass(p);var c=t.manager().hasClass(n),d=t.manager().hasClass(o);return d?(b.addToNextPosition(a),void 0):(a.addClass(p),t.manager().addClass(n),b.trigger("composerBlockMenuSelected",[a]),c||t.blocks.droppable.populateDropzones(),void 0)},addToNextPosition:function(a){var c=b.getCurrentBlock(),d=a,e=d.is(b.menu);
e&&(block=b.createBlockFromMenu(d)),c.after(block),b.drop(block),b.release(block),b.out(block),t.manager().removeClass(o),t.blocks.browser.close()},"{menu} touchend":function(){},"{menu} touchstart":function(){},"{menu} click":function(a){b.selectBlock(a)},"{menu} dragstart":function(a){b.drag(a),t.manager().addClass(m),b.view().parent().removeClass("open"),t.views.hide("blocks")},"{menu} dragstop":function(a){b.release(a),t.manager().removeClass(m)},"{menu} dblclick":function(){},drag:function(a){b.workarea().addClass(j),a.is(b.menu)||(a.addClass(k),b.browser.close(),t.editor.selection.remove(),b.trigger("composerBlockDrag",[a]))
},drop:function(a){a.is(b.menu)||(b.trigger("composerBlockBeforeDrop",[a]),a.addClass(f),b.trigger("composerBlockDrop",[a]),b.activateBlock(a))},release:function(a){b.workarea().removeClass(j),a.is(b.menu)||(a.removeClass(f).addClass(g).removeClassAfter(g+" "+k),b.trigger("composerBlockBeforeRelease",[a]),setTimeout(function(){b.trigger("composerBlockRelease",[a])},1e3))},over:function(a){a.addClass(e),a.hasClass(l)&&b.nest.of(a).addClass(e),b.block.of(a).addClass(e)},out:function(a){a.removeClass(e),a.hasClass(l)&&b.nest.of(a).removeClass(e),b.block.of(a).removeClass(e)
},highlight:function(a){b.root().addClass(q),a.addClass(i)},unhighlight:function(a){b.root().removeClass(q),a.removeClass(i)},dataset:{},"{block} click":function(a,c){c.clickHandled||b.refocusing||b.workarea().hasClass("is-resizing")||(c.clickHandled=!0,a.is(b.menu)||a.hasClass("active")||b.activateBlock(a))},data:function(c,d){if(void 0===c)return b.dataset;var f=parseInt(c);isNaN(f)?f=b.getBlockUid(c):c=b.getBlock(f);var g=b.getBlockHandler(b.getBlockType(c)),h=blocks.getBlockMeta(c),i=b.dataset[f];return void 0==b.getBlockType(c)?b.dataset:(b.dataset[f]=g.normalize?g.normalize(i):a.extend({},h.data,i),0==arguments.length||1==arguments.length||2==arguments.length&&a.isString(d)?b.getData(c,d):b.setData.apply(b,arguments))
},getData:function(a,c){var d=b.dataset;if(void 0===a)return d;var e=parseInt(a);isNaN(e)?e=b.getBlockUid(a):a=b.getBlock(a);var f=d[e];return void 0===c?f:f[c]},duplicateChildBlocksData:function(c,d){var e=b.getChildBlocks(d);e&&a.each(e,function(d,e){var e=a(e),f=b.getBlockUid(e),g=b.data(e),h=c.find("[data-uid="+f+"]");b.updateBlockUid(h);var i=a.extend(!0,{},g);b.setBlockData(h,i)})},setBlockData:function(a,c){uid=b.getBlockUid(a),b.dataset[uid]=c},setData:function(c,d,e){if(void 0===c)return b.dataset;var f=parseInt(c);
return isNaN(f)?f=b.getBlockUid(c):c=b.getBlock(c),a.isPlainObject(d)&&void 0===e?a.extend(b.dataset[f],d):b.dataset[f][d]=e},getMechanics:function(){return t.settings.get("blocks.mechanics")},setMechanics:function(a){t.settings.set("blocks.mechanics",a),b.trigger("composerBlockMechanicsChange",a)},"{mechswitch} click":function(a){b.mechswitch().removeClass("btn-primary"),a.addClass("btn-primary"),b.setMechanics(a.attr("data-value"))},"{block} mouseover":function(a,c){c.hovered||(c.hovered=!0,b.trigger("composerBlockHoverIn",[a]))
},"{block} mouseout":function(a){b.trigger("composerBlockHoverOut",[a])},"{self} composerDocumentInit":function(){var c=b.getAllBlocks();c.each(function(){{var c=a(this);b.getBlockType(c)}b.initBlock(c)})},"{self} composerDocumentBlur":function(){return b.refocusing?(b.refocusing=!1,void 0):(b.deactivateBlock(),void 0)},"{self} click":function(c,d){var e=b.view().parent().hasClass("open");if(e){var f=a(d.target);f.is("[data-toolbar-blocks]")||f.parents("[data-eb-composer-blocks]").length>0||b.view().parent().removeClass("open")
}},"{self} keyup":function(a,c){var d=b.view().parent().hasClass("open");d&&27==c.keyCode&&b.view().parent().removeClass("open")},"{editableContent} focusin":function(a,c){c.focusHandled||b.refocusing||t.document.isLegacy()||(b.refocusing=!0,c.focusHandled=!0,setTimeout(function(){var c=(b.workarea(),t.editor.selection.get()),d=c.focusNode;if(!d)return b.refocusing=!1,void 0;var e=b.block.of(d);if(!e.length)return b.refocusing=!1,void 0;if(!e.hasClass(h)){e.addClass(h);try{if(e.hasClass("active")){var f=b.getBlockHandler(e);
f.refocus(e)}else b.activateBlock(e)}catch(g){}e.removeClass(h),setTimeout(function(){b.refocusing=!1},100)}},1))}}}),b.resolve()})}),EasyBlog.module("composer/blocks/dimensions",function(){var b=this,c=function(a){return a.toString().match("%")?"%":"px"};EasyBlog.require().script("composer/vendors/nouislider").done(function(a){EasyBlog.Controller("Composer.Blocks.Dimensions",{elements:["[data-eb-block-dimensions-{field}]","[data-eb-block-dimensions-field-container] [data-eb-{numslider-toggle|numslider-widget|numslider-value|numslider-input|numslider-units|numslider-unit|numslider-current-unit}]"],defaultOptions:a.extend({},EBD.selectors)},function(b,d,e,f,g,h){return{init:function(){g=b.blocks,f=g.composer,h=a()
},"{self} composerBlockActivate":function(a,c,d){h=d,b.populate(d)},isResizableNestedBlock:function(a){return g.isNestedBlock(a)?"content"==g.getBlockNestType(a):!1},allowDimensionsFieldset:function(a){return b.isResizableNestedBlock(a)&&b.getDimensionsSettings(a).enabled},getDimensionsSettings:function(a){return g.getBlockMeta(a).dimensions},getDimensionsFieldset:function(){return f.panels.fieldset.get("dimensions")},shouldRespectMinContentSize:function(a){return b.isResizableNestedBlock(a)&&b.getDimensionsSettings(a).respectMinContentSize
},isInherited:function(a){return!a||/auto|inherit/.test(a)},hasInheritedSize:function(a,c){var d=a[0].style[c];return b.isInherited(d)},hasInheritedWidth:function(a){return b.hasInheritedSize(a,"width")},hasInheritedHeight:function(a){return b.hasInheritedSize(a,"height")},getSize:function(a,c){var d=a[0].style[c];return b.isInherited(d)?a.css(c):d},getWidth:function(a){return b.getSize(a,"width")},getHeight:function(a){return b.getSize(a,"height")},getComputedWidth:function(a){return a.width()},getComputedHeight:function(a){return a.height()
},setWidth:function(a,b){a.css("width",b)},setHeight:function(a,b){a.css("height",b)},updateWidth:function(a,c){b.setWidth(a,c),b.populateWidth(a)},updateHeight:function(a,c){b.setHeight(a,c),b.populateHeight(a)},getFluidWidth:function(b){var c=a(g.getBlockNest(b)[0]||b.parent()[0]),d=Math.round(b.width()/c.width()*100)+"%";return d},toFluidWidth:function(a){if(!g.isRootBlock(a)){var c=b.getFluidWidth(a);b.updateWidth(a,c)}},toFluidHeight:function(a){b.updateHeight(a,"")},toFixedWidth:function(a){b.updateWidth(a,a.width())
},toFixedHeight:function(a){b.updateHeight(a,a.height())},toAutoWidth:function(a){b.updateWidth(a,"auto")},toAutoHeight:function(a){b.updateHeight(a,"")},setUnit:function(a,c,d){if("width"===c){var e=b.getUnit(a,c);"%"==e&&"px"==d&&b.toFixedWidth(a),"px"==e&&"%"==d&&b.toFluidWidth(a)}},getUnit:function(a,d){return c(b.getSize(a,d))},updateUnit:function(a,c,d){b.setUnit(a,c,d),"width"==c&&b.populateWidth(a),"height"==c&&b.populateHeight(a)},populate:function(a){var c=b.getDimensionsFieldset(),d=b.allowDimensionsFieldset(a);
c.toggle(d),d&&(b.populateWidth(a),b.populateHeight(a))},populateWidth:function(a){var c=b.getWidth(a),d=!b.hasInheritedWidth(a);b.populateField("width",c,d)},populateHeight:function(a){var c=b.getHeight(a),d=!b.hasInheritedHeight(a);b.populateField("height",c,d)},populateField:function(a,d,e){var f=b.field().where("name",a),g=parseFloat(d),h=c(d);if(b.numsliderToggle.inside(f).prop("checked",e),b.numsliderInput.inside(f).data("number",g).val(g),b.numsliderCurrentUnit.inside(f).html(h),b.numsliderUnit.inside(f).where("unit",'"'+h+'"').activateClass("active"),f.data("unit",h),b.resizingFromSlider!==a){if("px"==h)var i={start:g,step:1,range:{min:0,max:800},pips:{mode:"values",density:4,values:[0,200,400,600,800,1e3]}};
if("%"==h)var i={start:g,step:1,range:{min:0,max:100},pips:{mode:"positions",values:[0,20,40,60,80,100],density:5}};b.numsliderWidget.inside(f).find(".noUi-pips").remove().end().noUiSlider(i,!0).noUiSlider_pips(i.pips)}},handleNumsliderWidget:function(a,c){var d=b.workarea(),e=b.field.of(a),f=e.data("name"),g=e.data("unit"),i=Math.round(c)+g;b.resizingFromSlider=f,clearTimeout(b.resizingTimer),d.addClass("is-resizing"),"width"==f&&b.updateWidth(h,i),"height"==f&&b.updateHeight(h,i),b.resizingTimer=setTimeout(function(){d.removeClass("is-resizing")
},15),b.resizingFromSlider=null},"{numsliderWidget} nouislide":function(a,c,d){b.handleNumsliderWidget(a,d)},"{numsliderWidget} set":function(a,c,d){b.handleNumsliderWidget(a,d)},"{numsliderInput} input":function(c){function d(a){c.on("blur.numslider",function(){c.val(a)})}c.off("blur.numslider");var e=b.field.of(c),f=e.data("name"),g=a.trim(c.val()),i=b.numsliderUnit.inside(e),j=i.data("unit"),k=g+j;if(0==g||!a.isNumeric(g)){var l=c.data("number");return d(l)}"width"==f&&b.updateWidth(h,k),"height"==f&&b.updateHeight(h,k)
},"{numsliderUnit} click":function(a){var c=b.field.of(a),d=c.data("name"),e=a.data("unit");b.setUnit(h,d,e)},"{numsliderToggle} change":function(a){var c=b.field.of(a),d=c.data("name");a.is(":checked")||("width"==d&&b.toAutoWidth(h),"height"==d&&b.toAutoHeight(h))},"{self} composerBlockResize":function(a,c,d){b.populate(d)},"{self} composerBlockNestOut":function(a,b,c){c.css({width:"",height:""})}}}),b.resolve()})}),EasyBlog.module("composer/blocks/droppable",function(){var b=this,c="is-nested";EasyBlog.require().library("ui/draggable","ui/droppable").done(function(a){EasyBlog.Controller("Composer.Blocks.Droppable",{defaultOptions:a.extend({"{dropzones}":"[data-ebd-dropzone]","{dropzonePlaceholder}":"[data-ebd-dropzone-placeholder]","{mediaFile}":"[data-eb-mm-file]"},EBD.selectors)},function(b,d,e,f,g,h){return{init:function(){g=b.blocks,f=g.composer,h=a(),b.dropzonePlaceholder=b.dropzonePlaceholder().detach().removeClass("hide")[0]
},"{self} composerReady":function(){var a=b.isPostTemplateLocked();a||(b.draggableOptions={connectWith:EBD.dropzone,helper:"clone",appendTo:f.document.ghosts(),placeholder:"ebd-block is-placeholder",refreshPositions:!0,handle:EBD.immediateBlockSortHandle},b.droppableOptions={accept:[EBD.block,".eb-mm-file"].join(","),tolerance:"pointer"},b.enable())},enable:function(){g.getAllBlocks().draggable(b.draggableOptions)},disable:function(){b.block(".ui-draggable").draggable("destroy")},selectedBlock:null,"{self} composerBlockMove":function(a,c,d){b.selectedBlock=d
},"{self} composerBlockMenuSelected":function(a,c,d){b.selectedBlock=d},isPostTemplateLocked:function(){var b=a("[data-eb-composer-views]").data("post-template-is-locked");return b?!0:!1},"{self} composerBlockInit":function(c,d,e){if(b.isPostTemplateLocked())return e.find("[data-ebd-block-toolbar]").css("cursor","auto"),void 0;var f=g.getBlockType(e);if("image"==f){var h=a.extend(!0,{},b.draggableOptions,{cursorAt:{top:0,left:0}});return e.draggable(h),void 0}e.draggable(b.draggableOptions)},populateDropzones:function(){var c=f.viewportContent().scrollTop(),d=f.viewportContent()[0].scrollHeight;
b.nest().each(function(){var c=a(this),d=c.data("type");if("block"==d&&(c.prepend(b.createNestedDropzone()),c.find(EBD.childBlock).each(function(){var c=a(this);c.after(b.createNestedDropzone())})),"content"==d){var e=g.nestable.availablePositions(c);a.each(e,function(a,d){c.prepend(b.createNestedDropzone(d))})}});var e=g.getRootBlocks();if(e.each(function(c){var d=a(this);0==c&&d.before(b.createDropzone()),d.hasClass("is-sort-item")||d.after(b.createDropzone())}),e.length<1&&b.root().append(b.createDropzone()),b.dropzone().droppable(b.droppableOptions),a.browser.safari){var h=f.viewportContent()[0].scrollHeight,i=(h-d)/d*100,j=c+c*i/100;
f.viewportContent().scrollTop(j)}},createDropzone:function(){return a(b.dropzonePlaceholder).clone()},createNestedDropzone:function(a){var c=b.createDropzone().addClass("is-nested");return a&&c.addClass("nest-"+a).data("position",a),c},destroyDropzones:function(){var c=f.viewportContent().scrollTop(),d=f.viewportContent()[0].scrollHeight;if(b.dropzone().remove(),a.browser.safari){var e=f.viewportContent()[0].scrollHeight,g=(e-d)/d*100,h=c+c*g/100;f.viewportContent().scrollTop(h)}},"{block} dragstart":function(a,c,d){c.stopPropagation(),d.helper.addClass("is-helper").css({width:a.width(),height:a.height()}),g.drag(a),h=a,b.populateDropzones(),f.manager().addClass("is-resizing")
},"{blocks.menu} dragstart":function(a){var e=f.manager().hasClass("is-dropping-block");e||b.populateDropzones(),h=a,f.manager().addClass("is-resizing")},"{mediaFile} dragstart":function(){b.populateDropzones(),h=a(),f.manager().addClass("is-resizing")},"{dropzone} click":function(a){if(!f.manager().hasClass("is-dragging-block")){b.isDropping=!0;var d=b.selectedBlock;d.removeClass("hide").removeClass("is-sort-item");{b.dropBlock(a,d)}setTimeout(function(){b.isDropping=!1,b.dropStop(),b.selectedMenu=null,b.selectedBlock=null,f.manager().removeClass("is-dropping-block"),f.manager().removeClass("is-moving-block")
},0)}},"{dropzone} mouseenter":function(a){a.addClass("is-receiving")},"{dropzone} mouseleave":function(a){a.removeClass("is-receiving")},"{dropzone} dropover":function(a,c,d){g.over(a),b.lastDropzone=a;var e=a.data("position");d.helper.addClass("is-sending"),e&&b.nest.of(a).data("snappedPosition",e)},"{dropzone} dropout":function(a,c,d){b.lastDropzone=null,g.out(a),d.helper.removeClass("is-sending")},isDropping:!1,lastDropzone:null,dropBlock:function(a,d){var e=d,h=d.is(g.menu);h&&(e=g.createBlockFromMenu(d));
var i=d.is(b.mediaFile);i&&(e=g.createBlockFromMediaFile(d));var j=f.manager().hasClass("is-moving-block"),k=f.manager().hasClass("is-dropping-block");if(j||k){var l=g.getBlockNest(a),m=a.data("position");l.data("snappedPosition",m)}var n=a.hasClass(c);return a.replaceWith(e),(h||i||j||k)&&(g.drop(e),g.release(e),g.out(e),n&&e.addClass(c)),f.manager().removeClass("is-dropping-block"),e},dropStop:function(){setTimeout(function(){f.manager().hasClass("is-dropping-block")||b.destroyDropzones()},1),f.manager().removeClass("is-resizing")
},"{dropzone} drop":function(a,d,e){if(!b.isDropping){b.isDropping=!0;var f=e.draggable,g=a.hasClass(c);block=b.dropBlock(a,f),setTimeout(function(){b.isDropping=!1,g&&block.addClass(c)},0)}},"{block} dragstop":function(a){a.removeClass("hide"),g.drop(a),g.release(a),g.out(a),b.dropStop()},"{blocks.menu} dragstop":function(a,c,d){if(b.isDropping||!b.lastDropzone)return b.dropStop(),void 0;var e=d.helper;b.dropBlock(b.lastDropzone,e),b.dropStop()},"{mediaFile} dragstop":function(a,c,d){if(b.isDropping||!b.lastDropzone)return b.dropStop(),void 0;
var e=d.helper;b.dropBlock(b.lastDropzone,e),b.dropStop()},"{self} composerDocumentScroll":function(b,c){var d=h.data("ui-draggable");a.ui.ddmanager.prepareOffsets(d,c)},"{dropzone} dropdeactivate":function(a){g.out(a)}}}),b.resolve()})}),EasyBlog.module("composer/blocks/font",function(a){var b=this;EasyBlog.require().script("composer/vendors/colorpicker","composer/vendors/nouislider").done(function(){EasyBlog.Controller("Composer.Blocks.Font",{elements:[".eb-composer-fieldset[data-name=font] [data-eb-{font-color-menu|font-family-menu|font-size-menu|font-color-content|font-color-picker|font-family-content|font-size-content|font-color-caption|font-family-caption|font-size-caption|font-family-option|font-format-option}]",".eb-composer-fieldset[data-name=font] [data-eb-{numslider-toggle|numslider-widget|numslider-value|numslider-input|numslider-units|numslider-unit|numslider-current-unit}]",".eb-composer-fieldset[data-name=font] [data-eb-{colorpicker|colorpicker-toggle}]"],defaultOptions:a.extend({fontSizeUnits:{px:{start:12,step:2,range:{min:8,max:72},pips:{mode:"values",density:4,values:[8,12,18,24,48,72]}},"%":{start:100,step:10,range:{min:0,max:200},pips:{mode:"positions",values:[0,50,100],density:10}}}},EBD.selectors)},function(b,c,d,e,f,g){return{init:function(){f=b.blocks,e=f.composer,g=a(),b.initFontFormatting(),b.initFontColor()
},"{self} composerBlockActivate":function(a,c,d){g=d,b.populate(d)},populate:function(a){var c=f.getBlockMeta(a),d=c.properties.fonts;e.panels.fieldset.get("font").toggle(d),d&&(b.populateFontColor(a),b.populateFontFamily(a),b.populateFontSize(a),b.populateFontFormatting(a))},hideFontFieldset:function(){e.panels.fieldset.get("font").hide()},initFontColor:function(){b.fontColorPicker().colorpicker()},populateFontColor:function(a){var c=a.css("color");b.updateFontColorUI(c,!0)},setFontColor:function(a,c){a.css("color",c),b.updateFontColorUI(c)
},updateFontColorUI:function(a,c){b.updatingFontColorUI=!0,a||(a=g.css("color")||"#000"),b.fontColorCaption().css("backgroundColor",a),c===!0&&b.fontColorPicker().colorpicker("setColor",a),b.updatingFontColorUI=!1},removeFontColor:function(a){b.setFontColor(a,"")},populateFontFamily:function(a){var c=a[0].style.fontFamily;b.updateFontFamilyUI(c)},setFontFamily:function(c,e){b.unpreviewFontFamily(c);var f=a.Event("composerBlockFontFamilyChange");f.fontFamily=e,d.trigger(f,[e,c]),b.updateFontFamilyUI(f.fontFamily),f.isDefaultPrevented()||c.css("fontFamily",f.fontFamily)
},updateFontFamilyUI:function(a){a=a.replace(/"/g,"'");var c=b.fontFamilyOption().removeClass("active").where("value",'"'+a+'"').addClass("active"),d=c.length>0?c.html():a.split(",")[0];b.fontFamilyCaption().html(d)},previewFontFamily:function(b,c){var e=b.data("originalFontFamily")||g[0].style.fontFamily,f=a.Event("composerBlockFontFamilyPreview");f.originalFontFamily=e,f.fontFamily=c,d.trigger(f,[c,e,b]),b.data("originalFontFamily",f.originalFontFamily),f.isDefaultPrevented()||b.css("fontFamily",f.fontFamily)
},unpreviewFontFamily:function(b){var c=b.data("originalFontFamily"),e=a.Event("composerBlockFontFamilyUnpreview");return e.originalFontFamily=c,d.trigger(e,[c,b]),b.removeData("originalFontFamily"),e.isDefaultPrevented()?void 0:(b.css("fontFamily",e.originalFontFamily),void 0)},populateFontSize:function(a){var c=a.css("fontSize");b.updateFontSizeUI(c)},setFontSize:function(c,d){if(a.isNumeric(d)){var e=b.getFontSizeUnit();d+=e}c.css("fontSize",d),b.updateFontSizeUI(d||c.css("fontSize")),d?b.setLineHeight(c,"120%"):b.removeLineHeight(c)
},updateFontSizeUI:function(a){b.updatingFontSizeUI=!0;var c=Math.abs(a.replace(/\%|px/gi,""));unit=a.match("%")?"%":"px",b.getFontSizeUnit()!==unit&&b.setFontSizeUnit(unit),b.fontSizeCaption().html(a),b.numsliderCurrentUnit().html(unit),b.numsliderUnit().removeClass("active").where("unit",'"'+unit+'"').addClass("active"),b.numsliderWidget().val(c),b.numsliderInput().val(c),b.updatingFontSizeUI=!1},removeFontSize:function(a){b.setFontSize(a,"")},getFontSizeUnit:function(){return b.fontSizeContent().data("unit")||"%"
},setFontSizeUnit:function(a){b.fontSizeContent().data("unit",a);var d=c.fontSizeUnits[a];b.numsliderWidget().find(".noUi-pips").remove().end().noUiSlider(d,!0).noUiSlider_pips(d.pips)},setLineHeight:function(a,b){a.css("lineHeight",b)},removeLineHeight:function(a){b.setLineHeight(a,"")},fontFormatting:{bold:{key:"fontWeight",val:"bold"},italic:{key:"fontStyle",val:"italic"},underline:{key:"textDecoration",val:"underline"},strikethrough:{key:"textDecoration",val:"line-through"},alignleft:{key:"textAlign",val:"left"},alignright:{key:"textAlign",val:"right"},aligncenter:{key:"textAlign",val:"center"},justify:{key:"textAlign",val:"justify"}},initFontFormatting:function(){b.fontFormatOption().on("touchstart click mousedown mouseup",function(a){a.preventDefault()
}).on("touchstart click",function(){var d=a(this),e=d.data("format");b.setFontFormatting(g,e,d.hasClass("active"))})},populateFontFormatting:function(c){var d=c[0];if(d){var f=d.style,g=b.fontFormatOption().each(function(){var c=a(this),d=c.data("format");if(/orderedlist|unorderedlist|indent|outdent/.test(d))return c.removeClass("active"),void 0;var e=b.fontFormatting[d],g=f[e.key]==e.val;c.toggleClass("active",g)}),h="text"==c.data("type");if(h){var i=e.editor.selection.getCurrent(),j=a(i).parentsUntil(c).filter("ul, ol").eq(0);
a.each({orderedlist:"ol",unorderedlist:"ul"},function(a,b){var c=j.is(b);g.where("format",a).toggleClass("active",c)})}e.panels.fieldset.get("font").find(".eb-font-formatting.section-list").toggle(h)}},setFontFormatting:function(a,c,d){var f=e.editor;switch(c){case"orderedlist":case"unorderedlist":f.list.toggle(c);break;case"indent":f.indent.increase();break;case"outdent":f.indent.decrease();break;default:var g=b.fontFormatting[c];a.css(g.key,d?"":g.val)}b.populateFontFormatting(a)},removeFontFormatting:function(a,c){b.setFontFormatting(a,c,!0)
},"{colorpicker} colorpickerChange":function(a,c,d){b.updatingFontColorUI||(b.colorpickerToggle().prop("checked",!0),b.setFontColor(g,d))},"{colorpickerToggle} change":function(a){a.checked()||b.removeFontColor(g)},"{fontFamilyOption} mouseover":function(a){var c=a.data("value");b.previewFontFamily(g,c)},"{fontFamilyOption} mouseout":function(){b.unpreviewFontFamily(g)},"{fontFamilyOption} click":function(a){var c=a.data("value");b.setFontFamily(g,c)},"{numsliderWidget} nouislide":function(a,c,d){b.numsliderInput().val(Math.abs(d))
},"{numsliderWidget} set":function(a,c,d){b.updatingFontSizeUI||b.setFontSize(g,Math.abs(d))},"{numsliderInput} input":function(c){if(!b.updatingFontSizeUI){var d=Math.abs(a.trim(c.val()));b.setFontSize(g,d)}},"{numsliderUnit} click":function(a){var c=a.data("unit");b.setFontSizeUnit(c)},"{numsliderToggle} click":function(){b.removeFontSize(g)},"{self} composerBlockRemove":function(a,c,d,e){e.skipFontTrigger||b.hideFontFieldset()},"{self} composerBlockDeactivate":function(){b.hideFontFieldset()}}}),b.resolve()
})}),EasyBlog.module("composer/blocks/guide",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Guide",{defaultOptions:a.extend({},EBD.selectors)},function(a,b,c,d,e){return{init:function(){e=a.blocks,d=a.blocks.composer},"{self} composerBlockHoverIn":function(a,b,c){c.addClass("hover")},"{self} composerBlockHoverOut":function(a,b,c){c.removeClass("hover")},"{self} composerBlockDrop":function(){},"{self} composerBlockActivate":function(b,c,d){d.addClass("active");var g=d.is(EBD.nestedBlock);g&&(a.nest.of(d).addClass("active"),e.getAllParentBlocks(d).addClass("has-active-child")),a.workarea().toggleClass("has-active-nest",g),d.addClass("is-glowing"),setTimeout(function(){d.removeTransitionClass("is-glowing",2e3)
},10)},"{self} composerBlockDeactivate":function(){a.block().removeClass("active has-active-child"),a.nest().removeClass("active")}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/accordion",function(a){var b=this;EasyBlog.require().library("accordion").done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Accordion",{defaultOptions:{"{accordionWrapper}":".eb-accordion","{tabHeader}":".nav-tabs","{tabHeaderListItem}":".nav-tabs > li","{tabHeaderListItemContent}":".nav-tabs > li a","{sectionContent}":".section-content","{sectionAns}":"> .section-content > .section-ans","{sectionHeader}":"[data-section-title]","{titleItem}":"[data-tab-header-item]","{control}":"[data-accordion-control]","{controlItemContent}":"[data-accordion-control] [data-listbox-item-content]"}},function(b,c,d,e,f,g,h){return{accordions:[],init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(b){var b=a.extend({},c.data,b);return content},reconstruct:function(c){if(console.log("reconstruct"),c.hasClass("is-new")){var d=a.uid("acc-");f.data(c).id=d;var e=f.getBlockContent(c),g=e.find("[data-eb-accordion]");g.addClass(d)}a.each(c.find("[data-accordion-wrapper]"),function(b,c){c=a(c);var d=c.parent();d.removeAttr("style")}),setTimeout(function(){b.accordions[f.data(c).id]=new Collapsible({node:document.querySelectorAll("."+f.data(c).id+" .block"),eventNode:".ac-q"})
},100)},"{self} composerBlockDuplicate":function(b,c,d,e){var g=f.getBlockType(d);if("accordion"==g){f.updateBlockUid(d);var h=f.data(e);data=f.data(d),a.extend(data,h);var i=a.uid("acc-");data.id=i,f.duplicateChildBlocksData(d,e),clonedContent=f.getBlockContent(d);var j=clonedContent.find("[data-eb-accordion]");j.removeClass(h.id),j.addClass(i)}},deconstruct:function(c){return a.each(c.find("[data-accordion-wrapper]"),function(d,e){e=a(e);var f=e.parent();f.removeAttr("contenteditable"),f.removeAttr("style"),e.children().appendTo(f),e.remove(),b.sectionContent.inside(c).eq(d).removeClass("is-active"),b.sectionHeader.inside(c).eq(d).removeAttr("contenteditable")
}),c},refocus:function(a){var c=b.sectionAns.inside(a).filter(".active");c.focus()},reset:function(){},recover:function(){},populate:function(a){var c=f.data(a);b.control().listbox().listbox("populate",c.tabs,function(a,b){a.listboxitem("content",b)})},revert:function(){},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d);return e.html()},toData:function(a){var b=f.data(a);return b},toText:function(a){var c=a.clone();return b.deconstruct(c).text()},section:{create:function(){var e=(a.uid("ac-"),'<h2 class="block__title ac-q" tabindex="0" contenteditable="true" data-section-title></h2>'),g=a('<div class="block ac section-content is-active" data-tabs-content></div>',{"class":"ac section-content"}),i=a("<div></div>",{"class":"ac-a section-ans"}),j=a("<div></div>",{"class":"ebd-nest","data-type":"block","data-accordion-wrapper":""}),k=f.constructNestedBlock("text");
f.initBlock(k),j.wrapInner(k),i.wrapInner(j),g.html(e),g.append(i),b.accordionWrapper.inside(h).append(g)},remove:function(c){var d=b.accordionWrapper.inside(h).filter(":first"),e=d.children(".section-content").eq(c),g=e.find(".section-ans");g.find(EBD.nestedBlock).each(function(){var b=a(this);f.removeBlock(b,{skipPanelTrigger:!0,skipFontTrigger:!0})}),e.remove()},focus:function(){}},"{control} listboxBeforeAddItem":function(a,c,d){b.section.create();var e=d.listboxitem("toData"),f=b.sectionContent.inside(h).filter(":last");
f.find("h2").html(e.content)},"{control} listboxAfterAddItem":function(){f.data(h).tabs=b.control().listbox("toData");var e=b.accordionWrapper.inside(h),g=e.html();e.html(g),b.accordions[f.data(h).id]=new Collapsible({node:document.querySelectorAll("."+f.data(h).id+" .block"),eventNode:".ac-q"})},"{control} listboxBeforeRemoveItem":function(a,c,d){var e=d.index();b.section.remove(e)},"{control} listboxAfterRemoveItem":function(){f.data(h).tabs=b.control().listbox("toData")},"{control} listboxAfterToggleDefault":function(){f.data(h).tabs=b.control().listbox("toData")
},"{controlItemContent} keypress":function(a,b){var c=b.keyCode?b.keyCode:b.which;"13"==c&&b.preventDefault()}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/audio",function(){var b=this;EasyBlog.require().library("audiojs").done(function(a){EasyBlog.Controller("Composer.Blocks.Handlers.Audio",{elements:["[data-eb-{file-error}]"],defaultOptions:{"{browseButton}":".eb-composer-placeholder-audio [data-eb-mm-browse-button]","{audio}":"audio","{placeholder}":"[data-eb-composer-audio-placeholder]","{infoBox}":"[data-audio-infobox]","{artist}":"[data-audio-artist]","{track}":"[data-audio-track]","{trackSeparator}":"[data-audio-track-separator]","{download}":"[data-audio-download]","{displayArtist}":"[data-audio-fieldset-artist]","{displayTrack}":"[data-audio-fieldset-track]","{displayDownload}":"[data-audio-fieldset-download]","{autoplay}":"[data-audio-fieldset-autoplay]","{loop}":"[data-audio-fieldset-loop]"}},function(b,c,d,e,f,g,h,i){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a(),i=EasyBlog.MediaManager
},toText:function(){},toData:function(a){var c=f.data(a),d=f.getBlockContent(a);return c.download=b.download.inside(d).attr("href"),c.artist=b.artist.inside(d).text(),c.track=b.track.inside(d).text(),c},toHTML:function(a){var a=a.clone()},toLegacyShortcode:function(a){var c={uri:a.uri},d="[embed=audio]"+JSON.stringify(c)+"[/embed]";return d},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(b){var c=f.createBlockContainer("audio"),d=f.data(c);return d=a.extend(d,b),c},constructFromMediaFile:function(a){{var c=a.data("key"),d=i.getUri(c),e=f.createBlockContainer("audio");
f.getBlockContent(e),f.data(e)}return e.addClass("is-loading"),i.getMedia(d).done(function(a){var c=a.meta;b.createPlayer(e,c.url,c.title)}).fail(function(){}).always(function(){e.removeClass("is-loading")}),e},reconstruct:function(a){var c=b.placeholder.inside(a),d=f.data(a);d.url&&b.createPlayer(a,d.url,d.track),c.length>0&&EasyBlog.MediaManager.uploader.register(c)},deconstruct:function(){},refocus:function(){},reset:function(a){f.getBlockContent(a)},populate:function(a){f.data(a);b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a);
b.autoplay().val(c.autoplay?"1":"0").trigger("change"),b.loop().val(c.loop?"1":"0").trigger("change"),b.displayArtist().val(c.showArtist?"1":"0").trigger("change"),b.displayDownload().val(c.showDownload?"1":"0").trigger("change"),b.displayTrack().val(c.showTrack?"1":"0").trigger("change")},getPlayerTemplate:function(){return a(g.player)},createPlayer:function(c,d,e){var g=f.data(c),h=f.getBlockContent(c),i=b.getPlayerTemplate(),j=g.uid||(g.uid=a.uid("audio-")),d=g.url||d,k=e||"",l=g.artist;g.url=d,g.track=k,g.artist=l,g.uid=j,b.audio.inside(i).attr("id",j).attr("src",d),b.artist.inside(i).html(g.artist).editable(!0),b.track.inside(i).html(g.track).editable(!0),b.download.inside(i).attr("href",d).attr("target","blank").on("click",function(a){a.preventDefault()
}),h.html(i),a.audiojs.events.ready(function(){a.audiojs.create(h.find("audio"))}),g.showDownload||b.download.inside(h).addClass("hide"),g.showArtist||b.artist.inside(h).addClass("hide"),g.showTrack||b.track.inside(h).addClass("hide"),b.updateInfoBox(c)},updateInfoBox:function(a){var c=f.data(a),d=f.getBlockContent(a),e=b.infoBox.inside(d);return c.showDownload||c.showTrack||c.showArtist?(e.removeClass("disabled"),void 0):(e.addClass("disabled"),void 0)},"{displayDownload} change":function(a){var e=(f.getBlockContent(h),1==a.val()?!0:!1),g=f.data(h);
return g.showDownload=e,b.updateInfoBox(h),e?(b.download.inside(h).removeClass("hide"),void 0):(b.download.inside(h).addClass("hide"),void 0)},"{displayArtist} change":function(a){var d=f.getBlockContent(h),e=1==a.val()?!0:!1,g=b.artist.inside(d),i=f.data(h);return i.showArtist=e,b.updateInfoBox(h),e?(g.removeClass("hide"),void 0):(g.addClass("hide"),void 0)},"{displayTrack} change":function(a){var d=f.getBlockContent(h),e=1==a.val()?!0:!1,g=b.track.inside(d),i=b.trackSeparator.inside(d),j=f.data(h);return j.showTrack=e,b.updateInfoBox(h),e?(i.removeClass("hide"),g.removeClass("hide"),void 0):(i.addClass("hide"),g.addClass("hide"),void 0)
},"{autoplay} change":function(a){var c=f.data(h),d=1==a.val()?!0:!1;c.autoplay=d},"{loop} change":function(a){var c=f.data(h),d=1==a.val()?!0:!1;c.loop=d},"{placeholder} mediaUploaderFilesAdded":function(a,b,c,d){EasyBlog.MediaManager.uploader.addItem(d[0],a)},"{placeholder} mediaUploaderFileUploaded":function(a,c,d,e,g){var h=g.response,i=h.media,j=i.meta,k=f.block.of(a);setTimeout(function(){b.createPlayer(k,j.url,e.name),k.hasClass("active")&&b.populate(k)},600)},"{browseButton} mediaSelect":function(a,c,d){var g=f.block.of(a);
if("audio"==d.meta.type){var h=d.meta,i=e.document,j=i.isLegacy();j?(content=b.toLegacyShortcode(d,g),i.insertContent(content)):b.createPlayer(g,h.url,h.title)}},"{placeholder} mediaUploaderFileError":function(c,d,e,f){f.code==a.plupload2.FILE_EXTENSION_ERROR&&b.fileError.inside(h).removeClass("hide")},"{self} mediaInsert":function(c,d,g,h,i,j){if("audio"==g.meta.type){var k=e.document,l=k.isLegacy();if(i=a.extend(i,{url:g.meta.url,track:i.title,autoplay:i.autoplay,loop:i.loop,showDownload:i.showDownload,showArtist:i.showArtist,showTrack:i.showTrack}),l)content=b.toLegacyShortcode(g,h),k.insertContent(content);
else{var h=f.constructBlock("audio",i);f.addBlock(h),j||f.activateBlock(h)}}}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/behance",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Behance",{defaultOptions:a.extend({"{form}":"> [data-behance-form]","{insert}":"[data-behance-insert]","{source}":"[data-behance-source]","{loader}":"> [data-behance-loader]","{preview}":"> [data-behance-preview]","{errorMessage}":"[data-behance-error]","{fsSource}":"[data-fs-behance-source]","{fsUpdate}":"[data-fs-behance-update]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.data(a);return b.url},toEditableHTML:function(){return""},toHTML:function(a){var b=f.data(a);return b.embed},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(c){var d=f.data(c),e=c.data("overlay"),h=f.getBlockContent(c);d.embed&&!e&&(h.empty(),b.setOverlay(c,d.embed)),d.embed||h.html(a(g.html)),c.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(a){var c=f.getBlockContent(a);
return b.form.inside(c).remove(),b.loader.inside(c).remove(),a},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);c.url&&b.fsSource().val(c.url)},loading:function(){var a=f.getBlockContent(h);return b.isLoading?(b.loader.inside(a).addClass("hidden"),b.form.inside(a).removeClass("hidden"),b.isLoading=!1,void 0):(b.loader.inside(a).removeClass("hidden"),b.form.inside(a).addClass("hidden"),b.isLoading=!0,void 0)},setOverlay:function(a,b){var c=f.getBlockContent(a),d=a.data("overlay");
d?(d.element().empty(),d.element().append(b)):(d=e.document.overlay.create(a),d.placeholder().css("height","450px").appendTo(c),d.element().append(b),d.attach()),a.data("overlay",d)},isUrlValid:function(a){if(""==a)return!1;var b=/^https:\/\/www\.behance\.net\/gallery\/(.*)\/(.*)$/,c=b.test(a);return c},getOembedUrl:function(a){return"http://www.behance.net/services/oembed?url="+a},crawl:function(a,c){var d=f.getBlockContent(a),e=f.data(a),g=b.getOembedUrl(c);if(!b.isUrlValid(c))return b.errorMessage().removeClass("hide"),!1;
var h=a.data("overlay");h&&h.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:g}).done(function(f){b.loading();var h=f[g];e.url=c,e.embed=h.oembed.html,b.setOverlay(a,e.embed),b.form.inside(d).addClass("hidden")}).fail(function(a){b.loading(),b.errorMessage().removeClass("hide").html(a)})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}var d=f.getBlockContent(h),e=b.source.inside(d).val();b.fsSource().val(e),b.crawl(h,e)},"{fsUpdate} click":function(){var c=(f.getBlockContent(h),b.fsSource().val());
b.crawl(h,c)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/buttons",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Buttons",{defaultOptions:{buttonClasses:"btn-default btn-info btn-primary btn-success btn-warning btn-danger","{button}":"> a.btn","{textWrapper}":"> span","{buttonSize}":"[data-eb-composer-block-button-size] [data-size]","{buttonHyperlink}":"[data-button-link]","{buttonNofollow}":"[data-button-nofollow]","{buttonTarget}":"[data-button-target]","{buttonSwatchItem}":"[data-eb-composer-button-swatch-item]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},selectionState:{},toData:function(a){var b=f.data(a);return b},toText:function(a){{var c=f.getBlockContent(a);b.button.inside(c)}return text=f.data(a).link},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d).html();return e},activate:function(a){h=a,b.toggleFontSettings(!1),b.populate(a)},deactivate:function(){b.toggleFontSettings(!0)},construct:function(){},reconstruct:function(a){var c=f.getBlockContent(a),d=b.button.inside(c);d.on("click",function(a){a.stopPropagation(),a.preventDefault()
})},deconstruct:function(a){var c=f.getBlockContent(a),d=b.button.inside(c);return b.textWrapper.inside(d).removeAttr("contenteditable").editable(!1),a},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);b.buttonSwatchItem().removeClass("active").where("style",c.style).addClass("active");var d=b.buttonSize().filter('[data-size="'+c.size+'"]');d.siblings().removeClass("active"),d.addClass("active"),b.buttonHyperlink().val(c.link),b.buttonNofollow().val(c.nofollow).trigger("change"),b.buttonTarget().val(c.target)
},toggleFontSettings:function(b){var c=["[data-eb-font]","[data-font-format-group-basic]"];c.forEach(function(c){b===!0?a(c).show():a(c).hide()})},"{buttonSwatchItem} click":function(a){var d=a.data("style"),e=f.getBlockContent(h);b.buttonSwatchItem().removeClass("active").where("style",d).addClass("active"),b.button.inside(e).removeClass(c.buttonClasses).addClass(d),f.data(h).style=d},"{buttonSwatchItem} mouseover":function(a){clearTimeout(b.previewTimer);var d=a.data("style"),e=f.getBlockContent(h);b.button.inside(e).removeClass(c.buttonClasses).addClass(d)
},"{buttonSwatchItem} mouseout":function(){clearTimeout(b.previewTimer);var d=f.getBlockContent(h);b.previewTimer=setTimeout(function(){b.button.inside(d).removeClass(c.buttonClasses).addClass(f.data(h).style)},50)},"{buttonSize} click":function(a){var c=a.data("size"),d=f.getBlockContent(h);a.addClass("active").siblings().removeClass("active"),b.button.inside(d).removeClass("btn-sm btn-xs btn-lg btn-xlg").addClass(c),f.data(h).size=c},"{buttonSize} mouseover":function(a){clearTimeout(b.previewTimer);var c=a.data("size"),d=f.getBlockContent(h);
b.button.inside(d).removeClass("btn-sm btn-xs btn-lg btn-xlg").addClass(c)},"{buttonSize} mouseout":function(){clearTimeout(b.previewTimer);var c=f.getBlockContent(h);b.previewTimer=setTimeout(function(){b.button.inside(c).removeClass("btn-sm btn-xs btn-lg btn-xlg").addClass(f.data(h).size)},50)},"{buttonHyperlink} keyup":a.debounce(function(a){var c=f.getBlockContent(h),d=f.data(h);d.link=a.val(),b.button.inside(c).attr("href",a.val())},250),"{buttonNofollow} change":function(a){var c=f.getBlockContent(h),d=f.data(h);
d.nofollow=1==a.val()?1:0,b.button.inside(c).attr("rel",1==a.val()?"nofollow":"")},"{buttonTarget} change":function(a){var c=f.getBlockContent(h),d=f.data(h);d.target=a.val(),b.button.inside(c).attr("target",a.val())}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/code",function(a){var b=this,c=a.rootPath+"/media/com_easyblog/scripts/vendors/ace.js";window.FD50_PSEUDO={module:function(b,c){c.call(a.Deferred(),a)}},EasyBlog.Controller("Composer.Blocks.Handlers.Code",{defaultOptions:{"{pre}":"> pre","{readOnly}":"[data-code-readonly]","{showGutter}":"[data-code-gutter]","{fontsize}":"[data-code-fontsize]","{themeSelection}":"[data-code-theme]","{modeSelection}":"[data-code-mode]","{iframeHeight}":"[data-code-height]",theme:"github",mode:"javascript",css:{position:"fixed",width:"100%",height:"100%",top:0,bottom:0,left:0,right:0,margin:0,padding:0}}},function(b,d,e,f,g,h,i){return{init:function(){g=b.blocks,f=g.composer,h=d.meta,i=a()
},toText:function(){},toData:function(a){{var c=g.data(a);a.data("uid")}return instance=b.editor.instances[a.data("uid")],contents=instance.editor.getSession().getValue(),c.code=contents,c},toEditableHTML:function(a){var b=a.clone(),c=g.getBlockContent(b);return c.find("[data-ebd-overlay-placeholder]").remove(),c.html()},toHTML:function(a){{var c=g.data(a);a.data("uid")}instance=b.editor.instances[a.data("uid")],contents=instance.editor.getSession().getValue();var e=a.clone(),f=b.deconstruct(e),h=g.getBlockContent(f),i=b.pre.inside(h);
i.html(contents),i.attr("data-mode",c.mode);var j=i.html();return j},activate:function(a){i=a,b.populate(a)},deactivate:function(){},construct:function(b){var b=a.extend({},d.data,b)},reconstruct:function(a){var c=g.getBlockContent(a),d=g.data(a);if(!a.data("overlay")){var e=f.document.overlay.create(a);e.placeholder().css("height",d.height+"px").prependTo(c),e.attach(),a.data("overlay",e)}b.editor.get(a)},"{self} composerBlockDuplicate":function(c,d,e,f){var h=g.getBlockType(e);if("code"==h){e.removeAttr("data-uid"),g.setBlockUid(e);
var i=g.data(f);data=g.data(e),a.extend(data,i),instance=b.editor.instances[f.data("uid")],contents=instance.editor.getSession().getValue(),data.code=contents;var j=g.getBlockContent(e);j.find("[data-ebd-overlay-placeholder]").remove()}},deconstruct:function(a){return a},reset:function(){},refocus:function(){},populate:function(a){var c=g.data(a);b.modeSelection().val(c.mode),b.themeSelection().val(c.theme),b.showGutter().val(c.show_gutter?1:0),b.showGutter().trigger("change"),b.iframeHeight().val(c.height)},getEditor:function(a){b.editor.get(i).done(a)
},switchMode:function(a){var c=g.data(i);b.getEditor(function(b,d){d.setMode("ace/mode/"+a),c.mode=a})},switchTheme:function(a){var c=g.data(i);b.getEditor(function(b){b.setTheme(a),c.theme=a})},switchInvisible:function(a){var c=g.data(current);b.getEditor(function(b){b.setShowInvisibles(a),c.show_invisible=a})},toggleGutter:function(a){var c=g.data(i);b.getEditor(function(b){b.renderer.setShowGutter(a),c.show_gutter=a})},updateFontSize:function(a){var c=g.data(i);b.getEditor(function(b){b.setFontSize(a),c.fontsize=a
})},updateHeight:function(a){data=g.data(i),data.height=a;var b=i.data("overlay");b.placeholder().css("height",data.height+"px");var c=b.element().find("iframe");c.css("height",data.height+"px")},editor:{instances:{},get:function(a){var c=b.editor.instances[a.data("uid")];return c||b.editor.create(a)},create:function(e){var h=e.data("uid"),i=g.getBlockContent(e),j=b.pre.inside(i),k=b.editor.instances[h]=a.Deferred(),l=g.data(e),m=k.overlay=e.data("overlay");m||(m=f.document.overlay.create(e),m.placeholder().css("height",l.height+"px").prependTo(i),m.attach(),e.data("overlay",m));
var n=a.create("iframe"),o=a.rootPath+"/media/index.html";return n.css("height",l.height+"px").attr("src",o).one("load",function(){var e=n[0].contentWindow,f=e.document,g=f.head,i=f.body,m=j.clone().css(d.css).appendTo(i)[0];e.eval("window.FD50 = window.parent.FD50_PSEUDO;"),a.script({url:c,head:g}).done(function(){var b=e.ace,c=b.edit(m),f=l.theme||j.data("theme")||d.theme,g=l.mode||j.data("mode")||d.mode,h=l.fontsize||j.data("fontsize")||d.fontsize,i=l.show_gutter||j.data("gutter")||d.show_gutter;c.setTheme(f),c.setFontSize(h),c.renderer.setShowGutter(i),l.code&&c.setValue(l.code),a(m).css("height","100%"),c.resize();
var n=c.getSession();n.setMode("ace/mode/"+g),k.editor=c,k.resolve(c,n,j)}).fail(function(){k.reject(a.Exception("ACE Editor could not be loaded.")),delete b.instances[h]})}),m.element().append(n),k}},"{showGutter} change":function(a){var d=1==a.val()?!0:!1;b.toggleGutter(d)},"{fontsize} change":function(c){var e=parseInt(a(c).val());b.updateFontSize(e)},"{modeSelection} change":function(c){var e=a(c).val();b.switchMode(e)},"{iframeHeight} keyup":a.debounce(function(a){var d=a.val();b.updateHeight(d)},250),"{themeSelection} change":function(c){var e=a(c).val();
b.switchTheme(e)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/codepen",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Codepen",{defaultOptions:{"{form}":"> [data-codepen-form]","{insert}":"[data-codepen-insert]","{source}":"[data-codepen-source]","{loader}":"> [data-codepen-loader]","{preview}":"> [data-codepen-preview]","{fsSource}":"[data-fs-codepen-source]","{fsUpdate}":"[data-fs-codepen-update]","{errorMessage}":"[data-codepen-error]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toText:function(a){var b=f.data(a);return b.url},toData:function(a){var b=f.data(a);return b},toEditableHTML:function(){return""},toHTML:function(a){var b=f.data(a);return b.embed},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(c){var d=f.data(c),e=c.data("overlay"),h=f.getBlockContent(c);d.embed&&!e&&(h.empty(),b.setOverlay(c,d.embed)),d.embed||h.html(a(g.html))},deconstruct:function(a){var c=f.getBlockContent(a);return b.form.inside(c).remove(),b.loader.inside(c).remove(),a
},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);b.fsSource().val(c.url)},loading:function(){var a=f.getBlockContent(h);b.isLoading?(b.loader.inside(a).addClass("hidden"),b.form.inside(a).removeClass("hidden"),b.isLoading=!1):(b.loader.inside(a).removeClass("hidden"),b.form.inside(a).addClass("hidden"),b.isLoading=!0)},setOverlay:function(a,b){var c=a.data("overlay");if(c)c.element().empty(),c.element().append(b);else{c=e.document.overlay.create(a);var d=f.getBlockContent(a);c.placeholder().css("height","300px").appendTo(d),c.element().append(b),c.attach()
}a.data("overlay",c)},getUrl:function(a){return"http://codepen.io/api/oembed?url="+a},isUrlValid:function(a){if(""==a)return!1;var b=/^https:\/\/codepen\.io\/(.*)\/pen\/(.*)$/,c=b.test(a);return c},crawl:function(a,c){var d=b.getUrl(c),e=f.data(a),g=f.getBlockContent(a);if(!b.isUrlValid(c))return b.errorMessage().removeClass("hide"),!1;var h=a.data("overlay");h&&h.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:d}).done(function(f){var g=f[d];e.url=c,e.embed=g.oembed.html,b.setOverlay(a,e.embed)
}).fail(function(a){b.errorMessage().removeClass("hide").html(a)}).always(function(){b.loading(),b.form.inside(g).addClass("hidden")})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}var e=(f.data(h),f.getBlockContent(h)),g=b.source.inside(e).val();b.fsSource().val(g),b.crawl(h,g)},"{fsUpdate} click":function(){{var a=b.fsSource().val();f.data(h)}b.crawl(h,a)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/columns",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Columns",{defaultOptions:{"{columnsHeader}":".row","{columns}":".row > div","{wrapper}":"> div[data-col-wrapper]","{columnRange}":"[data-eb-composer-block-column-range]","{control}":"[data-columns-control]","{controlWidth}":"[data-select-width]","{dropdown}":".eb-composer-manage-tab-name > select ","{listboxItem}":"[data-listbox-item]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},matchWrapperHeight:function(c){var d=0;b.wrapper.inside(c).css("height","").each(function(){d=Math.max(d,a(this).height())}).css("height",d)},removeWrapperHeight:function(a){b.wrapper.inside(a).css("height","")},"{blocks.root} sortactivate":function(){f.getBlocksByType("columns").each(function(){var c=f.getBlockContent(a(this));b.matchWrapperHeight(c)})},"{blocks.root} sortdeactivate":function(){f.getBlocksByType("columns").each(function(){var c=f.getBlockContent(a(this));b.removeWrapperHeight(c)})},"{wrapper} sortchange":function(a){var e=a.closest(EBD.block);
b.matchWrapperHeight(e)},"{wrapper} sortout":function(a){var e=a.closest(EBD.block);b.matchWrapperHeight(e)},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(b){var b=a.extend({},c.data,b);return content},reconstruct:function(){},deconstruct:function(b){var c=f.getBlockContent(b),d=c.find("> .row > .col > [data-col-wrapper]");return d.each(function(){var b=a(this),c=b.parent();b.children().appendTo(c),c.removeAttr("contenteditable"),b.remove()}),b},refocus:function(a){var c=f.getBlockContent(a),d=a.data("lastFocused")||b.columns.inside(c).filter(":first");
d.focus()},reset:function(){},populate:function(c){var d=f.data(c),e=c.attr("data-uid");b.control().listbox().listbox("populate",d.columns);var h=(f.getBlockContent(c),a('div[data-uid="'+e+'"]').find("div.ebd-block-content:eq(0) > div").children());h.each(function(c,d){var e=b.listboxItem().eq(c),f=b.controlWidth.inside(e),g=a(d).attr("data-size");f.val(g)})},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d);return e.html()},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.getBlockContent(a).clone();
return b.text()},column:{activate:function(a){var c=f.getBlockContent(h),d=b.columns.inside(c);d.eq(a).addClass("active-column")},deactivate:function(a){var c=f.getBlockContent(h),d=b.columns.inside(c);d.eq(a).removeClass("active-column")},create:function(c){var d=f.getBlockContent(h),g=(b.columns.inside(d),"col-12 col-md-"+c),i=f.createBlockNest();i.attr("data-col-wrapper","").addClass("ui-sortable");var j=f.constructNestedBlock("text");i.append(j);var k=a("<div></div>");k.addClass(g).attr("data-size",c).append(i),b.columnsHeader.inside(d).append(k)
},remove:function(a){var c=f.getBlockContent(h);b.columns.inside(c).eq(a).remove();var d=b.columns.inside(c).length,e=Math.ceil(12/d),g=!1;if(5==d){var e=2;g=!0}var i="col-12 col-md-"+e;b.columnsHeader.inside(c).find("div.col").removeClass().addClass(i),g&&(b.columns.inside(c).first().addClass("col-md-offset-1"),b.columns.inside(c).last().addClass("col-md-offset-0"))},change:function(c,d){var e=f.getBlockContent(h),g=f.data(h),i=h.attr("data-uid"),j=a('div[data-uid="'+i+'"]').find("div.ebd-block-content:eq(0) > div").children().length;
if(d>4&&3==j&&b.columns.inside(e).last().addClass("col col-md-2"),4==d&&4==j&&b.columns.inside(e).last().addClass("col col-md-2"),!(d>4)||4!=j&&5!=j){if(6==j)return b.dropdown().val("2"),void 0;b.columns.inside(e).first().removeClass("col-md-offset-1"),b.columns.inside(e).last().removeClass("col-md-offset-0");{var k="col-12 col-md-"+d;b.columns.inside(e).eq(c)}g.columns[c].size=d,b.columns.inside(e).eq(c).attr("data-size",d).removeClass().addClass(k)}}},"{listboxItem} mouseover":function(a){var d=a.index();b.column.activate(d)
},"{listboxItem} mouseout":function(a){var d=a.index();b.column.deactivate(d)},"{control} listboxBeforeAddItem":function(){},"{control} listboxAfterAddItem":function(){f.data(h).columns=b.control().listbox("toData"),b.column.create(1)},"{control} listboxBeforeRemoveItem":function(a,c,d){var e=d.index();b.column.remove(e)},"{control} listboxAfterRemoveItem":function(){f.data(h).columns=b.control().listbox("toData")},"{controlWidth} change":function(a){var d=a.parents(b.listboxItem.selector),e=d.index(),f=a.val();
b.column.change(e,f)},"{self} composerBlockDuplicate":function(b,c,d,e){var g=f.getBlockType(d);if("columns"==g){f.updateBlockUid(d);var h=f.data(e);data=f.data(d),a.extend(data,h),f.duplicateChildBlocksData(d,e)}}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/compare",function(a){var b=this;EasyBlog.require().library("imgareaselect").done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Compare",{defaultOptions:{image:"[data-type=compare] img"}},function(b,c,d,e,f,g,i){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,i=a()
},toData:function(a){return f.getData(a)},activate:function(c){i=c,b.populate(c),i.find("img").on("click.compare dragstart.compare",function(a){a.preventDefault(),a.stopPropagation()}).on("mousedown.compare",function(c){if(!b.drawing){c.stopPropagation(),c.preventDefault();var e=a(this),f=e.parents(".ebd-block:first");images=f.find("img"),console.log(f),b.drawing=!0,d.addClass("active");var g=parseInt(e.css("top")),i=parseInt(e.css("left")),j=e.width()-e.parent().width();h=e.height()-e.parent().height();var k=c.pageX,l=c.pageY;
a(document).on("mousemove.compare mouseup.compare",function(a){if(b.drawing){var c=-1*(k-a.pageX),d=-1*(l-a.pageY),e=0==j?0:i+(c||0),f=0==h?0:g+(d||0);images.css({top:g=f,left:i=e}),k=a.pageX,l=a.pageY}}).on("mouseup.compare",function(){a(document).off("mousemove.compare mouseup.compare"),f.removeClass("active"),b.drawing=!1})}})},construct:function(){},reconstruct:function(){},refocus:function(){},reset:function(){},populate:function(){},drawing:!1,"{image} mousedown":function(){}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/comparison",function(){var b=this;
EasyBlog.require().script("shared/comparison").done(function(a){EasyBlog.Controller("Composer.Blocks.Handlers.Comparison",{defaultOptions:{"{wrapper}":"[data-eb-comparison-wrapper]","{rightButtonPlaceholder}":"[data-right-browse-placeholder]","{rightButtonTemplate}":"[data-eb-comparison-template] > [data-eb-comparison-browse=right]","{leftButtonPlaceholder}":"[data-left-browse-placeholder]","{leftButtonTemplate}":"[data-eb-comparison-template] > [data-eb-comparison-browse=left]","{leftLabel}":"[data-left-label]","{rightLabel}":"[data-right-label]","{leftImage}":"[data-left-image]","{rightImage}":"[data-right-image]","{leftToggler}":"[data-field-left-label]","{leftTextField}":"#left_text","{rightToggler}":"[data-field-right-label]","{rightTextField}":"#right_text","{browseMedia}":"[data-eb-comparison-browse]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(a){f.data(a)},refocus:function(){},deconstruct:function(a){return b.browseMedia.inside(a).remove(),a},reset:function(){},populate:function(a){var c=f.data(a);b.wrapper().comparison(),b.initializeBrowseButtons(),b.leftToggler().val(c.left?1:0).trigger("change"),b.rightToggler().val(c.right?1:0).trigger("change"),b.leftTextField().val(c.left_text).trigger("keyup"),b.rightTextField().val(c.right_text).trigger("keyup")
},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d);return e.html()},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.getBlockContent(a).clone();return b.text()},initializeBrowseButtons:function(){var a=f.getBlockContent(h),c=b.rightButtonPlaceholder.inside(a).html(),d=b.leftButtonPlaceholder.inside(a).html();if(c.length<=0){var e=b.rightButtonTemplate().clone();b.rightButtonPlaceholder().html(e[0])}if(d.length<=0){var e=b.leftButtonTemplate().clone();b.leftButtonPlaceholder().html(e[0])
}},"{leftToggler} change":function(a){var d=f.data(h),e=0!=a.val(),g=f.getBlockContent(h);return d.left=e,e?(b.leftLabel.inside(g).html(b.leftTextField().val()).removeClass("t-hidden"),void 0):(b.leftLabel.inside(g).html("").addClass("t-hidden"),void 0)},"{rightToggler} change":function(a){var d=f.data(h),e=0!=a.val(),g=f.getBlockContent(h);return d.right=e,e?(b.rightLabel.inside(g).html(b.rightTextField().val()).removeClass("t-hidden"),void 0):(b.rightLabel.inside(g).html("").addClass("t-hidden"),void 0)},"{leftTextField} keyup":a.debounce(function(a){var c=f.data(h),d=a.val(),e=f.getBlockContent(h);
c.left_text=d,b.leftLabel.inside(e).html(d)}),"{rightTextField} keyup":a.debounce(function(a){var c=f.data(h),d=f.getBlockContent(h),e=a.val();c.right_text=e,b.rightLabel.inside(d).html(e)}),"{browseMedia} mediaSelect":function(a,c,d,e){if("image"==d.meta.type){var g=f.getBlockContent(h),i=a.data("eb-comparison-browse"),j=i+"Image",k=d.meta.variations[e.variation];console.log(k.width,k.height),k.width<480||k.height<480||("left"==i&&b[j].inside(g).css("background-image","url("+e.url+")"),"right"==i&&b[j].inside(g).attr("src",e.url))
}}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/dailymotion",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Dailymotion",{elements:["[data-dailymotion-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:a.extend({"{form}":"> [data-dailymotion-form]","{insert}":"[data-dailymotion-insert]","{source}":"[data-dailymotion-source]","{loader}":"> [data-dailymotion-loader]","{player}":"iframe","{wrapper}":"[data-dailymotion-wrapper]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var c=f.data(a),d=b.getOverlay(a);if(!d)return c;var e=b.player.inside(d.element());return c.source=e.attr("src"),c},toText:function(a){var c=f.data(a),d=b.getOverlay(a);if(!d)return c;var e=b.player.inside(d.element());return c.source=e.attr("src"),c.source},toHTML:function(a){var c=(f.data(a),a.data("overlay"));return c?c.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(a)},deactivate:function(){},construct:function(){},getWrapper:function(){var c=a(g.wrapper);
return c},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.source&&!d?b.setOverlay(a):0==c.source.length&&c.url?(e.html(g.html),b.crawl(c.url,a)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a);c.url&&(b.url().val(c.url),b.width().val(c.width),b.height().val(c.height),b.fluid().val(c.fluid?"1":"0").trigger("change"))
},getOverlay:function(a){var c=a.data("overlay"),g=(f.data(a),f.getBlockContent(a));if(!c){c=e.document.overlay.create(a);var h=b.getWrapper();c.placeholder().appendTo(h),g.empty().append(h),c.attach()}return c},setWrapperLayout:function(a){var c=b.wrapper.inside(a),d=f.data(a);d.fluid?c.addClass("is-responsive").css({width:"",height:""}):(c.hasClass("is-responsive")&&(d.width=c.width(),d.height=c.outerHeight()),b.width().val(d.width),b.height().val(d.height),c.css({width:d.width,height:d.height}).removeClass("is-responsive"))
},setOverlay:function(a){var c=f.data(a),d=b.getOverlay(a);d.element().length>0&&d.element().empty(),b.setWrapperLayout(a),d.element().append(c.embed),d.refresh(),a.data("overlay",d)},isUrlValid:function(a){if(""==a)return!1;var b=/^(http|https):\/\/www\.dailymotion\.com\/video\/(.*)$/,c=b.test(a);return c},loading:function(){var a=f.getBlockContent(h),c=b.loader.inside(a),d=b.form.inside(a);b.isLoading?(c.addClass("hidden"),d.removeClass("hidden"),b.isLoading=!1):(c.removeClass("hidden"),d.addClass("hidden"),b.isLoading=!0)
},crawl:function(a,c){var d=f.data(c),e=f.getBlockContent(c),g=c.data("overlay");g&&g.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:a}).done(function(e){var f=e[a];d.url=a,d.author={name:f.oembed.author_name,url:f.oembed.author_url},d.embed=f.oembed.html,d.width=f.oembed.width,d.height=f.oembed.height,b.setOverlay(c),b.updateFieldset(c)}).fail(function(a){b.errorMessage().removeClass("hide").html(a)}).always(function(){b.loading(),b.form.inside(e).addClass("hidden")})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);
f.activateBlock(c)}{var d=f.getBlockContent(h),e=b.source.inside(d).val();f.data(h)}return b.isUrlValid(e)?(b.crawl(e,h),void 0):(b.errorMessage().removeClass("hide"),void 0)},"{fluid} change":function(a){var d=1==a.val()?!0:!1,e=f.data(h);e.fluid=d,b.setWrapperLayout(h),b.widthFieldset().toggleClass("hide",d),b.heightFieldset().toggleClass("hide",d);var g=b.getOverlay(h);g.refresh()},"{width} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.width=e;var g=b.getOverlay(h),i=b.wrapper.inside(h);
i.css("width",e);var g=b.getOverlay(h);g.refresh()}},250),"{height} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.height=e;var g=b.wrapper.inside(h);g.css("height",e);var i=b.getOverlay(h);i.refresh()}},250),"{updateUrl} click":function(){var d=b.url().val(),g=(f.data(h),f.getBlockContent(h));return b.isUrlValid(d)?(b.crawl(d,h),void 0):(b.errorMessage.inside(g).removeClass("hide"),void 0)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/facebook",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Facebook",{defaultOptions:{"{form}":"> [data-fb-form]","{embed}":"[data-fb-embed]","{source}":"[data-fb-source]","{preview}":"[data-fb-preview]","{input}":"[data-fb-source-input]","{update}":"[data-fb-update]","{errorMessage}":"[data-fb-error]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.data(a);return b.source},toEditableHTML:function(){return""},toHTML:function(a){var c=(f.data(a),a.data("overlay"));return c?c.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.source&&!d?(e.empty(),b.createIframe(a,c.source)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()
})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);b.populateUrl(c.source)},setOverlay:function(a,b){var c=a.data("overlay");if(c)c.element().empty(),c.element().append(b);else{var c=e.document.overlay.create(a),d=f.getBlockContent(a);c.placeholder().css("height","400px").appendTo(d),c.element().append(b),c.attach()}a.data("overlay",c)},isUrlValid:function(a){if(""==a)return!1;var b=/^https:\/\/www\.facebook\.com\/(.*)\/(.*)$/,c=b.test(a);return c},createIframe:function(a,c){var d=document.createElement("iframe"),g=(f.getBlockContent(a),f.data(a));
g.source=c;var h=a.data("overlay");return h&&h.element().empty(),d.setAttribute("width","auto"),d.setAttribute("height","400"),d.setAttribute("src","https://www.facebook.com/plugins/post.php?href="+encodeURIComponent(c)+"&height=400"),d.setAttribute("scrolling","no"),d.setAttribute("frameborder","0"),d.setAttribute("allowTransparency","true"),b.setOverlay(a,d),d},"{embed} click":function(){if(h.length<1){var d=b.block.of(button);f.activateBlock(d)}{var e=f.getBlockContent(h),g=b.source.inside(e).val();f.data(h)
}return b.isUrlValid(g)?(b.populateUrl(g),b.createIframe(h,g),b.form.inside(e).addClass("t-hidden"),void 0):(b.errorMessage().removeClass("t-hidden"),void 0)},populateUrl:function(a){b.input().val(a)},"{update} click":function(){{var d=f.getBlockContent(h),e=b.input().val();f.data(h)}return b.isUrlValid(e)?(b.createIframe(h,e),b.form.inside(d).addClass("t-hidden"),void 0):(b.errorMessage.inside(d).removeClass("t-hidden"),void 0)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/file",function(a){var b=this;
EasyBlog.Controller("Composer.Blocks.Handlers.File",{defaultOptions:{"{browseButton}":".eb-composer-placeholder-file [data-eb-mm-browse-button]","{fileError}":"[data-eb-file-error]","{placeholder}":"[data-eb-composer-file-placeholder]","{player}":"[data-file-preview]","{dropElement}":"[data-plupload-drop-element]","{showIcon}":"[data-file-fieldset-icon]","{showSize}":"[data-file-fieldset-size]","{fileName}":"[data-file-name]","{fileType}":"[data-file-type]","{fileIcon}":"[data-file-icon]","{fileSize}":"[data-file-size]","{fileUrl}":"[data-file-url]"}},function(b,c,d,e,f,g,h,i){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a(),i=EasyBlog.MediaManager
},toData:function(a){{var c=f.data(a),d=f.getBlockContent(a);b.getPreviewTemplate()}return c.name=d.find(b.fileName).text(),c},toText:function(){},toHTML:function(a){var c=f.data(a);if(!c.url)return"";var d=a.clone(),e=b.deconstruct(d),g=f.getBlockContent(e);return g.html()},constructFromMediaFile:function(a){{var c=a.data("key"),d=i.getUri(c),e=f.createBlockContainer("file");f.getBlockContent(e),f.data(e)}return e.addClass("is-loading"),i.getMedia(d).done(function(a){var c=a.meta;b.createPreview(e,c.url,c.title,c.extension,c.size)
}).fail(function(){}).always(function(){e.removeClass("is-loading")}),e},toLegacyHTML:function(b){var d=a("<a>").attr({href:b.url}).html(b.title);return d.prop("outerHTML")},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(b){var c=f.createBlockContainer("file"),b=a.extend(f.data(c),b);return c},reconstruct:function(a){var c=f.data(a),d=b.placeholder.inside(a),e=b.dropElement.inside(d);c.url&&b.createPreview(a,c.url,c.name,c.type,c.size),e.length>0&&EasyBlog.MediaManager.uploader.register(d)
},deconstruct:function(a){var c=f.getBlockContent(a);return b.fileName.inside(c).editable(!1),a},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a),d=1==c.showicon?1:0,e=1==c.showsize?1:0;b.showIcon().val(d).trigger("change"),b.showSize().val(e).trigger("change")},getPreviewTemplate:function(){a(g.preview);return a(g.preview)},createPreview:function(c,d,e,g,h){var i=f.getBlockContent(c),j=b.getPreviewTemplate(),k=f.data(c);console.log(k),EasyBlog.ajax("site/views/composer/abs2rel",{url:d}).done(function(c){k.url=c,k.name=e,k.type=g,k.size=h,j.attr("id",k.uid),b.fileName.inside(j).text(k.name).editable(!0),b.fileType.inside(j).text(k.type);
var d=a.plupload2.formatSize(k.size);b.fileSize.inside(j).text(d),b.fileUrl.inside(j).attr("href",k.url).on("click",function(a){a.preventDefault()}),i.html(j),k.showicon||b.fileIcon.inside(j).addClass("hide"),k.showsize||b.fileSize.inside(j).parent("div").addClass("hide")})},"{showIcon} change":function(a){var d=f.getBlockContent(h),e=f.data(h);e.showicon=1==a.val(),e.showicon?b.fileIcon.inside(d).removeClass("hide"):b.fileIcon.inside(d).addClass("hide")},"{showSize} change":function(a){var d=f.getBlockContent(h),e=f.data(h);
e.showsize=1==a.val(),e.showsize?b.fileSize.inside(d).parent("div").removeClass("hide"):b.fileSize.inside(d).parent("div").addClass("hide")},"{placeholder} mediaUploaderFilesAdded":function(a,b,c,d){EasyBlog.MediaManager.uploader.addItem(d[0],a)},"{placeholder} mediaUploaderFileUploaded":function(a,c,d,e,g){var h=g.response,i=h.media,j=i.meta,k=f.block.of(a);setTimeout(function(){b.createPreview(k,j.url,j.title,j.extension,j.size)},600)},"{placeholder} mediaUploaderFileError":function(c,d,e,f){f.code==a.plupload2.FILE_EXTENSION_ERROR&&b.fileError.inside(h).removeClass("hide")
},"{placeholder} mediaUploaderError":function(){},"{self} mediaInfoDisplay":function(b,c,d,e){"file"==e.meta.type&&a(d).find("[data-file-url]").on("click",function(a){a.preventDefault()})},"{browseButton} mediaSelect":function(a,c,d){var g=f.block.of(a),i=!1;if(("pdf"==d.meta.type||"file"==d.meta.type)&&(i=!0,"pdf"==d.meta.type&&d.data.previewer)){i=!1,f.removeBlock(h);var g=f.constructBlock("pdf",{name:d.data.title,url:d.meta.url,height:d.data.height});f.addBlock(g),f.activateBlock(g)}if(i){var j=d.meta,k=e.document,l=k.isLegacy();
l?(content=b.toLegacyHTML(g),k.insertContent(content)):b.createPreview(g,j.url,j.title,j.type,j.size)}},"{self} mediaInsert":function(a,c,d,g,h,i){if("file"==d.meta.type){var j=e.document,k=j.isLegacy();if(k)content=b.toLegacyHTML(d.meta,g),j.insertContent(content);else{var g=f.constructBlock("file",{name:h.title,type:d.meta.extension,size:d.meta.size,url:d.meta.url,showicon:h.showicon,showsize:h.showsize});f.addBlock(g),i||f.activateBlock(g)}}}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/gallery",function(a){function g(a,b){var c=Math.pow(10,b);
return Math.round(a*c)/c}function h(b){if(a.isNumeric(b))return b;var c=b.split(":");return c[0]/c[1]}function j(a,b){return g(1/h(a)*100,b||3)+"%"}var b=this,c="is-empty",d="view-selectratio",e="view-customratio",f=function(b){if(b=a.trim(b),/\:/.test(b)){var c=b.split(":");return parseInt(c[0])+":"+parseInt(c[1])}return parseFloat(b)||0};EasyBlog.Controller("Composer.Blocks.Handlers.Gallery",{elements:["[data-eb-gallery-{items-fieldset|list|list-item-group|list-item|list-item-icon|list-item-title|list-item-primary-label|list-item-delete-button|list-item-primary-button}]","[data-eb-gallery-{size-fieldset|strategy-field|strategy-menu-item}]","[data-eb-gallery-{ratio-button|ratio-label|ratio-customize-button|ratio-cancel-button|ratio-use-custom-button|ratio-cancel-custom-button|ratio-selection|ratio-input}]"],defaultOptions:{"{galleryUploadPlaceholder}":".eb-gallery-upload-placeholder","{galleryContainer}":".eb-gallery","{galleryViewport}":".eb-gallery-viewport","{galleryItem}":".eb-gallery-item:not(.is-placeholder)","{galleryStage}":".eb-gallery-stage","{galleryNextButton}":".eb-gallery-next-button","{galleryPrevButton}":".eb-gallery-prev-button","{galleryMenu}":".eb-gallery-menu","{galleryMenuItem}":".eb-gallery-menu-item","{galleryImage}":".ebd-block[data-type=image]","{galleryItemPlaceholder}":".eb-gallery-item.is-placeholder","{galleryMenuItemPlaceholder}":".eb-gallery-menu-item.is-placeholder","{galleryBrowseButton}":"[data-eb-gallery-browse]","{galleryProgressBar}":"[data-eb-mm-upload-progress-bar]"}},function(b,g,i,k,l,m,n,o,p){return{init:function(){l=b.blocks,k=l.composer,m=g.meta,n=a(),o=l.dimensions,mediaManager=EasyBlog.MediaManager,mediaUploader=mediaManager.uploader,p=l.getBlockHandler("image")
},normalize:function(b){return a.extend({},m.data,b)},activate:function(c){n=c,b.populate(c);var d=b.listItemGroup();d.hasClass("ui-sortable")||d.sortable({items:b.listItem.selector,tolerance:"pointer",refreshPositions:!0,update:function(){var e=[],f=[];activeId=0,b.listItem().each(function(){var c=a(this),d=c.attr("data-id");c.hasClass("active")&&(activeId=d);var g=b.galleryItem().where("id",d);e.push(g[0]),f.push(g[0])});var g=b.galleryViewport.inside(n),h=b.galleryContainer.inside(n),j=(b.galleryItemPlaceholder.inside(n),b.galleryMenuItemPlaceholder.inside(n));
a.each(e.reverse(),function(a,b){g.prepend(b)}),a.each(f,function(c,d){var e=a(d),f=e.attr("data-id");b.galleryMenuItem.inside(n).where("id",f).remove();var g=b.getGalleryMenuItemTemplate(f);g.attr("data-id",f).insertBefore(j),activeId&&f==activeId&&g.addClass("active")}),EasyBlog.ImageGallery.setLayout(h)}})},deactivate:function(){},construct:function(){var b=l.createBlock("gallery");return b},constructGallery:function(c,d){{var e=b.galleryContainer.inside(c);b.galleryItemPlaceholder.inside(c),b.galleryMenuItemPlaceholder.inside(c),l.data(c)
}void 0===p&&(p=l.getBlockHandler("image"));var i=0;a.each(d,function(d,e){var f=a.uid("g");b.createGalleryItem(c,e,f),0==i&&b.setPrimary(f),i++}),EasyBlog.ImageGallery.setLayout(e)},createGalleryItem:function(a,d,e){var f=b.galleryContainer.inside(a),g=b.galleryItemPlaceholder.inside(a),h=b.galleryMenuItemPlaceholder.inside(a),i=l.data(a),j=d.meta,k=d.uri;void 0===p&&(p=l.getBlockHandler("image"));var m=b.getGalleryItemTemplate();m.attr("data-id",e),m.insertBefore(g);var o=b.getGalleryMenuItemTemplate(e);o.attr("data-id",e).insertBefore(h),f.removeClass(c);
var q=b.createGalleryImage(a,j);m.html(q);var r=mediaManager.getVariation(k,"icon");i.items[e]={title:j.title,iconUrl:r.url},p.normalizeImageSize(q),a.is(n)&&b.populateList(a)},reconstruct:function(a){a.editable(!1);var c=b.galleryUploadPlaceholder.inside(a),d=c.find("[data-plupload-browse-button]");d.attr("style",function(a,b){return b&&b.replace(/z\-index[^;]+;?/g,"")});mediaUploader.register(c);b.populateDataItems(a)},deconstruct:function(a){var c=l.data(a),d=l.getBlockContent(a),e=b.galleryContainer.inside(a);
b.galleryItemPlaceholder.inside(e).remove(),b.galleryMenuItemPlaceholder.inside(e).remove();var f=b.galleryItem.inside(e),g=f.where("id",c.primary);f.removeClass("active"),g.addClass("active"),b.galleryMenuItem.inside(e).removeClass("active").where("id",c.primary).addClass("active"),EasyBlog.ImageGallery.setLayout(e);var h=b.getGalleryItemIndex(a,g);0>h&&(h=0);var i=b.galleryViewport.inside(e),j=0;return 0!=h&&(j=-100*h),i.css("left",j+"%"),d.html(e),a},refocus:function(){},reset:function(){},populate:function(a){b.populateDataItems(a),b.populateRatio(a),b.populateResizeStrategy(a),b.populateList(a)
},populateDataItems:function(c){var d=l.data(c);a.each(d.itemsKeyArray,function(a,b){d.items[b]=d.itemsArray[a]}),b.uploadedItems=d.itemsArray.length},toData:function(a){var b=l.data(a);b.itemsArray=[],b.itemsKeyArray=[];for(var c in b.items)b.items.hasOwnProperty(c)&&(b.itemsArray.push(b.items[c]),b.itemsKeyArray.push(c));return b},toText:function(){},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=l.getBlockContent(d);return e.html()},toLegacyHTML:function(b){var c=[];a.each(b,function(a,b){var d=JSON.parse(b.meta.params),e={namespace:b.uri,caption_text:d.caption_text};
c.push(e)});var e="[embed=gallery]"+JSON.stringify(c)+"[/embed]";return e},getGalleryItemTemplate:function(){return a(m.galleryItem)},getGalleryMenuItemTemplate:function(b){var c=a(m.galleryMenuItem);return c.data("id",b),c},createGalleryListItem:function(){return a(m.galleryListItem)},createGalleryPlaceholder:function(){return a(m.galleryPlaceholder)},createGalleryImage:function(a,b){var c=l.data(a),d=JSON.parse(b.params),e=b.uri,f=mediaManager.getVariation(e,c.imageVariation),g=f.width,i=f.height,j=g/i,k={uri:e,url:f.url,key:f.key,mode:"advanced",mode_lock:!0,fluid:!0,width:"100%",width_lock:!0,height:"100%",height_lock:!0,ratio:h(c.ratio),strategy:c.strategy,element_ratio:j,natural_width:g,natural_height:i,natural_ratio:j,caption_enabled:!0,caption_text:d.caption_text,alt_text:d.alt_text,link_enabled:!1,style_enabled:!1,popup_enabled:!1,variation:c.imageVariation},m=l.constructNestedBlock("image",k).addClass("is-isolated");
return m},"{galleryUploadPlaceholder} mediaUploaderFilesAdded":function(d,e,f,g){var h=l.block.of(d),i=b.galleryContainer.inside(h),j=b.galleryItemPlaceholder.inside(h),k=b.galleryMenuItemPlaceholder.inside(h);d.addClass("state-uploading"),b.addedItems=g.length,a.each(g,function(d,e){var f=e.id,g=a.uid("g"),l=b.getGalleryItemTemplate();l.attr("data-file-id",f).attr("data-id",g);var m=b.createGalleryPlaceholder();l.html(m),l.insertBefore(j),b.galleryMenuItem.inside(h).removeClass("active");var n=b.getGalleryMenuItemTemplate(g);
n.attr("data-id",g).insertBefore(k).addClass("active"),mediaUploader.addItem(e,m),i.removeClass(c)}),EasyBlog.ImageGallery.setLayout(i)},uploadedItems:0,addedItems:0,"{galleryUploadPlaceholder} mediaUploaderBeforeUpload":function(){k.trigger("composerSubmitLock")},"{galleryUploadPlaceholder} mediaUploaderUploadComplete":function(){k.trigger("composerSubmitUnlock")},"{galleryUploadPlaceholder} mediaUploaderFileUploaded":function(a,c,d,e,f){void 0===p&&(p=l.getBlockHandler("image"));var g=e.id,h=f.response,i=h.media,j=i.meta,k=l.block.of(a),f=l.data(k);
setTimeout(function(){var c=b.galleryItem().where("fileId",g).removeAttr("data-file-id"),d=c.attr("data-id");mediaUploader.removeItem(e,c);var h=b.createGalleryImage(k,j);c.html(h);var i=j.uri,l=mediaManager.getVariation(i,"icon");f.items[d]={title:j.title,iconUrl:l.url},p.normalizeImageSize(h),k.is(n)&&b.populateList(k),0==b.uploadedItems&&b.setPrimary(d),b.uploadedItems+=1;var m=b.uploadedItems/b.addedItems*100;a.find(b.galleryProgressBar).css("width",m+"%"),100==m&&setTimeout(function(){a.find(b.galleryProgressBar).css("width","0%"),b.uploadedItems=0,b.addedItems=0,a.removeClass("state-uploading")
},1e3)},600)},setPrimary:function(a){var c=b.galleryItem().where("id",a),d=b.galleryMenuItem().where("id",a),e=l.block.of(c),f=l.data(e);f.primary=a,b.populateList(e),b.galleryMenuItem.inside(e).removeClass("active"),d.addClass("active")},setRatio:function(c,d){var e=l.data(c);e.ratio=d;var f=b.galleryStage.inside(c);f.css("padding-top",j(d));var g=b.galleryImage.inside(c);g.each(function(){var b=a(this);p.setImageRatio(b,h(d))})},updateRatio:function(a,c){b.setRatio(a,c),b.populateRatio(a)},populateRatio:function(a){var c=l.data(a),d=c.ratio;
b.ratioLabel().html(d)},"{ratioButton} click":function(){b.sizeFieldset().switchClass(d)},"{ratioCustomizeButton} click":function(){b.sizeFieldset().switchClass(e)},"{ratioCancelButton} click":function(){b.sizeFieldset().removeClass(d)},"{ratioCancelCustomButton} click":function(){b.sizeFieldset().switchClass(d)},"{ratioOkCustomButton} click":function(){b.sizeFieldset().removeClass(e)},"{ratioUseCustomButton} click":function(){var c=b.ratioInput(),d=f(c.val());0!=d&&(b.updateRatio(n,d),b.ratioSelection().removeClass("active"),b.sizeFieldset().removeClass(e))
},"{ratioSelection} click":function(a){b.ratioSelection().removeClass("active"),a.addClass("active"),b.sizeFieldset().removeClass(d);var c=a.data("value");b.updateRatio(n,c)},setResizeStrategy:function(c,d){var e=l.data(c);e.strategy=d;var f=b.galleryImage.inside(c);f.each(function(){var c=a(this);void 0===p&&(p=l.getBlockHandler("image")),p.resizeToViewport(c,d)})},updateResizeStrategy:function(a,c){b.setResizeStrategy(a,c),b.populateResizeStrategy(a)},populateResizeStrategy:function(a){var c=l.data(a),d=c.strategy;
b.strategyMenuItem().removeClass("active").where("strategy",d).addClass("active")},"{strategyMenuItem} click":function(a){var c=a.data("strategy");b.updateResizeStrategy(n,c)},listItems:{},populateList:function(c){var d=l.data(c),e=b.galleryItem.inside(c),f=[];e.each(function(){var c=a(this),e=c.attr("data-id"),g=d.items[e];if(g){var h=b.galleryImage.inside(c);if(h.length){var i=b.listItems[e];i||(i=b.createGalleryListItem(),i.attr("data-id",e),b.listItemTitle.inside(i).text(g.title),b.listItemIcon.inside(i).attr("src",g.iconUrl),b.listItems[e]=i);
var j=e==d.primary;i.toggleClass("is-primary",j).toggleClass("active",c.hasClass("active")),f.push(i)}}}),b.itemsFieldset().toggleClass("is-empty",!f.length),b.listItemGroup().empty().append(f)},"{listItem} click":function(a){var c=a.data("id");b.listItem().removeClass("active"),a.addClass("active");var d=b.galleryItem().where("id",c),e=b.getGalleryItemIndex(n,d),f=b.galleryContainer.of(d);EasyBlog.ImageGallery.go(f,e)},getGalleryItemIndex:function(a,c){var d=b.galleryViewport.of(c),e=d.find(b.galleryItem.selector),f=e.index(c);
return f},"{listItemDeleteButton} click":function(){var c=b.listItem(".active");if(c.length){var d=c.data("id"),e=b.galleryItem().where("id",d),f=e.prev();f.length&&(f=f.next());var g=l.block.of(e);e.remove();var h=b.galleryMenuItem().where("id",d);h.remove();var i=b.galleryContainer.inside(g),j=b.getGalleryItemIndex(f);EasyBlog.ImageGallery.setLayout(i),EasyBlog.ImageGallery.go(i,j),b.populateList(g)}},"{listItemPrimaryButton} click":function(){var c=b.listItem(".active");if(c.length){var d=c.data("id");b.setPrimary(d)
}},hasThumbnails:function(){return!1},"{galleryBrowseButton} mediaSelect":function(a,c,d){"image"==d.meta.type&&b.constructGallery(n,[d])},"{self} mediaInsertGallery":function(a,c,d){if(k.document.isLegacy()){var e=b.toLegacyHTML(d);return k.document.insertContent(e),void 0}var f=l.constructBlock("gallery",d);l.addBlock(f),b.constructGallery(f,d)},"{self} composerBlockDuplicate":function(b,c,d,e){var f=l.getBlockType(d);if("gallery"==f){d.removeAttr("data-uid"),l.setBlockUid(d);var g=l.data(e),h=a.extend(!0,{},g);
l.setBlockData(d,h);var i=l.data(d);a.each(i.itemsKeyArray,function(b,c){var e=i.items[c],f=a.uid("g");c==i.primary&&(i.primary=f),delete i.items[c],delete i.itemsArray[c],delete i.itemsKeyArray[b],i.items[f]=e,i.itemsArray[f]=e,i.itemsKeyArray[b]=f,d.find("[data-id="+c+"]").attr("data-id",f)})}}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/gist",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Gist",{defaultOptions:a.extend({"{form}":"> [data-gist-form]","{insert}":"[data-gist-insert]","{source}":"[data-gist-source]","{preview}":"[data-gist-preview]","{fsSource}":"[data-fs-gist-source]","{fsRefreshButton}":"[data-fs-gist-refresh]","{errorMessage}":"[data-gist-error]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.data(a);return b.source},toEditableHTML:function(){return""},toHTML:function(a){var c=(f.data(a),a.data("overlay"));return c?c.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.source&&!d?(e.empty(),b.createIframe(a,c.source)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()
})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);b.fsSource().val(c.source)},setOverlay:function(a,b){var c=a.data("overlay");if(c)c.element().empty(),c.element().append(b);else{var c=e.document.overlay.create(a),d=f.getBlockContent(a);c.placeholder().css("height","400px").appendTo(d),c.element().append(b),c.attach()}a.data("overlay",c)},isUrlValid:function(a){if(""==a)return!1;var b=/^https:\/\/gist\.github\.com\/(.*)\/(.*)$/,c=b.test(a);return c},createIframe:function(c,d){var e=document.createElement("iframe"),g=f.getBlockContent(c),h=f.data(c);
h.source=d,e.setAttribute("width","100%"),e.id="gistFrame",b.setOverlay(c,e);var i=a.callback(function(a){a+="px",g.find("iframe").css("height",a)}),j='<html><body onload="parent.'+i+'(document.body.scrollHeight);"><script type="text/javascript" src="'+d+'.js"></script></body></html>',k=e.document;return e.contentDocument?k=e.contentDocument:e.contentWindow&&(k=e.contentWindow.document),k.open(),k.writeln(j),k.close(),e},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}{var d=f.getBlockContent(h),e=b.source.inside(d).val();
f.data(h)}return b.isUrlValid(e)?(b.fsSource().val(e),b.createIframe(h,e),b.form.inside(d).addClass("hidden"),void 0):(b.errorMessage().removeClass("hide"),void 0)},"{fsRefreshButton} click":function(){{var a=f.getBlockContent(h),c=b.fsSource().val();f.data(h)}return b.isUrlValid(c)?(b.createIframe(h,c),b.form.inside(a).addClass("hidden"),void 0):(b.errorMessage.inside(a).removeClass("hide"),void 0)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/heading",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Heading",{defaultOptions:{"{headingElement}":"h1, h2, h3, h4, h5, h6","{levelSelection}":"[data-eb-composer-block-heading-level] [data-level]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},activate:function(c){if(h=c,content=b.getContent(c),content=a.trim(content),content==g.data.default){var d=f.getBlockContent(c),e=b.headingElement.inside(d);e.find("> span").html("&nbsp;").focus()}b.toggleFontSizeMenu(!1),b.populate(c)},deactivate:function(c){if(content=b.getContent(c),content=a.trim(content),0==content.length||" "==content){var d=f.getBlockContent(c),e=b.headingElement.inside(d);e.find("> span").html(g.data.default)}b.toggleFontSizeMenu(!0)},construct:function(b){return a.create(b.level).html(b.content)
},reconstruct:function(){},deconstruct:function(a,c){return c&&(a=a.clone()),b.headingElement.inside(a).editable(!1),a},refocus:function(){},reset:function(a){a.html(g.content)},populate:function(a){var c=b.level(a);b.levelSelection().where("level",c).activateClass("active")},toggleFontSizeMenu:function(b){var c=a("[data-eb-font-size-menu]");1==b?c.show():c.hide()},toData:function(a){return f.getData(a)},toHTML:function(a){var a=f.getBlockContent(a);return b.deconstruct(a,!0).html()},toText:function(a){return a.text()
},heading:{inside:function(a){return a.children(":first")}},getHeading:function(a){var c=f.getBlockContent(a),d=b.headingElement.inside(c);return d},level:function(a,c){var d=f.getBlockContent(a),e=b.headingElement.inside(d),g=e.tagName();return c&&g!==c&&(d.html(b.construct({level:c,content:e.html()})),b.headingElement.inside(a).editable(!0),g=c),g},getContent:function(a){var c=b.getHeading(a),d=c.find("> span").text();return"\xa0"==d&&(d=c.text()),d},updateFontFamily:function(a,c){var d=b.getHeading(a);d.css("fontFamily",c)
},setLevel:function(a,c){var c=b.level(a,c),d=b.headingElement.inside(a),e=[a,b,d];b.trigger("composerBlockHeadingSetLevel",e),b.trigger("composerBlockChange",e)},previewLevel:function(a,c){clearTimeout(b.previewTimer);var d=b.headingElement.inside(a),e=d.tagName();a.defineData("originalLevel",e).addClass("is-preview"),b.level(a,c);var f=[a,b,d];b.trigger("composerBlockHeadingPreviewLevel",f),b.trigger("composerBlockChange",f)},previewTimer:null,"{levelSelection} mouseover":function(a){a.data("level")},"{levelSelection} mouseout":function(){clearTimeout(b.previewTimer),b.previewTimer=setTimeout(function(){var a=h.data("originalLevel");
a&&b.setLevel(h,a)},50)},"{levelSelection} click":function(a){var c=a.data("level");b.setLevel(h,c),b.refocus(h)},"{self} composerBlockFontFamilyUnpreview":function(a,c,d,e){var f=h.data("uid"),g=e.data("uid");f==g&&b.updateFontFamily(h,d)},"{self} composerBlockFontFamilyPreview":function(a,c,d,e,f){var g=h.data("uid"),i=f.data("uid");g==i&&b.updateFontFamily(h,d)},"{self} composerBlockFontFamilyChange":function(a,c,d,e){var f=h.data("uid"),g=e.data("uid");f==g&&b.updateFontFamily(h,d)},"{self} composerBlockHeadingSetLevel":function(a,c,d){clearTimeout(b.previewTimer),d.removeClass("is-preview").removeData("originalLevel"),d.is(h)&&b.populate(d)
},"{self} composerBlockDuplicate":function(a,b,c,d){var e=f.getBlockType(c);if("heading"==e){var g=d.attr("style");g&&c.attr("style",g)}}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/html",function(){var b=this;EasyBlog.require().library("ace").done(function(a){EasyBlog.Controller("Composer.Blocks.Handlers.Html",{defaultOptions:{"{pre}":"[data-eb-composer-blocks-html-pre]","{imageWidth}":"[data-html-width]","{imageWidthTextField}":"#imageWidth","{imageHeight}":"[data-html-height]","{imageHeightTextField}":"#imageHeight"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a(),syncing=!1,sessionSync=!1
},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(){},deconstruct:function(){},refocus:function(){},reset:function(){},toText:function(a){var c=(f.data(a),a.clone()),d=f.getBlockContent(c),e=d.text();return e},toData:function(a){var b=f.data(a);return b},toHTML:function(a){var d=(f.data(a),a.clone()),e=f.getBlockContent(d),g=b.editor(),h=g.getSession();return h.setValue(e.html()),e.html()},editor:function(){var c=e.find(b.pre)[0];void 0==c&&(c=a.create("pre")[0]);
var d=ace.edit(c);d.setTheme("ace/theme/github");var g=d.getSession();return g.setMode("ace/mode/html"),sessionSync||(g.on("change",a.debounce(function(){var c=f.data(h),d=g.getValue();if(c.original=d,""!=d){var e=a("<div>"+d+"</div>"),i=e.find(".ebd-block").length;if(i){e.find(".ebd-block").removeClass("ebd-block");var e=a(e).html();c.original=e,g.setValue(e)}}b.sync(c.original)},500)),sessionSync=!0),d},populate:function(c){var d=b.editor(),e=d.getSession(),i=f.getBlockContent(c),j=a.trim(i.html());""==j&&(j=g.html);
var k=f.data(c);k.original?e.setValue(k.original):e.setValue(j),b.populateFieldsetValue(c),h=c},populateFieldsetValue:function(a){var c=f.data(a);b.imageWidth().val(c.imageWidth),b.imageHeight().val(c.imageHeight)},"{imageWidthTextField} keyup":a.debounce(function(a){{var b=f.data(h),c=a.val();f.getBlockContent(h)}b.imageWidth=c}),"{imageHeightTextField} keyup":a.debounce(function(a){{var b=f.data(h),c=a.val();f.getBlockContent(h)}b.imageHeight=c}),sync:function(a){if(!syncing){syncing=!0;var b=f.getBlockContent(h);
a.length>0&&b.html(a),syncing=!1}},reset:function(){}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/image",function(a){function l(a){return a.toString().match("%")?"%":"px"}function m(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}function n(b){if(a.isNumeric(b))return b;if(null==b||void 0==b)return"1:1";var c=b.toString().split(":");return c[0]+":"+c[1]}function p(a,b){return m(1/n(a)*100,b||3)+"%"}function q(a,b){return m(100*a,b||3)+"%"}function s(a,b){return a.css("width",b)}function t(a,b){return a.css("top",b)
}function u(a,b){return a.css("left",b)}function v(a,b){return a.css("padding-top",b)}function w(a,b){return a.css("height",b)}var b=this,e=/fit|fill/,f="is-fluid",g="is-loading",h="is-failed",j="Variation could not be retrieved because media meta does not exist in library!",x=a.Image.resizeWithin,y=a.Image.resizeToFill;EasyBlog.require().library("plupload2","imgareaselect").done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Image",{elements:["[data-eb-composer-image-{placeholder|browse-button}]","[data-eb-image-{url-fieldset|url-field|url-field-text|url-field-update-button}]","[data-eb-image-{source-fieldset|source-field|source-thumbnail|source-title|source-size|source-url|source-change-button}]","[data-eb-image-{variation-field|variation-list-container|variation-new-button|variation-create-button|variation-rebuild-button|variation-delete-button|variation-cancel-button|variation-cancel-failed-button}]","[data-eb-image-source-fieldset] [data-eb-mm-{variation-list|variation-list-item-group|variation-item}]","[data-eb-image-{variation-name|variation-width|variation-height}]","[data-eb-image-{alignment-selection}]","[data-eb-image-{ratio-button|ratio-label|ratio-customize-button|ratio-cancel-button|ratio-use-custom-button|ratio-cancel-custom-button|ratio-selection|ratio-preview|ratio-input}]","[data-eb-image-{map|map-container|map-figure|map-viewport|map-preview|map-picker}]","[data-eb-image-{strategy-menu-item|strategy-menu-content}]","[data-eb-image-{resize-input-field|resize-ratio-lock|resize-reset-button}]","[data-eb-image-{style-toggle|style-selection}]","[data-eb-image-{caption-toggle|caption-text-field}]","[data-eb-image-{alt-toggle|alt-text-field}]","[data-eb-image-{popup-toggle|popup-fieldset|popup-field|popup-thumbnail|popup-title|popup-size|popup-url|popup-change-button}]","[data-eb-image-{popup-variation-field|popup-variation-list-container}]","^popup [data-eb-image-popup-fieldset] [data-eb-mm-{variation-list|variation-list-item-group|variation-item}]"],defaultOptions:a.extend({uploader:{runtimes:"html5,flash",url:"/echo/json",max_file_size:"10mb",filters:[{title:"Image files",extensions:"jpg,gif,png"}]},"{browseButton}":".eb-composer-placeholder-image [data-eb-mm-browse-button]","{urlButton}":".eb-composer-placeholder-image [data-eb-insert-url-button]","{imagePlaceholder}":"[data-eb-composer-image-placeholder]","{imageContainer}":".eb-image","{imageFigure}":".eb-image-figure","{imageViewport}":".eb-image-viewport","{imageElement}":".eb-image-figure img","{imagePopupButton}":".eb-image-popup-button","{imageCaption}":".eb-image-caption","{imageCaptionText}":"[data-image-caption-text]","{imageHint}":".eb-image-hint","{fieldsets}":"[data-eb-image-fieldset]","{imageSizeFieldset}":"[data-eb-image-fieldset-size]","{responsive}":"[data-eb-image-responsive]","{width}":"[data-eb-image-width]","{height}":"[data-eb-image-height]","{lockRatio}":"[data-eb-image-lock-ratio]","{alignmentFieldset}":"[data-eb-image-alignment]","{link}":"[data-eb-image-link]","{linkUrl}":"[data-eb-image-link-url]","{imageUrlForm}":"[data-eb-image-url-form]","{imageUrlTextbox}":"[data-eb-image-url-textbox]","{imageUrlAdd}":"[data-eb-image-url-add]","{imageUrlCancel}":"[data-eb-image-url-cancel]"},EBD.selectors)},function(b,c,d,i,k,m,o,r,z){function A(a){return"image"==k.getBlockType(a)
}return{init:function(){k=b.blocks,i=k.composer,m=c.meta,o=a(),r=EasyBlog.MediaManager,z=i.panels.fieldset},deactivate:function(){},activate:function(a){o=a,a.hasClass("is-new")&&a.css("text-align","center"),b.populate(a)},construct:function(c){var d=k.createBlockContainer("image"),c=a.extend(k.data(d),c),e=k.getBlockContent(d).empty(),f=b.constructImage(c);return e.append(f),d.css("text-align","center"),d},constructFromMediaFile:function(c){var d=c.data("key"),e=r.getUri(d),f=k.createBlockContainer("image"),g=k.getBlockContent(f),h=k.data(f);
return f.css("text-align","center"),f.addClass("is-loading"),r.getMedia(e).done(function(a){var c=a.meta,d=r.getVariation(c.uri,"thumbnail");h.uri=c.uri,h.url=d.url,h.simple="simple",h.ratio_lock=!0,h.variation=d.key;var e=b.constructImage(h);g.html(e),f.hasClass("active")&&b.populate(f)}).fail(function(){var b=a(m.html);b.addClass("state-failed"),g.html(b)}).always(function(){f.removeClass("is-loading")}),f},constructImage:function(c){var d=a(m.imageContainer),e=b.imageFigure.inside(d),g=b.imageElement.inside(d);
if(g.attr("src",c.url),c.fluid&&d.addClass(f),d.addClass("style-"+c.style),c.alignment&&(/left|right/.test(c.alignment)&&d.css("float",c.alignment),/center/.test(c.alignment)&&d.css("float","")),c.caption_text&&(d.append(m.imageCaption),b.imageCaptionText.inside(d).html(c.caption_text)),c.popup_url){var h=a(m.imagePopupButton);h.attr("href",c.popup_url),e.append(h)}return d},toData:function(a){var b=k.data(a);return b},toHTML:function(a){if(!b.hasImage(a))return"";var c=a.clone(),d=b.deconstruct(c),e=k.getBlockContent(d);
return e.html()},toLegacyHTML:function(c){var d=b.toData(c),e=a("<img>").attr({src:d.url,width:d.width,height:d.height});if(d.caption_text&&e.addClass("easyblog-image-caption").attr("title",d.caption_text),d.alt_text&&e.attr("alt",d.alt_text),d.popup_url&&e.attr("data-popup",d.popup_url),d.style&&e.attr("data-style",d.style),d.alignment&&e.attr("align",d.alignment),d.link_url){var f=a("<a>").attr({href:d.link_url,title:d.link_title,target:d.link_target}).append(e);return f.prop("outerHTML")}return e.prop("outerHTML")
},toText:function(a){var c=b.imageCaptionText.inside(a).text(),d=b.imageElement.inside(a).attr("alt");return c+"\n"+d},reconstruct:function(a){var c=b.imagePlaceholder.inside(a);c.length>0&&EasyBlog.MediaManager.uploader.register(c)},hasImage:function(a){return b.imageContainer.inside(a).length>0},"{imagePlaceholder} mediaUploaderFilesAdded":function(a,b,c,d){EasyBlog.MediaManager.uploader.addItem(d[0],a)},"{imagePlaceholder} mediaUploaderFileUploaded":function(a,c,d,e,f){var g=f.response,h=g.media,i=h.meta,j=k.block.of(a);
b.updateImageSource(j,i)},"{sourceChangeButton} mediaSelectStart":function(a){var b=o.data("uid");a.data("uid",b)},"{sourceChangeButton} mediaSelect":function(a,c,d){if("image"==d.meta.type){var e=o.data("uid"),f=a.data("uid"),g=d.meta,h=i.document,j=h.isLegacy();if(j)content=b.toLegacyHTML(l),h.insertContent(content);else if(e!=f){var l=k.getBlock(f);b.setImageSource(l,g)}else b.updateImageSource(o,g)}},"{browseButton} mediaSelect":function(c,d,e,f){var g=k.block.of(c);if("image"==e.meta.type){var h=k.data(g);
h=a.extend(h,f);var j=i.document,l=j.isLegacy();l?(content=b.toLegacyHTML(g),j.insertContent(content)):(b.setImageSource(g,e),k.activateBlock(g))}},"{self} mediaInsert":function(c,d,e,f,g,h){if("image"==e.meta.type){var j=i.document,l=j.isLegacy();if(b.normalizeImageSize(f),l){var m=k.data(f);return g=a.extend(m,g),content=b.toLegacyHTML(f),console.log(content),j.insertContent(content),void 0}var f=k.constructBlock("image",g);if(k.addBlock(f),!h){k.activateBlock(f);var n=g.link;b.triggerLinkChange(n)}}},deconstruct:function(a){return b.imageCaptionText.inside(a).editable(!1),a
},refocus:function(){},reset:function(){},populate:function(a){var c=b.hasImage(a),d=k.panel.fieldgroup.get("image");d.toggleClass("is-new",!c),c&&(b.populateImageUrl(a),b.populateImageSource(a),b.populateImageSize(a),b.populateImageAlignment(a),b.populateImageCaption(a),b.populateImageAlt(a),b.populateImageLink(a),b.populateImageStyle(a),b.populateImageResponsive(a))},showImageHint:function(c,d){b.imageHint.inside(c).remove();var e=a(m.imageHint);e.find(".eb-hint-text").html(d);var f=b.imageViewport.inside(c);
f.append(e),e.removeClassAfter("is-new",1e3),setTimeout(function(){e.remove()},2500)},setImageSource:function(a,c){var d=k.data(a),e=d.variation;if(void 0!==c.params){var f=JSON.parse(c.params);e=void 0!==f.variation?f.variation:d.variation}var g=r.getVariation(c.uri,e);d.variation=g.key,d.url=g.url,d.uri=c.uri,d.natural_width=g.width,d.natural_height=g.height,d.natural_ratio=g.width/g.height;var h=b.constructImage(d);k.getBlockContent(a).empty().append(h),b.setImageAlignment(a,d.alignment)},updateImageSource:function(a,c){b.setImageSource(a,c),b.populate(a)
},getSourceThumbnailImage:function(b){return a("<img>").attr("src",b)[0]},populateImageUrl:function(a){var c=k.data(a),d=b.urlFieldset();return d.removeClass("t-hidden"),c.isurl?(b.urlFieldText().val(c.url),void 0):(d.addClass("t-hidden"),void 0)},populateImageSource:function(c){var d=k.data(c),e=b.sourceFieldset();if(e.removeClass("hidden"),d.isurl)return e.addClass("hidden"),void 0;var f=d.uri,e=b.sourceFieldset();e.addClass(g),r.getMedia(f).done(function(d){var e=d.meta;b.sourceThumbnail().css("background-image","url("+e.preview+")"),b.sourceTitle().text(e.title);
var f=a(d.variations);b.variationListContainer().empty().append(f),b.populateImageVariation(c)}).fail(function(){e.addClass(h)}).always(function(){e.removeClass(g)})},populateImageVariation:function(c){var d=k.data(c),e=d.uri,f=d.variation,g=r.getVariation(e,f);if(!g)return console.error(j),void 0;var h=b.variationItem().where("key",'"'+f+'"').activateClass("active");b.sourceSize().text(a.plupload2.formatSize(g.size||"")),b.sourceUrl().text(g.url||"");var i=h.hasClass("is-system"),l=h.hasClass("is-missing");
b.variationField().toggleClass("can-delete",!i).toggleClass("is-missing",l)},setImageVariation:function(c,d){var e=k.data(c),f=e.uri,g=r.getVariation(f,d);if(void 0!==g){e.url=g.url,b.imageElement.inside(c).attr("src",g.url),b.showImageHint(c,a.String.capitalize(g.name)+'<br/><span style="font-weight: normal;">'+g.width+"x"+g.height+"</span>"),e.variation=d;{e.ratio_lock}b.isInsideThumbnailBlock(c)||(b.setImageWidth(c,g.width),b.setImageHeight(c,g.height)),b.width().val(g.width),b.height().val(g.height)}},isInsideThumbnailBlock:function(a){var b=a.parent().parent(".eb-thumb").length>0;
return b},updateImageVariation:function(a,c){b.setImageVariation(a,c),b.populateImageVariation(a)},"{variationItem} click":function(a){var c=a.data("key");b.updateImageVariation(o,c)},"{variationNewButton} click":function(){b.variationField().addClass("show-create-form");var c=k.data(o),d=c.uri,e=r.getVariation(d,"system/original"),f=e.width,g=e.height,h=f/g;b.variationWidth().val(f).data("value",f).data("ratio",h),b.variationHeight().val(g).data("value",g).data("ratio",h)},"{variationCancelButton} click":function(){b.variationField().removeClass("show-create-form")
},"{variationCreateButton} click":function(){var d=b.variationField(),e=a.trim(b.variationName().val()),f=b.variationWidth().val(),g=b.variationHeight().val();if(""!=a.trim(e)){d.addClass("is-creating");var h=o,i=k.data(h),j=i.uri;r.createVariation(j,e,f,g).done(function(c){var e=a(c.variations);b.variationListContainer().empty().append(e),b.populateImageVariation(h),d.removeClass("show-create-form")}).fail(function(){d.removeClass("is-creating").addClass("is-failed")}).always(function(){d.removeClass("is-creating")
})}},"{variationCancelFailedButton} click":function(){b.variationField().removeClass("is-failed")},"{variationRebuildButton} click":function(){var d=k.data(o),e=d.uri,f=b.variationItem(".active"),g=f.data("key"),h=r.getVariation(e,g),i=h.name,j=r.getKey(e);EasyBlog.ajax("site/views/mediamanager/rebuildVariation",{name:i,key:j}).done(function(c){var d=a(c.variations);b.variationListContainer().empty().append(d),b.populateImageVariation(o),r.setMedia(e,c)})},"{variationDeleteButton} click":function(){var d=k.data(o),e=d.uri,f=b.variationItem(".active"),g=f.data("key"),h=r.getVariation(e,g),i=h.name;
r.removeVariation(e,i).done(function(c){var d=a(c.variations);b.variationListContainer().empty().append(d);var f=r.getVariation(e,"thumbnail");b.updateImageVariation(o,f.key)})},"{variationWidth} input":function(c){var d=c.data("ratio"),e=Math.round(parseFloat(c.val()));if(a.isNumeric(e)){var f=Math.round(e/d);b.variationHeight().val(f)}},"{variationHeight} input":function(c){var d=c.data("ratio"),e=Math.round(parseFloat(c.val()));if(a.isNumeric(e)){var f=Math.round(e*d);b.variationWidth().val(f)}},"{variationWidth} focus":function(a){a.select()
},"{variationHeight} focus":function(a){a.select()},"{variationWidth} blur":function(c){var d=c.data("ratio"),e=Math.round(parseFloat(c.val()));if(c.val(e),!a.isNumeric(e)){var f=b.variationHeight(),g=Math.round(parseFloat(f.val()));a.isNumeric(g)?(e=Math.round(g*d),c.val(e),f.val(g)):b.resetVariationFields()}},"{variationHeight} blur":function(c){var d=c.data("ratio"),e=Math.round(parseFloat(c.val()));if(c.val(e),!a.isNumeric(e)){var f=b.variationWidth(),g=Math.round(parseFloat(f.val()));a.isNumeric(g)?(e=Math.round(g/d),f.val(g),c.val(e)):b.resetVariationFields()
}},resetVariationFields:function(){var a=b.variationWidth(),c=b.variationHeight();a.val(a.data("width")),c.val(c.data("height"))},populateImageSize:function(c){var d=function(){var a=k.data(c),d=parseInt(b.getImageWidth(c)),e=parseInt(b.getImageHeight(c));b.width().val(d),b.height().val(e);var f=a.width_lock&&a.height_lock;f?b.fieldsets("[data-type=simple]").addClass("t-hidden"):b.fieldsets("[data-type=simple]").removeClass("t-hidden"),b.lockRatio().prop("checked",a.ratio_lock)},e=b.imageElement.inside(c);if(e[0].complete){d();
{k.data(c)}b.imageSizeFieldset().removeClass("is-loading")}else{var g=e.attr("src");b.imageSizeFieldset().addClass("is-loading"),a.Image.get(g).done(function(){var e=k.data(c);e.natural_ratio=e.width/e.height,d(c)}).always(function(){b.imageSizeFieldset().removeClass("is-loading")})}},setImageSize:function(a,c,d){"width"==c&&b.setImageWidth(a,d),"height"==c&&b.setImageHeight(a,d)},updateImageSize:function(a,c,d){b.setImageSize(a,c,d),b.populateImageSize(a)},isFluidImage:function(a){return b.imageContainer.inside(a).hasClass(f)
},isFixedImage:function(a){return!b.isFluidImage(a)},toFixedImage:function(a){var c=k.data(a),d=b.imageElement.inside(a),e=d.width(),f=d.height();b.setImageWidth(a,e);var g=c.ratio_lock;g||b.setImageHeight(a,f)},toFluidImage:function(a){var c=k.data(a),d=b.imageContainer.inside(a),e=b.imageElement.inside(a);if(k.isRootBlock(a))var f=d.width(),g=a.width(),h=Math.round(f/g*100)+"%";if(k.isNestedBlock(a))var h="100%";var i=e.height();b.setImageWidth(a,h);var j=c.ratio_lock;j||b.setImageHeight(a,i)},normalizeImageSize:function(a){var c=k.data(a),d=b.isFluidImage(a);
if(k.isRootBlock(a))var e=b.imageFigure.inside(a).width();if(k.isNestedBlock(a))var e=b.imageFigure.inside(a).width();b.setImageWidth(a,e),(d||"advanced"==c.mode)&&b.toFluidImage(a)},resetImageSize:function(a){var c=k.data(a);c.mode="simple";b.imageContainer.inside(a),b.imageFigure.inside(a),b.imageElement.inside(a);k.isNestedBlock(a)&&b.setImageWidth(a,a.css("width"))},getImageWidth:function(a){var c=b.imageFigure.inside(a),d=c[0].style;if(k.isRootBlock(a)){var e=b.imageContainer.inside(a),f=e[0].style.width;
if(/%/.test(f))return f}if(k.isNestedBlock(a)){var g=a[0].style.width;if(/%/.test(g))return g}return d.width||c.css("width")},getImageHeight:function(a){var c=b.imageFigure.inside(a),d=c[0].style;return d.height||c.css("height")},setImageWidth:function(a,c){var d=k.getData(a),e=l(c),g=parseFloat(c),h="%"==e,i="px"==e,j="simple"==d.mode,m="advanced"==d.mode,o=b.imageContainer.inside(a),q=b.imageElement.inside(a),t=(b.imageViewport.inside(a),b.imageFigure.inside(a)),x=(q.width(),q.height());h&&(d.fluid=!0,o.addClass(f)),i&&(d.fluid=!1,o.removeClass(f)),m&&b.toFixedElement(a),k.isRootBlock(a)&&(a.css("width",""),h&&(s(o,c),s(t,"100%"),j&&(s(q,"100%"),d.element_width="100%")),i&&(s(o,""),s(t,c),j&&(s(q,c),d.element_width=parseFloat(c)))),k.isNestedBlock(a)&&(h&&(s(a,c),s(t,""),j&&(s(q,"100%"),d.element_width="100%")),i&&(s(a,"auto"),s(t,c),j&&(s(q,c),d.element_width=parseFloat(c)))),d.width=h?c:g;
var y=d.ratio,z=d.ratio_lock,A=d.natural_ratio;if(z){var B=j?A:y;if(h&&(w(t,""),v(t,p(B)),j&&(w(q,"100%"),d.element_height="100%"),d.height="100%"),i){var C=g/n(B);w(t,C),v(t,""),j&&(w(q,C),d.element_height=C),d.height=C;var D=parseInt(d.height);b.height().val(D)}d.ratio=B,j&&(d.element_ratio=B)}else{var E=q.width(),y=E/x;h&&v(t,p(y)),i&&v(t,""),d.ratio=y,j&&(d.element_ratio=y)}if(m){b.toFluidElement(a);var F=d.strategy;/fit|fill/.test(F)&&b.resizeToViewport(a,F)}var G=b.imageCaption.inside(a);h&&s(G,"100%"),i&&s(G,c)
},setImageHeight:function(a,c){var d=k.data(a),c=parseFloat(c),e=d.ratio,f=d.ratio_lock,g=d.natural_ratio,h="simple"==d.mode,i="advanced"==d.mode,j=b.imageElement.inside(a),m=(b.imageViewport.inside(a),b.imageFigure.inside(a));if(b.isFluidImage(a)){if(f){var o=h?g:e,q=c*n(o);b.setImageWidth(a,q),b.toFluidImage(a),d.ratio=o,h&&(d.element_ratio=o)}else{i&&b.toFixedElement(a);var r=j.width(),e=r/c;if(v(m,p(e)),d.ratio=e,h&&(d.element_ratio=e),i){b.toFluidElement(a);var s=d.strategy;/fit|fill/.test(s)&&b.resizeToViewport(a,s)
}}d.height="100%"}if(b.isFixedImage(a))if(f){var o=h?g:e,q=c*n(o);b.setImageWidth(a,q),inputWidth=parseInt(q),b.width().val(inputWidth)}else w(m,c),w(j,c),d.height=c,d.element_width=parseFloat(c)},"{imageCaptionText} input":function(a){var d=a.text();b.captionTextField().val(d);var e=k.data(o);e.caption_text=d},"{responsive} change":function(a){var d=a.is(":checked");b.setImageResponsive(o,d)},"{self} composerBlockResizeStart":function(a,c,d){if(A(d)&&b.hasImage(d)){var f=b.imageFigure.inside(d),g={width:f.width(),height:f.outerHeight(),fluid:!1};
d.data("initialImageSize",g)}},"{self} composerBlockBeforeResize":function(a,c,d,e){function l(){var a=f.width+i;b.setImageWidth(d,a)}function m(){var a=f.height+j;b.setImageHeight(d,a)}if(A(d)&&b.hasImage(d)){c.preventDefault();var f=d.data("initialImageSize"),g=e.originalSize,h=e.size,i=h.width-g.width,j=h.height-g.height,n=k.data(d),o=n.ratio_lock;o?0==i?m():l():(0!==i&&l(),0!==j&&m()),f.fluid&&b.toFluidImage(d),b.populateImageSize(d)}},"{self} composerBlockResizeStop":function(a,c,d){A(d)&&b.hasImage(d)&&d.removeData("initialImageSize")
},"{self} composerBlockNestIn":function(a,c,d){A(d)&&b.hasImage(d)&&(b.resetImageSize(d),b.populateImageSize(d))},"{self} composerBlockNestOut":function(a,c,d){A(d)&&b.hasImage(d)&&(b.resetImageSize(d),b.populateImageSize(d))},populateImageResponsive:function(a){var c=k.data(a),d=c.responsive;b.updateImageResponsive(a,d)},setImageResponsive:function(a,c){var d=k.data(a);d.responsive=c,b.updateImageResponsive(a,c)},updateImageResponsive:function(a,c){var d=b.imageFigure.inside(a);d.toggleClass("is-responsive",c)
},setImageAlignment:function(a,c){var d=b.imageContainer.inside(a);/left|right/.test(c)&&(d.css("float",c),a.css("text-align","")),/center/.test(c)&&(d.css("float",""),a.css("text-align","center"));var e=k.data(a);e.alignment=c},updateImageAlignment:function(a,c){b.setImageAlignment(a,c),b.populateImageAlignment(a)},populateImageAlignment:function(a){k.isNestedBlock(a);var c=k.data(a),d=c.alignment;b.alignmentSelection().val(d)},"{alignmentSelection} change":function(a){var c=a.val();b.updateImageAlignment(o,c)
},populateImageAdvancedFields:function(a){var c=k.data(a);"advanced"===c.mode&&(b.populateImageResizeStrategy(a),b.populateImageResizeMap(a),b.populateImageResizeFields(a))},populateImageResizeStrategy:function(a){var c=k.data(a),d=c.strategy;b.strategyMenuItem().where("strategy",d).activateClass("active"),b.strategyMenuContent().where("strategy",d).activateClass("active")},setImageRatio:function(a,c){var d=k.data(a);d.ratio=c;var f=d.ratio_lock=0!==c;if(f){var g="simple"==d.mode,h="advanced"==d.mode;if(g&&(d.element_ratio=c,b.normalizeImageSize(a)),h){var i=d.strategy;
e.test(i)?(b.normalizeImageSize(a),b.resizeToViewport(a,i)):(b.toFixedElement(a),b.normalizeImageSize(a),b.toFluidElement(a))}}},setImageResizeStrategy:function(a,c){var d=k.data(a);d.strategy=c,e.test(c)&&b.resizeToViewport(a,c)},updateImageResizeStrategy:function(a,c){b.setImageResizeStrategy(a,c),b.populateImageAdvancedFields(a)},resizeToViewport:function(a,c){var d=k.data(a),e=d.natural_width,f=d.natural_height,g=b.imageViewport.inside(a),h=g.width(),i=g.height(),j=("fit"==c?x:y)(e,f,h,i),l=d.element_width=q(j.width/h),m=d.element_height=q(j.height/i),n=d.element_top=q(j.top/i),o=d.element_left=q(j.left/h),p=b.imageElement.inside(a);
p.css({width:l,height:m,top:n,left:o})},resizeToFillViewport:function(a){b.setImageResizeStrategy(a,"fill")},resizeToFitViewport:function(a){b.setImageResizeStrategy(a,"fit")},"{strategyMenuItem} click":function(a){var c=a.data("strategy");b.updateImageResizeStrategy(o,c)},populateImageMode:function(c){var d=k.data(c),e=d.mode,f=d.mode_lock;k.isRootBlock(c)&&(e="simple",f=!0),b.imageSizeFieldset().toggleClass("mode-lock",f);var g=b.imageSizePreset().removeClass("active").where("type",e).addClass("active"),h=a.trim(g.text());
b.imageSizeCurrentPreset().html(h);var i="preset-"+e;b.imageSizeFieldset().switchClass(i)},setImageMode:function(a,c){"simple"==c&&b.toSimpleImageMode(a),"advanced"==c&&b.toAdvancedImageMode(a)},toSimpleImageMode:function(a){var c=k.data(a);c.mode="simple",c.ratio=c.natural_ratio,c.ratio_lock=!0,c.element_width="",c.element_height="",c.element_top="",c.element_left="";var d=b.imageElement.inside(a);d.css({width:"",height:"",top:"",left:""}),b.normalizeImageSize(a)},toAdvancedImageMode:function(a){var c=k.data(a);
c.mode="advanced",c.ratio||(c.ratio=c.natural_ratio),c.element_ratio||(c.element_ratio=c.ratio),b.normalizeImageSize(a),b.resizeToFitViewport(a)},updateImageMode:function(a,c){b.setImageMode(a,c),b.populateImageSize(a)},"{imageSizePreset} click":function(a){var c=a.data("type");b.updateImageMode(o,c)},populateImageResizeMap:function(c){var d=k.data(c);if("custom"===d.strategy){var e=b.mapFigure(),f=e.width(),g=e.height(),h=b.imageViewport(),i=h.width(),j=h.height(),l=b.mapViewport(),m=x(i,j,f,g);l.css(m);var n=b.mapPreview(),o=["n","s","w","e","sw","se","nw","ne"],p=b.createResizeHandleElements(o),q=b.createResizeHandleSelectors(o);
n.hasClass("ui-resizable")&&n.resizable("destroy"),n.hasClass("ui-draggable")&&n.draggable("destroy"),n.css({backgroundImage:a.cssUrl(d.url),width:d.element_width,height:d.element_height,top:d.element_top,left:d.element_left}).empty().append(p).resizable({handles:q,aspectRatio:d.element_ratio_lock}).draggable()}},createResizeHandleSelectors:function(b){var c=[];return a.each(b,function(a,b){c[b]="> .ui-resizable-"+b}),c},createResizeHandleElements:function(b){var c=[];return a.each(b,function(b,d){var e=a('<div class="ui-resizable-handle ui-resizable-'+d+'"><div></div></div>')[0];
c.push(e)}),c},getElementSizeFromMap:function(){var a=b.mapViewport(),c=a.width(),d=a.height(),e=b.mapPreview(),f=e.position(),g=f.top,h=f.left,i=e.width(),j=e.height(),k=q(g/d),l=q(h/c),m=q(i/c),n=q(j/d);return{top:k,left:l,width:m,height:n}},setElementSizeFromMap:function(a){var c=k.data(a),d=b.getElementSizeFromMap(),e=b.imageElement.inside(a);e.css(d),b.setElementSizeOnBlockData(d,c)},updateElementSizeFromMap:function(a){b.setElementSizeFromMap(a),b.populateImageResizeFields(a)},setElementSizeOnBlockData:function(a,b){for(var d,c=["top","left","width","height"];d=c.shift();)b["element_"+d]=a[d]
},toFixedElement:function(a){var c=b.imageElement.inside(a),d=c.position(),e=d.top,f=d.left,g=c.width(),h=c.height();c.css({width:g,height:h,top:e,left:f})},toFluidElement:function(a){var c=k.data(a),d=b.imageElement.inside(a),e=d.position(),f=e.top,g=e.left,h=d.width(),i=d.height(),j=b.imageViewport.inside(a),l=j.width(),m=j.height(),n=c.element_top=q(f/m),o=c.element_left=q(g/l),p=c.element_width=q(h/l),r=c.element_height=q(i/m);d.css({top:n,left:o,width:p,height:r})},"{mapPreview} resize":function(){b.updateElementSizeFromMap(o)
},"{mapPreview} drag":function(){b.updateElementSizeFromMap(o)},populateImageResizeFields:function(a){for(var f,c=k.data(a),d=b.resizeInputField(),e=["width","height","top","left"];f=e.shift();){if(b.resizingFromInput==f)return;d.where("prop",f).val(c["element_"+f])}b.resizeRatioLock().prop("checked",c.element_ratio_lock)},setElementSize:function(c,d,e){return b["setElement"+a.capitalize(d)](c,e)},updateElementSize:function(a,c,d){b.setElementSize(a,c,d),b.populateImageAdvancedFields(a)},setElementWidth:function(a,c){var d=k.data(a),f=(parseFloat(c),l(c)),g=d.element_ratio,h=d.element_ratio_lock,i=b.imageViewport.inside(a),j=b.imageElement.inside(a);
if("%"==f)if(h){var m=d.element_width,n=j.width(),o=c,p=n*(parseFloat(o)/parseFloat(m)),r=p/g,t=i.height(),u=q(r/t);d.element_width=o,d.element_height=u,s(j,o),w(j,u)}else{var o=c;d.element_width=parseFloat(o),s(j,o)}},setElementHeight:function(a,c){var d=k.data(a),f=(parseFloat(c),l(c)),g=d.element_ratio,h=d.element_ratio_lock,i=b.imageViewport.inside(a),j=b.imageElement.inside(a);if("%"==f)if(h){var m=d.element_height,n=j.height(),o=c,p=n*(parseFloat(o)/parseFloat(m)),r=p*g,t=i.width(),u=q(r/t);d.element_width=u,d.element_height=o,s(j,u),w(j,o)
}else{var o=c;d.element_height=o,w(j,o)}},setElementTop:function(a,c){var d=k.data(a);d.element_top=c;var e=b.imageElement.inside(a);t(e,c)},setElementLeft:function(a,c){var d=k.data(a);d.element_left=c;var e=b.imageElement.inside(a);u(e,c)},setElementRatio:function(a,c){var d=k.data(a);d.element_ratio=c,b.setElementWidth(a,d.element_width)},updateElementRatio:function(a,c){b.setElementRatio(a,c),b.populateImageAdvancedFields(a)},resetElementSize:function(a){b.setImageResizeStrategy(a,"fit"),b.setImageResizeStrategy(a,"custom"),b.populateImageAdvancedFields(a)
},lockElementRatio:function(a){var c=k.data(a);c.element_ratio_lock=!0;var d=c.natural_ratio;b.updateElementRatio(a,d)},unlockElementRatio:function(a){var c=k.data(a);c.element_ratio_lock=!1,b.populateImageAdvancedFields(a)},lockImageRatio:function(a){var c=k.data(a);c.ratio_lock=!0,b.normalizeImageSize(a)},unlockImageRatio:function(a){var b=k.data(a);b.ratio_lock=!1},"{lockRatio} change":function(a){var d=a.is(":checked");return d?(b.lockImageRatio(o),void 0):(b.unlockImageRatio(o),void 0)},"{width} change":function(a){{var d=o,e=k.data(d),f=parseInt(a.val());
parseInt(e.width)}b.setImageWidth(o,f)},"{height} change":function(a){var d=o,e=k.data(d),f=parseInt(a.val()),g=parseInt(e.height);(0==f||1==f)&&(f=g),b.setImageHeight(o,f)},populateImageAlt:function(a){var c=k.data(a),d=b.imageElement.inside(a).attr("alt"),e=!1;void 0!==d&&d.length>0&&(e=!0);var f=c.alt_text;b.altTextField().val(""),f&&b.altTextField().val(f)},populateImageCaption:function(a){var c=k.data(a),e=(b.imageCaption.inside(a).length,c.caption_text);b.captionTextField().val(""),e&&b.captionTextField().val(e)
},getImageCaption:function(a){var b=k.data(a);return b.caption_text},setImageCaption:function(c,d){var e=b.imageCaption.inside(c);if(!e.length){var e=a(m.imageCaption),f=b.imageContainer.inside(c);f.append(e)}var g=b.imageCaptionText.inside(c);g.text(d);var h=k.data(c);h.caption_text=d},removeImageCaption:function(a){var c=b.imageCaption.inside(a);b.setImageCaption(a,""),c.remove()},disableImageCaption:function(a){b.removeImageCaption(a),b.populateImageCaption(a)},"{captionTextField} input":function(a){var d=a.val();
return""==d?(b.disableImageCaption(o),void 0):(b.setImageCaption(o,d),void 0)},setImageAlt:function(a,c){b.imageElement.inside(a).prop("alt",c);var d=k.data(a);d.alt_text=c},removeImageAlt:function(a){b.imageElement.inside(a).removeAttr("alt")},"{altTextField} input":function(c){var e=a.trim(c.val());return""==e?(b.removeImageAlt(o),void 0):(b.setImageAlt(o,e),void 0)},populateImageStyle:function(a){var c=k.data(a),d=c.style_enabled;z.toggle("image-style",d),b.styleSelection().where("value",c.style).activateClass("active")
},setImageStyle:function(a,c){var d=b.imageContainer.inside(a);d.switchClass("style-"+c);var e=k.data(a);e.style=c},updateImageStyle:function(a,c){b.setImageStyle(a,c),b.populateImageStyle(a)},"{styleSelection} click":function(a){var d=a.data("value");b.updateImageStyle(o,d)},populateImageLink:function(a){var c=k.data(a);return b.link().val(c.link),"none"==c.link?(b.linkUrl().addClass("t-hidden"),void 0):("custom"!=c.link&&b.linkUrl().addClass("t-hidden"),("custom"==c.link||"custom_new"==c.link)&&(b.linkUrl().removeClass("t-hidden"),b.linkUrl().val(c.link_url),b.linkUrl().trigger("input")),void 0)
},setImageLinkUrl:function(c,d){var e=k.data(c);e.link_url=d=a.trim(d);var f=b.imageViewport.inside(c);d?(f.attr("href",d),"custom_new"==e.link&&f.attr("target","_blank")):f.removeAttr("href")},removeImageLink:function(a){var c=k.data(a);c.link_url="";var d=b.imageViewport.inside(a);d.removeAttr("href"),d.removeAttr("target"),b.populateImageLink(a)},addImageLinkTarget:function(a){var c=b.imageViewport.inside(a);c.attr("target","_blank")},removeImageLinkTarget:function(a){var c=b.imageViewport.inside(a);c.removeAttr("target")
},setImagePopup:function(a,c,d){var e=k.data(a);b.imagePopupButton.inside(a).remove();var c=e.popup_uri=c||e.popup_uri||e.uri,d=e.popup_variation=d||e.popup_variation;if(!e.isurl){var f=r.getMedia(c).done(function(d){var g=(d.meta,r.getVariation(c,["system/original"]));e.popup_url=g.url,e.popup_variation=g.key,b.imagePopupButton.inside(a).attr("href",e.popup_url)});return f}e.popup_url=c},removeImagePopup:function(a){var c=k.data(a);c.popup_url="",c.popup_uri="",c.popup_variation="",b.imagePopupButton.inside(a).remove()
},triggerLinkChange:function(a){("custom"==a||"custom_new"==a)&&b.linkUrl().removeClass("t-hidden"),"lightbox"==a&&b.setImagePopup(o),"custom"!=a&&"custom_new"!=a&&b.removeImageLink(o),"lightbox"!=a&&("custom"==a&&b.removeImageLinkTarget(o),"custom_new"==a&&b.addImageLinkTarget(o),b.removeImagePopup(o))},"{link} change":function(a){var d=k.data(o),e=a.val();d.link=e,b.triggerLinkChange(e),d.link_url&&"lightbox"!=e&&b.setImageLinkUrl(o,d.link_url)},"{linkUrl} input":function(a){var d=a.val();b.setImageLinkUrl(o,d)
},"{imageViewport} click":function(a,b){b.preventDefault()},"{imageUrlAdd} click":function(){var d=b.imageUrlTextbox().val();if(d){var f=(k.getBlockContent(o),k.data(o));o.css("text-align","center"),f.uri=d,f.url=d,f.simple="simple",f.ratio_lock=!0,f.isurl=!0;var g=b.constructImage(f);k.getBlockContent(o).empty().append(g),o.hasClass("active")&&b.populate(o)}},"{urlButton} click":function(a){a.parents(b.imagePlaceholder()).addClass("inserting-url")},"{imageUrlCancel} click":function(a){a.parents(b.imagePlaceholder()).removeClass("inserting-url")
},"{urlFieldUpdateButton} click":function(){var d=b.urlFieldText().val();if(d){var e=k.data(o);e.uri=d,e.url=d;var f=b.constructImage(e);k.getBlockContent(o).empty().append(f)}},"{self} composerPaste":function(b,c,d){var e=d.find("img"),f=i.document,g=f.isLegacy();g||a.each(e,function(b,c){var c=a(c),d={uri:c.attr("src"),url:c.attr("src"),simple:"simple",ratio_lock:!0,isurl:!0},e=k.constructBlock("image",d);k.addBlock(e)})}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/instagram",function(a){var b=this;
EasyBlog.Controller("Composer.Blocks.Handlers.Instagram",{defaultOptions:a.extend({"{form}":"> [data-instagram-form]","{insert}":"[data-instagram-insert]","{source}":"[data-instagram-source]","{preview}":"[data-instagram-preview]","{fsSource}":"[data-fs-instagram-source]","{fsRefreshButton}":"[data-fs-instagram-refresh]","{errorMessage}":"[data-instagram-error]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.data(a);
return b.source},toEditableHTML:function(){return""},toHTML:function(a){var b=a.data("overlay");return b?b.element().html():void 0},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},deconstruct:function(a){var c=f.getBlockContent(a);return b.form.inside(c).remove(),a},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.source&&!d?(e.empty(),b.createIframe(a,c.source)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()
})},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);b.fsSource().val(c.source)},createIframe:function(c,d){var e=a.create("iframe"),g=f.data(c);d=b.sanitizeUrl(d),g.source=d,e.attr("src",d),b.setOverlay(c,e)},sanitizeUrl:function(a){return a=a.replace("?modal=true",""),a=a.replace(/\/$/,""),a.match(/\/embed/)||(a+="/embed/"),a},setOverlay:function(a,b){var c=a.data("overlay");if(c)c.element().empty(),c.element().append(b);else{c=e.document.overlay.create(a);var d=f.getBlockContent(a);
c.placeholder().css("height","400px").appendTo(d),c.element().append(b),c.attach()}a.data("overlay",c)},isUrlValid:function(a){if(""==a)return!1;var b=/^(?:http(?:s)?:\/\/)?www\.instagram\.com\/p\/(.*)(?:\/)?$/,c=b.test(a);return c},"{insert} click":function(a){if(h.length<1){var d=b.block.of(a);f.activateBlock(d)}var e=f.getBlockContent(h),g=b.source.inside(e).val(),g=g.replace("?utm_source=ig_web_copy_link","");return b.isUrlValid(g)?(b.fsSource().val(g),b.createIframe(h,g),b.form.inside(e).addClass("hidden"),void 0):(b.errorMessage().removeClass("hide"),void 0)
},"{fsRefreshButton} click":function(){var a=f.getBlockContent(h),c=b.fsSource().val();return b.isUrlValid(c)?(b.createIframe(h,c),b.form.inside(a).addClass("hidden"),void 0):(b.errorMessage().removeClass("hide"),void 0)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/links",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Links",{defaultOptions:{"{loader}":"> [data-link-loader]","{form}":"> [data-link-form]","{addLink}":"[data-link-add]","{linkInput}":"[data-link-input]","{errorMessage}":"[data-link-error]","{preview}":"> [data-link-preview]","{previewTitle}":"> [data-link-preview] [data-preview-title]","{previewContent}":"> [data-link-preview] [data-preview-content]","{previewLink}":"> [data-link-preview] [data-preview-link]","{previewImage}":"> [data-link-preview] [data-preview-image]","{imageWrapper}":"> [data-link-preview] [data-preview-image-wrapper]","{settings}":"[data-eb-composer-block-links-image]","{imageList}":"[data-eb-composer-block-links-image] [data-images]","{imagePlaceholder}":"[data-eb-composer-block-links-image] [data-image-placeholder]","{currentIndex}":"[data-eb-composer-block-links-image] [data-image-current-index]","{totalImages}":"[data-eb-composer-block-links-image] [data-images-total]","{previousImage}":"[data-eb-composer-block-links-image] [data-images-previous]","{nextImage}":"[data-eb-composer-block-links-image] [data-images-next]","{showImage}":"[data-links-image]","{noFollow}":"[data-links-nofollow]","{newWindow}":"[data-links-newwindow]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},toText:function(a){var c=f.getBlockContent(a),d=b.previewLink.inside(c).html();return d},toData:function(a){var b=f.data(a);return b},toHTML:function(a){var c=f.data(a);if(!c.url)return"";var d=a.clone(),e=b.deconstruct(d),g=f.getBlockContent(e),h=g.html();return h},makeEditable:function(a){var c=f.getBlockContent(a);b.previewTitle.inside(c).editable(!0).on("click",function(a){a.preventDefault()}),b.previewContent.inside(c).editable(!0),b.previewLink.inside(c).on("click",function(a){a.preventDefault()
}),b.imageWrapper.inside(c).on("click",function(a){a.preventDefault()})},reconstruct:function(a){var c=f.data(a),d=f.getBlockContent(a);c.url||c.title||d.html(g.html),b.makeEditable(a)},deconstruct:function(a){var c=f.getBlockContent(a),d=f.data(a),e=b.preview.inside(c);return d.showImage||b.imageWrapper.inside(c).remove(),b.previewTitle.inside(c).editable(!1),b.previewContent.inside(c).editable(!1),b.loader.inside(c).remove(),b.form.inside(c).remove(),b.preview.inside(c).removeAttr("data-link-preview"),b.previewImage.inside(c).removeAttr("data-preview-image"),b.previewTitle.inside(c).removeAttr("data-preview-title"),b.previewContent.inside(c).removeAttr("data-preview-content"),c.html(e.html()),e.remove(),a
},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);c.images&&c.images.length>0?b.populateImages(c.images,c.image):b.populateImages("",""),b.settings().removeClass("hide"),b.showImage().val(c.showImage?1:0),b.showImage().trigger("change"),b.noFollow().val(c.noFollow?1:0),b.noFollow().trigger("change"),b.newWindow().val(c.newWindow?1:0),b.newWindow().trigger("change")},populateImages:function(c,d){var e=a.inArray(d,c);return b.currentIndex().html(e+1),b.totalImages().html(c.length),b.imageList().children("img").remove(),c?(a.each(c,function(e,f){var g=a(new Image);
g.attr("src",f),b.imagePlaceholder().addClass("hidden"),g.addClass("hidden"),e==a.inArray(d,c)&&g.removeClass("hidden"),b.imageList().append(g)}),void 0):!1},updatePreview:function(){var a=f.getBlockContent(h),c=f.data(h);b.previewTitle.inside(a).html(c.title).attr("href",c.url),b.previewContent.inside(a).html(c.content);var d=b.previewLink.inside(a);d.html(c.url),d.attr("href",c.url),c.noFollow&&d.attr("rel","nofollow"),c.newWindow?d.attr("target","_blank"):d.removeAttr("target"),b.previewImage.inside(a).attr("src",c.image),b.imageWrapper.inside(a).attr("href",c.url)
},getSuggestions:function(a,c,d){EasyBlog.ajax("site/views/crawler/crawl",{url:a}).done(d).fail(function(a){b.showForm(c),b.errorMessage().html(a).removeClass("hide")})},hideForm:function(a){var c=f.getBlockContent(a);b.form.inside(c).addClass("hidden"),b.loader.inside(c).removeClass("hidden")},showForm:function(a){var c=f.getBlockContent(a);b.form.inside(c).removeClass("hidden"),b.loader.inside(c).addClass("hidden")},"{showImage} change":function(a){var d=f.getBlockContent(h),e=f.data(h),g=a.val();0==g?(e.showImage=!1,b.imageWrapper.inside(d).addClass("hide")):(e.showImage=!0,b.imageWrapper.inside(d).removeClass("hide"))
},"{newWindow} change":function(a){var d=f.getBlockContent(h),e=f.data(h);e.newWindow=1==a.val()?!0:!1;var g=b.previewLink.inside(d),i=b.previewTitle.inside(d),j=b.imageWrapper.inside(d);return e.newWindow?(g.attr("target","_blank"),i.attr("target","_blank"),j.attr("target","_blank"),void 0):(g.removeAttr("target"),i.removeAttr("target"),j.removeAttr("target"),void 0)},"{noFollow} change":function(a){var d=f.getBlockContent(h),e=f.data(h);e.noFollow=0==a.val()?!1:!0;var g=b.previewLink.inside(d),i=b.previewTitle.inside(d),j=b.imageWrapper.inside(d);
return e.noFollow?(g.attr("rel","nofollow"),i.attr("rel","nofollow"),j.attr("rel","nofollow"),void 0):(g.removeAttr("rel"),i.removeAttr("rel"),j.removeAttr("rel"),void 0)},"{previousImage} click":function(c){var e=b.imageList().children("img"),g=b.imageList().children("img:not(.hidden)"),i=a(g).prev("img"),j=parseInt(b.currentIndex().html()),k=f.data(h);if(i.length>0){k.image=i.attr("src"),b.updatePreview(),a(e).addClass("hidden"),a(i).removeClass("hidden");var l=j-1;b.currentIndex().html(l)}b.nextImage().disabled(!1),j-1==1?a(c).disabled(!0):a(c).disabled(!1)
},"{nextImage} click":function(c){var e=b.imageList().children("img"),g=b.imageList().children("img:not(.hidden)"),i=a(g).next("img"),j=parseInt(b.currentIndex().html()),k=f.data(h);i.length>0&&(k.image=i.attr("src"),b.updatePreview(),a(e).addClass("hidden"),a(i).removeClass("hidden"),b.currentIndex().html(j+1)),b.previousImage().disabled(!1),j+1==e.length?a(c).disabled(!0):a(c).disabled(!1)},"{addLink} click":function(){var c=f.getBlockContent(h),d=b.linkInput.inside(c).val(),e=f.data(h);return d?(b.hideForm(h),b.getSuggestions(d,h,function(a){var f=a[d];
e.title=f.title,e.content=f.description,e.url=d,e.images=f.images,e.image=f.images[0],e.showImage=!0,0===e.images.length&&(e.showImage=!1),b.updatePreview(),b.loader.inside(c).addClass("hidden"),b.preview.inside(c).removeClass("hidden"),b.makeEditable(),b.populate(h)}),void 0):(b.errorMessage().removeClass("hide"),void 0)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/liveleak",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Liveleak",{elements:["[data-liveleak-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:a.extend({"{form}":"> [data-liveleak-form]","{insert}":"[data-liveleak-insert]","{source}":"[data-liveleak-source]","{loader}":"> [data-liveleak-loader]","{errorMessage}":"[data-liveleak-error]","{player}":"iframe","{wrapper}":"[data-liveleak-wrapper]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var c=f.data(a),d=a.data("overlay");if(!d)return c;var e=b.player.inside(d.element());return c.source=e.attr("src"),c},toText:function(a){var b=f.data(a);return b.source},toHTML:function(a){var c=(f.data(a),a.data("overlay"));return c?c.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(a)},deactivate:function(){},construct:function(){},getWrapper:function(){var c=a(g.wrapper);return c},getPlayer:function(b){var c=a(g.player);return c.attr("src",b),c
},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.source&&!d?b.setOverlay(a):!c.source&&c.url?(e.empty(),b.crawl(c.url,a)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a);c.url&&(b.url().val(c.url),b.width().val(c.width),b.height().val(c.height),b.fluid().val(c.fluid?"1":"0").trigger("change"))
},getOverlay:function(a){var c=a.data("overlay"),g=(f.data(a),f.getBlockContent(a));if(!c){c=e.document.overlay.create(a);var h=b.getWrapper();c.placeholder().appendTo(h),g.empty().append(h),c.attach()}return c},setWrapperLayout:function(a){var c=b.wrapper.inside(a),d=f.data(a);d.fluid?c.addClass("is-responsive").css({width:"",height:""}):(c.hasClass("is-responsive")&&(d.width=c.width(),d.height=c.outerHeight()),b.width().val(d.width),b.height().val(d.height),c.css({width:d.width,height:d.height}).removeClass("is-responsive"))
},setOverlay:function(a){var c=f.data(a),d=b.getOverlay(a);d.element().length>0&&d.element().empty(),b.setWrapperLayout(a),d.element().append(c.embed),d.refresh(),a.data("overlay",d)},isUrlValid:function(a){if(""==a)return!1;var b=/^(http|https):\/\/www\.liveleak\.com\/view\?i=(.*)$/,c=b.test(a);return c},loading:function(){var a=f.getBlockContent(h),c=b.loader.inside(a),d=b.form.inside(a);b.isLoading?(c.addClass("hidden"),d.removeClass("hidden"),b.isLoading=!1):(c.removeClass("hidden"),d.addClass("hidden"),b.isLoading=!0)
},crawl:function(a,c){var d=f.data(c),e=f.getBlockContent(c),g=c.data("overlay");g&&g.element().empty();var h=/www\.liveleak\.com\/view\?i=(.*)$/,i=a.match(h),j=i[1],k="https://www.liveleak.com/e/"+j;b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:a}).done(function(e){var f=e[a];d.url=a,d.source=k,d.title=f.opengraph.title,d.description=f.opengraph.desc;var g=b.getPlayer(d.source);d.embed=g.prop("outerHTML"),b.setOverlay(c),b.updateFieldset(c)}).fail(function(a){b.errorMessage().removeClass("hide").html(a)
}).always(function(){b.loading(),b.form.inside(e).addClass("hidden")})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}{var d=f.getBlockContent(h),e=b.source.inside(d).val();f.data(h)}return b.isUrlValid(e)?(b.crawl(e,h),void 0):(b.errorMessage().removeClass("hide"),void 0)},"{fluid} change":function(a){var d=1==a.val()?!0:!1,e=f.data(h);e.fluid=d,b.setWrapperLayout(h),b.widthFieldset().toggleClass("hide",d),b.heightFieldset().toggleClass("hide",d);var g=b.getOverlay(h);g.refresh()
},"{width} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.width=e;var g=b.getOverlay(h),i=b.wrapper.inside(h);i.css("width",e);var g=b.getOverlay(h);g.refresh()}},250),"{height} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.height=e;var g=b.wrapper.inside(h);g.css("height",e);var i=b.getOverlay(h);i.refresh()}},250),"{updateUrl} click":function(){var d=b.url().val(),g=(f.data(h),f.getBlockContent(h));return b.isUrlValid(d)?(b.crawl(d,h),void 0):(b.errorMessage.inside(g).removeClass("hide"),void 0)
}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/livestream",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Livestream",{elements:["[data-livestream-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:a.extend({"{form}":"> [data-livestream-form]","{insert}":"[data-livestream-insert]","{source}":"[data-livestream-source]","{loader}":"> [data-livestream-loader]","{errorMessage}":"[data-livestream-error]","{player}":"iframe","{wrapper}":"[data-livestream-wrapper]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var c=f.data(a),d=a.data("overlay");if(!d)return c;var e=b.player.inside(d.element());return c.source=e.attr("src"),c},toText:function(a){var b=f.data(a);return b.source},toHTML:function(a){var b=a.clone(),d=(f.data(b),a.data("overlay"));return d?d.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(a)},deactivate:function(){},construct:function(){},getWrapper:function(){var c=a(g.wrapper);return c},getPlayer:function(b){var c=a(g.player);return c.attr("src",b),c
},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.source&&!d?b.setOverlay(a):!c.source&&c.url?(e.empty(),b.crawl(c.url,a)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){f.data(a);b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a);b.url().val(c.url),b.width().val(c.width),b.height().val(c.height),b.fluid().val(c.fluid?"1":"0").trigger("change")
},getOverlay:function(a){var c=a.data("overlay"),g=(f.data(a),f.getBlockContent(a));if(!c){c=e.document.overlay.create(a);var h=b.getWrapper();c.placeholder().appendTo(h),g.empty().append(h),c.attach()}return c},setWrapperLayout:function(a){var c=b.wrapper.inside(a),d=f.data(a);d.fluid?c.addClass("is-responsive").css({width:"",height:""}):(c.hasClass("is-responsive")&&(d.width=c.width(),d.height=c.outerHeight()),b.width().val(d.width),b.height().val(d.height),c.css({width:d.width,height:d.height}).removeClass("is-responsive"))
},setOverlay:function(a){var c=f.data(a),d=b.getOverlay(a);d.element().length>0&&d.element().empty(),b.setWrapperLayout(a),d.element().append(c.embed),d.refresh(),a.data("overlay",d)},isUrlValid:function(a){if(""==a)return!1;var b=/^(http|https):\/\/(www\.)?livestream\.com\/(.*)$/,c=b.test(a);return c},loading:function(){var a=f.getBlockContent(h),c=b.loader.inside(a),d=b.form.inside(a);b.isLoading?(c.addClass("hidden"),d.removeClass("hidden"),b.isLoading=!1):(c.removeClass("hidden"),d.addClass("hidden"),b.isLoading=!0)
},crawl:function(a,c){var d=f.data(c),e=f.getBlockContent(c),g=c.data("overlay");g&&g.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:a}).done(function(e){var f=e[a];d.url=a,d.source=a+"/player?width=640&height=360&autoPlay=false",d.width=640,d.height=360,d.title=f.opengraph.title,d.description=f.opengraph.desc,d.embed=b.getPlayer(d.source).prop("outerHTML"),d.permalink=f.opengraph.url,b.setOverlay(c),b.updateFieldset(c)}).fail(function(a){b.errorMessage().removeClass("hide").html(a)
}).always(function(){b.loading(),b.form.inside(e).addClass("hidden")})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}{var d=f.getBlockContent(h),e=b.source.inside(d).val();f.data(h)}return b.isUrlValid(e)?(b.crawl(e,h),void 0):(b.errorMessage().removeClass("hide"),void 0)},"{fluid} change":function(a){var d=1==a.val()?!0:!1,e=f.data(h);e.fluid=d,b.setWrapperLayout(h),b.widthFieldset().toggleClass("hide",d),b.heightFieldset().toggleClass("hide",d);var g=b.getOverlay(h);g.refresh()
},"{width} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.width=e;var g=b.getOverlay(h),i=b.wrapper.inside(h);i.css("width",e);var g=b.getOverlay(h);g.refresh()}},250),"{height} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.height=e;var g=b.wrapper.inside(h);g.css("height",e);var i=b.getOverlay(h);i.refresh()}},250),"{updateUrl} click":function(){var d=b.url().val(),g=(f.data(h),f.getBlockContent(h));return b.isUrlValid(d)?(b.crawl(d,h),void 0):(b.errorMessage.inside(g).removeClass("hide"),void 0)
}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/metacafe",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Metacafe",{elements:["[data-metacafe-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:a.extend({"{form}":"> [data-metacafe-form]","{insert}":"[data-metacafe-insert]","{source}":"[data-metacafe-source]","{loader}":"> [data-metacafe-loader]","{errorMessage}":"[data-metacafe-error]","{player}":"iframe","{wrapper}":"[data-metacafe-wrapper]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var c=f.data(a),d=a.data("overlay");if(!d)return c;var e=b.player.inside(d.element());return c.source=e.attr("src"),c},toText:function(a){var b=f.data(a);return b.source},toHTML:function(a){var b=a.clone(),d=(f.data(b),a.data("overlay"));return d?d.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(a)},deactivate:function(){},construct:function(){},getWrapper:function(){var c=a(g.wrapper);return c},getPlayer:function(b){var c=a(g.player);return c.attr("src",b),c
},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.source&&!d?b.setOverlay(a):!c.source&&c.url?(e.html(g.html),b.crawl(c.url,a)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){f.data(a);b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a);c.url&&(b.url().val(c.url),b.width().val(c.width),b.height().val(c.height),b.fluid().val(c.fluid?"1":"0").trigger("change"))
},getOverlay:function(a){var c=a.data("overlay"),g=(f.data(a),f.getBlockContent(a));if(!c){c=e.document.overlay.create(a);var h=b.getWrapper();c.placeholder().appendTo(h),g.empty().append(h),c.attach()}return c},setWrapperLayout:function(a){var c=b.wrapper.inside(a),d=f.data(a);d.fluid?c.addClass("is-responsive").css({width:"",height:""}):(c.hasClass("is-responsive")&&(d.width=c.width(),d.height=c.outerHeight()),b.width().val(d.width),b.height().val(d.height),c.css({width:d.width,height:d.height}).removeClass("is-responsive"))
},setOverlay:function(a){var c=f.data(a),d=b.getOverlay(a);d.element().length>0&&d.element().empty(),b.setWrapperLayout(a),d.element().append(c.embed),d.refresh(),a.data("overlay",d)},isUrlValid:function(a){if(""==a)return!1;var b=/^http:\/\/www\.metacafe\.com\/(.*)$/,c=b.test(a);return c},loading:function(){var a=f.getBlockContent(h),c=b.loader.inside(a),d=b.form.inside(a);b.isLoading?(c.addClass("hidden"),d.removeClass("hidden"),b.isLoading=!1):(c.removeClass("hidden"),d.addClass("hidden"),b.isLoading=!0)},crawl:function(a,c){var d=f.data(c),e=f.getBlockContent(c),g=c.data("overlay");
g&&g.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:a}).done(function(e){var f=e[a];d.url=a;var g=a;d.source=g.replace("/watch/","/embed/"),d.width=f.video.width,d.height=f.video.height,d.title=f.opengraph.title,d.description=f.opengraph.desc,d.embed=b.getPlayer(d.source).prop("outerHTML"),d.permalink=f.opengraph.url,b.setOverlay(c),b.updateFieldset(c)}).fail(function(a){b.errorMessage().removeClass("hide").html(a)}).always(function(){b.loading(),b.form.inside(e).addClass("hidden")
})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}{var d=f.getBlockContent(h),e=b.source.inside(d).val();f.data(h)}return b.isUrlValid(e)?(b.crawl(e,h),void 0):(b.errorMessage().removeClass("hide"),void 0)},"{fluid} change":function(a){var d=1==a.val()?!0:!1,e=f.data(h);e.fluid=d,b.setWrapperLayout(h),b.widthFieldset().toggleClass("hide",d),b.heightFieldset().toggleClass("hide",d);var g=b.getOverlay(h);g.refresh()},"{width} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();
if(0!=e){d.width=e;var g=b.getOverlay(h),i=b.wrapper.inside(h);i.css("width",e);var g=b.getOverlay(h);g.refresh()}},250),"{height} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.height=e;var g=b.wrapper.inside(h);g.css("height",e);var i=b.getOverlay(h);i.refresh()}},250),"{updateUrl} click":function(){var d=b.url().val(),g=(f.data(h),f.getBlockContent(h));return b.isUrlValid(d)?(b.crawl(d,h),void 0):(b.errorMessage.inside(g).removeClass("hide"),void 0)}}}),b.resolve()}),EasyBlog.require().script("admin/vendors/select2").done(function(){EasyBlog.module("composer/blocks/handlers/module",function(a){var b=this;
EasyBlog.Controller("Composer.Blocks.Handlers.Module",{defaultOptions:a.extend({"{form}":"> [data-module-form]","{errorMessage}":"[data-module-error]","{moduleSelection}":"[data-module-selection]","{loader}":"> [data-module-loader]","{moduleSelectionContent}":"[data-module-selection-content]","{moduleItem}":"[data-module-item]","{moduleList}":"[data-module-list]","{placeholder}":"[data-module-placeholder]","{placeholderContent}":"[data-module-placeholder-content]","{placeholderTitle}":"[data-module-placeholder-title]","{placeholderPreviewError}":"[data-module-preview-error]","{placeholderInfo}":"[data-module-placeholder-info]","{placeholderNotice}":"[data-module-placeholder-notice]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.data(a);return b.embed},toEditableHTML:function(){return""},toHTML:function(a){var b=f.data(a);return b.embed},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(c){var d=f.data(c),e=f.getBlockContent(c);d.html&&(e.empty(),b.loadPlaceholder(c,d)),d.html||e.html(a(g.html));var h=b.moduleSelection.inside(e),i=a(h).data("select2");(null==i||void 0==i)&&a(h).select2()},deconstruct:function(a){var c=f.getBlockContent(a);
return b.form.inside(c).remove(),a},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);b.updateFieldset(c.id)},showForm:function(a){var c=f.getBlockContent(a);b.placeholderInfo.inside(c).removeClass("hidden"),b.moduleSelectionContent.inside(c).removeClass("hidden")},hideForm:function(a){var c=f.getBlockContent(a);b.placeholderInfo.inside(c).addClass("hidden"),b.placeholderNotice.inside(c).removeClass("hidden")},loadPlaceholder:function(c,d){var e=f.getBlockContent(c),d=f.data(c);if(b.updateFieldset(d.id),d.html){e.html(d.html);
var g=b.placeholderTitle.inside(e),j=b.moduleSelection.inside(e);g.html(d.name),j.data("flag")?j.val(d.module+"-"+d.id):j.val(d.module)}else{var g=b.placeholderTitle.inside(e);g.html(d.name);var h=b.moduleSelection.inside(e),i=a(h).data("select2");null!=i&&void 0!=i&&a(h).select2("destroy"),d.html=e.html()}var h=b.moduleSelection.inside(e),i=a(h).data("select2");(null==i||void 0==i)&&a(h).select2()},processModule:function(a,c){var e=(f.getBlockContent(a),f.data(a));b.loading(),EasyBlog.ajax("site/views/composer/checkModuleContent",{module:c.module}).done(function(){e.moduleObj=c,e.id=c.id,e.name=c.name,e.module=c.module,b.updateFieldset(e.id),b.loading(),b.hideForm(a),b.loadPlaceholder(a,e),b.removeError(a)
}).fail(function(){b.loading(),b.showError(a)})},showError:function(a){var c=f.getBlockContent(a);b.errorMessage.inside(c).removeClass("hidden"),b.placeholderNotice.inside(c).addClass("hidden"),b.placeholderTitle.inside(c).addClass("hidden"),b.placeholderInfo.inside(c).addClass("hidden")},removeError:function(a){var c=f.getBlockContent(a);b.errorMessage.inside(c).addClass("hidden"),b.placeholderNotice.inside(c).removeClass("hidden"),b.placeholderTitle.inside(c).removeClass("hidden")},updateFieldset:function(a){b.moduleItem().removeClass("active"),b.moduleList().find("[data-id='"+a+"']").addClass("active")
},loading:function(){var a=f.getBlockContent(h),c=b.loader.inside(a),d=b.form.inside(a);b.isLoading?(c.addClass("hidden"),d.removeClass("hidden"),b.isLoading=!1):(c.removeClass("hidden"),d.addClass("hidden"),b.isLoading=!0)},"{moduleItem} click":function(c){var d=a(c).data("id"),e=a(c).data("title"),f=a(c).data("module"),g={id:d,name:e,module:f};b.processModule(h,g)},"{moduleSelection} change":function(c){var e=a(c).val(),f=e.split("-"),g=f[0],i=a(c).find(":selected").data("id"),j=a(c).find(":selected").html(),k={id:i,name:j,module:g};
b.processModule(h,k)}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/mtv",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Mtv",{elements:["[data-mtv-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:a.extend({"{form}":"> [data-mtv-form]","{insert}":"[data-mtv-insert]","{source}":"[data-mtv-source]","{loader}":"> [data-mtv-loader]","{errorMessage}":"[data-mtv-error]","{player}":"iframe","{wrapper}":"[data-mtv-wrapper]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var c=f.data(a),d=a.data("overlay");if(!d)return c;var e=b.player.inside(d.element());return c.source=e.attr("src"),c},toText:function(a){var b=f.data(a);return b.source},toHTML:function(a){var c=(f.data(a),a.data("overlay"));return c?c.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(a)},deactivate:function(){},construct:function(){},getWrapper:function(){var c=a(g.wrapper);return c},getPlayer:function(b){var c=a(g.player);return c.attr("src",b),c
},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.source&&!d?b.setOverlay(a):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a);c.url&&(b.url().val(c.url),b.width().val(c.width),b.height().val(c.height),b.fluid().val(c.fluid?"1":"0").trigger("change"))},getOverlay:function(a){var c=a.data("overlay"),g=(f.data(a),f.getBlockContent(a));
if(!c){c=e.document.overlay.create(a);var h=b.getWrapper();c.placeholder().appendTo(h),g.empty().append(h),c.attach()}return c},setWrapperLayout:function(a){var c=b.wrapper.inside(a),d=f.data(a);d.fluid?c.addClass("is-responsive").css({width:"",height:""}):(c.hasClass("is-responsive")&&(d.width=c.width(),d.height=c.outerHeight()),b.width().val(d.width),b.height().val(d.height),c.css({width:d.width,height:d.height}).removeClass("is-responsive"))},setOverlay:function(a){var c=f.data(a),d=b.getOverlay(a);d.element().length>0&&d.element().empty(),b.setWrapperLayout(a),d.element().append(c.embed),d.refresh(),a.data("overlay",d)
},isUrlValid:function(a){if(""==a)return!1;var b=/^(http|https):\/\/www\.mtv\.com\/(.*)$/,c=b.test(a);return c},loading:function(){var a=f.getBlockContent(h),c=b.loader.inside(a),d=b.form.inside(a);b.isLoading?(c.addClass("hidden"),d.removeClass("hidden"),b.isLoading=!1):(c.removeClass("hidden"),d.addClass("hidden"),b.isLoading=!0)},crawl:function(a,c){var d=f.data(c),e=f.getBlockContent(c),g=c.data("overlay");g&&g.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:a}).done(function(e){var f=e[a];
d.url=a,d.source=f.video.source,d.width=f.video.width,d.height=f.video.height,d.title=f.opengraph.title,d.description=f.opengraph.desc;var g=b.getPlayer(d.source);d.embed=g.prop("outerHTML"),b.setOverlay(c),b.updateFieldset(c)}).fail(function(a){b.errorMessage().removeClass("hide").html(a)}).always(function(){b.loading(),b.form.inside(e).addClass("hidden")})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}{var d=f.getBlockContent(h),e=b.source.inside(d).val();f.data(h)}return b.isUrlValid(e)?(b.crawl(e,h),void 0):(b.errorMessage().removeClass("hide"),void 0)
},"{fluid} change":function(a){var d=1==a.val()?!0:!1,e=f.data(h);e.fluid=d,b.setWrapperLayout(h),b.widthFieldset().toggleClass("hide",d),b.heightFieldset().toggleClass("hide",d);var g=b.getOverlay(h);g.refresh()},"{width} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.width=e;var g=b.getOverlay(h),i=b.wrapper.inside(h);i.css("width",e);var g=b.getOverlay(h);g.refresh()}},250),"{height} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.height=e;var g=b.wrapper.inside(h);g.css("height",e);
var i=b.getOverlay(h);i.refresh()}},250),"{updateUrl} click":function(){var d=b.url().val(),g=(f.data(h),f.getBlockContent(h));return b.isUrlValid(d)?(b.crawl(d,h),void 0):(b.errorMessage.inside(g).removeClass("hide"),void 0)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/note",function(a){var b=this;EasyBlog.require().done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Note",{defaultOptions:{data:{type:"warning",content:"Enter an important note here"},"{note}":".alert","{alertSelection}":"[data-eb-composer-block-alert-type] [data-type]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a(),c.data.content=a(g.content).html()
},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(b){{var b=a.extend({},c.data,b);a(g.content).switchClass("alert-"+b.type).html(b.content)}},reconstruct:function(){},deconstruct:function(a){var c=f.getBlockContent(a);return b.note.inside(c).editable(!1),a},refocus:function(a){var c=f.getBlockContent(a),d=b.note.inside(c);d.focus(),a.hasClass("is-new")&&e.editor.caret.setEnd(d[0])},toText:function(a){var c=f.getBlockContent(a),d=b.note.inside(c).text();return d},toData:function(a){var b=f.data(a);
return b},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d);return e.html()},reset:function(a){var c=f.getBlockContent(a);c.html(b.construct())},populate:function(a){var c=f.data(a);b.alertSelection().where("type",c.type).activateClass("selected")},setAlertType:function(a){var c=f.getBlockContent(h),d=c.find(b.note);d.switchClass("alert-"+a)},previewType:function(a){{var c=f.getBlockContent(h),d=b.note.inside(c),e=d.attr("class");f.getData(h)}h.hasClass("is-preview")||(h.data("originalClass",e),h.addClass("is-preview")),b.setAlertType(a);
var i=[h,b,d];b.trigger("composerBlockNotePreviewType",i),b.trigger("composerBlockChange",i)},previewTimer:null,"{alertSelection} mouseover":function(){},"{alertSelection} mouseout":function(){},"{alertSelection} click":function(c){var d=c.data("type"),e=f.data(h);b.alertSelection().removeClass("selected"),a(c).addClass("selected"),h.removeClass("is-preview"),h.removeData("originalClass"),b.setAlertType(d),e.type=d,b.populate(h)}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/pagebreak",function(a){var b=this;
EasyBlog.Controller("Composer.Blocks.Handlers.Pagebreak",{elements:["[data-pagebreak-fieldset-{title|alt}]"],defaultOptions:{"{spanTitle}":"[data-pagebreak-title]","{spanAlt}":"[data-pagebreak-alt]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()},toData:function(a){var b=f.data(a);return b},toText:function(){return""},toHTML:function(b){var c=f.data(b),d=a.create("hr");return c.alt&&d.attr("alt",c.alt),c.title&&d.attr("title",c.title),d.attr("class","system-pagebreak"),d.toHTML()
},deactivate:function(){},activate:function(a){h=a,b.populate(a)},deconstruct:function(){},construct:function(){},reconstruct:function(a){var d=(f.data(a),f.getBlockContent(a));d.html(g.html),b.updateFieldset(a)},refocus:function(){},reset:function(){},populate:function(a){b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a),d=f.getBlockContent(a);b.title().val(c.title),b.alt().val(c.alt);var e=c.title.length>0?" - "+c.title:"";b.spanTitle.inside(d).text(e);var e=c.alt.length>0?" - "+c.alt:"";b.spanAlt.inside(d).text(e)
},"{title} keyup":a.debounce(function(a){var d=f.data(h),e=f.getBlockContent(h),g=a.val();d.title=g;var i=g.length>0?" - "+g:"";b.spanTitle.inside(e).text(i)},250),"{alt} keyup":a.debounce(function(a){var d=f.data(h),e=f.getBlockContent(h),g=a.val();d.alt=g;var i=g.length>0?" - "+g:"";b.spanAlt.inside(e).text(i)},250)}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/pdf",function(a){var b=this;EasyBlog.require().script("composer/vendors/redactor10","composer/document/overlay","composer/vendors/selectionchange").done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Pdf",{defaultOptions:{"{browseButton}":".eb-composer-placeholder-pdf [data-eb-mm-browse-button]","{fileError}":"[data-eb-file-error]","{placeholder}":"[data-eb-composer-pdf-placeholder]","{player}":"[data-file-preview]","{dropElement}":"[data-plupload-drop-element]","{height}":"[data-pdf-height]","{wrapper}":"> [data-pdf-previewer]","{object}":"object","{iframe}":"iframe",width:"100%",height:"450px"}},function(b,c,d,e,f,g,h,i){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a(),i=EasyBlog.MediaManager
},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.data(a);return b.url},toHTML:function(a){var c=(f.data(a),a.data("overlay"));return c?c.element().html():void 0},toLegacyShortcode:function(a,b){var c={uri:a.uri,height:b.height},d="[pdf]"+JSON.stringify(c)+"[/pdf]";return d},toLegacyHTMLPermalink:function(b){var c=[];a.each(b,function(b,d){var e=d.meta;if("pdf"!=e.type)return!0;var f=a("<a>").attr({href:e.url,target:"_blank"}).append(e.title);c.push(f.prop("outerHTML"))});var d=c.join("<br>");
return d},toEditableHTML:function(){return""},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(b){var c=f.createBlockContainer("pdf"),b=a.extend(f.data(c),b);return c},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.url&&!d?(e.html(g.html),b.createEmbedObject(a)):e.html(g.html);var h=b.placeholder.inside(a),i=b.dropElement.inside(h);i.length>0&&EasyBlog.MediaManager.uploader.register(h)},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){f.data(a);
b.populateHeight(a)},getHeight:function(a){var b=f.data(a);return b.height?b.height:c.height},updateHeight:function(a,b){var c=a.data("overlay");if(c){var e=(f.getBlockContent(a),c.element()),g=e.find("iframe"),h=e.find("object");c.placeholder().css("height",b),h.attr("height",b),g.attr("height",b)}},setOverlay:function(a,c){var d=a.data("overlay");if(d)d.element().empty(),d.element().append(c);else{var d=e.document.overlay.create(a),g=f.getBlockContent(a),h=b.getHeight(a);d.placeholder().css("height",h).appendTo(g),d.element().append(c),d.attach()
}a.data("overlay",d)},createEmbedObject:function(d){b.placeholder.inside(d).remove();var e=a(document.createElement("object")),g=document.createElement("iframe"),i=(f.getBlockContent(d),f.data(d)),j=window.origin,k=i.url,l=j.replace(/^http(s?):/i,"");k=k.replace(l,""),i.pdfjs&&(i.pdfjs=i.pdfjs.replace(j,""),k=i.pdfjs+k);var m=d.data("overlay");m&&m.element().empty();var n=b.getHeight(d);return e.attr("data",k),e.attr("type","application/pdf"),e.attr("width",c.width),e.attr("height",n),g.setAttribute("width",c.width),g.setAttribute("height",n),g.setAttribute("src",k),g.setAttribute("scrolling","no"),g.setAttribute("frameborder","0"),g.setAttribute("allowTransparency","true"),e.html(g),b.setOverlay(d,e),g
},populateHeight:function(a){var c=f.data(a);b.height().val(c.height)},"{height} change":function(a){var d=f.data(h);d.height=a.val(),b.updateHeight(h,d.height)},"{placeholder} mediaUploaderFilesAdded":function(a,b,c,d){EasyBlog.MediaManager.uploader.addItem(d[0],a)},"{placeholder} mediaUploaderFileUploaded":function(c,d,e,g,h){var i=h.response,j=i.media,k=j.meta,l=f.block.of(c),h=f.data(l);h=a.extend(h,k),setTimeout(function(){b.createEmbedObject(l)},600)},"{placeholder} mediaUploaderFileError":function(c,d,e,f){f.code==a.plupload2.FILE_EXTENSION_ERROR&&b.fileError.inside(h).removeClass("hide")
},"{placeholder} mediaUploaderError":function(){},"{browseButton} mediaSelect":function(a,c,d){var g=f.block.of(a);if("pdf"==d.meta.type){if(!d.data.previewer){var g=f.constructBlock("file",{name:d.data.title,type:d.meta.extension,size:d.meta.size,url:d.meta.url,showicon:!0,showsize:!0});return f.addBlock(g),f.activateBlock(g),f.removeBlock(h),void 0}var i=d.meta,j=e.document,k=j.isLegacy();if(k)content=b.toLegacyShortcode(g),content=b.toLegacyHTML(g),j.insertContent(content);else{var l=f.data(g);l.url=i.url,l.height=d.data.height,b.createEmbedObject(g)
}}},"{self} mediaInsertPermalink":function(a,c,d){var f=e.document.isLegacy(),g=e.document;return f?(content=b.toLegacyHTMLPermalink(d),g.insertContent(content),void 0):void 0},"{self} mediaInsert":function(a,c,d,g,h,i){if("pdf"==d.meta.type){var j=e.document,k=j.isLegacy();if(k)content=b.toLegacyShortcode(d.meta,h),j.insertContent(content);else{if(h.previewer)var g=f.constructBlock("pdf",{name:h.title,url:d.meta.url,height:h.height});else var g=f.constructBlock("file",{name:h.title,type:d.meta.extension,size:d.meta.size,url:d.meta.url,showicon:!0,showsize:!0});
f.addBlock(g),i||f.activateBlock(g)}}}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/pinterest",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Pinterest",{defaultOptions:a.extend({"{form}":"> [data-pinterest-form]","{insert}":"[data-pinterest-insert]","{source}":"[data-pinterest-source]","{loader}":"> [data-pinterest-loader]","{preview}":"> [data-pinterest-preview]","{errorMessage}":"[data-pinterest-error]","{fsSource}":"[data-fs-pinterest-source]","{fsUpdate}":"[data-fs-pinterest-update]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.data(a);return b.url},toEditableHTML:function(){return""},toHTML:function(a){var b=f.data(a);return b.embed},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(c){var d=f.data(c),e=f.getBlockContent(c);d.embed&&(b.loadScript(),e.html(d.embed)),d.embed||e.html(a(g.html)),c.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(a){var c=f.getBlockContent(a);
return b.form.inside(c).remove(),b.loader.inside(c).remove(),a},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);c.url&&b.fsSource().val(c.url)},isUrlValid:function(a){if(""==a)return!1;var b=/^https:\/\/.+\.pinterest\.com\/pin\/(.*)$/,c=b.test(a);return c},insertEmbed:function(c,d){var e=f.getBlockContent(c),g=f.data(c),h=a("<a>");return h.attr("data-pin-do","embedPin").attr("href",d),g.url=d,g.embed=h.toHTML(),b.isUrlValid(d)?(e.html(h.toHTML()),b.form.inside(e).addClass("hidden"),void 0):(b.errorMessage().removeClass("hide"),!1)
},scriptLoaded:!1,scriptLoadedFromAjax:!1,scriptMainLoadedFromAjax:!1,loadScriptFromAjax:function(){b.scriptLoadedFromAjax?(a("<script>").attr("type","text/javascript").attr("src","//assets.pinterest.com/js/pinit_main.js").appendTo("head"),b.scriptMainLoadedFromAjax=!0):(a("<script>").attr("type","text/javascript").attr("src","//assets.pinterest.com/js/pinit.js").appendTo("head"),b.scriptLoadedFromAjax=!0)},loadScript:function(){b.scriptLoaded||(a("<script>").attr("type","text/javascript").attr("src","//assets.pinterest.com/js/pinit.js").appendTo("head"),b.scriptLoaded=!0,b.scriptLoadedFromAjax=!0)
},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}var d=f.getBlockContent(h),e=b.source.inside(d).val();b.fsSource().val(e),b.hideForm(h),b.crawl(h,e)},crawl:function(c,d){EasyBlog.ajax("site/views/crawler/crawl",{url:d}).done(function(e){b.loadScriptFromAjax();var g=e[d],h=f.getBlockContent(c),i=f.data(c),j=a("<a>");return i.url=g.opengraph.url,j.attr("data-pin-do","embedPin").attr("href",i.url),i.embed=j.toHTML(),b.isUrlValid(i.url)?(h.html(j.toHTML()),b.form.inside(h).addClass("hidden"),void 0):(b.showForm(c),b.errorMessage().removeClass("hide"),!1)
}).fail(function(a){b.showForm(c),b.errorMessage().html(a).removeClass("hide")})},showForm:function(a){var c=f.getBlockContent(a);b.form.inside(c).removeClass("hidden"),b.loader.inside(c).addClass("hidden")},hideForm:function(a){var c=f.getBlockContent(a);b.form.inside(c).addClass("hidden"),b.loader.inside(c).removeClass("hidden")},"{fsUpdate} click":function(){var c=(f.getBlockContent(h),b.fsSource().val());b.hideForm(h),b.crawl(h,c)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/post",function(a){var b=this;
EasyBlog.Controller("Composer.Blocks.Handlers.Post",{defaultOptions:{"{block}":".ebd-block[data-type=text]","{wrapper}":"> div[data-text-wrapper]","{lastParagraph}":"> div > p:last","{mediaPreview}":"[data-post-media]","{introPreview}":"[data-post-intro]","{linkPreview}":"[data-post-link-preview]","{titlePreview}":"[data-preview-title]","{showImage}":"[data-post-option-image]","{showIntro}":"[data-post-option-intro]","{showHyperlink}":"[data-post-option-link]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},activate:function(a){var c=f.data(a);h=a,b.showImage().val(0==c.show_image?0:1).trigger("change"),b.showIntro().val(0==c.show_intro?0:1).trigger("change"),b.showHyperlink().val(0==c.show_link?0:1).trigger("change"),b.populate()},deactivate:function(){},construct:function(b){var c=f.createBlockContainer("post"),b=a.extend({},g.data,b),d=a(b.content);return d.find("[data-post-title]").html(b.title),d.find("[data-post-link]").attr("href",b.url),d.on("click",function(a){a.preventDefault()}),d.find("[data-post-link-preview]").html(b.url),d.find("[data-post-intro]").html(b.intro),b.image?d.find("[data-post-image]").attr("src",b.image):d.find("[data-post-image]").remove(),f.content.inside(c).append(d),c.data("block",b),c
},reconstruct:function(a){{var b=f.getBlockContent(a);f.data(a)}b.find("[data-post-link]").on("click",function(a){a.preventDefault()})},deconstruct:function(a){var c=b.wrapper.inside(a),d=c.parent();return c.children().appendTo(d),c.remove(),a},refocus:function(a){var c=b.wrapper.inside(a),d=b.lastParagraph.inside(a);c.focus(),e.editor.caret.setEnd(d)},reset:function(a){a=f.getBlockContent(a),a.html(g.content)},populate:function(){},recover:function(){},revert:function(){},toText:function(a){var a=f.getBlockContent(a);
return a.text()},toHTML:function(a){{var a=f.getBlockContent(a),c=a.clone();b.deconstruct(c).html()}return b.deconstruct(c).html()},toData:function(a){var c=f.data(a);return c.content=b.toHTML(a),c},"{showImage} change":function(a){var d=f.getBlockContent(h),e=1==a.val()?!0:!1,g=f.data(h);return g.show_image=e,e?(b.mediaPreview.inside(d).show(),void 0):(b.mediaPreview.inside(d).hide(),void 0)},"{showIntro} change":function(a){var d=f.getBlockContent(h),e=1==a.val()?!0:!1,g=f.data(h);return g.show_intro=e,e?(b.introPreview.inside(d).show(),void 0):(b.introPreview.inside(d).hide(),void 0)
},"{showHyperlink} change":function(a){var d=f.getBlockContent(h),e=1==a.val()?!0:!1,g=f.data(h);return g.show_link=e,e?(b.linkPreview.inside(d).show(),void 0):(b.linkPreview.inside(d).hide(),void 0)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/quotes",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Quotes",{defaultOptions:{"{styleSelection}":"[data-eb-composer-block-quotes-style] [data-style]","{citation}":"[data-quotes-citation]","{blockquote}":"> blockquote","{cite}":"> blockquote > cite","{text}":"> blockquote > p"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},reconstruct:function(){},deconstruct:function(a){var c=f.getBlockContent(a);return b.text.inside(c).editable(!1),b.cite.inside(c).editable(!1),a},toData:function(a){var b=f.data(a);return b},toText:function(){},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d);return e.html()},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(b){var b=a.extend({},c.data,b);return content},refocus:function(a){var c=f.data(a);c.style&&b.setStyle(a,c.style)},reset:function(a){if(!a.hasClass("is-new")){var c=f.getBlockContent(a);
c.html(b.construct())}},populate:function(a){var c=f.data(a);b.styleSelection("[data-style="+c.style+"]").activateClass("active"),b.citation().val(c.citation).trigger("change")},setStyle:function(a,c){f.data(a,"current",c),b.styleSelection().removeClass("selected"),b.styleSelection().where("style",c).addClass("selected");var d=[a,b,c];b.trigger("composerBlockQuotesSetStyle",d),b.trigger("composerBlockChange",d)},previewType:function(a,c){clearTimeout(b.previewTimer);var d=[a,b,c];b.trigger("composerBlockQuotesSetStyle",d),b.trigger("composerBlockChange",d)
},"{styleSelection} mouseover":function(a){var c=a.data("style");b.previewType(h,c)},"{styleSelection} mouseout":function(){clearTimeout(b.previewTimer),b.previewTimer=a.delay(function(){var a=f.data(h).current;a&&b.setStyle(h,a)},50)},"{styleSelection} click":function(a){var c=a.data("style"),d=f.data(h);d.style=c,b.setStyle(h,c)},"{self} composerBlockQuotesSetStyle":function(a,c,d,e,g){clearTimeout(b.previewTimer);var i=f.getBlockContent(h);b.blockquote.inside(i).switchClass(g),b.populate(d)},"{citation} change":function(c){var e=f.data(h),g=1==a(c).val()?1:0,i=g?!1:!0,j=f.getBlockContent(h);
e.citation=g,b.cite.inside(j).toggleClass("hidden",i)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/readmore",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Readmore",{defaultOptions:{}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()},toData:function(a){var b=f.data(a);return b},toText:function(){},toHTML:function(){var c=a.create("hr");return c.attr("id","system-readmore"),c.toHTML()},deactivate:function(){},activate:function(a){h=a,blockActions=f.getBlockActions(h),blockActions.find("[data-blocks-duplicate]").remove(),b.populate(a)
},deconstruct:function(){},construct:function(){},reconstruct:function(a){var d=(f.data(a),f.getBlockContent(a));b.hideMenu(),d.html(g.html)},refocus:function(){},reset:function(){},populate:function(){},showMenu:function(){var a=f.menu().where("type","readmore");a.removeClass("hide")},hideMenu:function(){var a=f.menu().where("type","readmore");a.addClass("hide")},"{self} composerBlockAdd":function(a,c,d){var e=f.getBlockType(d);"readmore"==e&&b.hideMenu()},"{self} composerBlockRemove":function(a,c,d){var e=f.getBlockType(d);
"readmore"==e&&b.showMenu()}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/rule",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Rule",{defaultOptions:{"{rule}":"> hr","{styleSelection}":"[data-eb-composer-rule-style] [data-style]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()},activate:function(a){h=a,b.populate(a)},construct:function(b){var b=a.extend({},c.data,b),d=a("<hr/>");return d},toText:function(){},toData:function(a){var b=f.data(a);
return b},toHTML:function(a){var c=(f.data(a),f.getBlockContent(a));return c.html()},reconstruct:function(a){f.data(a)},refocus:function(a){var c=f.data(a);c.style&&b.setStyle(a,c.style)},reset:function(a){var c=f.getBlockContent(a);c.html(b.construct())},populate:function(a){var c=f.data(a);b.styleSelection("[data-style="+c.style+"]").activateClass("active")},setStyle:function(a,c){f.data(a,"current",c),b.styleSelection().removeClass("selected"),b.styleSelection().where("style",c).addClass("selected");var d=[a,b,c];
b.trigger("composerBlockRuleSetStyle",d),b.trigger("composerBlockChange",d)},"{styleSelection} click":function(a){var c=a.data("style"),d=f.data(h);d.style=c,b.setStyle(h,c),b.refocus(h)},"{self} composerBlockRuleSetStyle":function(a,c,d,e,g){var h=f.getBlockContent(d);b.rule.inside(h).switchClass(g),b.populate(d)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/section",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Section",{defaultOptions:{"{columnsHeader}":".row","{columns}":".row > div","{wrapper}":"> div[data-col-wrapper]","{columnRange}":"[data-eb-composer-block-column-range]","{control}":"[data-columns-control]","{controlWidth}":"[data-select-width]","{dropdown}":".eb-composer-manage-tab-name > select ","{listboxItem}":"[data-listbox-item]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(b){var b=a.extend({},c.data,b);return content},reconstruct:function(){},refocus:function(){},deconstruct:function(a){return a},reset:function(){},populate:function(){},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d);return e.html()},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.getBlockContent(a).clone();return b.text()},"{self} composerBlockDuplicate":function(b,c,d,e){var g=f.getBlockType(d);
if("section"==g){f.updateBlockUid(d);var h=f.data(e);data=f.data(d),a.extend(data,h),f.duplicateChildBlocksData(d,e)}}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/sendy",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Sendy",{defaultOptions:{"{wrapper}":"[data-eb-sendy-wrapper]","{placeholder}":"[data-sendy-placeholder]","{form}":"[data-sendy-form]","{formTitle}":"[data-sendy-title]","{formId}":"[data-sendy-id]","{formInfo}":"[data-sendy-info]","{formEmail}":"[data-sendy-email]","{formName}":"[data-sendy-name]","{formButton}":"[data-sendy-button]","{fieldUrl}":"[data-field-sendy-link]","{fieldId}":"[data-field-sendy-id]","{fieldTitleToggle}":"[data-field-sendy-title-toggle]","{fieldTitle}":"[data-field-sendy-title]","{fieldInfoToggle}":"[data-field-sendy-info-toggle]","{fieldInfo}":"[data-field-sendy-info]","{fieldEmailPlaceholder}":"[data-field-sendy-email-placeholder]","{fieldNameToggle}":"[data-field-sendy-name-toggle]","{fieldNamePlaceholder}":"[data-field-sendy-name-placeholder]","{fieldButton}":"[data-field-sendy-button]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(a){f.data(a)},refocus:function(){},deconstruct:function(a){return a},reset:function(){},populate:function(a){var c=f.data(a);b.fieldUrl().val(c.url).trigger("keyup"),b.fieldId().val(c.list_id).trigger("keyup"),b.fieldTitleToggle().val(c.title?1:0).trigger("change"),b.fieldTitle().val(c.title_text).trigger("keyup"),b.fieldInfoToggle().val(c.info?1:0).trigger("change"),b.fieldInfo().val(c.info_text).trigger("keyup"),b.fieldEmailPlaceholder().val(c.email_placeholder),b.fieldNamePlaceholder().val(c.name_placeholder),b.fieldButton().val(c.button)
},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d);return e.html()},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.getBlockContent(a).clone();return b.text()},getForm:function(){var a=b.getWrapper(),c=a.find(b.form.selector);return c},getPlaceHolder:function(){var a=f.getBlockContent(h),c=b.placeholder.inside(a);return c},getWrapper:function(){var a=f.getBlockContent(h),c=b.wrapper.inside(a);return c},updateForm:function(){var a=f.data(h),c=b.getWrapper(),d=b.getPlaceHolder();
return a.url&&a.list_id?(c.hasClass("t-hidden")&&(c.removeClass("t-hidden"),d.addClass("t-hidden"),b.updateFormTitle(),b.updateFormId(),b.updateFormButton(),b.updateFormInfo(),b.updateFormEmail(),b.updateFormName(),b.updateFormButton()),void 0):(c.addClass("t-hidden"),d.removeClass("t-hidden"),void 0)},updateFormId:function(){var a=b.getForm(),c=f.data(h);a.find(b.formId.selector).val(c.id)},updateFormInfo:function(){var a=b.getForm(),c=f.data(h),d=a.find(b.formInfo.selector);c.info?d.removeClass("t-hidden"):d.addClass("t-hidden"),d.html(c.info_text)
},updateFormTitle:function(){var a=b.getForm(),c=f.data(h),d=a.find(b.formTitle.selector);c.title?d.removeClass("t-hidden"):d.addClass("t-hidden"),d.html(c.title_text)},updateFormButton:function(){var a=b.getForm(),c=f.data(h),d=a.find(b.formButton.selector);d.text(c.button)},updateFormEmail:function(){var a=b.getForm(),c=f.data(h),d=a.find(b.formEmail.selector);d.attr("placeholder",c.email_placeholder)},updateFormName:function(){var a=b.getForm(),c=f.data(h),d=a.find(b.formName.selector);console.log(d.parent()),c.name?d.parent().removeClass("t-hidden"):d.parent().addClass("t-hidden"),d.attr("placeholder",c.name_placeholder)
},"{fieldUrl} keyup":a.debounce(function(a){var c=f.data(h);c.url=a.val(),b.updateForm()},300),"{fieldId} keyup":a.debounce(function(a){var c=f.data(h);c.list_id=a.val(),b.updateForm()},300),"{fieldTitleToggle} change":function(a){{var d=f.data(h),e=0!=a.val();f.getBlockContent(h)}d.title=e,b.updateFormTitle()},"{fieldTitle} keyup":a.debounce(function(a){var c=f.data(h),d=a.val();c.title_text=d,b.updateFormTitle()}),"{fieldInfoToggle} change":function(a){{var d=f.data(h),e=0!=a.val();f.getBlockContent(h)}d.info=e,b.updateFormInfo()
},"{fieldInfo} keyup":a.debounce(function(a){var c=f.data(h),d=a.val();c.info_text=d,b.updateFormInfo()}),"{fieldEmailPlaceholder} keyup":a.debounce(function(a){var c=f.data(h),d=a.val();c.email_placeholder=d,b.updateFormEmail()}),"{fieldNameToggle} change":function(a){{var d=f.data(h),e=0!=a.val();f.getBlockContent(h)}d.name=e,b.updateFormName()},"{fieldNamePlaceholder} keyup":a.debounce(function(a){var c=f.data(h),d=a.val();c.name_placeholder=d,b.updateFormName()}),"{fieldButton} keyup":a.debounce(function(a){var c=f.data(h),d=a.val();
c.button=d,b.updateFormButton()})}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/slideshare",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Slideshare",{defaultOptions:a.extend({"{form}":"> [data-slideshare-form]","{insert}":"[data-slideshare-insert]","{source}":"[data-slideshare-source]","{loader}":"> [data-slideshare-loader]","{preview}":"> [data-slideshare-preview]","{fsSource}":"[data-fs-slideshare-source]","{fsUpdate}":"[data-fs-slideshare-update]","{errorMessage}":"[data-slideshare-error]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toText:function(a){var b=f.data(a);return b.url},toData:function(a){var b=f.data(a);return b},toEditableHTML:function(){return""},toHTML:function(a){var b=f.data(a);return b.embed},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(c){var d=f.data(c),e=c.data("overlay"),h=f.getBlockContent(c);d.embed&&!e&&(h.empty(),b.setOverlay(c,d.embed)),d.embed||h.html(a(g.html)),c.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(a){var c=f.getBlockContent(a);
return b.form.inside(c).remove(),b.loader.inside(c).remove(),a},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);b.fsSource().val(c.url)},loading:function(){var a=f.getBlockContent(h);b.isLoading?(b.loader.inside(a).addClass("hidden"),b.form.inside(a).removeClass("hidden"),b.isLoading=!1):(b.loader.inside(a).removeClass("hidden"),b.form.inside(a).addClass("hidden"),b.isLoading=!0)},setOverlay:function(a,b){var c=a.data("overlay");if(!c){c=e.document.overlay.create(a);var d=f.getBlockContent(a);
return c.placeholder().css("height","600px").appendTo(d),c.element().append(b),c.attach(),a.data("overlay",c),void 0}c.element().empty(),c.element().append(b)},isUrlValid:function(a){if(""==a)return!1;var b=/^(http|https):\/\/www\.slideshare\.net\/(.*)$/,c=b.test(a);return c},crawl:function(c,d){var e=f.getBlockContent(c),g=f.data(c);if(!b.isUrlValid(d))return b.errorMessage().removeClass("hide"),!1;var h=c.data("overlay");h&&h.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:d}).then(function(b){var c=b[d];
return null===c.oembed?a.Deferred().reject():a.Deferred().resolve(c)}).done(function(a){g.url=d,g.embed=a.oembed.html,b.setOverlay(c,g.embed),b.loading(),b.form.inside(e).addClass("hidden")}).fail(function(a){b.errorMessage().removeClass("hide").html(a)})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}{var d=f.getBlockContent(h),e=b.source.inside(d).val();f.data(h)}b.crawl(h,e),b.fsSource().val(e)},"{fsUpdate} click":function(){{var a=b.fsSource().val();f.data(h)}b.crawl(h,a)
}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/soundcloud",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Soundcloud",{defaultOptions:a.extend({"{form}":"> [data-soundcloud-form]","{insert}":"[data-soundcloud-insert]","{source}":"[data-soundcloud-source]","{loader}":"> [data-soundcloud-loader]","{preview}":"> [data-soundcloud-preview]","{fsSource}":"[data-fs-soundcloud-source]","{fsUpdate}":"[data-fs-soundcloud-update]","{errorMessage}":"[data-soundcloud-error]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toText:function(a){var b=f.data(a);return b.url},toData:function(a){var b=f.data(a);return b},toEditableHTML:function(){return""},toHTML:function(a){var b=f.data(a);return b.embed},normalize:function(b){return a.extend({},g.data,b)},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(c){var d=f.data(c),e=c.data("overlay"),h=f.getBlockContent(c);d.embed&&!e&&(h.empty(),b.setOverlay(c,d.embed)),d.embed||h.html(a(g.html)),c.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()
})},deconstruct:function(a){var c=f.getBlockContent(a);return b.form.inside(c).remove(),b.loader.inside(c).remove(),a},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);b.fsSource().val(c.url)},isLoading:!1,loading:function(){var a=f.getBlockContent(h);b.isLoading?(b.loader.inside(a).addClass("hidden"),b.form.inside(a).removeClass("hidden"),b.isLoading=!1):(b.loader.inside(a).removeClass("hidden"),b.form.inside(a).addClass("hidden"),b.isLoading=!0)},setOverlay:function(a,b){var c=a.data("overlay"),d=f.getBlockContent(a);
c?(c.element().empty(),c.element().append(b)):(c=e.document.overlay.create(a),c.placeholder().css("height","350px").appendTo(d),c.element().append(b),c.attach()),a.data("overlay",c)},isUrlValid:function(a){if(""==a)return!1;var b=/^https:\/\/soundcloud\.com\/(.*)$/,c=b.test(a);return c},crawl:function(a,c){var d=f.data(a),e=f.getBlockContent(a);if(!b.isUrlValid(c))return b.errorMessage().removeClass("hide"),!1;var g=a.data("overlay");g&&g.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:c}).done(function(e){var f=e[c];
d.url=c,d.embed=f.oembed.html,b.setOverlay(a,d.embed)}).fail(function(a){b.errorMessage().removeClass("hide").html(a)}).always(function(){b.loading(),b.form.inside(e).addClass("hidden")})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}var d=f.getBlockContent(h),e=b.source.inside(d).val();b.fsSource().val(e),b.crawl(h,e)},"{fsUpdate} click":function(){var a=b.fsSource().val();b.crawl(h,a)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/spotify",function(a){var b=this;
EasyBlog.Controller("Composer.Blocks.Handlers.Spotify",{defaultOptions:a.extend({"{form}":"> [data-spotify-form]","{insert}":"[data-spotify-insert]","{source}":"[data-spotify-source]","{loader}":"> [data-spotify-loader]","{errorMessage}":"[data-spotify-error]","{preview}":"> [data-spotify-preview]","{fsSource}":"[data-fs-spotify-source]","{fsRefreshButton}":"[data-fs-spotify-refresh]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()},toData:function(a){var b=f.data(a);
return b},toText:function(a){var b=f.data(a);return b.url},toEditableHTML:function(){return""},toHTML:function(a){var b=f.data(a);return b.embed},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(c){var d=f.data(c),e=c.data("overlay"),h=f.getBlockContent(c);d.embed&&!e&&(h.empty(),b.setOverlay(c,d.embed)),d.embed||h.html(a(g.html)),c.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(a){var c=f.getBlockContent(a);
return b.form.inside(c).remove(),b.loader.inside(c).remove(),a},refocus:function(){},reset:function(){},populate:function(a){var c=f.data(a);b.fsSource().val(c.url)},isLoading:!1,loading:function(){var a=f.getBlockContent(h);b.isLoading?(b.loader.inside(a).addClass("hidden"),b.form.inside(a).removeClass("hidden"),b.isLoading=!1):(b.loader.inside(a).removeClass("hidden"),b.form.inside(a).addClass("hidden"),b.isLoading=!0)},setOverlay:function(a,b){var c=a.data("overlay");if(c)c.element().empty(),c.element().append(b);
else{c=e.document.overlay.create(a);var d=f.getBlockContent(a);c.placeholder().css("height","400px").appendTo(d),c.element().append(b),c.attach()}a.data("overlay",c)},showForm:function(a){var c=f.getBlockContent(a);b.form.inside(c).removeClass("hidden")},hideForm:function(a){var c=f.getBlockContent(a);b.form.inside(c).addClass("hidden")},crawl:function(c,d){var g=(f.getBlockContent(c),f.data(c));if(!b.isUrlValid(d))return b.errorMessage().removeClass("hide"),!1;var h=c.data("overlay");h&&h.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:d}).then(function(b){var c=b[d];
return null===c.oembed?a.Deferred().reject():a.Deferred().resolve(c)}).done(function(a){b.loading(),g.url=d,g.embed=a.oembed.html,b.hideForm(c),b.setOverlay(c,g.embed)}).fail(function(a){b.loading(),b.errorMessage().html(a).removeClass("hide")})},isUrlValid:function(a){if(""==a)return!1;var b=/^http(s):\/\/open\.spotify\.com\/(track|artist|album)\/(.*)$/,c=b.test(a);return c},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}var d=f.getBlockContent(h),e=b.source.inside(d).val();
b.fsSource().val(e),b.crawl(h,e)},"{fsRefreshButton} click":function(){var a=b.fsSource().val();b.crawl(h,a)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/table",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Table",{defaultOptions:{"{tableContainer}":"> .table-container","{table}":"table","{row}":"tr","{cell}":"td","{cellContent}":"td div[contenteditable]","{loading}":"[data-table-loading]","{tableStriped}":"[data-table-striped]","{tableBordered}":"[data-table-bordered]","{tableHover}":"[data-table-hover]","{tableCondensed}":"[data-table-condensed]","{tableRowFieldset}":"[data-table-rows]","{addRow}":"[data-table-rows-add]","{removeRow}":"[data-table-rows-remove]","{tableColumns}":"[data-table-columns]","{tableColumnsAdd}":"[data-table-columns-add]","{tableColumnsRemove}":"[data-table-columns-remove]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},activate:function(c){h=c,b.populate(c),c.on("keydown.tab",b.cellContent.selector,function(c){if(9==c.which){var d=a(c.target).parent(),f=b.cell.inside(h),g=f.eq(Math.min(f.index(d)+1,f.length-1)).find("> div[contenteditable]");e.editor.caret.setAfter(g[0].lastChild),c.stopPropagation()}})},deactivate:function(a){a.off("keydown.tab")},construct:function(){return content},deconstruct:function(){},reconstruct:function(){},refocus:function(a){var c=f.getBlockContent(a),d=a.data("lastFocused")||b.cell.inside(c).filter(":first");
d.focus()},reset:function(){},populate:function(a){var c=f.data(a);b.tableStriped().val(c.striped).trigger("change"),b.tableBordered().val(c.bordered).trigger("change"),b.tableHover().val(c.hover).trigger("change"),b.tableCondensed().val(c.condensed).trigger("change"),b.tableRowFieldset().val(c.rows),b.tableColumns().val(c.columns)},toHTML:function(c){b.loader(!1);var d=f.getBlockContent(c),e=b.table.inside(d).clone();return a.each(e.find("td"),function(b,c){c=a(c),c.html(c.find("div[contenteditable]").html())
}),e[0].outerHTML},toData:function(a){var b=f.data(a);return b},toText:function(a){var c=f.getBlockContent(a);return b.table.inside(c).text()},"{tableStriped} change":function(a){var d=f.getBlockContent(h),e=a.val();b.table.inside(d).toggleClass("table-striped",1==e),f.data(h,"striped",1==e?1:0)},"{tableBordered} change":function(a){var d=f.getBlockContent(h),e=a.val();b.table.inside(d).toggleClass("table-bordered",1==e),f.data(h,"bordered",1==e?1:0)},"{tableHover} change":function(a){var d=f.getBlockContent(h),e=a.val();
b.table.inside(d).toggleClass("table-hover",1==e),f.data(h,"hover",1==e?1:0)},"{tableCondensed} change":function(a){var d=f.getBlockContent(h),e=a.val();b.table.inside(d).toggleClass("table-condensed",1==e),f.data(h,"condensed",1==e?1:0)},loader:function(c){var d=f.getBlockContent(h),e=b.tableContainer.inside(d);if(c===!1)return b.loading.inside(d).remove(),void 0;if(!(b.loading.inside(d).length>0)){var i=(b.table.inside(e),a.create("div").attr("data-table-loading","").css({top:0,left:0,width:"100%",height:"50px",position:"absolute",background:"rgba(0,0,0,0.5)"}).html(a.create("div").css({textAlign:"center",position:"relative",top:"50%",lineHeight:"20px",marginTop:"-10px"}).html('<i class="fa fa-circle-o-notch fa-spin"></i>')));
e.append(i)}},"{tableRowFieldset} change":function(c){var e=f.getBlockContent(h),g=c.val(),i=f.data(h);(isNaN(g)||parseInt(g)<1||a.isEmpty(g))&&c.val(g=1),g=parseInt(g);var j=g-b.row.inside(e).length;if(0!=j){i.rows=g;var k=b.table.inside(e);setTimeout(function(){if(0>j&&b.row.inside(k).slice(j).remove(),j>0){var a=parseInt(b.tableColumns().val()),c=Array(j+1).join("<tr>"+Array(a+1).join('<td><div contenteditable="true">&#8203;</div></td>')+"</tr>");k.append(c)}k.appendTo(e)},50)}},"{tableColumns} change":function(c){var e=f.getBlockContent(h),g=c.val(),i=f.data(h);
(isNaN(g)||parseInt(g)<1||a.isEmpty(g))&&(g=1,c.val(g)),g=parseInt(g);var j=b.row.inside(e).filter(":first-child"),k=g-b.cell.inside(j).length;if(0!=k){i.columns=g;var l=b.table.inside(e);setTimeout(function(){var c=b.row.inside(l);if(0>k&&a.each(c,function(a,c){b.cell.inside(c).slice(k).remove()}),k>0){var d=Array(k+1).join('<td><div contenteditable="true">&#8203;</div></td>');c.append(d)}l.appendTo(e)},50)}},"{addRow} click":function(){var e=(f.getBlockContent(h),parseInt(b.tableRowFieldset().val())+1);b.tableRowFieldset().val(e).trigger("change")
},"{removeRow} click":function(){var e=(f.getBlockContent(h),Math.max(parseInt(b.tableRowFieldset().val())-1,1));b.tableRowFieldset().val(e).trigger("change")},"{tableColumnsAdd} click":function(){var d=parseInt(b.tableColumns().val())+1;b.tableColumns().val(d).trigger("change")},"{tableColumnsRemove} click":function(){b.tableColumns().val(Math.max(parseInt(b.tableColumns().val())-1,1)).trigger("change")}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/tabs",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Tabs",{defaultOptions:{"{tabHeader}":".nav-tabs","{tabHeaderListItem}":".nav-tabs > li","{tabHeaderListItemContent}":".nav-tabs > li a","{tabContent}":".tab-content","{tabPane}":"> .tab-content > .tab-pane","{titleItem}":"[data-tab-header-item]","{control}":"[data-tabs-control]","{controlItemContent}":"[data-tabs-control] [data-listbox-item-content]"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(b){var b=a.extend({},c.data,b);return content},reconstruct:function(b){if(b.hasClass("is-new")){var d=(f.data(b),f.getBlockContent(b)),e=a.uid("firsttab");newcontent=d.html().replace(/firsttab/g,e),d.html(newcontent)}},"{self} composerBlockDuplicate":function(c,d,e,g){var h=f.getBlockType(e);if("tabs"==h){f.updateBlockUid(e);var i=f.data(g);data=f.data(e),a.extend(data,i),f.duplicateChildBlocksData(e,g),clonedContent=f.getBlockContent(e);
var j=b.tabHeaderListItem.inside(e).find("a");a.each(j,function(b){var d=a(j[b]).attr("href"),e=a.uid("tab-");a(j[b]).attr("href","#"+e),clonedContent.find("div"+d).attr("id",e)})}},deconstruct:function(c){return a.each(c.find("[data-tab-wrapper]"),function(d,e){e=a(e);var f=e.parent();f.removeAttr("contenteditable"),e.children().appendTo(f),e.remove(),b.tabHeaderListItemContent.inside(c).eq(d).removeAttr("contenteditable")}),c},refocus:function(a){var c=b.tabPane.inside(a).filter(".active");c.focus()},reset:function(){},recover:function(){},populate:function(a){var c=f.data(a);
b.control().listbox().listbox("populate",c.tabs,function(a,b){a.listboxitem("content",b)})},revert:function(){},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d);return e.html()},toData:function(a){var b=f.data(a);return b},toText:function(a){var c=a.clone();return b.deconstruct(c).text()},tab:{create:function(){var d=a.uid("tab-"),g='<li><a href="#'+d+'" role="tab" data-bp-toggle="tab" data-tab-title contenteditable="true"></a></li>',i=a("<div></div>",{"class":"tab-pane",id:d}),j=a("<div></div>",{"class":"ebd-nest","data-type":"block","data-tab-wrapper":""}),k=f.constructNestedBlock("text");
j.wrapInner(k),i.wrapInner(j),b.tabContent.inside(h).filter(":first").append(i),b.tabHeader.inside(h).filter(":first").append(g),e.blocks.tree.populate()},remove:function(c){var d=b.tabContent.inside(h).filter(":first"),e=d.children(".tab-pane").eq(c);e.find(EBD.nestedBlock).each(function(){var b=a(this);f.removeBlock(b,{skipPanelTrigger:!0,skipFontTrigger:!0})}),e.remove(),b.tabHeaderListItem.inside(h).eq(c).remove()},focus:function(a){b.tabHeaderListItem.inside(h).eq(a).find("a").tab("show")}},"{tabHeaderListItem} click":function(a){a.find("a").tab("show")
},"{tabHeaderListItemContent} keyup":a.debounce(function(a,c){var d=c.keyCode?c.keyCode:c.which;if("13"!=d){var e=a.parents(".nav-tabs > li").index(),g=a.html().replace(/(<br>\s*)+$/,"");b.control().listbox("getItems").eq(e).listboxitem("content",g),f.data(h).tabs[e].content=g}},250),"{tabHeaderListItemContent} click":function(a,b){b.preventDefault()},"{tabHeaderListItemContent} keydown":function(a,b){var c=b.keyCode?b.keyCode:b.which;"13"==c&&b.preventDefault()},"{control} listboxBeforeAddItem":function(a,c,d){b.tab.create();
var e=d.listboxitem("toData"),f=b.tabHeader.inside(h).filter(":first");f.find("li").filter(":last").find("a").html(e.content)},"{control} listboxAfterAddItem":function(){f.data(h).tabs=b.control().listbox("toData"),1==b.tabContent.inside(h).length&&b.tabHeaderListItem.inside(h).filter(":first").find("a").tab("show")},"{control} listboxBeforeRemoveItem":function(a,c,d){var e=d.index();b.tab.remove(e)},"{control} listboxAfterRemoveItem":function(){f.data(h).tabs=b.control().listbox("toData"),1==b.tabContent.inside(h).length&&b.tabHeaderListItem.inside(h).filter(":first").find("a").tab("show")
},"{control} listboxAfterToggleDefault":function(){f.data(h).tabs=b.control().listbox("toData")},"{controlItemContent} keyup":a.debounce(function(a,c){var d=c.keyCode?c.keyCode:c.which;if("13"!=d){var e=a.parents("[data-listbox-item]"),g=e.index(),i=a.html().replace(/(<br>\s*)+$/,"");b.tabHeaderListItem.inside(h).eq(g).find("a").html(i),f.data(h).tabs[g].content=i}},250),"{controlItemContent} keypress":function(a,b){var c=b.keyCode?b.keyCode:b.which;"13"==c&&b.preventDefault()}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/ted",function(a){var b=this;
EasyBlog.Controller("Composer.Blocks.Handlers.Ted",{elements:["[data-ted-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:a.extend({"{form}":"> [data-ted-form]","{insert}":"[data-ted-insert]","{source}":"[data-ted-source]","{loader}":"> [data-ted-loader]","{errorMessage}":"[data-ted-error]","{player}":"iframe","{wrapper}":"[data-ted-wrapper]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()},toData:function(a){var c=f.data(a),d=a.data("overlay");
if(!d)return c;var e=b.player.inside(d.element());return c.source=e.attr("src"),c},toText:function(a){var b=f.data(a);return b.source},toHTML:function(a){var b=a.clone(),d=(f.data(b),a.data("overlay"));return d?d.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(a)},deactivate:function(){},construct:function(){},getWrapper:function(){var c=a(g.wrapper);return c},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);c.source&&!d?b.setOverlay(a):!c.source&&c.url?(e.html(g.html),b.crawl(c.url,a)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()
})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){f.data(a);b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a);c.url&&(b.url().val(c.url),b.width().val(c.width),b.height().val(c.height),b.fluid().val(c.fluid?"1":"0").trigger("change"))},getOverlay:function(a){var c=a.data("overlay"),g=(f.data(a),f.getBlockContent(a));if(!c){c=e.document.overlay.create(a);var h=b.getWrapper();c.placeholder().appendTo(h),g.empty().append(h),c.attach()}return c},setWrapperLayout:function(a){var c=b.wrapper.inside(a),d=f.data(a);
d.fluid?c.addClass("is-responsive").css({width:"",height:""}):(c.hasClass("is-responsive")&&(d.width=c.width(),d.height=c.outerHeight()),b.width().val(d.width),b.height().val(d.height),c.css({width:d.width,height:d.height}).removeClass("is-responsive"))},setOverlay:function(a){var c=f.data(a),d=b.getOverlay(a);d.element().length>0&&d.element().empty(),b.setWrapperLayout(a),d.element().append(c.embed),d.refresh(),a.data("overlay",d)},isUrlValid:function(a){if(""==a)return!1;var b=/^(http|https):\/\/www\.ted\.com\/talks\/(.*)$/,c=b.test(a);
return c},loading:function(){var a=f.getBlockContent(h),c=b.loader.inside(a),d=b.form.inside(a);b.isLoading?(c.addClass("hidden"),d.removeClass("hidden"),b.isLoading=!1):(c.removeClass("hidden"),d.addClass("hidden"),b.isLoading=!0)},crawl:function(a,c){var d=f.data(c),e=f.getBlockContent(c),g=c.data("overlay");g&&g.element().empty();var a="http://www.ted.com/services/v1/oembed.json?url="+encodeURIComponent(a);b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:a}).done(function(e){var f=e[a];d.url=a,d.title=f.oembed.title,d.author={name:f.oembed.author_name,url:f.oembed.author_url},d.embed=f.oembed.html,d.permalink=f.oembed.url,b.setOverlay(c),b.updateFieldset(c)
}).fail(function(a){b.errorMessage().removeClass("hide").html(a)}).always(function(){b.loading(),b.form.inside(e).addClass("hidden")})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}{var d=f.getBlockContent(h),e=b.source.inside(d).val();f.data(h)}return b.isUrlValid(e)?(b.crawl(e,h),void 0):(b.errorMessage().removeClass("hide"),void 0)},"{fluid} change":function(a){var d=1==a.val()?!0:!1,e=f.data(h);e.fluid=d,b.setWrapperLayout(h),b.widthFieldset().toggleClass("hide",d),b.heightFieldset().toggleClass("hide",d);
var g=b.getOverlay(h);g.refresh()},"{width} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.width=e;var g=b.getOverlay(h),i=b.wrapper.inside(h);i.css("width",e);var g=b.getOverlay(h);g.refresh()}},250),"{height} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.height=e;var g=b.wrapper.inside(h);g.css("height",e);var i=b.getOverlay(h);i.refresh()}},250),"{updateUrl} click":function(){var d=b.url().val(),g=(f.data(h),f.getBlockContent(h));return b.isUrlValid(d)?(b.crawl(d,h),void 0):(b.errorMessage.inside(g).removeClass("hide"),void 0)
}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/text",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Text",{defaultOptions:{"{block}":".ebd-block[data-type=text]","{blockWrapper}":"> [data-eb-text-block-wrapper]","{contentWrapper}":"> [data-eb-text-block-wrapper] > [data-eb-text-content-wrapper]","{allContentWrapper}":"[data-eb-text-content-wrapper]","{lastParagraph}":"> p:last"}},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()},activateKeys:function(){a(document).off("keydown.blocks.text")
},deactivateKeys:function(){a(document).on("keydown.blocks.text",function(a){var b=a.which;return 33==b||34==b?(a.preventDefault(),!1):!0})},getContent:function(a){var c=f.getBlockContent(a),d=b.contentWrapper.inside(c),e=d.find("p").text();return e},activate:function(c){b.deactivateKeys(),h=c,content=b.getContent(c),content=a.trim(content);var d=f.getBlockContent(c),e=b.contentWrapper.inside(d);content==g.data.default?e.find("> p").html("&nbsp;").focus():e.focus(),b.populate()},deactivate:function(c){b.activateKeys();
var d=b.getContent(c);if(d=a.trim(d),0==d.length||" "==d){var e=f.getBlockContent(c),h=b.contentWrapper.inside(e),i=h.find("> p");1===i.length&&i.html(g.data.default)}},construct:function(){var b=f.createBlock("text"),c=f.getBlockContent(b);return c.html(g.data.content),b},reconstruct:function(c){var d=f.getBlockContent(c),e=b.blockWrapper.inside(d);e.length||(e=a(g.blockWrapper).append(d[0].childNodes).appendTo(d));var h=b.contentWrapper.inside(d);if(!h.length){var i=[];a.each(e[0].childNodes,function(){a(this).is(EBD.block)||i.push(this)
}),h=a(g.contentWrapper).append(i).appendTo(e)}},"{self} composerBlockDuplicate":function(a,b,c,d){var e=f.getBlockType(c);"text"==e&&(f.updateBlockUid(c),f.duplicateChildBlocksData(c,d))},deconstruct:function(a){var c=f.getBlockContent(a),d=b.contentWrapper.inside(c);if(0==d.length)return a;var e=d[0].childNodes,g=c.find(EBD.immediateNestedBlock).filter(":not(.is-isolated)");return c.empty().append(g).append(e),a},refocus:function(){},reset:function(){},populate:function(){},recover:function(){},revert:function(){},toText:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d).text();
return e},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d).html();return e},toData:function(){},"{self} composerListFormat":function(c,d,e){var g=f.getBlockType(e);"text"==g&&(b.reconstruct(e),e.find(".redactor-selection-marker").each(function(){var b=a(this);b.find("ul, ol").length&&b.children().insertBefore(b)}))},"{allContentWrapper} mouseup":function(a){var b=f.block.of(a);f.font.populateFontFormatting(b)},"{allContentWrapper} keyup":a.debounce(function(a){var b=f.block.of(a);
f.font.populateFontFormatting(b)},100)}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/thumbnails",function(a){var b=this,c="view-selectratio",d="view-customratio",e=["numslider","numslider-toggle","numslider-widget","numslider-value","numslider-input"],f=function(b){if(b=a.trim(b),/\:/.test(b)){var c=b.split(":");return parseInt(c[0])+":"+parseInt(c[1])}return parseFloat(b)||0};EasyBlog.Controller("Composer.Blocks.Handlers.Thumbnails",{elements:["[data-eb-thumbnails-{layout-fieldset|layout-selection|size-fieldset|strategy-field|strategy-menu-item}]","[data-eb-thumbnails-columns-field] [data-eb-{"+e.join("|")+"}]","[data-eb-thumbnails-{ratio-button|ratio-label|ratio-customize-button|ratio-cancel-button|ratio-use-custom-button|ratio-cancel-custom-button|alignment-selection|size-field|ratio-selection|ratio-input}]"],defaultOptions:{"{thumbUploadPlaceholder}":".eb-thumbs-upload-placeholder","{thumbContainer}":".eb-thumbs","{thumbColumn}":".eb-thumbs-col","{thumbItem}":".eb-thumb","{thumbViewport}":"> div","{thumbPlaceholder}":".eb-thumb-placeholder","{thumbImage}":".ebd-block[data-type=image]","{browseButton}":"[data-eb-thumbnails-browse]","{sourceChangeButton}":"[data-eb-image-source-change-button]"}},function(b,e,g,h,i,j,k,l,m){return{init:function(){i=b.blocks,h=i.composer,j=e.meta,k=a(),l=i.dimensions,mediaManager=EasyBlog.MediaManager,mediaUploader=mediaManager.uploader,b.initImageBlockHandler(),b.initIndexing(k)
},initIndexing:function(c){var d=b.thumbItem.inside(c);indexing=a(d).length},normalize:function(b){return a.extend({},j.data,b)},activate:function(a){k=a,b.initIndexing(a),b.populate(a),b.initSortable(a)},deactivate:function(a){b.destroySortable(a)},initSortable:function(c){if(!window.ezb.mobile){var d=b.thumbColumn.inside(c),e=b.thumbContainer.inside(c);a(d).data("ui-sortable")||a(d).sortable({connectWith:".eb-thumbs-col",placeholder:"eb-thumb",containment:e}).disableSelection()}},destroySortable:function(c){if(!window.ezb.mobile){var d=b.thumbColumn.inside(c);
if(a(d).data("ui-sortable"))try{a(d).sortable("destroy")}catch(e){}}},construct:function(){},initImageBlockHandler:function(){void 0==m&&(i=b.blocks,m=i.getBlockHandler("image"))},constructImage:function(c,d,e){var f=b.addThumbItem(c);f.removeClass("is-uploading"),f.find(".eb-loader-o").remove();var g=b.thumbViewport.inside(f);f.append(g),a.each(e,function(a,e){var f=b.createThumbImage(c,d,e);g.html(f)});var h=b.thumbContainer.inside(c);h.removeClass("is-empty")},reconstruct:function(a){a.editable(!1);var c=b.thumbUploadPlaceholder.inside(a);
EasyBlog.MediaManager.uploader.register(c)},deconstruct:function(a){return b.destroySortable(a),b.thumbUploadPlaceholder.inside(a).remove(),a},refocus:function(){},reset:function(){},toData:function(a){var b=i.data(a);return b},toText:function(){},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=i.getBlockContent(d);return e.html()},createThumbItem:function(){return a(j.thumbItem)},addThumbItem:function(a){var c=b.createThumbItem();c.attr("data-position",indexing),indexing++;var d=b.getNextColumn(a);return d.append(c),c
},getNextColumnIndex:function(a){var c=i.data(a),d=b.thumbItem.inside(a).length,e=d,f=c.column_count,g=b.getColumnIndex(e,f);return g},getColumnIndex:function(a,b){return a-Math.floor(a/b)*b},getNextColumn:function(a){var c=b.getNextColumnIndex(a),d=b.thumbColumn.inside(a).eq(c);return d},createThumbPlaceholder:function(){return a(j.thumbPlaceholder)},createThumbImage:function(c,d,e){var f=i.data(c),g=d.uri,h=mediaManager.getVariation(g,"small"),j=mediaManager.getVariation(g,"large"),k=h.width,l=h.height,n=k/l,o=!1,p=!1;
if(void 0!=e.meta.params){var q=JSON.parse(e.meta.params);o=q.caption_text,p=q.alt_text}var r={uri:g,url:h.url,variation:h.key,mode_lock:!0,width_lock:!0,height_lock:!0,element_ratio:n,natural_width:k,natural_height:l,natural_ratio:n,caption_enabled:!0,caption_text:o,alt_text:p,link_enabled:!1,style_enabled:!1,size_enabled:!1,popup_uri:g,popup_url:j.url,popup_variation:j.key},s=f.layout;"stack"==s&&a.extend(r,{mode:"simple",fluid:!1,width:"100%"}),"grid"==s&&a.extend(r,{mode:"advanced",fluid:!0,width:"100%",height:"100%",ratio:f.ratio,strategy:f.strategy});
var t=i.constructNestedBlock("image",r).addClass("is-isolated");return"grid"==s&&(b.initImageBlockHandler(),setTimeout(function(){m.toAdvancedImageMode(t),m.setImageRatio(t,f.ratio),m.resizeToViewport(t,f.strategy)},150)),t},"{thumbUploadPlaceholder} mediaUploaderFilesAdded":function(c,d,e,f){var g=i.block.of(c);a.each(f,function(a,c){var d=c.id,e=b.addThumbItem(g);e.addClass("is-uploading").attr("data-file-id",d);var f=b.thumbViewport.inside(e),h=b.createThumbPlaceholder();e.append(f),mediaUploader.addItem(c,h);
var i=b.thumbContainer.inside(g);i.removeClass("is-empty")})},"{thumbUploadPlaceholder} mediaUploaderFileUploaded":function(a,c,d,e,f){var g=e.id,h=f.response,j=h.media,k=j.meta;setTimeout(function(){var c=i.block.of(a),d=b.thumbItem().where("fileId",g);d.removeClass("is-uploading").removeAttr("data-file-id").find(".eb-loader-o").remove(),mediaUploader.removeItem(e,d);var f=b.thumbViewport.inside(d),h=b.createThumbImage(c,k,j);f.html(h)},600)},populate:function(a){var c=b.hasThumbnails(a),d=i.panel.fieldgroup.get("thumbnails");
d.toggleClass("is-new",!c),c&&(b.populateLayout(a),b.populateColumnCount(a),b.populateResizeStrategy(a),b.populateRatio(a))},setLayout:function(c,d){b.initImageBlockHandler();var e=i.data(c);e.layout=d;var f=b.thumbImage.inside(c);f.each(function(){var c=a(this);if("stack"==d&&m.toSimpleImageMode(c),"grid"==d){var g=e.strategy,h=e.ratio;f.each(function(){m.toAdvancedImageMode(c),m.setImageRatio(c,h),m.resizeToViewport(c,g)})}})},updateLayout:function(a,c){b.setLayout(a,c),b.populateLayout(a)},populateLayout:function(a){var c=i.data(a),d=c.layout;
b.layoutSelection().removeClass("active").where("value",d).addClass("active"),b.sizeFieldset().switchClass("preset-"+d)},"{layoutSelection} click":function(a){var c=a.data("value");b.updateLayout(k,c)},setColumnCount:function(c,d){var e=i.data(c);e.column_count=d;var f=b.thumbItem.inside(c);f.detach();for(var g=[],h=0;h++<d;)g.push(a(j.thumbColumn));var k=[];f.each(function(){var c=a(this),d=c.data("position");k[d]=c});for(var l=new Array,h=0;h<k.length;h++)k[h]&&l.push(k[h]);var f=a(l);f.each(function(c){var e=a(this),f=b.getColumnIndex(c,d),h=g[f];
h.append(e)});var m=b.thumbColumn.inside(c);m.remove();var n=b.thumbContainer.inside(c);n.append(g),c.hasClass("active")&&b.initSortable(c)},updateColumnCount:function(a,c){b.setColumnCount(a,c),b.populateColumnCount(a)},populateColumnCount:function(a){var c=i.data(a),d=c.column_count;if(!b.resizingFromSlider){var e={start:d,step:1,range:{min:1,max:8},pips:{mode:"values",values:[1,2,3,4,5,6,7,8],density:16}};b.numsliderWidget().find(".noUi-pips").remove().end().noUiSlider(e,!0).noUiSlider_pips(e.pips)}},"{numsliderWidget} set":function(a,c,d){b.resizingFromSlider=!0;
var e=Math.round(d);b.updateColumnCount(k,e),b.resizingFromSlider=null},setRatio:function(c,d){b.initImageBlockHandler();var e=i.data(c);e.ratio=d;var f=b.thumbImage.inside(c);f.each(function(){var c=a(this);m.setImageRatio(c,d)})},updateRatio:function(a,c){b.setRatio(a,c),b.populateRatio(a)},populateRatio:function(a){var c=i.data(a),d=c.ratio;b.ratioLabel().html(d)},"{ratioButton} click":function(){b.sizeFieldset().switchClass(c)},"{ratioCustomizeButton} click":function(){b.sizeFieldset().switchClass(d)},"{ratioCancelButton} click":function(){b.sizeFieldset().removeClass(c)
},"{ratioCancelCustomButton} click":function(){b.sizeFieldset().switchClass(c)},"{ratioOkCustomButton} click":function(){b.sizeFieldset().removeClass(d)},"{ratioUseCustomButton} click":function(){var c=b.ratioInput(),e=f(c.val());0!=e&&(b.updateRatio(k,e),b.ratioSelection().removeClass("active"),b.sizeFieldset().removeClass(d))},"{ratioSelection} click":function(a){b.ratioSelection().removeClass("active"),a.addClass("active"),b.sizeFieldset().removeClass(c);var d=a.data("value");b.updateRatio(k,d)},setResizeStrategy:function(c,d){b.initImageBlockHandler();
var e=i.data(c);e.strategy=d;var f=b.thumbImage.inside(c);f.each(function(){var c=a(this);m.resizeToViewport(c,d)})},updateResizeStrategy:function(a,c){b.setResizeStrategy(a,c),b.populateResizeStrategy(a)},populateResizeStrategy:function(a){var c=i.data(a),d=c.strategy;b.strategyMenuItem().removeClass("active").where("strategy",d).addClass("active")},"{strategyMenuItem} click":function(a){var c=a.data("strategy");b.updateResizeStrategy(k,c)},hasThumbnails:function(a){return!!b.thumbItem.inside(a).length},"{self} composerBlockBeforeRemove":function(a,c,d){var e=i.getBlockType(d);
if("image"==e){var f=b.thumbItem.of(d);setTimeout(function(){var a=i.block.of(f);f.remove();var c=b.thumbContainer.inside(a),d=b.hasThumbnails(a);c.toggleClass("is-empty",!d)},1)}},"{self} composerBlockDuplicate":function(a,b,c,d){var e=i.getBlockType(c);"thumbnails"==e&&(i.updateBlockUid(c),i.duplicateChildBlocksData(c,d))},"{browseButton} mediaSelect":function(a,c,d,e){"image"==d.meta.type&&b.constructImage(k,e,[d])},"{sourceChangeButton} mediaSelect":function(a,c,d){if("image"==d.meta.type){var f=i.data(k),g=f.layout;
b.updateLayout(k,g)}}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/tweet",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Tweet",{defaultOptions:a.extend({"{form}":"> [data-tweet-form]","{insert}":"[data-tweet-insert]","{source}":"[data-tweet-source]","{loader}":"> [data-codepen-loader]","{preview}":"> [data-tweet-preview]","{fsSource}":"[data-fs-tweet-source]","{fsUpdate}":"[data-fs-tweet-update]","{errorMessage}":"[data-tweet-error]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var b=f.data(a);return b},toText:function(a){var b=f.data(a);return b.source},toHTML:function(a){var c=a.clone(),d=b.deconstruct(c),e=f.getBlockContent(d);return e.html()},activate:function(a){h=a,b.populate(a)},deactivate:function(){},construct:function(){},reconstruct:function(c){var d=f.data(c),e=f.getBlockContent(c),h=c.data("overlay");d.embed&&!h&&b.preview.inside(e).removeClass("hidden").html(d.embed),d.source||e.html(a(g.html)),c.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()
})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){f.data(a)},loading:function(){var a=f.getBlockContent(h);b.isLoading?(b.loader.inside(a).addClass("hidden"),b.form.inside(a).removeClass("hidden"),b.isLoading=!1):(b.loader.inside(a).removeClass("hidden"),b.form.inside(a).addClass("hidden"),b.isLoading=!0)},isUrlValid:function(a){if(""==a)return!1;var b=/^https:\/\/twitter\.com\/(.*)\/status\/(.*)$/,c=b.test(a);return c},crawl:function(a,c){var d=f.getBlockContent(a),e=f.data(a);
return b.isUrlValid(c)?(b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:c}).done(function(a){b.loading();var f=a[c];e.url=c,e.embed=f.oembed.html,e.source=c,b.form.inside(d).addClass("hidden"),b.preview.inside(d).html(e.embed).removeClass("hidden")}).fail(function(a){b.loading(),b.errorMessage().html(a).removeClass("hide")}),void 0):(b.errorMessage().removeClass("hide"),!1)},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}var d=f.getBlockContent(h),e=b.source.inside(d).val();
b.fsSource().val(e),b.crawl(h,e)},"{fsUpdate} click":function(){{var a=b.fsSource().val();f.data(h)}b.crawl(h,a)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/video",function(a){var b=this,c="view-selectratio",d="view-customratio",e=["video-width","video-height"],f=["numslider","numslider-toggle","numslider-widget","numslider-value","numslider-input","numslider-units","numslider-unit","numslider-current-unit"],g=function(a){return a.replace(/video-/,"")},h=function(a){return a.toString().match("%")?"%":"px"
},i=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},j=ratioDecimal=function(b){if(a.isNumeric(b))return b;var c=b.split(":");return c[0]/c[1]},m=(ratioPercent=function(a,b){return i(100*j(a),2)+(b?"%":0)},ratioPadding=function(a){return i(1/j(a)*100,2)+"%"},function(b){if(b=a.trim(b),/\:/.test(b)){var c=b.split(":");return parseInt(c[0])+":"+parseInt(c[1])}return parseFloat(b)||0});EasyBlog.require().library("plupload2","videojs").done(function(a){EasyBlog.Controller("Composer.Blocks.Handlers.Video",{elements:["[data-eb-{file-error}]","[data-eb-video-size-field] [data-eb-{"+f.join("|")+"}]","^videoSizeField .eb-composer-field[data-name={"+e.join("|")+"}]","[data-eb-video-{ratio-button|ratio-label|ratio-customize-button|ratio-cancel-button|ratio-use-custom-button|ratio-cancel-custom-button|alignment-selection|size-field|ratio-selection|ratio-input}]"],defaultOptions:{"{browseButton}":".eb-composer-placeholder-video [data-eb-mm-browse-button]","{placeholder}":"[data-eb-composer-video-placeholder]","{player}":"[data-video-player]","{dropElement}":"[data-plupload-drop-element]","{autoplay}":"[data-video-fieldset-autoplay]","{loop}":"[data-video-fieldset-loop]","{muted}":"[data-video-fieldset-muted]","{controls}":"[data-video-controls]","{width}":"[data-video-width]","{height}":"[data-video-height]","{videoContainer}":".eb-video","{videoViewport}":".eb-video-viewport","{videoPlayer}":"video","{videoSource}":"source"}},function(b,e,i,k,l,n,o,p,q,r){return{init:function(){l=b.blocks,k=l.composer,n=e.meta,o=a(),q=l.dimensions,r=EasyBlog.MediaManager,a.each(f,function(c,d){var e=a.camelize(d);
b[e].of=a.memoize(function(a){var c=b.getVideoSizeField(a);return b[e].under(c)})});var c={};p=function(d){return a(c[d.data("uid")]||(c[d.data("uid")]=b.videoContainer.inside(d)[0]))},getVideoViewport=a.memoize(function(a){return b.videoViewport.inside(a)},function(a){return a.data("uid")})},normalize:function(b){return a.extend({},n.data,b)},activate:function(a){o=a,b.populate(a)},deactivate:function(){},construct:function(b){var c=l.createBlockContainer("video"),d=l.data(c);return d=a.extend(d,b),c},constructFromMediaFile:function(a){{var c=a.data("key"),d=r.getUri(c),e=l.createBlockContainer("video");
l.getBlockContent(e),l.data(e)}return e.addClass("is-loading"),r.getMedia(d).done(function(a){setTimeout(function(){var c=a.meta,d=c.url;b.createPlayer(e,d)},250)}).fail(function(){}).always(function(){e.removeClass("is-loading")}),e},reconstruct:function(a){a.editable(!1);var c=l.data(a),d=b.hasVideo(a);if(d){var c=l.data(a);b.createPlayer(a,c.url)}else{var e=b.placeholder.inside(a);e.length>0&&EasyBlog.MediaManager.uploader.register(e)}},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){var c=b.hasVideoContainer(a),d=l.panel.fieldgroup.get("video");
d.toggleClass("is-new",!c),data=l.data(a),c&&(b.populateVideoSize(a),b.populateVideoControls(a))},toData:function(a){var b=l.data(a),c=p(a);if(c.length>0){var d=c[0].style;b.width=d.width,b.height=d.height}return b},toText:function(){},toHTML:function(){},toLegacyShortcode:function(a,b){var c="[embed=video][/embed]",d=l.data(b),e=d.width+"px",f=d.height+"px",g={width:e,height:f,uri:a.uri,autoplay:d.autoplay?"1":"0",muted:d.muted?"1":"0",loop:d.loop?"1":"0"},c="[embed=video]"+JSON.stringify(g)+"[/embed]";return c
},toEditableHTML:function(){},"{placeholder} mediaUploaderFilesAdded":function(a,b,c,d){EasyBlog.MediaManager.uploader.addItem(d[0],a)},"{placeholder} mediaUploaderFileUploaded":function(a,c,d,e,f){var g=f.response,h=g.media,i=h.meta,j=l.block.of(a);setTimeout(function(){b.createPlayer(j,i.url),j.hasClass("active")&&b.populate(j)},600)},"{placeholder} mediaUploaderFileError":function(c,d,e,f){f.code==a.plupload2.FILE_EXTENSION_ERROR&&b.fileError.inside(o).removeClass("hide")},"{self} composerBlockDuplicate":function(b,c,d,e){var f=l.getBlockType(d);
if("video"==f){d.removeAttr("data-uid"),l.setBlockUid(d);var g=l.data(e);data=l.data(d),a.extend(data,g),data.uid=a.uid("video-");var h=l.getBlockContent(d);h.empty()}},createPlayer:function(c,d){var e=l.data(c),f=d.substr(d.lastIndexOf(".")+1),g="video/x-flv";("mp4"==f||"MP4"==f||"3gp"==f||"3GP"==f||"MOV"==f||"mov"==f||"webm"==f)&&(g="video/mp4");var h=e.uid||(e.uid=a.uid("video-")),i=a(n.player).clone(),j=b.videoPlayer.inside(i),k=b.videoSource.inside(i);j.attr("id",h),k.attr("src",d),k.attr("type",g),e.url=d,e.width&&i.css("width",e.width),e.height&&i.css("height",e.height),q.toFluidWidth(c),q.toFluidHeight(c);
var m=l.getBlockContent(c);m.empty(),m.append(i),videojs(h,{controls:!0,autoplay:!1},function(){this.muted(e.muted)})},populateVideoControls:function(a){var c=l.data(a),d=1==c.autoplay?1:0,e=1==c.loop?1:0,f=1==c.muted?1:0;b.autoplay().val(d).trigger("change"),b.loop().val(e).trigger("change"),b.muted().val(f).trigger("change")},"{muted} change":function(a){var c=l.data(o);c.muted=a.val()},"{autoplay} change":function(a){var c=l.data(o);c.autoplay=a.val()},"{loop} change":function(a){var c=l.data(o);c.loop=a.val()
},populateVideoSize:function(a,c){for(var d,c=c||["width","height"];d=c.shift();){var e="width"==d?b.getVideoWidth(a):b.getVideoHeight(a),f=parseFloat(e),g=h(e);if(console.log(e),b.resizingFromSlider!==d){if("px"==g)var i={start:f,step:1,range:{min:1,max:1600},pips:{mode:"values",values:[64,320,640,960,1280,1600],density:4}};if("%"==g)var i={start:f,step:1,range:{min:1,max:100},pips:{mode:"values",values:[0,20,40,60,80,100],density:5}};b.numsliderWidget.of(d).find(".noUi-pips").remove().end().noUiSlider(i,!0).noUiSlider_pips(i.pips)
}var j=Math.round(f);"width"==d&&b.width().val(j),"height"==d&&b.height().val(j)}b.populateVideoRatio(a),b.populateVideoAlignment(a)},getVideoWidth:function(a){var b=p(a),c=b[0].style;if(l.isNestedBlock(a)){var d=a[0].style.width;if(/%/.test(d))return d}return c.width||b.css("width")},getVideoHeight:function(a){var b=p(a),c=b[0].style;return c.height||b.css("height")},getVideoSize:function(a,c){return"width"==c?b.getVideoWidth(a):"height"==c?b.getVideoHeight(a):void 0},getVideoComputedWidth:function(a){return p(a).width()
},getVideoComputedHeight:function(a){return p(a).outerHeight()},setVideoWidth:function(a,c){{var d=p(a),f=(getVideoViewport(a),b.getVideoRatio(a)),g=h(c);b.getVideoComputedHeight(a)}d.toggleClass("is-responsive","%"==g),l.isNestedBlock(a)?("%"==g&&(a.css("width",c),d.css("width","")),"px"==g&&(a.css("width","auto"),d.css("width",c))):d.css("width",c),0==f&&"%"==g&&(f=null),b.adjustVideoRatio(a,f)},setVideoFluidWidth:function(a,b){var c=p(a);if(l.isNestedBlock(a))q.toAutoWidth(a),c.css("width",b),q.toFluidWidth(a),c.css("width","");
else{var d=l.getBlockContent(a),b=b/d.width()*100+"%";c.css("width",b)}},setVideoSize:function(a,c,d){"width"==c&&b.setVideoWidth(a,d),"height"==c&&b.setVideoHeight(a,d)},updateVideoSize:function(a,c,d){b.setVideoSize(a,c,d),b.populateVideoSize(a)},setVideoHeight:function(a,c){var d=p(a),e=getVideoViewport(a),f=b.getVideoRatio(a);if(b.isFluidVideo(a)){if(0==f){var g=b.getVideoComputedWidth(a),c=parseFloat(c);f=g/c}else{var g=parseFloat(c)*f;b.setVideoFluidWidth(a,g)}d.css("height",""),e.css("padding-top",ratioPadding(f))
}else if(d.css("height",c),0!==f){var g=parseFloat(c)*ratioDecimal(f);d.css("width",g),e.css("padding-top","")}},setVideoUnit:function(a,c,d){if("width"===c){{var f=(p(a),b.getVideoWidth(a)),g=b.getVideoComputedWidth(a);b.getVideoComputedHeight(a)}"px"==d&&/%/.test(f)&&b.setVideoWidth(a,g),"%"==d&&/px/.test(f)&&b.setVideoFluidWidth(a,g)}},getVideoUnit:function(a,c){var d=b.getVideoSize(a,c);return h(d)},updateVideoUnit:function(a,c,d){b.setVideoUnit(a,c,d),b.populateVideoSize(a)},handleNumsliderWidget:function(a,c){var d=b.getVideoSizeProp(a),e=b.getVideoSizeUnit(d),c=Math.round(c)+e;
b.resizingFromSlider=d,b.updateVideoSize(o,d,c),b.resizingFromSlider=null},"{width} change":function(a){var d=a.val()+"%";b.updateVideoSize(o,"width",d)},"{height} change":function(a){var d=a.val()+"px";b.updateVideoSize(o,"height",d)},"{numsliderWidget} nouislide":function(a,c,d){b.handleNumsliderWidget(a,d)},"{numsliderWidget} set":function(a,c,d){b.handleNumsliderWidget(a,d)},"{numsliderInput} input":function(c){function d(a){c.on("blur.numslider",function(){c.val(a)})}c.off("blur.numslider");var e=b.getVideoSizeProp(c),f=b.getVideoSize(o,e),g=parseFloat(f),i=c.val(),j=h(f),k=i+j;
return a.isNumeric(i)?(b.updateVideoSize(o,e,k),void 0):d(g)},"{numsliderUnit} click":function(a){var c=b.getVideoSizeProp(a),d=a.data("unit");b.updateVideoUnit(o,c,d)},"{self} composerBlockResizeStart":function(a,c,d){if("video"===l.getBlockType(d)){var f=b.getVideoComputedWidth(d),g=b.getVideoComputedHeight(d);d.data("initialWidth",f),d.data("initialHeight",g)}},"{self} composerBlockBeforeResize":function(a,c,d,e){function q(){b.isFluidVideo(d)?b.setVideoFluidWidth(d,n):b.setVideoWidth(d,n)}function r(){b.setVideoHeight(d,o)
}if("video"===l.getBlockType(d)&&b.hasVideoContainer(d)){c.preventDefault();var g=(d.data("initialImageSize"),e.originalSize),h=e.size,i=h.width-g.width,j=h.height-g.height,k=d.data("initialWidth"),m=d.data("initialHeight"),n=k+i,o=m+j,p=b.getVideoRatio(d);0==p?(0!==i&&q(),0!==j&&r()):0==i?0!==j&&r():q(),b.populateVideoSize(d)}},setVideoRatio:function(a,c){var d=l.data(a);d.ratio=c,b.adjustVideoRatio(a,c)},adjustVideoRatio:function(a,c){var d=p(a),e=getVideoViewport(a),f=b.getVideoComputedWidth(a),g=b.getVideoComputedHeight(a),h="",i="";
null==c&&(c=f/g),b.isFluidVideo(a)?i=ratioPadding(c):h=0==c?g:f/ratioDecimal(c),d.css("height",h),e.css("padding-top",i)},populateVideoRatio:function(a){var c=l.data(a),d=c.ratio;b.ratioButton().toggleClass("ratio-unlocked",0==d),b.ratioLabel().html(d)},updateVideoRatio:function(a,c){b.setVideoRatio(a,c),b.populateVideoRatio(a)},getVideoRatio:function(a){{var c=l.data(a);p(a)}if(void 0===c.ratio){var e=b.getVideoComputedWidth(a),f=b.getVideoComputedHeight(a);c.ratio=e/f}return j(c.ratio)},"{browseButton} mediaSelect":function(a,c,d){var f=l.block.of(a);
if("video"==d.meta.type){var g=d.meta,h=k.document,i=h.isLegacy();i?(content=b.toLegacyHTML(f),h.insertContent(content)):b.createPlayer(f,g.url)}},"{self} mediaInsert":function(c,d,e,f,g,h){if("video"==e.meta.type){var i=k.document,j=i.isLegacy();if(j){var m=l.data(f);g=a.extend(m,g),content=b.toLegacyShortcode(e.meta,f),i.insertContent(content)}else{var f=l.constructBlock("video",{url:e.meta.url,autoplay:g.autoplay,loop:g.loop,muted:g.muted});l.addBlock(f),h||l.activateBlock(f)}}},"{self} mediaInfoDestroy":function(a,c,d,e){if(!e||"video"==e.meta.type){var f=b.videoPlayer.inside(d),g=f.attr("id");
videojs(g).dispose()}},"{ratioButton} click":function(){b.sizeField().switchClass(c)},"{ratioCustomizeButton} click":function(){b.sizeField().switchClass(d)},"{ratioCancelButton} click":function(){b.sizeField().removeClass(c)},"{ratioCancelCustomButton} click":function(){b.sizeField().switchClass(c)},"{ratioOkCustomButton} click":function(){b.sizeField().removeClass(d)},"{ratioUseCustomButton} click":function(){var c=b.ratioInput(),e=m(c.val());0!=e&&(b.updateVideoRatio(o,e),b.ratioSelection().removeClass("active"),b.sizeField().removeClass(d))
},"{ratioSelection} click":function(a){b.ratioSelection().removeClass("active"),a.addClass("active"),b.sizeField().removeClass(c);var d=a.data("value");b.updateVideoRatio(o,d)},"{alignmentSelection} change":function(a){var b=a.val();l.font.setFontFormatting(o,"align"+b)},populateVideoAlignment:function(a){if(l.isNestedBlock(a))return b.sizeField().addClass("no-alignment"),void 0;var c=l.getBlockContent(a),d=b.getVideoComputedWidth(a),e=d<c.width();b.sizeField().toggleClass("no-alignment",!e);var f=a.css("text-align");
b.alignmentSelection().val(f)},getVideoSizeField:function(c){var d=b["videoSizeFieldVideo"+a.capitalize(c)]();return d},getVideoSizeProp:function(a){var c=a.closest(b.numslider.selector),d=g(c.data("name"));return d},getVideoSizeUnit:function(c){var d=b.getVideoSizeField(c);return a.trim(b.numsliderCurrentUnit.under(d).text())},isFluidVideo:function(a){var b=p(a);return b.hasClass("is-responsive")},hasVideo:function(a){var b=l.data(a);return!!b.url},hasVideoContainer:function(a){return b.videoContainer.inside(a).length>0
}}}),b.resolve()})}),EasyBlog.module("composer/blocks/handlers/vimeo",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Vimeo",{elements:["[data-vimeo-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:a.extend({"{form}":"> [data-vimeo-form]","{insert}":"[data-vimeo-insert]","{source}":"[data-vimeo-source]","{loader}":"> [data-vimeo-loader]","{player}":"iframe","{wrapper}":"[data-vimeo-wrapper]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var c=f.data(a),d=a.data("overlay");if(!d)return c;var e=b.player.inside(d.element());return c.source=e.attr("src"),c},toText:function(a){var b=f.data(a);return b.source},toHTML:function(a){var b=a.clone(),d=(f.data(b),a.data("overlay"));return d?d.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(a)},deactivate:function(){},construct:function(){},getWrapper:function(){var c=a(g.wrapper);return c},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);
c.source&&!d?b.setOverlay(a):0==c.source.length&&c.url?(e.html(g.html),b.crawl(c.url,a)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){f.data(a);b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a);c.url&&(b.url().val(c.url),b.width().val(c.width),b.height().val(c.height),b.fluid().val(c.fluid?"1":"0").trigger("change"))},getOverlay:function(a){var c=a.data("overlay"),g=(f.data(a),f.getBlockContent(a));
if(!c){c=e.document.overlay.create(a);var h=b.getWrapper();c.placeholder().appendTo(h),g.empty().append(h),c.attach()}return c},setWrapperLayout:function(a){var c=b.wrapper.inside(a),d=f.data(a);d.fluid?c.addClass("is-responsive").css({width:"",height:""}):(c.hasClass("is-responsive")&&(d.width=c.width(),d.height=c.outerHeight()),b.width().val(d.width),b.height().val(d.height),c.css({width:d.width,height:d.height}).removeClass("is-responsive"))},setOverlay:function(a){var c=f.data(a),d=b.getOverlay(a);d.element().length>0&&d.element().empty(),b.setWrapperLayout(a),d.element().append(c.embed),d.refresh(),a.data("overlay",d)
},isUrlValid:function(a){if(""==a)return!1;var b=/^https:\/\/vimeo\.com\/(.*)$/,c=b.test(a);return c},loading:function(){var a=f.getBlockContent(h),c=b.loader.inside(a),d=b.form.inside(a);b.isLoading?(c.addClass("hidden"),d.removeClass("hidden"),b.isLoading=!1):(c.removeClass("hidden"),d.addClass("hidden"),b.isLoading=!0)},crawl:function(a,c){var d=f.data(c),e=f.getBlockContent(c),g=c.data("overlay");g&&g.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:a}).done(function(e){var f=e[a];
d.url=a,d.author={name:f.oembed.author_name,url:f.oembed.author_url},d.description=f.oembed.description,d.embed=f.oembed.html,d.duration=f.oembed.duration,d.width=f.oembed.width,d.height=f.oembed.height,b.setOverlay(c),b.updateFieldset(c)}).fail(function(a){b.errorMessage().removeClass("hide").html(a)}).always(function(){b.loading(),b.form.inside(e).addClass("hidden")})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);f.activateBlock(c)}{var d=f.getBlockContent(h),e=b.source.inside(d).val();f.data(h)
}return b.isUrlValid(e)?(b.crawl(e,h),void 0):(b.errorMessage().removeClass("hide"),void 0)},"{fluid} change":function(a){var d=1==a.val()?!0:!1,e=f.data(h);e.fluid=d,b.setWrapperLayout(h),b.widthFieldset().toggleClass("hide",d),b.heightFieldset().toggleClass("hide",d);var g=b.getOverlay(h);g.refresh()},"{width} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.width=e;var g=b.getOverlay(h),i=b.wrapper.inside(h);i.css("width",e);var g=b.getOverlay(h);g.refresh()}},250),"{height} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();
if(0!=e){d.height=e;var g=b.wrapper.inside(h);g.css("height",e);var i=b.getOverlay(h);i.refresh()}},250),"{updateUrl} click":function(){var d=b.url().val(),g=(f.data(h),f.getBlockContent(h));return b.isUrlValid(d)?(b.crawl(d,h),void 0):(b.errorMessage.inside(g).removeClass("hide"),void 0)}}}),b.resolve()}),EasyBlog.module("composer/blocks/handlers/youtube",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Handlers.Youtube",{elements:["[data-youtube-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url|nocookie}]"],defaultOptions:a.extend({"{related}":"[data-youtube-fieldset-related]","{form}":"> [data-youtube-form]","{insert}":"[data-youtube-insert]","{source}":"[data-youtube-source]","{loader}":"> [data-youtube-loader]","{errorMessage}":"[data-youtube-error]","{player}":"iframe","{wrapper}":"[data-youtube-wrapper]"},EBD.selectors)},function(b,c,d,e,f,g,h){return{init:function(){f=b.blocks,e=f.composer,g=c.meta,h=a()
},toData:function(a){var c=f.data(a),d=a.data("overlay");if(!d)return c;var e=b.player.inside(d.element());return c.source=e.attr("src"),c},toText:function(a){var b=f.data(a);return b.source},toEditableHTML:function(){return""},toHTML:function(a){var c=(f.data(a),a.data("overlay"));return c?c.element().html():void 0},activate:function(a){f.getBlockContent(a),f.data(a);h=a,b.populate(h)},deactivate:function(){},construct:function(){},getWrapper:function(){var c=a(g.wrapper);return c},reconstruct:function(a){var c=f.data(a),d=a.data("overlay"),e=f.getBlockContent(a);
c.source&&!d?b.setOverlay(a):0==c.source.length&&c.url?(e.html(g.html),b.crawl(c.url,a)):e.html(g.html),a.find(b.source.selector).off("paste").on("paste",function(a){a.stopPropagation()})},deconstruct:function(){},refocus:function(){},reset:function(){},populate:function(a){f.data(a);b.updateFieldset(a)},updateFieldset:function(a){var c=f.data(a);b.url().val(c.url),b.width().val(c.width),b.height().val(c.height),b.fluid().val(c.fluid?"1":"0").trigger("change"),b.related().val(c.related?"any":"same").trigger("change"),b.nocookie().val(1==c.nocookie?"1":"0").trigger("change")
},getOverlay:function(a){var c=a.data("overlay"),g=(f.data(a),f.getBlockContent(a));if(!c){c=e.document.overlay.create(a);var h=b.getWrapper();c.placeholder().appendTo(h),g.empty().append(h),c.attach()}return c},setWrapperLayout:function(a){var c=b.wrapper.inside(a),d=f.data(a);d.fluid?c.addClass("is-responsive").css({width:"",height:""}):(c.hasClass("is-responsive")&&(d.width=c.width(),d.height=c.outerHeight()),b.width().val(d.width),b.height().val(d.height),c.css({width:d.width,height:d.height}).removeClass("is-responsive"))
},setOverlay:function(a){var c=f.data(a),d=b.getOverlay(a);d.element().length>0&&d.element().empty(),b.setWrapperLayout(a),d.element().append(c.embed),d.refresh(),a.data("overlay",d)},isUrlValid:function(a){if(""==a)return!1;var b=/^(http|https):\/\/www\.youtube\.com\/watch\?v=(.*)$/,c=b.test(a);if(!c){var b=/^(http|https):\/\/youtu\.be\/(.*)$/;c=b.test(a)}return c},loading:function(){var a=f.getBlockContent(h),c=b.loader.inside(a),d=b.form.inside(a);b.isLoading?(c.addClass("hidden"),d.removeClass("hidden"),b.isLoading=!1):(c.removeClass("hidden"),d.addClass("hidden"),b.isLoading=!0)
},hideForm:function(a){var c=f.getBlockContent(a);b.form.inside(c).addClass("hidden"),b.loader.inside(c).removeClass("hidden")},showForm:function(a){var c=f.getBlockContent(a);b.form.inside(c).removeClass("hidden"),b.loader.inside(c).addClass("hidden")},crawl:function(a,c){var d=f.data(c),g=(f.getBlockContent(c),c.data("overlay"));g&&g.element().empty(),b.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:a}).done(function(e,f){var g=e[a];return"Unauthorized"==g.oembed?(b.showForm(c),b.errorMessage().removeClass("hide").html(f),void 0):(d.url=a,d.author={name:g.oembed.author_name,url:g.oembed.author_url},d.embed=g.oembed.html,d.embed_nocookie=g.oembed.html_nocookie,d.embed_original=g.oembed.html,d.width=g.oembed.width,d.height=g.oembed.height,b.setOverlay(c),b.updateFieldset(c),void 0)
}).fail(function(a){b.errorMessage().removeClass("hide").html(a)}).always(function(){b.loading()})},"{insert} click":function(a){if(h.length<1){var c=b.block.of(a);return f.activateBlock(c),void 0}{var d=f.getBlockContent(h),e=b.source.inside(d).val();f.data(h)}return b.isUrlValid(e)?(b.crawl(e,h),void 0):(b.errorMessage().removeClass("hide"),void 0)},"{related} change":function(a){var d=f.data(h),e="any"==a.val(),g=h.data("overlay");if(d.related=e,g){var i=b.player.inside(g.element()),j=i.attr("src");e||(j=j.replace("?feature=oembed","?feature=oembed&rel=0"),i.attr("src",j)),e&&(j=j.replace("&rel=0",""),i.attr("src",j)),d.source=j
}},"{fluid} change":function(a){var d=1==a.val()?!0:!1,e=f.data(h);if(e.url){e.fluid=d,b.setWrapperLayout(h),b.widthFieldset().toggleClass("hide",d),b.heightFieldset().toggleClass("hide",d);var g=b.getOverlay(h);g.refresh()}},"{width} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(d.url&&0!=e){d.width=e;var g=b.getOverlay(h),i=b.wrapper.inside(h);i.css("width",e);var g=b.getOverlay(h);g.refresh()}},250),"{height} keyup":a.debounce(function(a){var d=f.data(h),e=a.val();if(0!=e){d.height=e;var g=b.wrapper.inside(h);
g.css("height",e);var i=b.getOverlay(h);i.refresh()}},250),"{updateUrl} click":function(){var d=b.url().val(),g=(f.data(h),f.getBlockContent(h));return b.isUrlValid(d)?(b.crawl(d,h),void 0):(b.errorMessage.inside(g).removeClass("hide"),void 0)},"{nocookie} change":function(a){var d=f.data(h),e=1==a.val()?!0:!1;d.nocookie=e,d.url&&(d.embed=e?d.embed_nocookie:d.embed_original,d.related||(d.embed=d.embed.replace("?feature=oembed","?feature=oembed&rel=0")),b.setOverlay(h))}}}),b.resolve()}),EasyBlog.module("composer/blocks/mobile",function(a){var b=this;
EasyBlog.Controller("Composer.Blocks.Mobile",{defaultOptions:a.extend({"{blipp}":"[data-eb-blipp]","{viewport}":".eb-composer-viewport","{actionBar}":"[data-eb-composer-actions]"},EBD.selectors)},function(b,c,d,e,f){return{init:function(){f=b.blocks,e=f.composer},"{blipp} mousedown":function(c,d){d.stopPropagation(),d.preventDefault();var g;a(document).off("mousemove.blip mouseup.blip").on("mousemove.blip",function(d){var e=a.getPointerPosition(d),f=b.viewport(),h=f.offset(),i=30,j=f.width()-10,k=f.height()-30,l=h.left+30,m=e.x-h.left,n=e.y-h.top;
c.css("left",m),c.css("top",n),g=null,e.y<i&&(g="addBlock"),e.y>k&&(g="removeBlock"),e.x<l&&(g="viewBlockTree"),e.x>j&&(g="moveBlock")}).on("mouseup.blip",function(){return a(document).off("mousemove.blip"),b.actionBar().show(),e.blocks.droppable.destroyDropzones(),e.sidebar.deactivate("blocks"),e.sidebar.deactivate("explorer"),"addBlock"==g?(e.sidebar.activate("blocks"),e.blocks.droppable.populateDropzones(),b.trigger("ComposerMobileAddBlock"),void 0):"moveBlock"==g?(e.blocks.droppable.populateDropzones(),f.getAllBlocks().on("click.tapremove",function(b){b.stopPropagation();
var c=a(this);c.addClass("hide")}),void 0):"removeBlock"==g?(b.actionBar().hide(),f.getAllBlocks().on("click.tapremove",function(b){b.stopPropagation();var c=a(this);f.removeBlock(c)}),b.trigger("ComposerMobileRemoveBlock"),void 0):"viewBlockTree"==g?(EasyBlog.Composer.sidebar.activate("explorer"),b.trigger("ComposerMobileViewTree"),void 0):void 0})}}}),b.resolve()}),EasyBlog.module("composer/blocks/nestable",function(){var b=this,c="is-nested";EasyBlog.require().library("ui/sortable").done(function(a){EasyBlog.Controller("Composer.Blocks.Nestable",{defaultOptions:a.extend({},EBD.selectors)},function(b,d,e,f,g){return{init:function(){g=b.blocks,f=b.blocks.composer,currentNest=a()
},enable:function(){b.nest().each(function(){var c=a(this);b.initNestable(c)})},disable:function(){b.nest().each(function(){var c=a(this);b.destroyNestable(c)})},initNestable:function(a){a.hasClass("ui-sortable")||a.sortable({items:EBD.childBlock,connectWith:EBD.root+", "+EBD.nest,helper:"clone",appendTo:f.document.ghosts(),placeholder:"ebd-block is-placeholder is-nested",tolerance:"pointer",refreshPositions:!0,handle:EBD.immediateBlockSortHandle})},destroyNestable:function(a){a.hasClass("ui-sortable")&&a.sortable("destroy")
},"{self} composerBlockMechanicsChange":function(a,c,d){"sortable"==d?b.enable():b.disable()},isBlockNest:function(a){return"block"==a.data("type")},isContentNest:function(a){return"content"==a.data("type")},"{self} composerBlockCreate":function(){},"{self} composerBlockInit":function(c,d,e){e.is(EBD.nestableBlock)&&"sortable"!=!g.getMechanics()&&e.find(EBD.nest).each(function(){var c=a(this);b.initNestable(c)})},disableEditableNest:function(a){a.editable()&&(a.editable(!1),a.data("editable-nest",!0))},enableEditableNest:function(a){a.data("editable-nest")&&(a.editable(!0),a.removeData("editable-nest"))
},"{block} mouseover":function(a,c){if(!c.nestHandled){if(a.is(EBD.nestedBlock)){var d=b.nest.of(EBD.nestedBlock);b.disableEditableNest(d)}else{var d=b.nest.inside(a);if(d.length<1)return;b.enableEditableNest(d)}c.nestHandled=!0}},"{block} mouseout":function(a){if(a.is(EBD.nestedBlock)){var d=b.nest.of(EBD.nestedBlock);b.enableEditableNest(d)}},snap:function(a,d,e,f){if(b.isBlockNest(e))return f.addClass(c),void 0;var g=e.offset(),h=e.width(),i=g.left+h/2,j=b.position(e,i>a?"left":"right");f.addClass(c).switchClass("nest-"+j),e.data("snappedPosition",j)
},unsnap:function(a){a.removeClass(c).removeClass(function(a,b){return(b.match(/(^|\s)nest-\S+/g)||[]).join(" ")})},positions:function(a){return(a.data("positions")||"left,right").split(",")},availablePositions:function(c){var d=b.positions(c);return c.find(EBD.childBlock+":not(.is-sort-item)").each(function(){var c=b.extractPosition(a(this).attr("class"));c&&a.pull(d,c)}),d},extractPosition:function(b){return b instanceof a&&(b=b.attr("class")),((b.match(/nest-\w+/g)||[])[0]||"").split("nest-")[1]},position:function(c,d){var e=b.availablePositions(c);
return a.indexOf(e,d)>-1?d:e[0]},setTargetNest:function(a){b.clearTargetNest(),g.over(a)},unsetTargetNest:function(a){g.out(a)},clearTargetNest:function(){b.nest().each(function(){var b=a(this);g.out(b)})},trackNest:function(c,d){a(document).off("mousemove.nestable").on("mousemove.nestable",function(a){b.snap(a.pageX,a.pageY,c,d)})},untrackNest:function(){a(document).off("mousemove.nestable")},"{self} composerBlockBeforeDrop":function(a,d,e){var f=e.closest(EBD.nest),h=b.extractPosition(e);if(e.toggleClass(c,f.length>0),b.isContentNest(f)){var i=b.position(f,f.data("snappedPosition"));
e.switchClass("nest-"+i),e.hasClass("is-new")&&g.dimensions.toFluidWidth(e),h&&i!==h?b.trigger("composerBlockNestChange",[e,i,h]):b.trigger("composerBlockNestIn",[e,i])}else h&&(b.unsnap(e),b.trigger("composerBlockNestOut",[e]))},replaceWithCommentPlaceholder:function(c,d){var e=a("<div>").html(c[d]),f=e.find(EBD.immediateNestedBlock);if(!(f.length<=0)){f.each(function(){var e=a(this),f=g.getBlockUid(e),h=document.createComment("block"+f);e.replaceWith(h);var i=g.getBlock(f),j=g.exportBlock(i),k=b.extractPosition(i.attr("class"));
k&&(j.position=k),"html"==d&&c.blocks.push(j)});var h=e.html();c[d]=h}},"{self} composerBlockExport":function(a,c,d,e){e.blocks=[],b.replaceWithCommentPlaceholder(e,"editableHtml"),b.replaceWithCommentPlaceholder(e,"html")}}}),b.resolve()})}),EasyBlog.module("composer/blocks/panel",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Panel",{elements:["[data-eb-composer-blocks-{props}]","[data-eb-composer-blocks-{prop-group|prop-action}]","[data-eb-composer-{panel}][data-id=blocks]","[data-eb-composer-blocks-{block-subpanel|removal-subpanel}]","[data-eb-composer-block-{fieldgroup}]","[data-eb-composer-blocks-props-{block-menu|text-menu|block-content|text-content}]","[data-eb-composer-blocks-{subpanel|subpanel-button}]"],defaultOptions:{"{blockTitle}":"[data-block-property-title]","{blockIcon}":"[data-block-property-icon]"}},function(b,c,d,e,f,g){return{init:function(){f=b.blocks,e=f.composer,g=a()
},"{self} composerBlockBeforeActivate":function(a,c,d){e.panels.activate("blocks"),g=d,b.panel().switchClass("show-block-subpanel"),b.fieldgroup.display(d)},fieldgroup:{get:a.memoize(function(c){var d=e.find(b.fieldgroup).where("type",c);if(d.length<1)var g=f.getBlockMeta(c),d=a(g.fieldgroup);return d}),hide:function(){b.panel().addClass("is-empty").find(b.fieldgroup).detach()},display:function(a){var c=a.attr("data-type"),d=b.panel();d.removeClass("is-empty").find(b.fieldgroup).detach();var e=d.find(b.propGroup).where("type","specific");
b.fieldgroup.get(c).toggleClass("is-standalone",f.isStandaloneBlock(a)).appendTo(e)}},openPanel:function(a){("block"==a||"text"==a)&&(b.panel().switchClass("show-"+a+"-subpanel"),b.subpanelButton().where("name",a).activateClass("active")),"removal"==a&&b.panel().switchClass("show-removal")},activatePanel:function(a){clearTimeout(b.revertToPostPanel);{var c=f.getBlockMeta(a);f.getAllParentBlocks(a),f.getChildBlocks(a)}b.subpanelButton().show(),c.properties.textpanel||b.subpanelButton().hide(),b.blockIcon().attr("class",c.icon),b.blockTitle().html(c.title)
},deactivatePanel:function(){b.revertToPostPanel=setTimeout(function(){e.document.workarea().hasClass("is-sorting")||e.panels.activate("post-options")},1),b.fieldgroup.hide()},"{self} composerBlockActivate":function(a,c,d){b.activatePanel(d)},"{self} composerBlockDeactivate":function(a,c,d){b.deactivatePanel(d)},"{self} composerBlockRemove":function(a,c,d,e){e.skipPanelTrigger||b.fieldgroup.hide(d)},"{subpanelButton} click":function(a){var c=a.data("name");b.openPanel(c)}}}),b.resolve()}),EasyBlog.module("composer/blocks/removal",function(){var b=this,c="is-removing";
EasyBlog.require().library("ui/droppable").done(function(){EasyBlog.Controller("Composer.Blocks.Removal",{defaultOptions:{"{workarea}":EBD.workarea,"{dropzone}":"[data-eb-composer-blocks-removal-subpanel]"}},function(a,b,d,e,f,g){return{init:function(){f=a.blocks,e=f.composer},"{self} composerBlockDrag":function(b,c,d){g=d,e.panels.activate("blocks"),f.panel.openPanel("removal");var h=a.dropzone();h.data("inited")||(h.droppable({accept:EBD.block,tolerance:"pointer"}),h.data("inited",!0))},"{self} composerBlockDrop":function(){a.workarea().hasClass(c)||f.panel.openPanel("block")
},"{dropzone} drop":function(b,d,e){var g=e.draggable,h=a.workarea();h.addClass(c),g.addClass(c),b.addClass(c),setTimeout(function(){f.removeBlock(g),setTimeout(function(){f.panel.openPanel("block"),h.removeClass("is-removing"),setTimeout(function(){b.removeClass("is-removing active")},250)},250)},100)},"{dropzone} dropout":function(a){a.removeClass("active")},"{dropzone} dropover":function(a){a.addClass("active")}}}),b.resolve()})}),EasyBlog.module("composer/blocks/resizable",function(){var b=this;EasyBlog.require().library("ui/resizable").done(function(a){EasyBlog.Controller("Composer.Blocks.Resizable",{defaultOptions:a.extend({"{resizeHandle}":".ui-resizable-handle"},EBD.selectors)},function(b,c,d,e,f){return{init:function(){f=b.blocks,e=b.blocks.composer
},initResizable:function(c){if(!b.hasResizable(c)){var d=b.determineResizeHandles(c);if(d){{var e=b.createResizeHandleElements(d),g=b.createResizeHandleSelectors(d);f.getBlockViewport(c).append(e).resizable({handles:g})}a(e).hide(),c.addClass("is-resizable")}}},destroyResizable:function(a){a.hasClass("ui-resizable")&&f.getBlockViewport(a).resizable("destroy"),a.removeClass("is-resizable")},hasResizable:function(a){return f.getBlockViewport(a).hasClass("ui-resizable")},handles:{right:{w:"dimension",sw:"dimension",s:"dimension"},left:{e:"dimension",se:"dimension",s:"dimension"}},determineResizeHandles:function(a){var c=f.nestable.extractPosition(a);
return b.handles[c]},createResizeHandleElements:function(b){var c=[];return a.each(b,function(b,d){var e=a('<div class="ui-resizable-handle"><div></div></div>').addClass("ui-resizable-"+b).attr({"data-direction":b,"data-role":d});c.push(e[0])}),c},createResizeHandleSelectors:function(b){var c=[];return a.each(b,function(a){c[a]="> .ui-resizable-"+a}),c},getResizeHandles:function(a){return f.getBlockViewport(a).children(b.resizeHandle.selector)},"{self} composerBlockActivate":function(a,c,d){b.initResizable(d),b.getResizeHandles(d).show()
},"{self} composerBlockDeactivate":function(a,c,d){b.getResizeHandles(d).hide()},"{self} composerBlockNestIn":function(a,c,d){b.initResizable(d)},"{self} composerBlockNestOut":function(a,c,d){b.destroyResizable(d)},"{self} composerBlockNestChange":function(a,c,d){b.destroyResizable(d),b.initResizable(d)},"{blocks.viewport} resizestart":function(a,c,d){b.workarea().addClass("is-resizing");var e=b.block.of(a);parentBlocks=f.getAllParentBlocks(e),parentBlocks.addClass("has-resizing-child"),b.trigger("composerBlockResizeStart",[e,d])
},"{blocks.viewport} resize":function(a,c,d){a.css({top:"",left:"",width:"",height:""}),c.stopPropagation();var e=b.block.of(a);if(f.isNestedBlock(e)&&"content"===f.getBlockNestType(e)){var g=b.trigger("composerBlockBeforeResize",[e,d]);if(!g.isDefaultPrevented()){var h=d.originalSize,i=d.size;if(h.width!==i.width){var j=f.getBlockNest(e),k=i.width/j.width();0>k&&(k=0),k>1&&(k=1),k=Math.floor(100*k)+"%",e.css("width",k)}if(h.height!==i.height){e.css("height","");var l=e.height(),m=i.height;l>m&&(m=""),e.css("height",m)
}}b.trigger("composerBlockResize",[e])}},"{blocks.viewport} resizestop":function(a,c,d){b.workarea().removeClassAfter("is-resizing");var e=b.block.of(a);parentBlocks=f.getAllParentBlocks(e),parentBlocks.removeClass("has-resizing-child"),b.trigger("composerBlockResizeStop",[e,d])}}}),b.resolve()})}),EasyBlog.module("composer/blocks/scrollable",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Scrollable",{defaultOptions:a.extend({},EBD.selectors)},function(b,c,d,e,f){return{init:function(){f=b.blocks,e=f.composer
},"{block} dragstart":function(){b.scrollstart()},"{blocks.menu} dragstart":function(){b.scrollstart()},"{block} dragstop":function(){b.scrollstop()},"{blocks.menu} dragstop":function(){b.scrollstop()},"{self} composerBlockDrop":function(){b.scrollstop()},stop:!1,scrollTimer:null,scrollstart:function(){var i,c=e.viewport(),d=e.document.viewportContent()[0],f=c.height(),g=50,h=f-50,j=function(){b.stop=!1,(i.y>h||i.y<g)&&(b.stop=!0,i.y>h&&(d.scrollTop+=f/2),i.y<g&&(d.scrollTop-=f/2),clearTimeout(b.scrollTimer),b.scrollTimer=setTimeout(j,1e3),b.trigger("composerDocumentScroll"))
};a(document).on(a.ns("mousemove touchmove",".scrollable"),function(c){i=a.getPointerPosition(c),b.stop&&i.y>g&&i.y<h&&(b.stop=!1),b.stop||j()})},scrollstop:function(){clearTimeout(b.scrollTimer),a(document).off(a.ns("mousemove touchmove",".scrollable"))}}}),b.resolve()}),EasyBlog.module("composer/blocks/search",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Search",{defaultOptions:{"{searchInput}":"[data-eb-blocks-search]","{blockSectionContent}":"[data-eb-composer-block-section-content]"}},function(b,c,d,e,f){return{init:function(){f=b.blocks,e=f.composer
},search:function(c){var c=a.trim(c.toLowerCase()),d=f.menu(),e=d.filter("[data-keywords*='"+c+"']"),g=""==c,h=!g&&e.length<1;return g?d.show():d.hide(),g?(a("[data-eb-composer-block-section]").show(),a('[data-eb-composer-block-menu][data-type="post"]').hide(),void 0):(e.show(),e.each(function(c,d){a(d).parents(b.blockSectionContent.selector).removeClass("t-hidden")}),f.view().toggleClass("is-empty",h),f.menuGroup().each(function(){var b=a(this),c=b.parents(".eb-composer-fieldset").show();b.height()<1&&c.hide()
}),void 0)},"{searchInput} input":a.debounce(function(a){b.search(a.val())},150)}}),b.resolve()}),EasyBlog.module("composer/blocks/text",function(){var b=this;EasyBlog.require().script("composer/vendors/colorpicker","composer/vendors/nouislider","composer/layout/elements").done(function(a){EasyBlog.Controller("Composer.Blocks.Text",{elements:[".eb-composer-fieldset[data-name=text] [data-eb-{font-color-menu|font-family-menu|font-size-menu|font-color-content|font-color-picker|font-family-content|font-size-content|font-color-caption|font-family-caption|font-size-caption|font-family-option|font-format-option}]",".eb-composer-fieldset[data-name=text] [data-eb-{numslider-toggle|numslider-widget|numslider-value|numslider-input|numslider-units|numslider-unit|numslider-current-unit|numslider-unit-toggle}]",".eb-composer-fieldset[data-name=text] [data-eb-{colorpicker|colorpicker-toggle}]","[data-eb-{links|link-item-group|link|link-item|link-preview|link-preview-caption|link-url-field|link-title-field|link-blank-option|link-nofollow-option|link-follow-option|link-remove-button}]"],defaultOptions:a.extend({fontSizeUnits:{px:{start:12,step:2,range:{min:8,max:72},pips:{mode:"values",density:4,values:[8,12,18,24,48,72]}},"%":{start:100,step:10,range:{min:0,max:200},pips:{mode:"positions",values:[0,50,100],density:10}}},"{textFieldset}":".eb-composer-fieldset[data-name=text]","{linksFieldset}":".eb-composer-fieldset[data-name=links]","{fontSizeCheckbox}":"[data-eb-font-size-content] .eb-numslider-toggle input","{fontSizeToggle}":"[data-eb-font-size-content] .eb-numslider-toggle label","{linkBlankOptionField}":".eb-link-blank-option","{colorHexContainer}":"[data-eb-colorhex-container]","{colorHexInput}":"[data-eb-colorhex-field]"},EBD.selectors)},function(b,c,d,e,f,g,h,i,j,k){return{init:function(){f=b.blocks,e=f.composer,textSelected=!1,hasTextSelection=!1,hasHexIframe=!1,b.textFieldset().on("touchstart click mousedown mouseup",function(a){a.preventDefault()
}),b.linksFieldset().on("touchstart click mousedown mouseup",function(a){a.preventDefault()})},"{self} composerDocumentReady":function(){g=e.editor,b.initFontColor(),b.initLinks(),b.initHandlers()},initHandlers:function(){},"{self} composerBlockActivate":function(a,c,d){var e=f.getBlockMeta(d);return e.properties.fonts?void 0:(b.textFieldset().hide(),b.linksFieldset().hide(),void 0)},"{self} composerTextSelect":function(a,c,d,e){var h=f.getBlockMeta(e);return h.properties.fonts&&"buttons"!=h.type?(k||(f.panel.blockSubpanel().addClass("has-text-selection"),b.textFieldset().show(),h.data.tabs||b.linksFieldset().show(),b.textFieldset().find(".eb-font-formatting.section-list").toggle("text"==e.data("type")),b.populateFont(),hasTextSelection=!0,b.startEditingSelection(),h.data.tabs||b.populateLinks(),b.populateColorHexItem()),void 0):(b.textFieldset().hide(),b.linksFieldset().hide(),void 0)
},"{self} composerTextDeselect":function(){k||b.workarea().hasClass("is-sorting")||(f.panel.blockSubpanel().removeClass("has-text-selection"),b.textFieldset().hide(),b.linksFieldset().hide(),b.removeTextMarkers(),hasTextSelection=!1,b.linkItemGroup().empty(),b.detroyColorHexItem())},populateFont:function(){b.populateFontColor(),b.populateFontFamily(),b.populateFontSize(),b.populateFontFormatting()},initFontColor:function(){b.fontColorPicker().colorpicker()},"{self} colorpickerChange":function(a,c,d){if(hasTextSelection){var e=b.colorHexContainer().find("iframe[data-colorhex-iframe]");
if(e.length>0){var f=e.contents().find("[data-eb-colorhex-field]");f.val(d)}}},detroyColorHexItem:function(){b.colorHexInput().removeClass("t-hidden"),b.colorHexContainer().find("iframe[data-colorhex-iframe]").remove(),b.hasHexIframe=!1},populateColorHexItem:function(){if(hasTextSelection){var c=g.selection.getParent(),d=a(c).css("color"),e=d.match(/\d+/g);rgb={r:e[0]||0,g:e[1]||0,b:e[2]||0};var f=a.hsbToHex(a.rgbToHsb(rgb));if(f="#"+f,1!=b.hasHexIframe){b.hasHexIframe=!0;var j=a(b.colorHexInput()[0]).clone();
j.css({padding:"0px 12px",display:"block",fontSize:"13px",lineHeight:"16px",paddingBottom:"0px",color:"#555555",width:"100%",height:"31px",position:"absolute",zIndex:2,backgroundColor:"#ffffff",backgroundImage:"none",border:"1px solid #e1e1e1",borderRadius:"3px",textTransform:"uppercase"}),j.val(f),j.on("keyup",function(c){var d=c.keyCode||c.charCode,e=[13,38,40,39,37,27,32,17,18,16,8,46];if(!(a.inArray(d,e)>=0)){var f=a(this).val();b.colorHexInput().val(f),7==f.length&&b.setFontColor(f)}});try{var h=a("<iframe data-colorhex-iframe>");
h.css({margin:0,padding:"0px",height:"31px",width:"100px",border:"none",display:"block","float":"left"}),h.on("load",function(){a(this.contentWindow.document.body).css({margin:0,overflow:"hidden",width:"100px"}).append(j)}),b.colorHexInput().addClass("t-hidden"),b.colorHexContainer().prepend(h)}catch(k){console.error("There may a cross-iframe security issue. Unable to create text link item properly",k)}}else{var h=b.colorHexContainer().find("iframe[data-colorhex-iframe]");h.contents().find("[data-eb-colorhex-field]")
}}},populateFontColor:function(){if(b.lastUpdatedViaFontColorUI)return b.lastUpdatedViaFontColorUI=!1,void 0;var c=g.selection.getParent(),d=a(c).css("color");b.colorpickerToggle().prop("checked",c.style.color),b.updateFontColorUI(d,!0)},setFontColor:function(a){b.lastUpdatedViaFontColorUI=!0;var c=!0;g.inline.toggleStyle("color: "+a,c),b.updateFontColorUI(a)},updateFontColorUI:function(a,c){b.updatingFontColorUI=!0,!a&&(a="#000"),b.fontColorCaption().css("backgroundColor",a),c===!0&&b.fontColorPicker().colorpicker("setColor",a),b.updatingFontColorUI=!1
},removeFontColor:function(){g.inline.removeStyleRule("color")},populateFontFamily:function(){if(b.lastUpdatedViaFontFamilyUI)return b.lastUpdatedViaFontFamilyUI=!1,void 0;var a=g.selection.getParent(),c=a.style.fontFamily.replace(/\'\"/g,"");b.updateFontFamilyUI(c)},setFontFamily:function(a){b.lastUpdatedViaFontFamilyUI=!0,g.inline.format("span","style","font-family: "+a),b.updateFontFamilyUI(a)},updateFontFamilyUI:function(a){a||(a="");var c=b.fontFamilyOption().removeClass("active").where("value",'"'+a+'"').addClass("active"),d=c.length>0?c.html():a.split(",")[0];
b.fontFamilyCaption().html(d)},removeFontFamily:function(){b.lastUpdatedViaFontFamilyUI=!0,g.inline.removeStyleRule("font-family")},populateFontSize:function(){var c=g.selection.getParent(),d=a(c).css("fontSize"),e=!!c.style.fontSize;b.updateFontSizeUI(d),b.numsliderToggle().prop("checked",!!e)},setFontSize:function(c){if(a.isNumeric(c)){var d=b.getFontSizeUnit();c+=d}b.lastUpdatedViaFontSizeUI=!0,g.inline.format("span","style","font-size: "+c);var e=g.selection.getParent(),f=a(e).css("fontSize");b.updateFontSizeUI(c||f),b.numsliderToggle().prop("checked",!!c)
},updateFontSizeUI:function(a){b.updatingFontSizeUI=!0;var c=Math.abs(a.replace(/\%|px/gi,""));unit=a.match("%")?"%":"px",b.getFontSizeUnit()!==unit&&b.setFontSizeUnit(unit),b.fontSizeCaption().html(a),b.numsliderCurrentUnit().html(unit),b.numsliderUnit().removeClass("active").where("unit",'"'+unit+'"').addClass("active"),b.numsliderWidget().val(c),b.numsliderInput().val(c),b.updatingFontSizeUI=!1},removeFontSize:function(){g.inline.removeStyleRule("font-size")},getFontSizeUnit:function(){return b.fontSizeContent().data("unit")||"%"
},setFontSizeUnit:function(d){b.fontSizeContent().data("unit",d);var e=c.fontSizeUnits[d];b.numsliderWidget().find(".noUi-pips").remove().end().noUiSlider(a.extend({document:i},e),!0).noUiSlider_pips(e.pips)},formattingTags:{bold:"strong",italic:"em",underline:"u",strikethrough:"del",code:"code",superscript:"sup",subscript:"sub",orderedlist:"ol",unorderedlist:"ul"},populateFontFormatting:function(){b.lastUpdatedViaFontFormattingUI?b.lastUpdatedViaFontFormattingUI=!1:b.removeTextMarkers();var c=g.selection.getCurrent(),d=a(c).parentsUntil(EBD.block).filter("ul, ol").eq(0);
b.fontFormatOption().each(function(){var e=a(this),f=e.data("format"),g=b.formattingTags[f];hasFormatting=/unorderedlist|orderedlist/.test(f)?d.is(g):0!==a(c).closest(g).length,e.toggleClass("active",hasFormatting)})},toggleFontFormatting:function(a){switch(a){case"orderedlist":case"unorderedlist":g.list.toggle(a);break;case"indent":g.indent.increase();break;case"outdent":g.indent.decrease();break;case"clear":b.selectWithinTextMarkers(),g.inline.removeFormat(),b.removeTextMarkers();break;default:!b.hasTextMarkers()&&b.createTextMarkers(),g.inline.format(a),b.lastUpdatedViaFontFormattingUI=!0
}},hasTextMarkers:function(){return b.workarea().find(".composer-text-marker").length>0},createTextMarkers:function(){g.selection.removeMarkers(),g.selection.createMarkers();var c=a.makeArray(b.workarea().find(".redactor-selection-marker").each(function(){a(this).removeClass("redactor-selection-marker").addClass("composer-text-marker").attr("id",this.id.replace("selection-","text-"))}));return b.selectWithinTextMarkers(c),c},getTextMarkers:function(){var c=a.makeArray(b.workarea().find("span#text-marker-1, span#text-marker-2"));
return c[0]&&c[1]?c:void 0},selectWithinTextMarkers:function(a){a||(a=b.getTextMarkers()),a&&g.caret.set(a[0].nextSibling,0,a[1],0)},removeTextMarkers:function(){b.workarea().find(".composer-text-marker").remove()},startEditingSelection:function(){k=!0,b.removeTextMarkers(),b.workarea().off("mousedown.stopEditingSelection").one("mousedown.stopEditingSelection",function(){b.stopEditingSelection()})},stopEditingSelection:function(){k=!1},initLinks:function(){b.linkItem.template=b.linkItem(".is-blank").detach().removeClass("is-blank")[0]
},populateLinks:function(){var c=g.selection.getNodesInRange(),d=a(c).filter("a"),e=b.linkItemGroup().empty();a.each(d,function(a,c){var d=b.createLinkItem().appendTo(e);b.processLinkItem(d),b.updateLinkItem(d,c)}),b.linkItemGroup().toggleClass("has-existing-links",d.length>0);var f=b.createLinkItem().addClass("is-new").appendTo(e);b.processLinkItem(f);var h=g.selection.getText();b.linkPreviewCaption.inside(f).html(h)},createLinkItem:function(){var c=a(b.linkItem.template).clone();return c},processLinkItem:function(c){var d=b.linkUrlField.inside(c),e=b.linkTitleField.inside(c);
c.data("linkUrlField",d[0]),c.data("linkTitleField",e[0]),d.data("linkItem",c).on("input",b.linkUrlFieldInputHandler).on("mousedown",function(){if(a.IE){var b=c.data("anchorNode");b||g.selection.save()}}),e.data("linkItem",c).on("input",b.linkTitleFieldInputHandler).on("mousedown",function(){if(a.IE){var b=c.data("anchorNode");b||g.selection.save()}});var f=c.find(".eb-link-input");d.css({padding:"6px 12px",display:"block",fontSize:"13px",lineHeight:"24px",fontWeight:"bold",paddingBottom:"0px",color:"#555555",width:"100%",border:"none",outline:"none",position:"relative",zIndex:2}),a.IE&&d.css({height:"28px"}),e.css({border:"none",resize:"none",fontSize:"12px",padding:"12px",paddingTop:"32px",overflow:"hidden",outline:"none",position:"absolute",width:"100%",height:"100%",color:"#555555",fontFamily:"Arial, Helvetica, sans-serif",top:0,left:0,zIndex:1});
try{var h=a("<iframe>");h.on("load",function(){a(h[0].contentWindow.document.body).css({margin:0,overflow:"hidden"}).append(d).append(e)}),f.append(h)}catch(i){console.error("There may a cross-iframe security issue. Unable to create text link item properly",i)}},updateLinkItem:function(c,d){b.linkPreviewCaption.inside(c).html(a(d).text()),a(c.data("linkUrlField")).val(d.getAttribute("href")),a(c.data("linkTitleField")).val(d.title),b.linkBlankOption.inside(c).prop("checked","_blank"==d.target),b.linkNofollowOption.inside(c).prop("checked",d.rel.toLowerCase().indexOf("nofollow")>=0),b.linkFollowOption.inside(c).prop("checked",d.rel.toLowerCase().indexOf("follow")>=0),c.data("anchorNode",d)
},removeLinkItem:function(a){return b.removeAnchorNode(a),a.hasClass("is-new")?(b.resetLinkItem(a),void 0):(a.remove(),b.linkItem(":not(.is-new)").length<1&&b.linkItemGroup().removeClass("has-existing-links"),void 0)},resetLinkItem:function(a){b.linkUrlField.inside(a).val(""),b.linkTitleField.inside(a).val(""),b.linkBlankOption.inside(a).prop("checked",!1)},createAnchorNode:function(b){var c=g.selection.getHtml(),d=a.uid("link-"),e=a("<a />").attr("id",d).html(c)[0];return g.insert.node(e),e=a("#"+d).removeAttr("id")[0],g.selection.selectElement(e),b.data("anchorNode",e),e
},updateAnchorNode:function(c){var d=c.data("anchorNode");if(d){var e=a(c.data("linkUrlField")),f=a(c.data("linkTitleField")),g=b.linkBlankOption.inside(c),h=b.linkNofollowOption.inside(c),i=b.linkFollowOption.inside(c);if(d.href=a.trim(e.val()),d.title=f.val(),g.is(":checked")||h.is(":checked")||i.is(":checked")){var j="";g.is(":checked")&&(d.target="_blank",j+="noopener noreferrer"),h.is(":checked")&&(j+=" nofollow"),i.is(":checked")&&(j+=" follow"),j=a.trim(j),d.rel=j}else d.removeAttribute("target"),d.removeAttribute("rel")
}},removeAnchorNode:function(b){var c=b.data("anchorNode");c&&(g.selection.save(),$anchorNode=a(c),$anchorNode.contents().insertAfter($anchorNode),$anchorNode.remove(),g.selection.restore(),b.removeData("anchorNode"))},"{fontFormatOption} click":function(a){var c=a.data("format");"clear"!=c&&a.toggleClass("active"),b.toggleFontFormatting(c)},"{fontFamilyOption} click":function(a){var c=a.data("value");b.setFontFamily(c)},"{colorpicker} colorpickerChange":function(a,c,d){b.updatingFontColorUI||(b.colorpickerToggle().prop("checked",!0),b.setFontColor(d))
},"{colorpickerToggle} change":function(a){a.checked()||b.removeFontColor()},"{fontSizeToggle} click":function(){var c=b.fontSizeCheckbox();c.is(":checked")?(c.prop("checked",!1),b.removeFontSize()):c.prop("checked",!0)},"{numsliderWidget} nouislide":function(a,c,d){b.numsliderInput().val(Math.abs(d))},"{numsliderWidget} set":function(a,c,d){b.updatingFontSizeUI||b.setFontSize(Math.abs(d))},"{numsliderInput} input":function(c){if(!b.updatingFontSizeUI){var d=Math.abs(a.trim(c.val()));b.setFontSize(d)}},"{numsliderUnit} click":function(a){var c=a.data("unit");
b.setFontSizeUnit(c),b.numsliderUnits().removeClass("open")},"{numsliderUnitToggle} click":function(){b.numsliderUnits().toggleClass("open")},"{linkItem} mouseover":function(b){var d=b.data("anchorNode");d&&a(d).addClass("is-highlighting")},"{linkItem} mouseout":function(b){var d=b.data("anchorNode");d&&a(d).removeClass("is-highlighting")},linkUrlFieldInputHandler:function(){var d=a(this);b.startEditingSelection();var e=a(d.data("linkItem")),f=a.trim(d.val()),h=e.data("anchorNode");return""===f||h||(a.IE&&g.selection.restore(),h=b.createAnchorNode(e),d.focus().val(d.val())),""==f&&h?(b.removeAnchorNode(e),void 0):(b.updateAnchorNode(e),void 0)
},linkTitleFieldInputHandler:function(){var d=a(this);b.startEditingSelection();var e=a(d).data("linkItem");b.updateAnchorNode(e)},"{linkBlankOptionField} click":function(a){var d=a.find("input");d.is(":checked")?d.prop("checked",!1):d.prop("checked",!0),b.startEditingSelection();var e=b.linkItem.of(a);b.updateAnchorNode(e)},"{linkRemoveButton} click":function(a){b.startEditingSelection();var d=b.linkItem.of(a);b.removeLinkItem(d)}}}),b.resolve()})}),EasyBlog.module("composer/blocks/toolbar",function(a){var b=this,c="is-editing-block",d="is-moving-block",e="is-dropping-block",f="is-inserting-block",g="is-selected";
EasyBlog.Controller("Composer.Blocks.Toolbar",{elements:["[data-eb-blocks-{close-button|parent-button|cancel-move-button}]","[data-ebd-block-{toolbar|sort-handle}]"],defaultOptions:a.extend({"{cancelDropButton}":"[data-blocks-cancel-drop-button]","{cancelMoveButton}":"[data-blocks-cancel-move]","{closeBlocks}":"[data-toolbar-blocks-close]","{toolbarWrapper}":"[data-toolbar-blocks-wrapper]","{done}":"[data-blocks-done]","{insert}":"[data-blocks-insert]","{move}":"[data-blocks-move]","{duplicate}":"[data-blocks-duplicate]","{remove}":"[data-blocks-remove]"},EBD.selectors)},function(b,h,i,j,k){return{init:function(){k=b.blocks,j=b.blocks.composer
},dropping:!1,cancelDrop:function(){j.blocks.droppable.selectedMenu=null,j.blocks.droppable.selectedBlock=null,j.blocks.droppable.dropStop(),j.blocks.menu().removeClass(g),j.manager().removeClass(e)},deleteCurrentBlock:function(){var a=j.manager(),b=k.getCurrentBlock(),c=k.getNextBlock(),d=k.getPreviousBlock();k.removeBlock(b),c!==!1&&k.activateBlock(c),c===!1&&d&&k.activateBlock(d),c||d||a.removeClass("is-editing-block"),a.removeClass("is-inserting-block")},duplicateBlock:function(){var c=k.getCurrentBlock(),d=k.getBlockContent(c),e=k.getBlockType(c),f=k.getData(c),g=k.createBlock(e);
k.data(g,f),k.setBlockContent(g,d),c.after(g),k.drop(g),k.release(g),k.out(g);var h=k.getChildBlocks(g);h.length>0&&a.each(h,function(b,c){var d=k.getBlockType(c);if("image"==d){var e=a(c);e.removeClass("is-editable")}}),k.activateBlock(g),k.getCurrentBlock().click(),b.trigger("composerBlockDuplicate",[g,c])},insertBlock:function(){j.manager().toggleClass("is-inserting-block"),j.blocks.browser.toggle()},moveBlock:function(){var a=j.manager().hasClass(d);if(!a){j.blocks.droppable.populateDropzones(),j.manager().addClass(d);
var c=k.getCurrentBlock();c.addClass("is-sort-item"),b.workarea().addClass("is-sorting"),b.trigger("composerBlockMove",[c])}},"{closeBlocks} click":function(){b.cancelDrop(),j.manager().removeClass(f),j.blocks.browser.close()},"{self} composerBlockDrop":function(){b.dropping=!1},"{self} composerBlockMenuSelected":function(){b.dropping=!0},"{self} click":function(){},"{self} composerBlockActivate":function(a,d,e){if(!e.hasClass("is-standalone")){j.manager().addClass(c);var f=k.isNestedBlock(e);blockActions=k.getBlockActions(e),f&&(blockActions.find(b.duplicate().selector).remove(),blockActions.find(b.insert().selector).remove()),e.hasClass("is-isolated")&&blockActions.find(b.move().selector).remove()
}},"{self} composerBlockDeactivate":function(){j.manager().removeClass(c).removeClass(f)},"{cancelMoveButton} click":function(){j.manager().removeClass(d),j.blocks.droppable.dropStop();var c=k.getCurrentBlock();c.removeClass("hide").removeClass("is-sort-item"),b.workarea().removeClass("is-sorting")},"{parentButton} click":function(){var b=k.getCurrentBlock();if(b.length){var c=k.getParentBlock(b);c.length?k.activateBlock(c):k.deactivateBlock()}},"{cancelDropButton} click":function(){b.cancelDrop()},"{closeButton} click":function(){j.views.hide("blocks")
},"{duplicate} click":function(a,c){c.stopPropagation(),b.duplicateBlock()},"{move} click":function(c){a(c).mouseleave(),b.moveBlock()},"{remove} click":function(c){a(c).mouseleave(),b.deleteCurrentBlock()},"{insert} click":function(){b.insertBlock()}}}),b.resolve()}),EasyBlog.module("composer/blocks/tree",function(a){var b=this;EasyBlog.Controller("Composer.Blocks.Tree",{elements:["[data-eb-{block|block-icon|block-title|block-level-count|block-child-count}]","[data-eb-blocks-{tree-field|tree|tree-item|tree-item-template|tree-item-icon|tree-item-title|tree-item-group|tree-toggle-button}]"]},function(b,c,d,e,f,g){return{init:function(){f=b.blocks,e=f.composer,g=b.createTreeItem,b.treeItemTemplate=b.treeItemTemplate().detach().html()
},setCurrentBlock:function(a){var c=f.getBlockType(a),d=f.getBlockMeta(c);b.blockTitle().text(d.title),b.blockIcon().attr("class",d.icon);var e=f.getAllParentBlocks(a),g=f.getChildBlocks(a),h=g.length,i=e.length+1;b.blockChildCount().text(h),b.blockLevelCount().text(i),b.block().toggleClass("has-child",h)},populate:function(c){if(!c)var c=f.getCurrentBlock();if(c.length){var d=b.treeField(),e=f.getParentBlock(c),h=!!e.length,i=f.getChildBlocks(c),j=!!i.length;d.toggleClass("has-parent",h).toggleClass("has-children",j);
var k=[],l=b.getTreeDisplayMode();if("minimal"==l)if(h){k.push(g(e,1));var m=f.getChildBlocks(e);m.each(function(){var b=a(this);k.push(g(b,2)),b.is(c)&&i.each(function(){var b=a(this);k.push(g(b,3))})})}else k.push(g(c,1)),i.each(function(){var b=a(this);k.push(g(b,2))});else{var n=f.getRootBlocks(),o=function(b,c){var d=c;k.push(g(b,d));var e=f.getChildBlocks(b);e.each(function(){var b=a(this);o(b,d+1)})};n.each(function(){o(a(this),1)})}b.tree().toggle("full"==l||k.length>1),b.treeItemGroup().empty().append(k)
}},createTreeItem:function(a,c){var d=a.data("treeItem");return d||(d=b.renderTreeItem(a),a.data("treeItem",d)),d.toggleClass("active",a.hasClass("active")).toggleClass("is-nested",a.hasClass("is-nested")).switchClass("level-"+c),d},renderTreeItem:function(c){var d=f.getBlockUid(c),e=f.getBlockType(c),g=f.getBlockMeta(e),h=a(b.treeItemTemplate);return h.attr({"data-type":g.type,"data-uid":d}).find(b.treeItemIcon).addClass(g.icon).end().find(b.treeItemTitle).text(g.title),h},getTreeDisplayMode:function(){return b.treeField().hasClass("tree-minimal")?"minimal":"full"
},setTreeDisplayMode:function(a){b.treeField().switchClass("tree-"+a),b.populate()},"{self} composerBlockAdd":function(){b.populate()},"{self} composerBlockActivate":function(a,c,d){b.setCurrentBlock(d),b.populate(d)},"{self} composerBlockRemove":function(){b.populate()},"{treeItem} click":function(a){var b=a.data("uid"),c=f.getBlock(b);f.unhighlight(c),f.activateBlock(c)},"{treeItem} mouseenter":function(a){var b=a.data("uid"),c=f.getBlock(b);f.highlight(c),f.scrollTo(c)},"{treeItem} mouseleave":function(a){var b=a.data("uid"),c=f.getBlock(b);
f.unhighlight(c)},"{treeToggleButton} click":function(){var c=(b.treeField(),b.getTreeDisplayMode());b.setTreeDisplayMode("minimal"==c?"full":"minimal")}}}),b.resolve()}),EasyBlog.module("composer/category",function(a){var b=this;EasyBlog.Controller("Composer.Category",{defaultOptions:{"{itemGroupTemplate}":"[data-category-item-group-template]","{itemTemplate}":"[data-category-item-template]","{viewport}":"[data-eb-composer-category-viewport]","{loader}":"[data-eb-composer-category-loader]","{tree}":"[data-eb-composer-category-tree]","{itemGroup}":"[data-eb-composer-category-item-group]","{itemGroupHeader}":"[data-eb-composer-category-item-group-header]","{item}":"[data-eb-composer-category-item]","{itemCount}":"[data-eb-composer-category-item-count]","{itemCheckbox}":"[data-eb-composer-category-item-checkbox]","{count}":"[data-eb-composer-category-count]","{searchTextfield}":"[data-eb-composer-category-search-textfield]","{jsondata}":"[data-eb-composer-category-jsondata]"}},function(b,c,d,e){return{init:function(){e=b.composer,b.multipleCategories=b.viewport().data("multiple-categories"),b.initializeTemplates(),b.viewport().on("mousewheel",function(a){a.stopPropagation()
});var a=0,c=JSON.parse(b.jsondata().val());for(b.build(c);category=c[a++];)category.selected&&b.selectCategory(category.id);b.go(0),b.jsondata().remove(),window.catz=b},initializeTemplates:function(){c.templates={},c.templates.itemGroup=b.itemGroupTemplate().detach().html(),c.templates.item=b.itemTemplate().detach().html()},categories:{0:{id:0,title:"",parent_id:null},search:{id:"search",title:"",parent_id:null}},children:{search:[]},childLoaded:{},keys:{},clones:{},selected:{},build:function(a){for(var d,c=0;d=a[c++];){var e=parseInt(d.id),f=parseInt(d.parent_id);
if(void 0==b.categories[e]){b.categories[e]=d,(b.children[f]||(b.children[f]=[])).push(d),d.childs>0&&(b.childLoaded[e]=!1);var g=d.key=d.title.toLowerCase()+" [#"+e+"]";b.keys[g]=d}}},childrens:a.memoize(function(c,d){var e=b.children[c];if(!e)return[];var h,f=d?[].concat(b.childrens(c)):a.flatten(e,"id"),g=f.length;if(d)for(h=0;g>h;h++)f=f.concat(b.childrens(f[h],d));return f},function(a,b){return a+(b?"_deep":"")}),parents:a.memoize(function(a){var c=b.categories[a];if(c){if(0==a)return[0];for(var d=[];c=b.categories[c.parent_id];)d.unshift(c.id);
return d}}),itemGroup:{get:a.memoize(function(c){var d=b.children[c];if(d){for(var g,e=b.categories[c],f=b.getItemGroupTemplate(e),h=[],i=0;g=d[i++];)h.push(b.item.get(g.id));return a(f).locate("viewport").append(h),f}})},item:{get:a.memoize(function(a){var c=b.categories[a];if(c){var d=b.children[a],e=b.getItemTemplate(c,d||null);return e}})},getItemGroupTemplate:function(b){var d=a(c.templates.itemGroup);return d.attr("data-id",b.id),d.find("[data-title]").html(b.title),d[0]},getItemTemplate:function(b,d){var e=a(c.templates.item);
return e.attr("data-id",b.id),e.find("[data-title]").html(b.title),(d||b.childs>0)&&e.addClass("has-children"),e[0]},itemCount:{get:a.memoize(function(c){return a(b.item.get(c)).find(b.itemCount.selector)[0]}),set:function(c,d){a(b.itemCount.get(c)).find("span").html(d)}},populate:function(c){var d=b.children[c];if(d){a(b.itemGroup.get(c)).locate("header").removeClass("active");for(var f,e=0,g=b.selected,h=a.values(g);f=d[e++];){var i=f.id,j=[],k=[];if(b.childLoaded[i]){var l=[],m=[];allChildIds=b.childrens(i,!0),a.each(allChildIds,function(a,b){l.push(b.id)
}),j=a.intersection(h,l),immediateChildIds=b.childrens(i,!1),a.each(immediateChildIds,function(a,b){m.push(b.id)}),k=a.intersection(j,m);var n=b.categories[f.parent_id||f.id];n.hadChildSelectedCount=j.length>0?1:f.hadChildSelectedCount}var o=j.length>0||f.hadChildSelectedCount>0,p=a("[data-category-primary-input]").val();if(a(b.item.get(i)).toggleClass("selected",a.has(g,i)).toggleClass("is-primary",i==p).toggleClass("has-selected-children",o).removeClass("active"),f.childs>0){var q=k.length?k.length:f.hadChildSelectedCount,r=q+"/"+f.childs;
b.itemCount.set(i,r)}}}},query:a.memoize(function(c){var d=b.keys,e={},f=new RegExp("^"+a.regExpEscape(c),"i");for(key in d)if(key.match(f)){var g=d[key],h=g.parent_id;(e[h]||(e[h]=[])).push(g)}return e}),search:function(c){if(!(c.length<3)){var d=b.composer.getPostId();b.loader().removeClass("hide"),EasyBlog.ajax("site/views/categories/search",{keyword:c,postId:d}).done(function(a){if(a){var c=0,d=a;for(b.build(d);category=d[c++];)category.selected&&b.selectCategory(category.id),0!=category.parent_id&&(b.childLoaded[category.parent_id]=!0)
}}).always(function(){b.loader().addClass("hide");var d=b.query(c),e=b.clones,f=[],g=[];for(parentId in d){for(var k,h=b.categories[parentId],i=b.getItemGroupTemplate(h),j=d[parentId],g=[],l=0;k=j[l++];){var m=k.id,n=e[m]||(e[m]=a(b.item.get(m)).clone()[0]);g.push(n)}a(i).locate("viewport").append(g),f[0==parentId?"unshift":"push"](i)}b.itemGroup().detach(),a(b.itemGroup.get("search")).empty().append(f).appendTo(b.tree().switchClass("level-0").data("level",0))})}},currentTree:[],go:function(c){var d=b.categories[c];
if(d){var e=b.tree(),f=b.parents(c),g=f.length-1,h=a.map(f,function(a){return b.itemGroup.get(a)}),i=e.data("level")||0;i>g&&h.push(b.itemGroup().eq(i)),b.itemGroup().detach(),b.populate(a.last(f)),e.append(h).switchClass("level-"+g).data("level",g),b.searchTextfield().val("")}},open:function(c){var d=b.children[c];d&&(a(b.item.get(c)).addClass("active"),b.go(d[0].id))},selectCategory:function(a){b.toggle(a,!0)},deselect:function(a,c){b.toggle(a,!1,c)},toggle:function(c,d,e){var f=a.extend({},b.selected),g=a(b.item.get(c)),h=a(b.clones[c]),i=b.selected;
void 0===d&&(d=!g.hasClass("selected")),d?i[c]=parseInt(c):delete i[c];var j=(d?"add":"remove")+"Class";if(g[j]("selected"),h[j]("selected"),0==a.keys(b.selected).length&&!e){var j=(d?"remove":"add")+"Class";return g[j]("selected"),h[j]("selected"),EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/errorDefaultCategoryWarning",{})}),d?delete i[c]:i[c]=parseInt(c),void 0}b.trigger("category"+(d?"select":"deselect"),[b.categories[c]]),e||b.multipleCategories||a.each(f,function(a,c){b.deselect(c,!0)}),b.count().html(a.keys(b.selected).length)
},"{self} categorydeselect":function(a,c,d){if(d.parent_id){var e=b.categories[d.parent_id];e.hadChildSelectedCount>0&&e.hadChildSelectedCount--}},enableKeyboardNavigation:function(){a(document).off("keydown.composer.category").on("keydown.composer.category",function(a){var c=a.keyCode,d={38:"up",40:"down",37:"left",39:"right"};switch(c){case 38:case 40:case 37:case 39:b.navigate(d[c]);break;case 32:}})},disableKeyboardNavigation:function(){a(document).off("keydown.composer.category")},navigate:function(a){var c=b.currentClickedItem;
switch(a){case"up":c.prev().click();break;case"down":c.next().click();break;case"left":b.go(c.data("id"));break;case"right":}},toArray:function(){if(!b.selected)return[];var a=[];for(id in b.selected){var c=b.categories[id];a.push(c)}return a},lastClickedItem:a(),currentClickedItem:a(),"{item} click":function(a){b.lastClickedItem=b.currentClickedItem,b.currentClickedItem=a},"{self} composerSave":function(c,d,e){e.data.categories=a.values(b.selected)},"{self} categorysetprimary":function(c,d,e){b.item().removeClass("is-primary"),a(b.item.get(e.id)).addClass("is-primary")
},"{itemGroup} click":function(a,c){var d=a.find(b.item.selector),e=b.lastClickedItem,f=b.currentClickedItem;if(c.metaKey||c.ctrlKey||d.removeClass("active"),f.toggleClass("active"),c.shiftKey&&e.length>0){var g=d.index(e),h=d.index(f);d.slice.apply(d,h>g?[g,h]:[h,g]).addClass("active")}d.filter(".active").length>0?b.enableKeyboardNavigation():b.disableKeyboardNavigation()},"{item} dblclick":function(a){var c=a.data("id");b.open(c)},"{itemCount} click":function(a){var c=b.item.of(a).data("id"),d=void 0==b.childLoaded[c]?!0:b.childLoaded[c];
if(d)b.open(c);else{var e=b.composer.getPostId();b.loader().removeClass("hide"),EasyBlog.ajax("site/views/categories/getChildCategories",{id:c,postId:e}).done(function(a){if(a){var d=0,e=a;for(b.build(e);category=e[d++];)category.selected;b.open(c)}b.childLoaded[c]=!0}).always(function(){b.loader().addClass("hide")})}},"{itemCheckbox} click":function(a,c){var d=b.item.of(a).data("id");b.toggle(d),c.stopPropagation()},"{itemGroupHeader} click":function(a){var c=b.itemGroup.of(a).data("id");a.addClass("active"),b.go(c)
},"{searchTextfield} keyup":a.debounce(function(c){var d=a.trim(c.val());""==d?b.go(0):b.search(d)},250),"{self} composerValidate":function(){}}}),b.resolve()}),EasyBlog.module("composer/composer",function(){var b=this,c=window.EBD={};c.root=".ebd",c.block=".ebd-block:not(is-helper):not(.is-placeholder):not(.is-dropzone)",c.childBlock="> "+c.block,c.nest=".ebd-nest",c.nestedBlock=c.block+".is-nested",c.immediateNestedBlock=c.nestedBlock+":not("+c.nest+" "+c.nest+" "+c.nestedBlock+")",c.standaloneBlock=c.block+".is-standalone",c.isolatedBlock=c.block+".is-isolated",c.workarea="[data-ebd-workarea]",c.dropzone="[data-ebd-dropzone]",c.blockToolbar="[data-ebd-block-toolbar]",c.blockSortHandle="[data-ebd-block-sort-handle]",c.blockViewport="[data-ebd-block-viewport]",c.blockContent="[data-ebd-block-content]",c.blockActions="[data-ebd-block-actions]",c.immediateBlockSortHandle="> "+c.blockToolbar+" > "+c.blockSortHandle,c.immediateBlockViewport="> "+c.blockViewport,c.immediateBlockContent=c.immediateBlockViewport+"> "+c.blockContent,c.editableContent=c.block+".is-editable [contenteditable=true]",c.selectors={"{workarea}":c.workarea,"{root}":c.workarea+" "+c.root,"{nest}":c.workarea+" "+c.root+" "+c.nest,"{block}":c.workarea+" "+c.root+" "+c.block,"{dropzone}":c.workarea+" "+c.root+" "+c.dropzone};
var e=3,f=4,g=1,i=0;EasyBlog.require().script("composer/vendors/history","composer/vendors/scrolly","composer/document","composer/blocks","composer/category","composer/tags","composer/revisions","composer/shortcuts","composer/mobile","composer/media","composer/posts","composer/templates","composer/panels","composer/panels/post","composer/panels/authorship","composer/panels/category","composer/panels/seo","composer/panels/autopost","shared/gallery","shared/toggler").library("dialog").done(function(a){EasyBlog.Controller("Composer",{hostname:"composer",pluginExtendsInstance:!0,elements:["[data-eb-composer-{manager|actions|form|ghosts|alerts}]","[data-eb-composer-{views|view|viewport|viewport-content}]","[data-eb-{alert-template}]"],defaultOptions:{templates:{},postUid:null,authorId:null,"{frame}":"[data-composer-frame]","{manager}":"[data-composer-manager]","{alert}":"[data-composer-alert]","{alertMessage}":"[data-composer-alert-message]","{alertPlaceholder}":"[data-eb-alert-placeholder]","{retryButton}":"[data-eb-composer-instance-entry-button]","{toolbarViews}":"[data-toolbar-view]","{form}":"[data-composer-form]","{viewport}":"[data-eb-composer-viewport]","{viewportContent}":"[data-eb-composer-viewport-content]","{exit}":"[data-composer-exit]","{publish}":"[data-composer-publish]","{preview}":"[data-composer-preview]","{permalinkPreview}":"[data-permalink-preview]","{saveTemplate}":"[data-composer-save-template]","{deleteTemplate}":"[data-composer-delete-template]","{saveDraft}":"[data-composer-save-draft]","{approvePost}":"[data-composer-approve]","{trashPost}":"[data-composer-trash]","{rejectPost}":"[data-composer-reject]","{submitApproval}":"[data-composer-submit-approval]","{updatePost}":"[data-composer-update]","{autosaveWrapper}":"[data-composer-autosave]","{autosaveMessage}":"[data-composer-autosave-message]","{publishedField}":"[data-composer-field-published]","{previewField}":"[data-composer-field-preview]","{undoPublishing}":"[data-undo-publish]","{publishNow}":"[data-publish-now]","{draftWarning}":"[data-draft-warning]","{draftDiscard}":"[data-draft-discard]","{draftContinue}":"[data-draft-continue]","{draftItems}":"[data-eb-composer-revisions-item].is-draft","{jceFullWindowBtn}":"[data-eb-composer-page-body].eb-editor--jce #content_fullscreen"}},function(b,c,d,h,j){return{saveOptions:{autosave:!1,showSaveMessage:!0,updateRevisionStatus:!0,updateAddressBar:!0},init:function(){EasyBlog.debug||a(window).on("beforeunload",function(a){return a.preventDefault(),!1
}),c.templates.alert=b.alertTemplate().detach().html(),h=b.frame(),j=b.manager(),c.authorId=h.data("author-id"),c.permalink=h.data("permalink"),c.exitAlert=h.data("exit-alert"),c.mapIntegration=h.data("map-integration"),c.shortcuts=h.data("shortcuts"),d.noscroll(),EasyBlog.Composer=b,a.extend(c,h.htmlData("composer")),c.mobile=1==c.mobile,b.installPlugins(["media","templates","blocks","posts","panels","document","tags","category","revisions"]),c.shortcuts&&b.installPlugins(["shortcuts"]),c.mobile&&b.installPlugins(["mobile"]),b.keepalive.start(),j.hasClass("show-templates")||b.autosave.start(),a("input, textarea").each(function(){a(this).on("focus",function(){j.addClass("input-focused")
}),a(this).on("blur",function(){j.removeClass("input-focused")})}),b.trigger("composerReady")},isPublished:function(){return b.publishedField().val()==g},isDraft:function(){return b.publishedField().val()==e},publishPost:function(){b.previewField().val(0),b.publishedField().val(g),b.disableLeavePrompt(),b.save({autosave:0,isapply:0})},"{self} composerDocumentReady":function(){h.removeClass("is-loading")},"{self} composerSubmitLock":function(){h.addClass("is-submit-lock")},"{self} composerSubmitUnlock":function(){setTimeout(function(){h.removeClass("is-submit-lock")
},2e3)},installPlugins:function(c){a.each(c,function(a,c){b.addPlugin(c)})},settings:{get:function(a){return d.find("input[name='"+a+"']").val()},set:function(a,c){return d.find("input[name='"+a+"']").val(c),b.trigger("composerSettingsChange",[a,c]),c}},getPreviewNamespace:function(){return"post-preview-"+c.authorId+"-"+b.getPostUid()},getPostId:function(){return h.attr("data-post-id")},getPostUid:function(){return h.attr("data-post-uid")},getRevisionId:function(){return b.getPostUid().split(".")[1]},getDoctype:function(){return h.attr("data-post-doctype")
},views:{show:function(a){b.trigger("composerViewShow",[a])},hide:function(a){b.trigger("composerViewHide",[a]);var c=b.toolbarViews("[data-type="+a+"]");c.length&&c.removeClass("open"),b.views.show("document")}},keepalive:{timer:null,start:function(a){var d=b.keepalive,a=a||c.keepalive.interval;d.stop(),1>a||(d.timer=setTimeout(function(){d.run(a)},a))},run:function(a){EasyBlog.ajax("site/views/composer/keepAlive").always(function(){b.keepalive.start(a)})},stop:function(){clearTimeout(b.keepalive.timer)}},autosave:{timer:null,counter:0,start:function(a){var a=a||c.autosave.interval;
b.autosave.stop(),1>a||!a||(b.autosave.timer=setTimeout(function(){b.autosave.run(a)},a))},run:function(a){b.autosave.save(),b.autosave.start(a)},stop:function(){clearTimeout(b.autosave.timer)},save:function(){if(!(b.saving||a("div.ebd-block[data-ebd-dropzone]").length>0)){var c=blocks.getCurrentBlock(),d=b.publishedField().val();0==b.autosave.counter&&d!=f&&b.publishedField().val(e),b.autosave.counter++,h.addClass("is-autosaving"),b.saving=!0;var g=a.Task();b.trigger("composerSave",[g,b]),c.length>0&&blocks.activateBlock(c),g.process().done(function(){a("[data-composer-field-document]").val(g.data.document);
var c=b.form().serializeObject();"legacy"==b.getDoctype()&&(c.content=g.data.content),EasyBlog.ajax("site/controllers/posts/autosave",c).done(function(c,d,e){void 0!=d&&(b.autosaveWrapper().removeClass("t-hidden"),b.autosaveMessage().html(c),History.pushState({state:1},"",e),a("[data-eb-composer-post-uid]").val(d.uid),a("[data-eb-composer-revision-id]").val(d.revision_id))})}).always(function(){b.saving=!1})}}},saving:!1,getSaveData:function(c){b.form().each(function(){var b=a(this).serializeObject();a.extend(c,b)
})},save:function(c){if(!h.hasClass("is-submit-lock")&&!b.saving){b.saving=!0,c=a.extend(b.saveOptions,c),c.target?b.form().attr("target",b.getPreviewNamespace()):b.form().attr("target","_self"),c.preview?b.previewField().val(1):b.previewField().val(0);var d=a.Task();d.data.autosave=c.autosave?c.autosave:0,b.trigger("composerSave",[d,b]),d.process().done(function(){a("[data-composer-field-document]").val(d.data.document),b.form().submit()}).fail(function(){b.trigger("composerSaveError")}).always(function(){b.saving=!1,c.target&&(c.target=void 0),c.preview&&(c.preview=!1)
})}},trash:function(){b.disableLeavePrompt(),EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/confirmTrash",{uid:b.getPostId()}),bindings:{"{deleteButton} click":function(){EasyBlog.ajax("site/views/composer/delete",{uid:b.getPostUid()}).done(function(){})}}})},setMessage:function(d){a.isArray(d)||(d=[d]);var e=d[0],f="success";/error|danger/.test(e.type)&&(f="danger"),b.alert().length<=0&&a(c.templates.alert).appendTo(b.alertPlaceholder()),b.alert().removeClass("t-hidden"),b.alert().removeClass("o-alert--success o-alert--danger").addClass("o-alert--"+f),b.alert().find(b.alertMessage).html(e.message)
},"{preview} click":function(){var a=b.publishedField().val();a!=f&&b.publishedField().val(e),b.save({preview:!0,target:b.getPreviewNamespace()})},"{saveTemplate} click":function(){if(!b.saving){b.disableLeavePrompt(),b.saving=!0;var e=a.Task();b.trigger("composerSave",[e,b]),e.process().done(function(){a("[data-composer-field-document]").val(e.data.document),b.form().submit()}).fail(function(){b.trigger("composerSaveError")}).always(function(){b.saving=!1})}},"{deleteTemplate} click":function(){EasyBlog.dialog({content:EasyBlog.ajax("site/views/templates/confirmDeleteTemplates",{ids:b.getPostId()})})
},"{exit} click":function(a){c.exitAlert||b.disableLeavePrompt(),window.location=a.data("url")},"{saveDraft} click":function(a){if(!h.hasClass("is-submit-lock")){b.disableLeavePrompt(),a.addClass("is-loading");var d=b.publishedField().val();d!=f&&b.publishedField().val(e),b.save({preview:!1,target:!1,autosave:!1,isapply:!1})}},"{savePostButton} click":function(a){var c=b.publishedField().val();c!=f&&b.publishedField().val(e),a.addClass("is-saving is-loading"),b.save({autosave:1,isapply:0}).done(function(){}).always(function(){a.removeClass("is-saving is-loading")
})},"{submitApproval} click":function(a){b.disableLeavePrompt(),a.addClass("is-loading"),b.publishedField().val(f),b.save({autosave:0,isapply:0})},"{approvePost} click":function(a){b.publishedField().val(g),a.addClass("is-saving is-loading"),b.disableLeavePrompt(),b.save({autosave:0,isapply:0}).done(function(){}).always(function(){a.removeClass("is-saving")})},"{rejectPost} click":function(){b.publishedField().val(e),b.disableLeavePrompt(),b.save({autosave:0,isapply:0}).done(function(){})},"{undoPublishing} click":function(){clearTimeout(b.countingDown),a("[data-counting-down]").children("span").html(10),a("[data-show-undo]").removeClass("is-undo-on")
},"{publishNow} click":function(){b.publish().addClass("is-loading"),b.publishPost()},countingDown:null,countdown:function(c){var d=9;b.countingDown=setInterval(function(){a("[data-counting-down]").children("span").html(d),d--,1>d&&(clearTimeout(b.countingDown),setTimeout(function(){c.addClass("is-loading"),b.publishPost()},1e3))},1e3)},countdownValidate:function(c){var d=blocks.getCurrentBlock(),e=a.Task();b.trigger("composerSave",[e,b]),d.length>0&&blocks.activateBlock(d),e.process().done(function(){a("[data-composer-field-document]").val(e.data.document);
var d=b.form().serializeObject();"legacy"==b.getDoctype()&&(d.content=e.data.content),EasyBlog.ajax("site/controllers/posts/validateContent",d).done(function(){a("[data-show-undo]").addClass("is-undo-on"),b.countdown(c)}).fail(function(a){b.setMessage(a)})})},"{publish} click":function(a){h.hasClass("is-submit-lock")||(undoEnabled=a.data("undo-enabled"),undoEnabled?b.countdownValidate(a):(a.addClass("is-loading"),b.publishPost()))},"{updatePost} click":function(a){h.hasClass("is-submit-lock")||(b.publishedField().val()==e&&(b.previewField().val(0),b.publishedField().val(g)),b.disableLeavePrompt(),a.addClass("is-loading"),b.save())
},"{unpublishPostButton} click":function(){b.publishedField().val(i),b.save({autosave:0,isapply:0})},"{trashPost} click":function(){b.trash()},"{draftContinue} click":function(){b.disableLeavePrompt()},"{draftDiscard} click":function(){EasyBlog.ajax("site/views/composer/discardDraft",{id:b.getPostId()}).done(function(a){b.setMessage({type:"success",message:a}),j.removeClass("warning-draft"),b.draftItems().remove()}).fail(function(a){b.setMessage(a)})},"{self} composerSelectTemplate":function(){j.removeClass("show-templates"),setTimeout(function(){b.autosave.start()
},6e3)},"{permalinkPreview} click":function(){if(b.isDraft())return b.preview().click(),void 0;if(b.isPublished()){window.open(c.permalink,b.getPreviewNamespace())}else console.log(b.isDraft())},"{jceFullWindowBtn} click":function(){a("[data-eb-composer-page-body].eb-editor--jce").toggleClass("eb-editor--fullscreen")},disableLeavePrompt:function(){a(window).off("beforeunload"),a(window).unbind("beforeunload"),window.onbeforeunload=function(){}}}}),a("body").addController("EasyBlog.Controller.Composer"),b.resolve()
})}),EasyBlog.module("composer/document",function(){var b=this;EasyBlog.require().script("composer/document/toolbar","composer/document/permalink","composer/document/maps","composer/document/osm","composer/document/cover","composer/vendors/expanding").done(function(a){EasyBlog.Controller("Composer.Document",{hostname:"document",pluginExtendsInstance:!0,elements:["[data-eb-composer-document] .eb-composer-{viewport|viewport-content}","[data-eb-composer-{page|page-viewport|page-header|page-body}]","[data-ebd-{workarea|textarea}]","[data-ebd-workarea-{ghosts}]","[data-ebd-workarea-{legacy}]"],defaultOptions:{"{root}":"[data-ebd-workarea] "+EBD.root,"{block}":EBD.block,"{nest}":EBD.nest,"{titleField}":"[data-post-title]",plugins:["toolbar","permalink","cover"],mapIntegration:"maps"}},function(b,c,d,e,f,g){return{init:function(){g=b.composer,c.mapIntegration="osm"==b.composer.options.mapIntegration?"osm":"maps",b.initPlugins(),b.initTitlebar(),b.isLegacy()?b.initLegacyDocument():b.initEasyBlogDocument()
},initPlugins:function(){a.each(c.plugins,function(a,c){b.addPlugin(c)}),b.addPlugin(c.mapIntegration)},initTitlebar:function(){var a=b.titleField().one("focus",function(){a.expandingTextarea()})},initLegacyDocument:function(){if(window.tinyMCE){var c=function(){if(tinyMCE.activeEditor&&tinyMCE.activeEditor.editorContainer){var d=tinyMCE.activeEditor.editorContainer;a.isString(d)||(d.style.width="100%",a(tinyMCE.activeEditor.contentDocument).find("html").css({height:"100%"}).end().find("body").css({height:"100%",margin:"1em"})),b.setLayout()
}else setTimeout(c,500)};c()}b.trigger("composerDocumentReady")},initEasyBlogDocument:function(){EasyBlog.require().script("composer/vendors/redactor10","composer/document/overlay","composer/vendors/selectionchange").done(function(){e=b.composer.editor=b.workarea().composer({replaceDivs:!1,toolbar:!1}).data("redactor"),f=b.composer.blocks,b.initDocument(),b.setLayout(),b.addPlugin("overlay"),b.initSelectionChange(),b.trigger("composerDocumentReady")})},isLegacy:function(){return"legacy"==g.getDoctype()},initDocument:function(){b.trigger("composerDocumentInit"),b.workarea().removeClass("is-loading")
},loadDocument:function(a){b.trigger("composerDocumentLoad"),b.root().html(a),b.initDocument()},"{window} resize":a.throttle(function(){b.setLayout()},250),setLayout:function(){b.updateEditorHeight(),b.trigger("composerDocumentRefresh")},updateEditorHeight:function(){b.page().css("height","auto");var c=b.viewport().height(),d=b.pageViewport().height(),e=b.pageHeader().height(),f=d-e,h=48,i=60,j=50;g.options.mobile&&(h=0,i=0);var k=c-j-i-h-e;if(window.tinyMCE){if(!tinyMCE.activeEditor)return;var l=tinyMCE.activeEditor.editorContainer;
if(a.isString(l)){var m=b.pageBody(),l=a("#"+l);l.find("#content_tbl").css("height","auto");var n=a(tinyMCE.activeEditor.contentAreaContainer).find("iframe"),o=m.height()-n.height(),p=f-o;n.css("height",p);var q=a(tinyMCE.activeEditor.getElement()),r=f-m.find(".toggle-editor").height();q.css("height",r)}else{var l=a(l).parent(),n=a(l).find("iframe"),o=l.height()-n.height(),p=f-o;n.css("height",p)}}else b.root().css({minHeight:k})},setTitle:function(a){b.titleField().val(a)},insertContent:function(c){if(b.isLegacy())EasyBlog.LegacyEditor.insert(c);
else{var d=a(c);d.is(EBD.block)&&f.addBlock(d)}},setContent:function(a){return b.isLegacy()?EasyBlog.LegacyEditor.setContent(a):void 0},getContent:function(){if(b.isLegacy())return EasyBlog.LegacyEditor.getContent();var c="";return f.getRootBlocks().each(function(){var b=a(this);c+=f.getBlockHTML(b)}),c},getText:function(){if(b.isLegacy())return a(b.getContent()).text();var c=[];return f.getRootBlocks().each(function(){var b=a(this),d=f.getBlockType(b);blockHandler=f.getBlockHandler(d),blockHandler.toText&&c.push(a.trim(blockHandler.toText(b)))
}),c.join("\n")},initSelectionChange:function(){a.selectionchange.start();var c,d=a.debounce(function(){if(e){var d=e.selection.get(),f=d.toString(),g=!1;if(""!=f){var h=d.focusNode,i=b.block.of(h);if(i.closest(".is-standalone").length)return;if(i.hasClass("active"))for(;h!=i[0];){var j=a(h);if(j.editable()){g=!0;break}h=h.parentNode}}g?(b.trigger("composerTextSelect",[d,i,e]),c=!1):!c&&b.trigger("composerTextDeselect",[e])}},100);a(document).on("selectionchange",d)},saveLegacyDocument:function(b){var c=b.data,d=EasyBlog.LegacyEditor.getContent();
d=a.sanitizeHTML(d),a.IE<9&&(d=a.toXHTML(d)),c.intro="",c.content=d},saveEasyBlogDocument:function(b){var c=f.getRootBlocks(),d=[],e=[],h=b.add("Saving document"),i={title:b.data.title,permalink:b.data.permalink,type:g.getDoctype(),version:"1.0"};a.when.apply(null,e).always(function(){c.each(function(){var b=a(this),c=f.exportBlock(b),e=c.style;void 0!=e&&""!=e&&(e=e.replace(/font-family: \"Comic Sans MS\";/,"font-family: Comic Sans MS;"),e=e.replace(/font-family: \"Trebuchet MS\";/,"font-family: Trebuchet MS;"),c.style=e),d.push(c)
}),i.blocks=d,b.data.document=JSON.stringify(i)}).done(function(){h.resolve()}).fail(function(){h.reject(a.Exception("Error saving document."))})},"{self} composerSave":function(a,c,d){if("legacy"==g.getDoctype())return b.saveLegacyDocument(d),void 0;var e=f.getCurrentBlock();e.length>0&&f.deactivateBlock(e),b.saveEasyBlogDocument(d)},"{titleField} keydown":function(a,b){return 13==b.keyCode?(b.preventDefault(),!1):void 0},"{titleField} keyup":function(a){b.trigger("composerTitleEditing",[a,a.val()])},"{titleField} change":function(a){b.trigger("composerTitleChanged",[a,a.val()])
},"{viewport} click":function(c,d){if(!b.isLegacy()){var e=b.workarea();if(!e.hasClass("is-resizing")){var f=a(d.target).parentsUntil(c).addBack().filter(EBD.block);f.length||b.trigger("composerDocumentBlur")}}},"{self} composerValidate":function(){},"{self} keyup":function(c,d){if(66==d.keyCode){if(b.isLegacy())return;if(EasyBlog.MediaManager.isOpen())return;var e=a(":input").is(":focus"),f=g.manager().hasClass("is-editing-block"),h=b.titleField().is(":focus");if(f||e||h)return;g.blocks.browser.toggle()}}}}),b.resolve()
})}),EasyBlog.module("composer/document/cover",function(){var b=this;EasyBlog.require().library("image","plupload2").done(function(){EasyBlog.Controller("Composer.Document.Cover",{elements:["[data-eb-composer-blogimage-{browse-button}]",".eb-composer-{field}-blogimage"],defaultOptions:{"{container}":"[data-cover-container]","{placeholder}":"[data-cover-placeholder]","{workarea}":"[data-cover-workarea]","{preview}":"[data-cover-preview]","{previewImage}":"[data-cover-preview-image]","{previewVideo}":"[data-cover-preview-video]","{previewEmpty}":"[data-cover-preview-empty]","{browse}":"[data-cover-browse]","{upload}":"[data-cover-upload]","{remove}":"[data-cover-remove]","{progress}":"[data-eb-mm-upload-progress]","{addCoverButton}":".eb-document-add-cover-button","{title}":"[data-cover-title]","{altText}":"[data-cover-alt]","{caption}":"[data-cover-caption]","{data}":"[data-cover-value]"}},function(a){return{defaultUri:null,init:function(){var b=a.placeholder();
b.length>0&&EasyBlog.MediaManager.uploader.register(b);var c=a.data().val();a.defaultUri=c},setImage:function(b,c,d,e,f){var g=EasyBlog.ajax("site/views/composer/setImageCover",{url:b});a.preview().append(g),c.indexOf("flickr:")>=0&&(c="flickr:/"+b),a.data().val(c),d&&a.title().val(d),f&&a.caption().val(f),e&&a.altText().val(e),setTimeout(function(){a.placeholder().addClass("has-image has-art state-done")},250)},setVideo:function(b,c,d){var e=EasyBlog.ajax("site/views/composer/setVideoCover",{url:b});a.preview().append(e),a.data().val(c),d&&a.title().val(d),setTimeout(function(){a.placeholder().addClass("has-image has-art state-done")
},250)},"{container} click":function(a,b){b.stopPropagation()},"{browse} mediaSelect":function(b,c,d){"video"==d.meta.type?a.setVideo(d.meta.url,d.meta.uri,d.meta.title):a.setImage(d.meta.url,d.meta.uri,d.meta.title,d.data.alt_text,d.data.caption_text),setTimeout(function(){a.container().parent().addClass("open")},5)},"{placeholder} mediaUploaderFilesAdded":function(a,b,c,d){EasyBlog.MediaManager.uploader.addItem(d[0],a)},"{placeholder} mediaUploaderFileUploaded":function(b,c,d,e,f){var g=f.response,h=g.media,i=h.meta;
"video"==i.type?a.setVideo(i.url,i.uri,i.title):a.setImage(i.url,i.uri,i.title)},"{placeholder} mediaUploaderFileError":function(){},"{placeholder} mediaUploaderError":function(a,b,c,d){var e=JSON.parse(d.response);a.addClass("is-failed");var f=a.find("[data-eb-mm-failed-message]");f.attr("data-original-title",e.message),f.attr("data-eb-provide","tooltip")},"{workarea} mouseover":function(){a.placeholder().hasClass("has-image")&&a.remove().removeClass("hide")},"{workarea} mouseleave":function(){a.remove().addClass("hide")
},"{remove} click":function(){a.placeholder().removeClass("has-image is-uploading has-art is-failed"),a.title().val(""),a.data().val(""),a.altText().val(""),a.caption().val(""),a.preview().empty()}}}),b.resolve()})}),EasyBlog.module("composer/document/maps",function(a){var b=this;EasyBlog.Controller("Composer.Document.Maps",{elements:["[data-eb-composer-location-{places|autocomplete|form|form-message}]"],defaultOptions:{"{container}":"[data-location-container]",geomode:"native",searchmode:"detect","{detect}":"[data-location-detect]","{remove}":"[data-location-remove]","{preview}":"[data-location-preview]","{map}":"[data-location-map]","{inputContainer}":"[data-location-input-container]","{input}":"[data-location-input]","{address}":"[data-location-address]","{latitude}":"[data-location-latitude]","{longitude}":"[data-location-longitude]","{place}":"[data-eb-composer-location-places] li"}},function(b,c,d,e,f,g){return{init:function(){b.composer=g=b.document.composer,d=b.container(),c.apikey=b.container().data("google-apikey"),navigator.geolocation||(c.geomode="external"),b.setupAutocomplete()
},setupAutocomplete:function(){e=b.autocomplete().detach(),f=e.find(b.places),textfield=b.input(),a(document).on("click",function(b){var c=a(b.target).parents().addBack();c.filter(textfield).length<1&&e.detach()})},searching:function(a){b.container().toggleClass("is-searching",a);var c=b.input();c.attr("placeholder",a?c.data("placeholder-searching"):c.data("placeholder"))},userCoords:null,getUserCoords:function(){var d=a.Deferred(),e=b.userCoords;return e?(d.resolve(e),d):("native"==c.geomode?navigator.geolocation.getCurrentPosition(function(a){var b=a.coords;
d.resolve({latitude:b.latitude,longitude:b.longitude})},function(){b.getUserCoordsByIP().done(d.resolve).fail(d.reject)}):d=b.getUserCoordsByIP(),d.done(function(a){b.userCoords=a}))},getUserCoordsByIP:function(){a.getJSON("//www.telize.com/geoip?callback=?").then(function(a){return{latitude:a.latitude,longitude:a.longitude}})},search:function(a){var c=b.getUserCoords().then(function(c){b.searching(!0);var d=EasyBlog.ajax("site/views/composer/getLocations",{latitude:c.latitude,longitude:c.longitude,query:a||""});
return d}).fail(function(c){b.container().addClass("has-errors"),b.formMessage().html(c),b.search.reset(a)}).always(function(){b.searching(!1)});return c},searchManual:a.memoize(function(c){var d=a.Deferred();b.searching(!0);var e=EasyBlog.ajax("site/views/composer/getLocations",{query:c}).done(function(){d.resolve()}).always(function(){b.searching(!1)});return e}),populate:function(){var c=b.input(),d=a.trim(c.val()),e=b.searchmode;if("detect"==e)b.search(d).done(a.debounce(function(c){var d=[];a.each(c,function(b,c){var e=a.create("li").html("<strong>"+c.name+"</strong><small>"+c.address+"</small>").data("venue",c)[0];
d.push(e)}),f.empty().append(d),b.reposition()},50)).fail(function(){});else{if(""==d)return;b.searchManual(d).done(a.debounce(function(c){var d=[];a.each(c,function(b,c){var e=a.create("li").html("<strong>"+c.name+"</strong><small>"+c.address+"</small>").data("venue",c)[0];d.push(e)}),f.empty().append(d),b.reposition()},100)).fail(function(){})}},_populate:a.debounce(function(){b.populate()},350),reposition:function(){var a=b.input();e.appendTo(b.inputContainer()).css({width:a.outerWidth()}).position({my:"left top",at:"left bottom",of:a})
},currentLocation:null,setLocation:function(f){b.currentLocation=f,e.detach(),b.preview().addClass("has-location"),b.input().val(f.name),b.latitude().val(f.latitude),b.longitude().val(f.longitude);var g=b.map(),h=f.latitude+","+f.longitude,i=a.param({size:"520x240",sensor:!0,scale:2,zoom:16}),j="//maps.googleapis.com/maps/api/staticmap?"+i+"&center="+h+"&markers="+h;if(!a.isEmpty(c.apikey))var j="//maps.googleapis.com/maps/api/staticmap?"+i+"&center="+h+"&markers="+h+"&key="+c.apikey;a.Image.get(j).done(function(){g.css("backgroundImage",a.cssUrl(j)),setTimeout(function(){g.addClass("is-ready")
},1)}).always(function(){d.removeClass("is-loading")})},removeLocation:function(){b.preview().removeClass("has-location"),b.input().val(""),b.latitude().val(""),b.longitude().val("")},"{window} resize":function(){e.parent().length<1||b.reposition()},"{label} click":function(){b[b.field().hasClass("active")?"hide":"show"]()},"{input} input":function(){b.searchmode="manual",e.detach(),b._populate()},"{detect} click":function(){b.input().val(""),b.searchmode="detect",e.detach(),b.populate()},"{place} click":function(a){var c=a.data("venue");
b.setLocation(c)},"{remove} click":function(){b.removeLocation()},"{container} click":function(a,b){b.stopPropagation()}}}),b.resolve()}),EasyBlog.module("composer/document/osm",function(){var b=this;EasyBlog.require().library("leaflet").done(function(a){EasyBlog.Controller("Composer.Document.Osm",{elements:["[data-eb-composer-location-{places|autocomplete|form|form-message}]"],defaultOptions:{"{container}":"[data-location-container]",geomode:"native",searchmode:"detect","{detect}":"[data-location-detect]","{remove}":"[data-location-remove]","{preview}":"[data-location-preview]","{map}":"[data-location-map]","{inputContainer}":"[data-location-input-container]","{input}":"[data-location-input]","{address}":"[data-location-address]","{latitude}":"[data-location-latitude]","{longitude}":"[data-location-longitude]","{place}":"[data-eb-composer-location-places] li"}},function(b,c,d,e,f,g){return{init:function(){b.composer=g=b.document.composer,d=b.container(),c.apikey=b.container().data("google-apikey"),navigator.geolocation||(c.geomode="external"),b.setupAutocomplete()
},initMap:function(){b.osm=L.map("map",{zoom:12}),b.osm.fitWorld(),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:1,maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(b.osm),b.preview().addClass("has-location")},setupAutocomplete:function(){e=b.autocomplete().detach(),f=e.find(b.places),textfield=b.input(),a(document).on("click",function(b){var c=a(b.target).parents().andSelf();c.filter(textfield).length<1&&e.detach()
})},searching:function(a){b.container().toggleClass("is-searching",a);var c=b.input();c.attr("placeholder",a?c.data("placeholder-searching"):c.data("placeholder"))},userCoords:null,getUserCoords:function(){var d=a.Deferred(),e=b.userCoords;return e?(d.resolve(e),d):("native"==c.geomode?navigator.geolocation.getCurrentPosition(function(a){var b=a.coords;d.resolve({latitude:b.latitude,longitude:b.longitude})},function(){b.getUserCoordsByIP().done(d.resolve).fail(d.reject)}):d=b.getUserCoordsByIP(),d.done(function(a){b.userCoords=a
}))},getUserCoordsByIP:function(){a.getJSON("//www.telize.com/geoip?callback=?").then(function(a){return{latitude:a.latitude,longitude:a.longitude}})},search:function(a){var c=b.getUserCoords().then(function(c){b.searching(!0);var d=EasyBlog.ajax("site/views/composer/getLocations",{latitude:c.latitude,longitude:c.longitude,query:a||""});return d}).fail(function(c){b.container().addClass("has-errors"),b.formMessage().html(c),b.search.reset(a)}).always(function(){b.searching(!1)});return c},navigate:function(a,c){var d={lat:parseFloat(a),lng:parseFloat(c)};
void 0!==b.marker&&b.osm.removeLayer(b.marker),b.osm.flyTo(d,10,{duration:3}),b.marker=L.marker(d).addTo(b.osm)},"{self} composerViewShow":function(a,c,d){"location"==d&&void 0===b.osm&&(b.preview().addClass("has-location"),setTimeout(function(){b.initMap(),latitude=b.latitude().val(),longitude=b.longitude().val(),latitude&&longitude&&b.navigate(latitude,longitude)},250))},"{self} mobileLocationShow":function(){b.preview().addClass("has-location"),setTimeout(function(){b.initMap(),latitude=b.latitude().val(),longitude=b.longitude().val(),latitude&&longitude&&b.navigate(latitude,longitude)
},250)},searchManual:a.memoize(function(c){var d=a.Deferred();b.searching(!0);var e=EasyBlog.ajax("site/views/composer/getLocations",{query:c}).done(function(){d.resolve()}).always(function(){b.searching(!1)});return e}),populate:function(){var c=b.input(),d=a.trim(c.val()),e=b.searchmode;if("detect"==e)b.search(d).done(a.debounce(function(c){var d=[];a.each(c,function(b,c){var e=a.create("li").html("<strong>"+c.name+"</strong><small></small>").data("venue",c)[0];d.push(e)}),f.empty().append(d),b.reposition()
},50)).fail(function(){});else{if(""==d)return;b.searchManual(d).done(a.debounce(function(c){var d=[];a.each(c,function(b,c){var e=a.create("li").html("<strong>"+c.name+"</strong><small></small>").data("venue",c)[0];d.push(e)}),f.empty().append(d),b.reposition()},100)).fail(function(){})}},_populate:a.debounce(function(){b.populate()},350),reposition:function(){var a=b.input();e.appendTo(b.inputContainer()).css({width:a.outerWidth()}).position({my:"left top",at:"left bottom",of:a})},currentLocation:null,setLocation:function(a){b.currentLocation=a,e.detach(),b.input().val(a.name),b.latitude().val(a.latitude),b.longitude().val(a.longitude),b.navigate(a.latitude,a.longitude)
},removeLocation:function(){b.input().val(""),b.latitude().val(""),b.longitude().val(""),b.osm.removeLayer(b.marker),b.osm.fitWorld()},"{window} resize":function(){e.parent().length<1||b.reposition()},"{label} click":function(){b[b.field().hasClass("active")?"hide":"show"]()},"{input} input":function(){b.searchmode="manual",e.detach(),b._populate()},"{detect} click":function(){b.input().val(""),b.searchmode="detect",e.detach(),b.populate()},"{place} click":function(a){void 0===b.osm&&b.initMap();var c=a.data("venue");
b.setLocation(c)},"{remove} click":function(){void 0!==b.marker&&b.removeLocation()},"{container} click":function(a,b){b.stopPropagation()}}})}),b.resolve()}),EasyBlog.module("composer/document/overlay",function(a){var b=this;EasyBlog.Controller("Composer.Document.Overlay",{defaultOptions:a.extend({"{overlay}":"[data-ebd-overlay]","{placeholder}":"[data-ebd-overlay-placeholder]","{sortable}":".ui-sortable","{placeholderInsideSortHelper}":".ebd-block.is-helper .ebd-overlay-placeholder"},EBD.selectors)},function(b,c,d,e){return{id:1,init:function(){composer=b.document.composer,e=composer.blocks,b.DocumentOverlay=function(c){this.id=b.id++,this.uid=c.data("uid"),this.type=c.data("type"),this._element=a("<div>",{"class":"ebd-overlay","data-id":this.id,"data-type":this.type,"data-ebd-overlay":""})[0],this._placeholder=a("<div>",{"class":"ebd-overlay-placeholder","data-id":this.id,"data-ebd-overlay-placeholder":""})[0]
},a.extend(b.DocumentOverlay.prototype,{block:function(){return e.getBlock(this.uid)},element:function(){return a(this._element)},placeholder:function(){return a(this._placeholder)},attach:function(){this.element().appendTo(b.document.workarea()),this.reposition()},refresh:function(){this.element().hasClass("is-animating")||this.reposition()},reposition:function(){var c=this.element(),d=c.hasClass("is-sorting")?a(b.placeholderInsideSortHelper().where("id",this.id)[0]||this._placeholder):this.placeholder();c.css({width:d.width(),height:d.height()}).position({my:"left top",at:"left top",of:d})
},emerge:function(){this.element().addClass("hover"),this.block().addClass("hover")},submerge:function(){this.element().removeClass("hover"),this.block().removeClass("hover")},remove:function(){b.remove(this.id)}});var c=a.throttle(function(){b.refresh()},25,{leading:!0,trailing:!0}),d=a.ns("keydown keypress keyup input mousedown click mousemove mouseup touchstart touchmove touchend",".overlay"),f=a.ns("sortactivate sortchange sortover sortout sortdeactivate sortstop",".overlay");composer.document.root().on(d,c),composer.views().on("scrolly.overlay",c),b.element.on(f,b.sortable.selector,c)
},blocks:{},instances:[],keys:{},get:function(a){return b.keys[a]},getInstancesByBlock:function(a){var c=e.getBlockUid(a);return b.blocks[c]||[]},create:function(a){var c=new b.DocumentOverlay(a);b.instances.push(c),b.keys[c.id]=c;var d=b.blocks;return(d[c.uid]||(d[c.uid]=[])).push(c),c},remove:function(c){var d=b.get(c);d.element().remove(),d.placeholder().remove(),a.pull(b.blocks[c],d),delete b.keys[c],a.pull(b.instances,d)},of:function(a){return b.blocks[a.data("uid")]||[]},refresh:function(c){var d=c?b.of(c):b.instances;
a.each(d,function(a,b){b.refresh()})},"{self} composerBlockDrag":function(c,d,e){setTimeout(function(){b.refresh()},1),a.each(b.of(e),function(a,b){b.element().addClass("is-sorting")})},"{dropzone} dropover":function(){setTimeout(function(){b.refresh()},1)},"{block} drag":function(a){b.refresh(a)},drop:function(c){a.each(b.of(c),function(a,b){b.element().removeClass("is-sorting").addClass("is-dropping")}),b.refresh()},"{self} composerBlockDrop":function(a,c,d){b.drop(d)},"{self} composerBlockAdd":function(a,c,d){b.drop(d)
},"{self} composerBlockBeforeRelease":function(c,d,e){a.each(b.of(e),function(a,b){b.element().removeClass("is-dropping").addClass("is-releasing is-animating").removeClassAfter("is-releasing")}),b.refresh(),setTimeout(function(){b.refresh()},50)},"{self} composerBlockRelease":function(c,d,e){a.each(b.of(e),function(a,b){b.element().removeClass("is-animating")}),b.refresh()},"{self} composerDocumentRefresh":function(){b.refresh()},"{self} composerBlockRemove":function(c,d,e){var f=b.getInstancesByBlock(e);a.each(f,function(a,b){b.remove()
})},"{placeholder} click":function(a){var c=a.data("id"),d=b.get(c);d.emerge()},"{placeholder} mouseover":function(a){var c=a.data("id"),d=b.get(c);d.block().hasClass("active")&&d.emerge()},"{overlay} mouseout":function(a){var c=a.data("id"),d=b.get(c);d.submerge()}}}),b.resolve()}),EasyBlog.module("composer/document/permalink",function(){var b=this;EasyBlog.Controller("Composer.Document.Permalink",{defaultOptions:{"{wrapper}":"[data-eb-editor-permalink]","{preview}":"[data-permalink-preview]","{input}":"[data-permalink-input]","{edit}":"[data-permalink-edit]","{cancel}":"[data-permalink-cancel]","{update}":"[data-permalink-update]"}},function(a,b,c,d){return{init:function(){d=a.document.composer,b.permalink=a.input().val()
},form:{show:function(){a.wrapper().addClass("is-editing")},hide:function(){a.wrapper().removeClass("is-editing")}},normalize:function(){var c=a.input().val();EasyBlog.ajax("site/views/composer/normalizePermalink",{permalink:c,postId:d.getPostId()}).done(function(c,d){a.input().val(c),a.preview().html(d),b.permalink=c})},"{input} keyup":function(b,c){var d=c.keyCode?c.keyCode:c.which;return 13==d?(c.stopPropagation(),c.preventDefault(),a.update().click(),!1):void 0},"{edit} click":function(){a.form.show()},"{cancel} click":function(){a.input().val(b.permalink),a.form.hide()
},"{update} click":function(){a.normalize(),a.wrapper().removeClass("is-editing")},"{self} composerTitleChanged":function(c,d,e,f){return""!=b.permalink?!1:(a.input().val(f),a.normalize(),void 0)}}}),b.resolve()}),EasyBlog.module("composer/document/toolbar",function(a){var b=this;EasyBlog.Controller("Composer.Document.Toolbar",{defaultOptions:{"{media}":"[data-eb-composer-media]","{embedVideo}":"[data-eb-composer-embed-video]","{button}":"[data-toolbar-view]","{closeDropdown}":"[data-toolbar-dropdown-close]","{coverButton}":"[data-composer-toolbar-cover]","{toggleSidebarButton}":"[data-eb-composer-toggle-sidebar]","{blocks}":"[data-toolbar-blocks]"}},function(b,c,d,e){return{init:function(){e=b.document.composer
},activate:function(){},deactivate:function(){},isActive:function(){},hideBlocks:function(){b.blocks().parent().removeClass("open")},toggleSidebar:function(){e.manager().toggleClass("is-sidebar-open")},"{toggleSidebarButton} click":function(){b.toggleSidebar()},"{media} click":function(a){b.hideBlocks(),EasyBlog.MediaManager.open(a.data("uri"))},"{closeDropdown} click":function(a,c){c.stopPropagation();var d=a.parents(b.button.selector),f=d.data("type");d.removeClass("open"),e.views.hide(f)},"{blocks} click":function(){e.blocks.browser.toggle()
},"{button} click":function(a){b.hideBlocks(),b.deactivate();var d=a.data("type");e.views.show(d)},"{embedVideo} click":function(){EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/embedVideoDialog"),bindings:{"{insertButton} click":function(){var a=this.videoUrl().val();if(a){var b=this.videoWidth().val(),c=this.videoHeight().val(),d=this.noCookie().val(),e=this.relatedSource().val();"same"==e&&(a+="&rel=0");var f='[embed=videolink]{"video":"'+a+'","width":"'+b+'","height":"'+c+'","nocookie":"'+d+'"}[/embed]';
EasyBlog.LegacyEditor.insert(f),EasyBlog.dialog().close(),this.videoUrl().val("")}}}})},"{showDrawerButton} click":function(){a("[data-eb-composer-frame]").toggleClass("show-drawer")}}}),b.resolve()}),EasyBlog.module("composer/layout/elements",function(a){var b=this,c=function(a){return a%400?a%100?a%4?!1:!0:!1:!0};a(document).on("keyup","[data-date-form] [data-date-day]",function(){if(a.trim(a(this).val())){var b=parseInt(a(this).siblings("[data-date-year]").val()||a(this).siblings("[data-date-year]").data("dateDefault")),d=parseInt(a(this).siblings("[data-date-month]").val()||a(this).siblings("[data-date-month]").data("dateDefault")),e=parseInt(a(this).val()||a(this).data("dateDefault")),f=/1|3|5|7|8|10|12/.test(d)?31:30;
2==d&&(f=c(b)?29:28),1>e&&(e=1),e>f&&(e=f),a.isNumeric(e)?a(this).val(e):a(this).val("")}}),a(document).on("keyup","[data-date-form] [data-date-year]",function(){if(a.trim(a(this).val())){var b=parseInt(a(this).val());1>b&&(b=1),a.isNumeric(b)?a(this).val(b):a(this).val("")}}),a.fn.listbox=function(b){var c=this;if(a.isPlainObject(b)||void 0===b)return c.each(function(){var c=a(this),e=d.get(c);return e?(e.update(b),this):(e=new d(c,b),void 0)}),this;if(a.isString(b)){var h,e=a(this[0]),f=d.get(e)||new d(e),g=f[b];
return a.isFunction(g)&&(h=g.apply(f,a.makeArray(arguments).slice(1))),h||this}return this},a.fn.listboxitem=function(b){var c=this;if(void 0===b)return c.each(function(){var b=a(this);d.Item.init(b)}),this;if(a.isString(b)){var e=a(this[0]);d.Item.init(e);var h,f=e.data("listboxitem"),g=f[b];return a.isFunction(g)&&(h=g.apply(f,a.makeArray(arguments).slice(1))),h||this}return this};var d=function(b,c,e){var f=this,g={};f.container=b,f.options={},b.data("listbox",f),a.each(d.defaultOptions,function(a){var d=b.attr("data-listbox-"+a);
void 0!==d&&(g[a]=isNaN(parseInt(d))?d:parseInt(d))}),e&&f.extend(e),f.update(a.extend(!0,{},d.defaultOptions,g,c)),f.init()};d.defaultOptions={toggleDefault:!0,sortable:!0,allowAdd:!0,allowRemove:!0,max:0,min:1,customHTML:"",itemTitle:"Title"},d.get=function(b){var c=a(b).data("listbox");return c instanceof d?c:void 0},a.extend(d.prototype,{addButton:function(){return this.container.find("[data-listbox-button-add]")},update:function(b){var c=this;a.extend(!0,c.options,b)},extend:function(b){a.each(b,function(b,c){a.isFunction(c)&&(d.prototype[b]=c)
})},getItems:function(a){var c=this.container.find("[data-listbox-item]");return a&&(c=c.filter(a)),d.Item.init(c),c},getParentItem:function(b){var c=a(b).closest("[data-listbox-item]");return d.Item.init(c),c},init:function(){var a=this,b=a.container,c=b.find("[data-listbox-custom-html]");a.options.customHTML=c.html(),c.remove(),a.options.toggleDefault&&b.on("click.listbox.toggleDefault","[data-listbox-button-default]",function(){return a.toggleDefault(this)}),a.options.allowAdd&&b.on("click.listbox.addItem","[data-listbox-button-add]",function(){return a.add(this)
}),a.options.allowRemove&&b.on("click.listbox.removeItem","[data-listbox-button-remove]",function(){return a.remove(this)}),a.options.sortable&&this.initSortable(),!a.options.customHTML&&this.getItems().find("[data-listbox-item-content]").editable(!0)},initSortable:function(){},toggleDefault:function(a){var b=this.getItems(),c=this.getParentItem(a);0!=c.length&&(this.container.trigger("listboxBeforeToggleDefault",[c]),c&&(b.removeClass("is-default"),c.addClass("is-default"),this.container.trigger("listboxAfterToggleDefault",[c])))
},isDefault:function(a){return a.hasClass("is-default")},add:function(){var a=this.getItems();if(!(this.options.max>0&&a.length>=this.options.max)){var b=d.Item.newItem(this.options);this.container.trigger("listboxBeforeAddItem",[b]),b&&(this.addButton().before(b),this.container.trigger("listboxAfterAddItem",[b]),0==this.getItems(".is-default").length&&this.toggleDefault(this.getItems(":first")))}},remove:function(a){var b=this.getItems();if(!(this.options.min>0&&b.length<=this.options.min)){var c=this.getParentItem(a);
this.container.trigger("listboxBeforeRemoveItem",[c]),c&&(c.remove(),this.container.trigger("listboxAfterRemoveItem",[c]),this.isDefault(c)&&this.toggleDefault(this.getItems(":first")))}},populate:function(b,c){var e=this;e.getItems().remove(),a.each(b,function(b,f){var g=d.Item.newItem(e.options);a.isFunction(c)&&c(g,f.content),f.default&&g.addClass("is-default"),e.container.trigger("listboxBeforePopulateItem",[f]),e.addButton().before(g),e.container.trigger("listboxAfterPopulateItem",[f])})},toData:function(){var b=[];
return a.each(this.getItems(),function(c,d){b.push(a(d).listboxitem("toData"))}),b}}),d.Item=function(a){this.item=a,this.parent=a.parents("[data-listbox]").data("listbox")},d.Item.get=function(b){var c=a(b).data("listboxitem");return c instanceof d.Item?c:void 0},d.Item.init=function(b){return b=a(b),a.each(b,function(b,c){c=a(c),d.Item.get(c)||c.data("listboxitem",new d.Item(c))}),b},d.Item.newItem=function(b){var c=a("<div></div>",{"data-listbox-item":"","class":"eb-composer-manage-tab row-table"}),e=a("<div></div>",{"class":"col-cell eb-composer-manage-tab-handler"});
b.sortable&&e.append('<i class="fa fa-bars"></i>'),b.toggleDefault&&e.append(' <i class="fa fa-star" data-listbox-button-default></i>'),c.append(e);var f=a("<div></div>",{"data-listbox-item-content":"","class":"col-cell eb-composer-manage-tab-name"}).html(b.customHTML?a.buildHTML(b.customHTML):b.itemTitle);return!b.customHTML&&f.editable(!0),c.append(f),b.allowRemove&&c.append(a("<div></div>",{"data-listbox-button-remove":"","class":"col-cell eb-composer-manage-tab-remove"}).html("&times;")),d.Item.init(c),c
},a.extend(d.Item.prototype,{isDefault:function(){return this.item.hasClass("is-default")},content:function(a){var b=this.item.find("[data-listbox-item-content]");return void 0!==a?(b.html(a),this):b.html()},remove:function(){this.parent.remove(this.item)},setDefault:function(){this.parent.toggleDefault(this.item)},toData:function(){var a=this;return{"default":a.isDefault()?1:0,content:a.content()}}}),EasyBlog.UI=function(b){var c=b.document;a(c).on("click.ebtabs",".eb-tabs-menu-item",function(){var b=a(this),c=b.closest(".eb-tabs"),d=c.find("> .eb-tabs-menu"),e=d.find("> .eb-tabs-menu-item"),f=c.find("> .eb-tabs-content"),g=f.find("> .eb-tabs-content-item");
"toggle"==c.data("eb-tabs-mode")&&b.hasClass("active")?(e.removeClass("active"),g.removeClass("active")):(e.removeClass("active"),b.addClass("active"),g.removeClass("active").where("id",b.data("id")).addClass("active")),c[g.filter(".active").length>0?"addClassAfter":"removeClassAfter"]("is-open",1)})},EasyBlog.UI(window),b.resolve()}),EasyBlog.module("composer/media",function(){var b=this;EasyBlog.require().library("plupload2","ui/draggable").script("composer/media/uploader").done(function(a){var c=EasyBlog.Controller("MediaManager",{hostname:"mediaManager",pluginExtendsInstance:!0,elements:["[data-eb-mm-{folder-upload-current-file|folder-upload-stat|folder-upload-completed|folder-upload-total|folder-upload-progress-bar}]","[data-eb-mm-{pagination-previous|pagination-next|pagination-current|pagination-total}]"],defaultOptions:{types:{image:["jpg","jpeg","png","gif","webp","jfif"],video:["3gp","m4v","mp4","flv","wmv","mp3","webm","swf","mov"],imagevideo:["jpg","jpeg","png","gif","jfif","webp","3gp","m4v","mp4","flv","wmv","webm","swf","mov"],audio:["mp3","m4a","aac","ogg"],pdf:["pdf"]},templates:{},selections:{},"{frame}":"[data-mm-frame]","{body}":"[data-mm-body]","{place}":"[data-mm-place]","{browseButton}":"[data-eb-mm-browse-button]","{actions}":"[data-mm-actions]","{layout}":"[data-mm-layout]","{close}":"[data-mm-close]","{insert}":"[data-mm-insert]","{insertGallery}":"[data-mm-insert-gallery]","{loadMore}":"[data-mm-item-loadmore]","{delete}":"[data-mm-delete]","{insertPermalink}":"[data-mm-insert-permalink]","{panel}":"[data-mm-info-panel]","{infoPermalink}":"[data-mm-info-permalink]","{infoTitle}":"[data-mm-info-title]","{infoPreview}":"[data-mm-info-preview]","{form}":"[data-mm-form]","{formInput}":"[data-mm-form] [data-mm-panel-input]","{panelState}":"[data-mm-info-state]","{folderTitle}":"[data-mm-folder-title]","{breadcrumbs}":"[data-mm-breadcrumbs]","{breadcrumb}":"[data-mm-breadcrumb-item]","{group}":"[data-group]","{groupList}":"[data-group-list]","{listing}":"[data-mm-listing]","{item}":"[data-mm-item]","{folder}":"[data-mm-folder]","{checkbox}":"[data-mm-item-checkbox]","{checkboxInput}":"[data-mm-item-checkbox-input]","{screens}":"[data-mm-screens]","{selectionCounter}":"[data-mm-selection-counter]","{selectionList}":"[data-mm-selection-list]","{selectionItem}":"[data-selection-wrapper]","{clearSelections}":"[data-mm-clear-selections]","{footer}":"[data-mm-footer]","{dropzoneWrapper}":"[data-dragzone-wrapper]","{dropzone}":"[data-mm-dropzone]","{uploadTemplate}":"[data-eb-mm-upload-template]","{uploadThumbnail}":"[data-eb-mm-upload-thumbnail]","{thumbnail}":"[data-eb-mm-file].type-image i[data-thumbnail]","{flickrButton}":"[data-flickr-login]","{createFolder}":"[data-mm-create-folder]","{selectionTemplate}":"[data-mm-selection-template]","{mobileClosePlaces}":"[data-mm-mobile-close-places]","{mobileOpenPlaces}":"[data-mm-mobile-open-places]","{mobileOpenPanel}":"[data-mm-mobile-panel-open]","{mobileHidePanel}":"[data-mm-mobile-panel-hide]","{errorMessage}":"[data-mm-error-message]"}},function(b,c,d,e,f){return{init:function(){c.templates.upload=b.uploadTemplate().detach().html(),c.templates.selection=b.selectionTemplate().detach().html(),f=c.templates,a.each(c.types,function(a,c){for(var e,d=0;e=c[d++];)b.types.file=a
}),b.addPlugin("uploader"),EasyBlog.MediaManager=b;var d=b.frame(),e=d.data("uri");d.attr("data-key",e),b.requirementsMessages={width:d.data("requirements-width"),height:d.data("requirements-height")};var g=1==d.data("acl-upload");g&&b.uploader.register(d),c.mobile=1==d.data("mobile")},open:function(a,c){"post"==a&&(a=b.getCurrentPostUri());var d=b.frame();d.removeClass("t-hidden show-local"),c&&(b.currentFilterType=c),d.removeClass("is-selecting is-browsing can-select-multiple");var e="is-browsing";"select"==b.mode&&(e="is-selecting"),d.addClass(e),("gallery"==b.currentBrowseType||"thumbnails"==b.currentBrowseType)&&d.addClass("can-select-multiple"),d.switchClass("filter-"+b.currentFilterType),b.currentUri&&"places"!=b.currentUri&&(a=b.currentUri),b.setActivePlace(a),a&&b.navigate(a)
},hide:function(){b.pauseVideoObject(),b.frame().addClass("t-hidden"),b.selection.clear(),b.panel.hide(),b.currentFilterType="all",b.mode="standard",b.currentBrowseButton=null,b.currentBrowseType=null,b.disabledPanels=null},loading:function(){b.body().removeClass("is-empty").addClass("is-loading")},doneLoading:function(){b.body().removeClass("is-loading")},pauseVideoObject:function(){a("video").length>0&&a("video").get(0).pause()},"{self} composerReady":function(){e=EasyBlog.Composer},types:{"":"file"},getExtension:function(a){var a=b.getUri(a),c=a.lastIndexOf(".");
return c>-1?a.slice(c+1).toLowerCase():""},getType:function(a){return b.types[b.getExtension(a)]||"file"},getPlaceName:function(a){var b=a.split(":");return b[0]},getKey:function(b){return"_"==b.substring(0,1)?b:"_"+a.moxie.btoa(b).replace(/\+/g,".").replace(/\=/g,"-").replace(/\//g,"~")},getUri:function(b){if(b instanceof a){var c=b;b=c.data("key")||""}return firstKeyCharacter=b.substring(0,1),"_"!==firstKeyCharacter?b:(uri=b.slice(1),uri=uri.replace(/\./g,"+"),uri=uri.replace(/\-/g,"="),uri=uri.replace(/\~/g,"/"),uri=a.moxie.atob(uri,!0))
},getParent:function(a){var a=b.getUri(a),c=a.lastIndexOf("/");return c>-1?a.slice(0,c):null},getFilename:function(a){var a=b.getUri(a),c=a.lastIndexOf("/");return c>-1?a.slice(c+1):a},isOpen:function(){return!b.frame().hasClass("t-hidden")},isRoot:function(a){return b.getUri(a).indexOf("/")<0},canInsert:function(){return b.frame().hasClass("has-insertions")},canDelete:function(){return b.frame().hasClass("can-delete")},canUpload:function(){return b.frame().hasClass("can-upload")},getCurrentPostUri:function(a){var b="post:"+EasyBlog.Composer.getPostId();
return void 0!==a&&a.length>0&&(b=a+":"+EasyBlog.Composer.getPostId()),b},medias:{},mediaLoaders:{},getMedia:function(a){var c=b.getKey(a),d=b.getCurrentPostUri(),e=b.mediaLoaders[a];return e||(e=EasyBlog.ajax("site/views/mediamanager/info",{key:c,currentPostUri:d}).done(function(a){var c=a.uri;b.setMedia(c,a)})),e},setMedia:function(c,d){b.medias[c]=d,b.mediaLoaders[c]=a.Deferred().resolve(d)},getVariations:function(a){var c=b.medias[a];if(c)return c.meta.variations||{}},getVariation:function(c,d){if(a.isString(d)){var e=d;
switch(e){case"icon":d=["system/icon","system/small","system/small 320","system/thumbnail","system/original"];break;case"small":d=["system/small","system/small 320","system/thumbnail","system/original"];break;case"medium":d=["system/medium","system/large","system/original"];break;case"thumbnail":d=["system/thumbnail","system/original"];break;case"large":d=["system/large","system/original"];break;case"original":d=["system/original"];break;default:d=[e,"system/original"]}}var g,f=b.getVariations(c);return a.each(d,function(b,c){return a.has(f,c)?(g=f[c],!1):void 0
}),g},createVariation:function(a,c,d,e){var f=b.getKey(a),g=EasyBlog.ajax("site/views/mediamanager/createVariation",{key:f,name:c,width:d,height:e}).done(function(c){b.setMedia(a,c)});return g},removeVariation:function(a,c){var d=b.getKey(a),e=EasyBlog.ajax("site/views/mediamanager/deleteVariation",{key:d,name:c}).done(function(c){b.setMedia(a,c)});return e},mode:"standard",currentFilterType:"all",currentBrowseButton:null,currentFolderUri:null,currentUri:"places",selection:{getLastItem:function(){var a=b.selection.total();
if(0>=a)return!1;var d=Object.keys(c.selections),e=d[d.length-1];return b.selection.getItem(e)},getItem:function(a){return c.selections[a]},getItems:function(){return c.selections},getKeys:function(){var b=[];return a.each(c.selections,function(a){b.push(a)}),b},total:function(){return Object.keys(c.selections).length},hasItems:function(){return!a.isEmptyObject(c.selections)},canCreateGallery:function(){var b=c.selections,d=!0;return a.each(b,function(a,b){return"image"!=b.meta.type?(d=!1,!1):void 0}),d},insert:function(a,d){c.selections[a]=d,b.frame().addClass("has-selections"),template=b.getSelectionTemplate(d),b.selectionList().append(template),b.trigger("mediaSelectionUpdated",[c.selections,d])
},remove:function(a){var d=b.selection.getItem(a);delete c.selections[a],b.selectionList().find('[data-key="'+a+'"]').remove(),b.trigger("mediaSelectionUpdated",[c.selections,d])},clear:function(){delete c.selections,b.folder().removeClass("is-selected"),b.selectionList().html(""),b.item().removeClass("is-selected"),b.checkboxInput().prop("checked",!1),b.frame().removeClass("has-selections"),b.panel.hide(),c.selections={},b.simulateMetakey=!1,b.trigger("mediaSelectionUpdated",[c.selections])}},setActivePlace:function(a){var c=b.getKey(a);
b.currentPlace=a,b.frame().addClass("can-upload can-create-folder can-delete has-insertions"),"posts"==b.currentPlace||"users"==b.currentPlace?b.frame().removeClass("can-upload can-create-folder can-delete"):"easysocial"==b.currentPlace||"jomsocial"==b.currentPlace||"flickr"==b.currentPlace?b.frame().removeClass("can-upload can-create-folder can-delete"):b.currentPlace.indexOf("amazon")>=0&&b.frame().removeClass("can-create-folder"),b.place().removeClass("is-active"),a==b.getCurrentPostUri()&&(c=b.getKey("post"));
var d=b.place('[data-key="'+c+'"]');d.addClass("is-active")},"{place} click":function(a){var e=a.data("id"),f=a.data("key"),g=b.getUri(f);"post"==e&&(g=b.getCurrentPostUri()),"amazon"==e&&(g=b.getCurrentPostUri(e));var h=b.currentUri;h!==g&&(b.selection.clear(),b.setActivePlace(g),a.addClass("is-loading"),c.mobile&&b.frame().removeClass("is-places-open"),b.navigate(g).done(function(){a.removeClass("is-loading").addClass("is-active")}))},"{loadMore} click":function(a){var d=a.data("page"),e=b.getKey("flickr"),f=a.find("[data-loadmore-container]");
f.addClass("is-loading"),b.selection.clear(),EasyBlog.ajax("site/views/mediamanager/loadmore",{key:e,page:d}).done(function(c){a.remove(),b.groupList().append(c.contents)})},navigate:function(c,d){void 0===d&&(d=!0);var f=(b.currentUri,b.currentUri),g=b.getKey(c);if(f===c)return b.uploader.updateUploaderUrl("",g),void 0;b.currentUri=c,b.loading();var h=a.Deferred();return b.selection.clear(),b.frame().switchClass("place-"+b.getPlaceName(c)),EasyBlog.ajax("site/views/mediamanager/contents",{key:g}).done(function(a){b.doneLoading(),a.login?(b.screens().html(a.contents),b.frame().addClass("has-login")):(b.listing().html(a.contents),b.frame().removeClass("has-login")),b.uploader.updateUploaderUrl(a);
var e=a.meta.items.folder.length,f=a.meta.items.file.length;if(0==e&&0==f?b.body().addClass("is-empty"):b.body().removeClass("is-empty"),e>0?b.body().addClass("has-folders"):b.body().removeClass("has-folders"),f>0?b.body().addClass("has-files"):b.body().removeClass("has-files"),d){var g=b.isRoot(c);("easysocial"==b.currentPlace||"jomsocial"==b.currentPlace)&&(g=a.meta.root);var i="posts"!=b.currentPlace&&"users"!=b.currentPlace||"posts"==b.currentPlace&&"posts"==a.meta.place||"users"==b.currentPlace&&"users"==a.meta.place;
g&&i?b.breadcrumbs().html(a.breadcrumb):b.breadcrumbs().append(a.breadcrumb)}h.resolve()}),h},getCurrentRequirements:function(a){return b.currentRequirements?b.currentRequirements[a]:!1},getSelectionTemplate:function(b){var c=a(f.selection);return c.attr("data-uri",b.uri),c.attr("data-key",b.meta.key),"image"==b.meta.type?c.find("[data-selection-cover]").css("background-image","url("+b.meta.preview+")"):c.find("[data-selection-cover]").html('<i class="'+b.meta.icon+'"></i>'),c[0]},getUploadTemplate:function(b){var d=a(c.templates.upload);
return d.attr("data-id",b.id),d.find("[data-eb-mm-upload-type]").addClass("type-"+b.type),d[0]},folder:{nodes:{},get:function(a){var a=b.getKey(a),c=b.folder.selector+"[data-key='"+a+"']",e=d.find(c);return e},remove:function(a){b.folder.get(a).remove();var c=b.folder().length;0==c&&b.body().removeClass("has-folders")},insert:function(a,c){var d=b.mediaLoaders[a.uri];d||b.setMedia(a.uri,a);var e=b.group("[data-type=folder]"),f=b.groupList.inside(e);b.body().removeClass("is-empty"),b.body().addClass("has-folders"),f.prepend(c)
},rename:function(c,d){b.getMedia(c).done(function(c){var e=c.meta;if(e.title!=d){var f=b.folder.get(e.key);b.panelState().addClass("t-hidden"),EasyBlog.ajax("site/views/mediamanager/rename",{key:e.key,filename:d}).done(function(c){b.panelState().removeClass("t-hidden");var d=c.meta.filename;b.folderTitle().val(d),delete b.mediaLoaders[e.uri],b.setMedia(c.uri,c);var g=a(c.file);f.replaceWith(g),b.panel().data("uri",c.uri);b.getKey(c.uri);b.selection.remove(e.key)})}})}},"{formInput} change":function(c){var e=c.parents(b.panel.selector),f=e.data("uri"),g={key:b.getKey(f)},h=b.formInput.inside(e);
h.length>0&&a.each(h,function(c,d){var d=a(d),e=d.attr("name"),f=d.val();d.is("[data-mm-panel-title]")&&b.item("[data-key="+g.key+"]").trigger("mediaTitleChanged",[f]),g["params["+e+"]"]=f}),EasyBlog.ajax("site/views/mediamanager/updateItemMeta",g).done(function(a){b.panelState().removeClass("t-hidden");var c=a.uri;b.setMedia(c,a)})},"{folderTitle} keypress":function(c,d){var e=d.keyCode?d.keyCode:d.which;if(13==e){var f=a.trim(c.val());if(0==f.length)return;var g=c.parents(b.panel.selector).data("uri");b.folder.rename(g,f),d.stopPropagation(),d.preventDefault()
}},"{folderTitle} change":function(c){var e=a.trim(c.val());if(0!=e.length){var f=c.parents(b.panel.selector).data("uri");b.folder.rename(f,e)}},"{folder} click":function(a){var e=a.data("uri"),f=a.data("key"),g=!a.hasClass("is-selected");if(c.mobile)return a.dblclick(),void 0;var h=b.selection.getLastItem();if(h){var i=h.meta;"folder"!=i.type&&delete b.mediaLoaders[e]}b.selection.clear(),b.folder().removeClass("is-selected"),a.toggleClass("is-selected",g),g&&b.getMedia(e).done(function(a){b.selection.insert(f,a),b.panel.show(e)
})},"{folder} dblclick":function(a,c){c.preventDefault();var d=a.data("uri");b.navigate(d)},uploadItems:{},createUploadItem:function(c){var d=b.getUploadTemplate(c);if(b.uploadItems[c.id]=d,c.type.match("image")){var e=new a.moxie.Image;e.onload=function(){e.downsize(100),b.uploadThumbnail.inside(d).css("backgroundImage",a.cssUrl(e.getAsDataURL()))},e.load(c.getSource())}return b.uploader.addItem(c,d),d},getFileGroup:function(a){var a=b.group("[data-type="+a+"]");return a},file:{active:a(),get:function(a){var a=b.getKey(a),c=b.file.getSelector(a);
return d.find(c)},getSelector:function(a){return b.item.selector+'[data-key="'+a+'"]'},activate:function(a){b.file.deactivate(),b.file.active=a.addClass("active")},deactivate:function(){b.file.active.removeClass("active")},insert:function(a){b.body().removeClass("is-empty"),b.body().addClass("has-files");var c=b.getFileGroup("file");b.groupList.inside(c).prepend(a)},remove:function(a){var c=b.file.get(a);c.remove();var d=b.item().length;0==d&&b.body().removeClass("has-files")}},notice:{show:function(a){var c=b.errorMessage();
c.removeClass("t-hidden").html(a)},hide:function(){var a=b.errorMessage();a.addClass("t-hidden")}},"{showAllFilesButton} click":function(a){b.folder.of(a).removeClass("filter-new")},panel:{save:function(){var a=b.panel().data("uri");a.length<=0||b.getMedia(a).done(function(a){var c=b.panel().find(">div");a.panel=c.detach()})},populate:function(){},show:function(c){b.panelState().addClass("t-hidden"),b.panel.save(),b.panel().data("uri",c),b.getMedia(c).done(function(c){b.panel().html(c.panel),b.panel().removeClass("t-hidden"),b.frame().addClass("is-info-panel-open"),b.panel().find("[data-eb-mm-panel-type]").removeClass("t-hidden"),b.disabledPanels&&a(b.disabledPanels).each(function(){b.panel().find("[data-eb-mm-panel-type="+this+"]").addClass("t-hidden")
})})},hide:function(){b.panel().data("uri",""),b.panel().addClass("t-hidden")}},"{flickrButton} click":function(a){var c=a.data("url"),d=960,e=650,f=screen.width/2-d/2,g=screen.height/2-e/2;window.doneLogin=function(){b.currentUri="flickrlogin",b.navigate("flickr")},window.open(c,"","scrollbars=no,resizable=no, width="+d+",height="+e+",left="+f+",top="+g)},"{createFolder} click":function(){var e=b.getKey(b.currentUri);EasyBlog.dialog({content:EasyBlog.ajax("site/views/mediamanager/createFolderDialog"),bindings:{"{submitButton} click":function(){var c=this.folderName().val(),d=this.folderName(),f=this.alert();
return d.parent().removeClass("has-error"),""==a.trim(c)?(d.parent().addClass("has-error"),void 0):(EasyBlog.ajax("site/views/mediamanager/createFolder",{key:e,folder:c}).done(function(a,c){b.folder.insert(a,c),EasyBlog.dialog().close()}).fail(function(a){d.parent().addClass("has-error"),f.html(a.message).removeClass("t-hidden")}),void 0)}}})},"{clearSelections} click":function(a,c){c.stopPropagation(),b.selection.clear()},"{delete} click":function(){if(b.selection.hasItems()){var e=b.selection.getItems();EasyBlog.dialog({content:EasyBlog.ajax("site/views/mediamanager/confirmDelete"),bindings:{"{submitButton} click":function(){var c=b.selection.getKeys();
EasyBlog.ajax("site/views/mediamanager/delete",{keys:c}).done(function(){a.each(e,function(a,c){var d=b.getUri(a),e="folder"==c.meta.type;b.removeMedia(d,e)}),b.selection.clear(),EasyBlog.dialog().close()}).fail(function(){console.log("failed",arguments)})}}})}},"{self} mediaRemove":function(a,c,d,e){var f=b.getKey(d);e&&b.folder.remove(f),e||b.file.remove(f);var g=b.item().length,h=b.folder().length;0==g&&0==h&&b.body().addClass("is-empty")},refreshMedia:function(a){a=b.getUri(a),delete b.medias[a],delete b.mediaLoaders[a]
},removeMedia:function(a,c){b.getKey(a);b.selection.clear(),b.refreshMedia(a),b.trigger("mediaRemove",[a,c])},"{fileRenameButton} click":function(c){var d=b.info.of(c),e=d.data("key"),f=a.trim(b.infoFilename.inside(d).text());EasyBlog.dialog({content:EasyBlog.ajax("site/views/mediamanager/renameFileDialog",{current:f}),bindings:{"{submitButton} click":function(){var c=this.fileName().val();""!=a.trim(c)&&b.file.rename(e,c)}}})},"{paginationPrevious} click, {paginationNext} click":function(a){var c=a.data("page"),d=b.getHint("loading");
EasyBlog.ajax("site/views/mediamanager/users",{page:c}).done(function(a){d.replaceWith(a)}),b.display(d)},dropzone:{show:function(){b.selection.clear(),b.frame().find("[data-dragzone]").removeClass("t-hidden")},hide:function(){b.frame().find("[data-dragzone]").addClass("t-hidden")}},dropActivated:!1,"{dropzoneWrapper} dragover":function(){b.canUpload()&&(b.dropActivated||(b.dropActivated=!0,b.dropzone.show(),setTimeout(function(){b.dropzoneWrapper().on("dragleave",function(){b.dropzone.hide(),b.dropActivated=!1,b.dropzoneWrapper().off("dragleave")
})},100)))},"{dropzoneWrapper} drop":function(){b.dropzone.hide()},"{selectionItem} click":function(a){var d=a.data("uri");b.panel.show(d)},simulateMetakey:!1,"{checkbox} click":function(a,c){c.preventDefault(),c.stopPropagation();var d=a.siblings(b.checkboxInput),e=a.parent(b.item);b.simulateMetakey=!0,d.prop("checked",!d.is(":checked")).trigger("change"),e.click()},"{checkboxInput} change":function(){var d=b.checkboxInput(":checked").length;0==d&&(b.simulateMetakey=!1)},"{item} click":function(a,d){b.notice.hide();
var e=!a.hasClass("is-selected"),f=a.data("uri");b.folder().removeClass("is-selected"),b.simulateMetakey=!0;var g=b.selection.getLastItem();if(g){var h=g.meta;"folder"==h.type&&b.selection.clear()}(!b.simulateMetakey&&!d.metaKey||"select"==b.mode&&"thumbnails"!=b.currentBrowseType&&"gallery"!=b.currentBrowseType)&&b.selection.clear(),a.toggleClass("is-selected",e),a.find(b.checkboxInput).prop("checked",e).trigger("change"),b.getMedia(f).done(function(a){var d=b.getKey(a.uri);if(e)b.selection.insert(d,a),c.mobile||b.panel.show(f);
else{b.selection.remove(d);var g=b.selection.hasItems();if(g&&!c.mobile){var h=b.selection.getLastItem();b.panel.hide(),b.panel.show(h.uri)}else b.panel.hide()}})},"{mobileClosePlaces} click":function(){b.frame().removeClass("is-places-open")},"{mobileOpenPlaces} click":function(){b.frame().addClass("is-places-open")},"{mobileOpenPanel} click":function(a,c){c.stopPropagation();var d=a.data("uri");b.frame().addClass("is-info-panel-open"),b.panel.hide(),b.panel.show(d)},"{mobileHidePanel} click":function(a,c){c.stopPropagation(),b.panel.hide(),b.frame().removeClass("is-info-panel-open")
},"{insertGallery} click":function(){var d=b.selection.getItems();b.trigger("mediaInsertGallery",[d]),b.hide()},"{insertPermalink} click":function(){var d=b.selection.getItems();b.trigger("mediaInsertPermalink",[d]),b.hide()},"{insert} click":function(){var e=b.selection.total()>1,f=b.selection.getItems(),g=!0;a.each(f,function(c){var f=b.getUri(c);b.getMedia(f).done(function(c){var d=a("<div>");d.html(c.info);var h=d.find(EBD.standaloneBlock);b.pauseVideoObject();var i=b.panel().data("uri");if(i==f&&(c.panel=b.panel().find("> div")),c.data=a(c.panel).find("[data-mm-form]").serializeObject(),"image"==c.meta.type){var j=c.meta.variations[c.data.variation],k=b.getCurrentRequirements("width"),l=b.getCurrentRequirements("height");
if(k){k=parseInt(k);var m=parseInt(j.width);if(k>=m)return g=!1,b.notice.show(b.requirementsMessages.width.replace("%i",k)),void 0}if(l){l=parseInt(l);var n=parseInt(j.height);if(l>=n)return g=!1,b.notice.show(b.requirementsMessages.height.replace("%i",l)),void 0}}if(a.map(c.data,function(a,b){0==a&&(c.data[b]=!1),1==a&&(c.data[b]=!0)}),"image"==c.meta.type&&"lightbox"==c.data.link){var o=b.getVariation(c.data.uri,"original");c.data.popup_url=o.url,c.data.popup_uri=o.uri}"select"==b.mode?b.currentBrowseButton.trigger("mediaSelect",[c,c.data]):b.trigger("mediaInsert",[c,h,c.data,e])
})}),g&&b.hide()},"{layout} click":function(a){var d=a.data("type");b.layout().removeClass("is-active"),b.layout("[data-type="+d+"]").addClass("is-active"),b.listing().removeClass("is-grid is-list").addClass("is-"+d)},"{close} click":function(){b.hide()},"{breadcrumb} click":function(a){var d=a.data("uri"),e=a.nextAll();e.remove(),b.navigate(d,!1)},"{item} mediaTitleChanged":function(a,b,c){var d=a.find("[data-item-title]");d.html(c)},"{self} keyup":function(a,c){27==c.keyCode&&b.isOpen()&&b.hide()},"{self} mediaUploaderFileFiltered":function(a,c,d,e){if(b.canUpload()){{var f=b.uploadItems[e.id]||b.createUploadItem(e);
b.getType(e.name)}b.file.insert(f)}},"{self} mediaUploaderFileError":function(c,d,e,f){var g=f.file,h=a(b.uploadItems[g.id]),i=JSON.parse(f.response);h.addClass("is-failed");var j=h.find("[data-eb-mm-failed-message]");j.attr("data-original-title",i.message),j.attr("data-eb-provide","tooltip")},"{self} mediaUploaderFileUploaded":function(c,d,e,f,g){var h=g.response,i=h.media;b.setMedia(i.uri,i),setTimeout(function(){var c=b.uploadItems[f.id];if(c){var d=a(i.file).addClass("is-new");a(c).replaceWith(d)}},600)},"{self} mediaSelectionUpdated":function(a,c,d,f){var g=b.selection.total();
if(b.selectionCounter().html(g),0>=g)return b.actions().removeClass("show-insert show-gallery show-permalink"),void 0;var h=e.document.isLegacy(),i=b.selection.getLastItem(),j=i.meta;if(f&&"undefined"!==f){var k=f.meta;if("folder"!=k.type||h){if("folder"==k.type&&h)return b.actions().addClass("show-gallery"),void 0;g>=1&&b.actions().addClass("show-insert"),g>1&&b.selection.canCreateGallery()?b.actions().addClass("show-gallery"):b.actions().removeClass("show-gallery"),h&&"pdf"==k.type&&k.id==j.id&&"pdf"==j.type?b.actions().addClass("show-permalink"):h&&"pdf"==j.type?b.actions().addClass("show-permalink"):b.actions().removeClass("show-permalink")
}}},"{browseButton} click":function(a){var d=a.data("eb-mm-filter"),e=a.data("eb-mm-start-uri"),f=b.getUri(e),g=a.data("eb-mm-browse-place"),h=a.data("eb-mm-browse-type");"post"==f&&(f=b.getCurrentPostUri()),b.notice.hide();var i={width:a.data("min-width"),height:a.data("min-height")};i.width||i.height||(i=!1);var j=a.data("eb-mm-disabled-panels")?a.data("eb-mm-disabled-panels"):[];j.length&&(j=j.split(",")),b.mode="select",b.currentBrowseType=h,b.currentBrowseButton=a,b.currentRequirements=i,b.disabledPanels=j,b.currentBrowseButton.trigger("mediaSelectStart",[b.currentBrowseButton]),b.open(f,d),"local"==g?b.frame().addClass("show-local"):b.frame().removeClass("show-local")
}}});a("body").addController(c),b.resolve(c)})}),EasyBlog.module("composer/media/uploader",function(){var b=this;EasyBlog.require().library("plupload2").done(function(a){EasyBlog.Controller("MediaManager.Uploader",{elements:["[data-eb-mm-{upload-progress|upload-name|upload-size|upload-progress-value|upload-progress-bar}]","[data-eb-mm-upload-{error-text|error-retry}]"],defaultOptions:{}},function(b,c,d,e){return{init:function(){e=b.mediaManager;var c={runtimes:"html5, html4",autostart:!0},d=e.frame().htmlData("mm-uploader");
b.defaultUploadOptions=a.extend(c,d)},instances:{},targetUrl:null,updateUploaderUrl:function(c,d){void 0===d&&(d=c.meta.key),b.targetUrl=a.uri(b.defaultUploadOptions.url).replaceQueryParam("key",d).toString()},register:function(c,d){var d=a.extend({},b.defaultUploadOptions,d),f=c.data("key"),g=EasyBlog.MediaManager.getUri(f);"post"==g&&(f=EasyBlog.MediaManager.getKey(EasyBlog.MediaManager.getCurrentPostUri()));var h=d.extensions.split(",");a.each(EasyBlog.MediaManager.options.types,function(b,c){a(c).filter(function(b,c){return a.inArray(c,h)
})}),EasyBlog.MediaManager.options.types.file=h;var i=c.data("type")||"file";d.extensions=EasyBlog.MediaManager.options.types[i].join(","),b.targetUrl=d.url=a.uri(d.url).replaceQueryParam("key",f).toString();var j=c.plupload2(d,!1),k=j.id;return j.uri=e.getUri(f),j.container=c,b.instances[k]=j,a.each(b.plupload,function(a,d){j.bind(a,function(){d.apply(this,arguments),b.trigger("mediaUploader"+a,arguments),c.trigger("mediaUploader"+a,arguments)})}),j.init(),b.uploader=j,j},plupload:{FileFiltered:function(a,b){b.items=[],b.addedDate=(new Date).getTime()
},FilesAdded:function(a){a.settings.autostart&&a.start()},BeforeUpload:function(a,c){b.updateAllItems(c)},UploadFile:function(a,c){b.targetUrl&&(a.settings.url=b.targetUrl),b.updateAllItems(c)},UploadProgress:function(a,c){b.updateAllItems(c)},ChunkUploaded:function(a,c){b.updateAllItems(c)},FileUploaded:function(c,d,e){try{var f=a.parseJSON(e.response);e.response=f}catch(g){}b.updateAllItems(d)},Error:function(c,d){var e=d.file;if(e){if("-600"==d.code)return e.status=4,e.error=d.message,EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/cancelFileSizeWarning")}),b.updateAllItems(e),b.trigger("mediaUploaderFileError",arguments),c.container.trigger("mediaUploaderFileError",arguments),void 0;
e.status=4,e.error=a.parseJSON(d.response),b.updateAllItems(e),b.trigger("mediaUploaderFileError",arguments),c.container.trigger("mediaUploaderFileError",arguments)}},FilesRemoved:function(a,c){c.status=6,b.updateAllItems(c)},Destroy:function(a){delete b.instances[a.id]},Init:a.noop,PostInit:a.noop,OptionChanged:a.noop,StateChanged:a.noop,QueueChanged:a.noop,Refresh:a.noop,UploadComplete:a.noop},getInstances:function(c){return a.map(b.instances,function(a){return a.uri==c?a:null})},status:{0:"idle",1:"queued",2:"uploading",3:"unused",4:"failed",5:"done",6:"removed"},addItem:function(a,c){a.items.push(c),b.updateItem(a,c)
},updateItem:function(c,d){var d=a(d),e=b.status[c.status];if(d.switchClass("state-"+e),c.error)return d.find(b.errorText).html(c.error.message),d.find(b.errorRetry).off("click.mmupload.retry").on("click.mmupload.retry",function(){d.switchClass("state-idle")}),void 0;d.find(b.uploadName).html(c.name),d.find(b.uploadSize).html(a.plupload2.formatSize(c.size)),d.find(b.uploadProgressValue).html(c.percent+"%");var f=c.percent;0==c.percent&&(f=5);var g=d.find(b.uploadProgressBar);if(g.hasClass("progress-bar")){var f=100*Math.ceil(f/5);
g.css("width",f+"%")}else{var f=5*Math.ceil(f/5);g.addClass("o-progress-radial--"+f)}},updateAllItems:function(c){c.items&&a.each(c.items,function(a,d){b.updateItem(c,d)})},removeItem:function(b,c){a.pull(b.items,c)}}}),b.resolve()})}),EasyBlog.module("composer/mobile",function(){var b=this;EasyBlog.Controller("Composer.Mobile",{defaultOptions:{"{cover}":"[data-composer-mobile-cover]","{info}":"[data-composer-mobile-info]","{hideInfo}":"[data-composer-mobile-hide-info]","{options}":"[data-composer-mobile-options]","{optionScreen}":"[data-composer-mobile-options-screen]","{posts}":"[data-composer-mobile-posts]","{location}":"[data-composer-mobile-location]","{revisions}":"[data-composer-mobile-revisions]"}},function(a,b,c,d,e){return{init:function(){c=a.composer,e=c.manager(),d=c.blocks
},hideMobileOptions:function(){e.removeClass("is-mobile-options-open")},"{cover} click":function(){e.addClass("is-cover-open")},"{hideInfo} click":function(){e.removeClass("is-sidebar-open")},"{info} click":function(){e.addClass("is-sidebar-open")},"{posts} click":function(b,d){d.stopPropagation(),a.hideMobileOptions(),c.views.show("posts"),e.addClass("is-posts-open")},"{location} click":function(b,c){c.stopPropagation(),a.hideMobileOptions(),a.trigger("mobileLocationShow"),e.addClass("is-location-open")},"{revisions} click":function(b,c){c.stopPropagation(),a.hideMobileOptions(),e.addClass("is-revisions-open")
},"{options} click":function(a,b){b.stopPropagation(),e.addClass("is-mobile-options-open")},"{optionScreen} click":function(){a.hideMobileOptions()},"{self} composerViewShow":function(a,b,c){var d="is-"+c+"-open";e.addClass(d)},"{self} composerViewHide":function(a,b,c){var d="is-"+c+"-open";e.removeClass(d).addClass("xyzzz")},"{self} composerBlockDrop":function(){c.manager().removeClass("is-blocks-open")}}}),b.resolve()}),EasyBlog.module("composer/panels",function(a){var b=this;EasyBlog.Controller("Composer.Panels",{hostname:"panels",defaultOptions:{"{panel}":"[data-eb-composer-panel]","{panelTab}":"[data-eb-composer-panel-tab]","{showDrawer}":"[data-eb-composer-panel-show-drawer]","{fieldset}":".eb-composer-fieldset","{fieldsetToggle}":".eb-composer-fieldset-toggle input","{customIdInput}":"[data-eb-composer-blocks-id]","{customCssInput}":"[data-eb-composer-blocks-css]"}},function(b){return{init:function(){var c=["autopost","association","seo","post","category","authorship"];
a.each(c,function(a,c){b.addPlugin(c)})},panel:{get:a.memoize(function(a){return b.panel().where("id",a)})},panelTab:{get:a.memoize(function(a){return b.panelTab().where("id",a)})},fieldset:{get:function(a){return b.fieldset().where("name",a)},enable:function(a,c){void 0===c&&(c=!0),b.fieldset.get(a).toggleClass("is-disabled",!c).find(b.fieldsetToggle).prop("checked",!!c)},disable:function(a,c){void 0===c&&(c=!1),b.fieldset.enable(a,c)},show:function(a){b.fieldset.get(a).removeClass("is-hidden")},hide:function(a){b.fieldset.get(a).addClass("is-hidden")
},toggle:function(a,c){b.fieldset.get(a).toggleClass("is-hidden",void 0===c?void 0:!c)}},activate:function(a){b.deactivate(),b.panel.get(a).addClass("active"),b.panelTab.get(a).addClass("active"),b.trigger("composerPanelActivate",[a])},deactivate:function(a){a||(a=b.panel(".active").data("id")),b.panel.get(a).removeClass("active"),b.panelTab.get(a).removeClass("active"),b.trigger("composerPanelDeactivate",[a])},"{self} composerBlockExport":function(a,b,c,d){var e=blocks.data(c);(e.custom_css||e.custom_id)&&(void 0===d.data&&(d.data={}),e.custom_css&&(d.data.custom_css=e.custom_css),e.custom_id&&(d.data.custom_id=e.custom_id))
},"{self} composerBlockActivate":function(a,c,d){var f=blocks.data(d);composer.panels.fieldset.get("css").toggle(!0),composer.panels.fieldset.get("id").toggle(!0),b.customCssInput().val(""),b.customIdInput().val(""),f.custom_css&&b.customCssInput().val(f.custom_css),f.custom_id&&b.customIdInput().val(f.custom_id)},"{self} composerBlockDeactivate":function(a,c,d){var f=blocks.data(d);f.custom_css=b.customCssInput().val(),f.custom_id=b.customIdInput().val(),b.customCssInput().val(""),b.customIdInput().val(""),composer.panels.fieldset.get("css").hide(),composer.panels.fieldset.get("id").hide()
},"{panelTab} click":function(a){var c=a.data("id");b.activate(c)},"{showDrawer} click":function(){a("[data-eb-composer-frame]").toggleClass("show-drawer")},"{fieldsetToggle} change":function(a){b.fieldset.of(a).toggleClass("is-disabled",!a.is(":checked"))}}}),b.resolve()}),EasyBlog.module("composer/panels/association",function(a){var b=this;EasyBlog.Controller("Composer.Panels.Association",{defaultOptions:{"{selectButton}":"[data-assoc-select]","{clearButton}":"[data-assoc-clear]"}},function(){return{"{clearButton} click":function(b){var d=a(b).data("id");
a("input#assoc-postname"+d).val(""),a("input#assoc-postid"+d).val("")},"{selectButton} click":function(a){var c=a.data("code"),d=a.data("id");EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/browsePosts",{id:d,code:c})})}}}),b.resolve()}),EasyBlog.module("composer/panels/authorship",function(a){var b=this;EasyBlog.Controller("Composer.Panels.Authorship",{defaultOptions:{"{authorArea}":"[data-eb-composer-author]","{currentAuthor}":"[data-eb-composer-current-author]","{searchAssociates}":"[data-associates-search]","{cancelSearchAssociates}":"[data-associates-search-cancel]","{searchAuthor}":"[data-author-search]","{cancelSearchAuthor}":"[data-author-search-cancel]","{tab}":"[data-author-type]","{tabContent}":"[data-tab-content]","{changeAuthor}":"[data-eb-composer-switch-author]","{authorPicker}":"[data-eb-composer-author-picker]","{authorItem}":"[data-eb-author-item]","{authorList}":"[data-eb-composer-author-list]","{authorCheckbox}":"[data-eb-composer-authoritem]","{activeAuthorId}":"[data-eb-composer-authorid]","{activeAuthorAvatar}":"[data-eb-composer-authoravatar]","{activeAuthorName}":"[data-eb-composer-authorname]","{authorPrevBtn}":"[data-eb-author-prev]","{authorNextBtn}":"[data-eb-author-next]","{associatesList}":"[data-eb-composer-associates-list]","{associateItem}":"[data-associates-item]","{associateCheckbox}":"[data-associates-checkbox]","{activeAssociateName}":"[data-eb-composer-associatename]","{activeAssociateId}":"[data-eb-composer-associateid]","{activeAssociateType}":"[data-eb-composer-associatetype]","{activeAssociateAvatar}":"[data-eb-composer-associateavatar]"}},function(b){return{init:function(){},"{cancelSearchAssociates} click":function(){b.associateItem().removeClass("hide"),b.searchAssociates().val("")
},"{cancelSearchAuthor} click":function(){b.authorItem().removeClass("hide");var c=a.trim(b.searchAuthor().val());b.searchAuthor().val(""),c&&b.loadAuthors(0,"")},"{searchAssociates} keydown":a.debounce(function(c){var e=a.trim(c.val()).toLowerCase();if(!e)return b.associateItem().removeClass("hide"),void 0;var f=b.associateItem().filter(function(){var b=a.trim(a(this).data("title")).toLowerCase();return 0==b.indexOf(e)?!0:!1});f&&(b.associateItem().addClass("hide"),f.removeClass("hide"))},300),"{searchAuthor} keydown":a.debounce(function(c){var e=a.trim(c.val()).toLowerCase();
""!=e&&b.loadAuthors(0,e)},300),associatesLoaded:!1,"{tab} click":function(a){var d=a.data("type");"associates"==d&&b.loadAssociates(),b.tab().removeClass("active"),b.tab().where("type",d).addClass("active"),b.tabContent().removeClass("active"),b.tabContent().where("type",d).addClass("active")},"{changeAuthor} click":function(){return b.authorArea().toggleClass("is-opened"),b.authorPicker().toggleClass("pulled"),1==b.tab().length?(b.loadAssociates(),void 0):(b.loadAuthors("0",""),void 0)},"{authorPrevBtn} click":function(c,d){d.preventDefault();
var e=a.trim(b.searchAuthor().val()).toLowerCase(),f=a(c).data("start");f=parseInt(f),0>f&&(f=0),b.loadAuthors(f,e)},"{authorNextBtn} click":function(c,d){d.preventDefault();var e=a(c).data("start"),f=a.trim(b.searchAuthor().val()).toLowerCase();b.loadAuthors(e,f)},loadAuthors:function(c,d){var e=a("<div />",{"class":"loading-authors"});e.html('<i class="fa fa-circle-o-notch fa-spin"></i>'),b.authorList().html(e),EasyBlog.ajax("site/views/composer/listAuthors",{selected:b.activeAuthorId().val(),limitstart:c,search:d}).done(function(a){b.authorList().html(a)
})},loadAssociates:function(){b.associatesLoaded||EasyBlog.ajax("site/views/composer/listAssociates",{source_id:b.activeAssociateId().val(),source_type:b.activeAssociateType().val()}).done(function(a){b.associatesLoaded=!0,b.associatesList().html(a)})},"{authorCheckbox} change":function(a){var d=a.parents(b.authorItem.selector).data("avatar"),e=a.parents(b.authorItem.selector).data("id"),f=a.parents(b.authorItem.selector).data("title");b.setActiveAuthor(e,f,d)},"{associateCheckbox} change":function(a){var d=a.parents(b.associateItem.selector).data("avatar"),e=a.parents(b.associateItem.selector).data("id"),f=a.parents(b.associateItem.selector).data("title"),g=a.parents(b.associateItem.selector).data("type");
return"easyblog.sitewide"==g?(b.removeAssociate(),void 0):(b.setActiveAssociate(e,g,f,d),void 0)},removeAssociate:function(){b.activeAssociateId().val(0),b.activeAssociateType().val("easyblog.sitewide"),b.activeAssociateName().addClass("hidden"),b.activeAssociateAvatar().addClass("hide")},setActiveAssociate:function(a,c,d,e){b.activeAssociateId().val(a),b.activeAssociateName().html(d).removeClass("hidden"),b.activeAssociateType().val(c),b.activeAssociateAvatar().attr("src",e).removeClass("hide")},setActiveAuthor:function(a,c,d){b.activeAuthorId().val(a),b.activeAuthorName().html(c),b.activeAuthorAvatar().attr("src",d),composer.options.authorId!=a?b.currentAuthor().removeClass("hide"):b.currentAuthor().addClass("hide")
}}}),b.resolve()}),EasyBlog.module("composer/panels/autopost",function(a){var b=this;EasyBlog.Controller("Composer.Panels.AutoPost",{defaultOptions:{"{twitterCheckbox}":"[data-autopost-twitter]","{facebookCheckbox}":"[data-autopost-facebook]","{linkedinCheckbox}":"[data-autopost-linkedin]"}},function(b){return{itemUpdated:function(b){var c=a(b).is(":checked");return c?(a(b).parent().addClass("checked"),void 0):(a(b).parent().removeClass("checked"),void 0)},"{twitterCheckbox} change":function(a){b.itemUpdated(a)
},"{facebookCheckbox} change":function(a){b.itemUpdated(a)},"{linkedinCheckbox} change":function(a){b.itemUpdated(a)}}}),b.resolve()}),EasyBlog.module("composer/panels/category",function(a){var b=this;EasyBlog.Controller("Composer.Panels.Category",{defaultOptions:{fields:null,templates:{},"{template}":"[data-category-primary-template]","{fieldsTab}":"[data-eb-composer-panel-tab][data-id=fields]","{fieldsPanel}":"[data-eb-composer-panel][data-id=fields]","{fieldsPanelForm}":"[data-eb-composer-panel][data-id=fields] [data-scrolly-viewport]","{fieldsForm}":"[data-eb-composer-panel-fields]","{empty}":"[data-eb-composer-fields-empty]","{categories}":"[data-category-primary-items]","{category}":"[data-category-primary-item]","{categoryText}":"[data-title-text]","{primaryCategoryInput}":"[data-category-primary-input]","{primaryCategoryTitle}":"[data-category-primary-title]"}},function(b,c,d,e){return{init:function(){c.templates.primaryCategory=b.template().detach().html(),e=EasyBlog.Composer
},getTemplate:function(b){var d=a(c.templates[b]);return d},insertCategory:function(a){var c=b.getTemplate("primaryCategory");c.attr("data-title",a.title).attr("data-id",a.id).find(b.categoryText).html(a.title),b.categories().append(c)},removeCategory:function(c){if(1!=b.categories().children().length){if(b.categories().children('[data-id="'+c.id+'"]').remove(),1==b.categories().children().length||c.id==b.primaryCategoryInput().val()){var d=a(b.categories().children()[0]),f=d.data("id"),g=d.data("title");b.assignPrimaryCategory(f,g)
}e.form().find("[data-category="+c.id+"]").remove()}},assignPrimaryCategory:function(a,c){b.primaryCategoryInput().val(a),b.primaryCategoryTitle().html(c);var d={id:a,title:c};b.trigger("categorysetprimary",d)},categoryExists:function(a){var a=b.categories().children('[data-id="'+a.id+'"]');return a.length>0},"{category} click":function(a){var d=a.data("id"),e=a.data("title");b.assignPrimaryCategory(d,e)},"{self} categorydeselect":function(a,c,d){var f=b.fieldsPanel().find('[data-category-id*="'+d.id+'"]');if(groupId=f.data("group-id")){categoryIds=f.attr("data-category-id");
var g=categoryIds.split(",");if(g.length>1)return g=jQuery.grep(g,function(a){return a!=d.id}),g&&(categoryIds=g.join()),f.attr("data-category-id",categoryIds),b.removeCategory(d),void 0}if(f.remove(),0==b.fieldsPanel().find("[data-panel-field]").length){b.empty().show();var h=e.panels.panelTab.get("fields");h.addClass("hide")}b.removeCategory(d)},"{self} categoryselect":function(a,c,d){b.categoryExists(d)||b.insertCategory(d),EasyBlog.ajax("site/views/categories/getCustomFields",{id:d.id,postId:EasyBlog.Composer.getPostId()}).done(function(a,c){if(a.length>0){if(c){var f=b.fieldsPanel().find('[data-group-id="'+c+'"]'),g=f.data("category-id");
if(g)return f.attr("data-category-id",g+","+d.id),void 0}if(b.fieldsPanelForm().append(a),b.fieldsPanel().find("[data-panel-field]").length>0){var h=e.panels.panelTab.get("fields");h.removeClass("hide"),b.empty().hide()}}});var f=b.createHiddenInput(d);f.appendTo(e.form())},createHiddenInput:function(b){var c=a("<input>").attr("type","hidden").attr("value",b.id).attr("name","categories[]").attr("data-category",b.id);return c},"{self} composerSaveError":function(a,c,d){d.customCode&&-500==d.customCode?b.fieldsTab().addClass("has-error"):b.fieldsTab().removeClass("has-error")
}}}),b.resolve()}),EasyBlog.module("composer/panels/post",function(a){var b=this;EasyBlog.Controller("Composer.Panels.Post",{defaultOptions:{"{languageSelect}":"[data-composer-language]"}},function(){return{"{languageSelect} change":function(b){var d=a(b).val();return"*"==d?(a("[data-composer-association]").addClass("t-hidden"),void 0):(a("[data-composer-association]").removeClass("t-hidden"),a("[data-composer-association-item]").each(function(){var b=a(this),c=b.data("id"),e=b.data("code");e==d?(a(this).find("input#assoc-postname"+c).val(""),a(this).find("input#assoc-postid"+c).val(""),a(this).addClass("hide")):a(this).hasClass("hide")&&a(this).removeClass("hide")
}),void 0)},"{self} composerSelectTemplate":function(){}}}),b.resolve()}),EasyBlog.module("composer/panels/seo",function(){var b=this;EasyBlog.require().library("textboxlist").done(function(a){EasyBlog.Controller("Composer.Panels.Seo",{defaultOptions:{"{keywordTemplate}":"[data-keyword-template]","{metaInput}":"[data-meta-description]","{metaCounter}":"[data-meta-counter]","{keywordCounter}":"[data-keyword-counter]","{textboxlist}":"[data-eb-composer-seo-keywords-textboxlist]","{autofillButton}":"[data-eb-composer-seo-keywords-autofill-button]","{jsondata}":"[data-eb-composer-keywords-jsondata]","{keywordsInput}":"[data-eb-keywords]"}},function(b){return{init:function(){if(0!=b.metaInput().length){a.template("composer/textboxlist/keywords",b.keywordTemplate().detach().html()),b.textboxlist().textboxlist({component:"eb",view:{item:"composer/textboxlist/keywords"}}),b.tagger=b.textboxlist().textboxlist("controller");
var d=JSON.parse(b.jsondata().val());a.each(d,function(a,c){b.tagger.addItem(c)})}},"{textboxlist} listChange":a.debounce(function(){b.keywordCounter().html(b.tagger.getAddedItems().length)},15),"{metaInput} keyup":function(c){var e=a(c).val().length;b.metaCounter().html(e)},"{autofillButton} click":function(c){var d=b.textboxlist().textboxlist("controller"),e=EasyBlog.Composer.document.getText(),f=a(c).parent();a(f).addClass("is-loading"),EasyBlog.ajax("site/views/composer/suggestKeywords",{data:e}).done(function(c){a(f).removeClass("is-loading"),c&&(a.each(c,function(a,b){d.addItem(b.title)
}),b.metaCounter().text(c.length))})},"{self} composerSave":function(c,d,e){e.data.keywords=0==b.metaInput().length?"":a.pluck(b.tagger.getAddedItems(),"title").join(", "),b.keywordsInput().val(e.data.keywords)}}}),b.resolve()})}),EasyBlog.module("composer/posts",function(a){var b=this;EasyBlog.Controller("Composer.Posts",{defaultOptions:{"{container}":"[data-posts-container]","{listingContainer}":"[data-posts-listing-container]","{listing}":"[data-posts-listing]","{emptyMessage}":"[data-posts-empty-message]","{insert}":"[data-post-insert]","{wrapper}":"[data-eb-composer-posts]","{result}":"[data-eb-composer-posts-result]","{searchField}":"[data-posts-search]"}},function(b,c,d,e){return{loaded:!1,initialResult:null,initialEmpty:null,init:function(){e=b.composer,blocks=e.blocks,blocks.loadBlockHandler("post")
},reset:function(){b.listingContainer().removeClass("is-loading is-empty"),b.listing().html(b.initialResult),b.emptyMessage().html(b.initialEmpty)},"{container} click":function(a,b){b.stopPropagation()},"{searchField} keydown":a.debounce(function(c){var d=b.listingContainer(),e=a.trim(c.val());return e.length<1?(b.reset(),void 0):(d.removeClass("is-empty"),d.addClass("is-loading"),b.listing().html(""),EasyBlog.ajax("site/views/search/search",{query:e}).done(function(a,c){return d.removeClass("is-loading"),0==c?(d.addClass("is-empty"),b.emptyMessage().html(a),void 0):(b.listing().append(a),void 0)
}),void 0)},500),hideViewport:function(){e.views.hide("posts"),e.options.mobile&&e.togglePosts().click()},"{insert} click":function(c){var e=EasyBlog.Composer.getDoctype(),f=c.htmlData();if("ebd"==e){var g=blocks.constructBlock("post",{title:f.title,url:f.permalink,image:f.image,intro:f.content});blocks.addBlock(g)}else link=a.create("a").attr({href:f.permalink,title:f.title}).html(f.title),EasyBlog.LegacyEditor.insert(link.toHTML());b.hideViewport()},"{composer} composerViewShow":function(a,c,d){if(void 0===b.initialEmpty&&(b.initialEmpty=b.emptyMessage().html()),"posts"===d&&!b.loaded){var f=b.listingContainer();
f.addClass("is-loading"),EasyBlog.ajax("site/views/composer/listArticles",{exclude:e.getPostId()}).done(function(a){return f.removeClass("is-loading"),b.loaded=!0,0==a.length?(f.addClass("is-empty"),void 0):(f.addClass("is-ready"),b.initialResult=a,b.listing().append(a),void 0)})}}}}),b.resolve()}),EasyBlog.module("composer/revisions",function(a){var b=this;EasyBlog.Controller("Composer.Revisions",{defaultOptions:{"{container}":"[data-revisions-container]","{revisionsFieldset}":"[data-eb-revisions-fieldset]","{revisionToggle}":"[data-eb-revisions-dropdown-toggle]","{revisionDropdown}":"[data-eb-pilot-dropdown]","{revisionHandler}":"[data-eb-revisions-handler]","{revisionList}":"[data-eb-revisions-list]","{compareTitle}":"[data-revisions-comparison-title]","{closeComparison}":"[data-revisions-close-comparison]","{compareScreenWrapper}":"[data-eb-composer-revisions]","{compareScreen}":"[data-eb-composer-revisions-compare-screen]","{item}":"[data-eb-composer-revisions-item]","{compareRevision}":"[data-eb-composer-revisions-compare]","{openRevision}":"[data-eb-composer-revisions-open]","{useRevision}":"[data-eb-composer-revisions-use]","{deleteRevision}":"[data-eb-composer-revisions-delete]","{revisionBlocks}":".eb-composer-revisions .ebd-block","{revisionPurge}":"[data-eb-revision-purge]"}},function(b,c,d,e,f,g){return{init:function(){e=b.composer,g=e.panels,f=e.blocks,compareId=e.frame().data("composer-compare-id"),compareId&&b.initCompareRevision(compareId),b.preventParentScrolling()
},preventParentScrolling:function(){b.revisionList().on("mousewheel",function(a){a.stopPropagation()})},"{container} click":function(a,b){b.stopPropagation()},"{item} click":function(a){var c=a.hasClass("active");a.hasClass("is-current")||(b.item().removeClass("active"),a.toggleClass("active",!c))},revisionsLoaded:!1,getRevisionItem:function(c){var d=a(c).parents(b.item.selector);return d},"{revisionBlocks} mouseover":function(b){var d=a(b).data("uid"),e=f.getBlock(d);f.highlight(e)},"{revisionBlocks} mouseout":function(b){var d=a(b).data("uid"),e=f.getBlock(d);
f.unhighlight(e)},"{closeComparison} click":function(){e.frame().switchClass("view-document"),e.views.show("document"),b.compareScreenWrapper().removeClass("active"),b.compareScreen().html("")},"{compareRevision} click":function(c){e.frame().switchClass("view-revisions"),e.views.show("revisions"),b.compareScreenWrapper().addClass("active");var f=b.getRevisionItem(c),g=a(f).data("id"),h=EasyBlog.Composer.getRevisionId();EasyBlog.ajax("site/views/revisions/compare",{current:h,target:g}).done(function(a,c){b.compareTitle().html(a),b.compareScreen().html(c)
})},initCompareRevision:function(a){e.frame().switchClass("view-revisions"),e.views.show("revisions"),b.compareScreenWrapper().addClass("active");var c=EasyBlog.Composer.getRevisionId();EasyBlog.ajax("site/views/revisions/compare",{current:c,target:a}).done(function(a,c){b.compareTitle().html(a),b.compareScreen().html(c)})},"{useRevision} click":function(c){var e=b.getRevisionItem(c),f=a(e).data("id");EasyBlog.dialog({content:EasyBlog.ajax("site/views/revisions/confirmUseRevision",{uid:EasyBlog.Composer.getPostId()+"."+f})})
},"{deleteRevision} click":function(c){var e=a(c).parents(b.item.selector),f=a(e).data("id");EasyBlog.dialog({content:EasyBlog.ajax("site/views/revisions/deleteRevision",{id:f}),bindings:{"{submitButton} click":function(){EasyBlog.ajax("site/controllers/posts/deleteRevision",{id:f}).done(function(){a(e).remove(),EasyBlog.dialog().close()})}}})},"{revisionPurge} click":function(){e.views.hide("revisions");var d=EasyBlog.Composer.getRevisionId(),f=EasyBlog.Composer.getPostId();EasyBlog.dialog({content:EasyBlog.ajax("site/views/revisions/purgeRevision",{id:f}),bindings:{"{submitButton} click":function(){EasyBlog.ajax("site/controllers/posts/purgeRevisions",{id:f,revisionid:d}).done(function(b,c){a("[data-eb-composer-revisions-item]").each(function(c,d){var e=a(d).data("id").toString();
a.inArray(e,b)<0&&a(d).remove()}),EasyBlog.Composer.setMessage(c)}).fail(function(a){EasyBlog.Composer.setMessage(a)}).always(function(){EasyBlog.dialog().close()})}}})},"{revisionToggle} click":function(){b.revisionsFieldset().toggleClass("show-revision-list"),EasyBlog.ajax("site/views/revisions/getRevisions",{uid:EasyBlog.Composer.getPostUid()}).done(function(a){b.revisionsLoaded=!0,b.revisionList().html(a)})},"{composer} composerSaveSuccess":function(){b.revisionsLoaded=!1}}}),b.resolve()}),EasyBlog.module("composer/shortcuts",function(){var b=this;
EasyBlog.Controller("Composer.Shortcuts",{defaultOptions:{"{shortcutsButton}":"[data-composer-shortcuts-button]","{shortcutsPopup}":"[data-composer-shortcuts]","{closePopup}":"[data-shortcuts-close]"}},function(a){return{init:function(){this.initHelpScreen()},editor:function(b,c){if(!a.isHelpOpen()){var e=a.composer.document.toolbar;b&&220==c&&e.toggleSidebar()}},composerBlocks:function(b,c,d,e){var f=a.composer.blocks.toolbar,g=a.composer.blocks,h=g.getCurrentBlock();return b&&190==c&&d?(e.preventDefault(),f.insertBlock(),void 0):a.isHelpOpen()||h.length<=0?void 0:b&&d&&8==c?(e.preventDefault(),f.deleteCurrentBlock(),void 0):b&&68==c&&d?(e.preventDefault(),f.duplicateBlock(),void 0):(b&&77==c&&d&&f.moveBlock(),void 0)
},help:function(b,c){191==c&&b&&a.toggleHelpScreen();var e=27==event.keyCode;e&&a.isHelpOpen()&&a.hideHelpScreen()},media:function(b,c,d){if(!a.isHelpOpen()){var e=a.composer,f=e.document.toolbar,g=EasyBlog.MediaManager;if(e.document.isLegacy()&&b&&222==c&&f.embedVideo().click(),b&&190==c&&!d&&f.coverButton().click(),b&&(59==c||186==c)){if(g.isOpen())return g.hide(),void 0;g.open("post")}}},isMac:function(){var a=/(Mac)/i.test(navigator.platform);return a},isWindows:function(){var a=/(Win)/i.test(navigator.platform);
return a},isHelpOpen:function(){var b="none"!=a.shortcutsPopup().css("display");return b},hideHelpScreen:function(){a.shortcutsPopup().hide()},toggleHelpScreen:function(){a.shortcutsPopup().toggle()},initHelpScreen:function(){a.element.on("keydown",function(b){var c=b.metaKey,d=b.shiftKey,e=b.keyCode,f=a.composer;a.isWindows()&&(c=b.ctrlKey),a.help(c,e,d,b),a.editor(c,e,d,b),a.media(c,e,d,b),f.document.isLegacy()||a.composerBlocks(c,e,d,b)})},"{shortcutsButton} click":function(){a.toggleHelpScreen()},"{closePopup} click":function(){a.hideHelpScreen()
}}}),b.resolve()}),EasyBlog.module("composer/tags",function(a){var b=this,c={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38},d={38:"up",40:"down",37:"left",39:"right"};EasyBlog.require().library("textboxlist","scrollTo").script("composer/vendors/nearest").done(function(){EasyBlog.Controller("Composer.Tags",{elements:["[data-eb-composer-tags-{textboxlist|readonly}]"],defaultOptions:{templates:{},"{tagTemplate}":"[data-tag-template]",readOnly:!1,"{tags}":"[data-eb-composer-tags]","{tag}":".textboxlist-item","{total}":"[data-eb-composer-tags-total]","{count}":"[data-eb-composer-tags-count]","{suggestions}":".eb-composer-tags-suggestions","{selection}":".eb-composer-tags-selection","{toggleButton}":"[data-eb-composer-tags-toggle-button]","{autofillButton}":"[data-eb-composer-tags-autofill-button]","{itemgroup}":".eb-composer-tags-selection-itemgroup","{item}":".eb-composer-tags-selection-itemgroup > div","{textfield}":"[data-textboxlist-textField]","{jsondata}":"[data-eb-composer-tags-jsondata]","{defaulttags}":"[data-eb-composer-default-tags]","{tagsInput}":"[data-eb-tags]"}},function(b,e,f,g,h,i){return{init:function(){if("0"!=EasyBlog.Composer.options.tags.enabled){e.readOnly=b.readonly().length>0,a.template("composer/textboxlist/item",b.tagTemplate().detach().html()),h=b.selection,g=b.suggestions;
var c=parseInt(b.tags().attr("data-eb-composer-tags-max"))||null;b.textboxlist().textboxlist({component:"eb",max:c,ignoreLocked:!0,view:{item:"composer/textboxlist/item"},filterItem:function(b){return a.isString(b)?i.sanitize(b):(b.title=i.sanitize(b.title),b)}}),i=b.tagger=a.extend(b.textboxlist().textboxlist("controller"),b.tagger),g.populate("",!0);for(var d=0,f=JSON.parse(b.jsondata().val());existingTag=f[d++];)"0"==existingTag.id?i.addItem(existingTag.title):i.addItem({id:existingTag.id,title:existingTag.title,key:i.getItemKey(existingTag.title),locked:!1});
var j=JSON.parse(b.defaulttags().val());a.each(j,function(a,b){i.addLockedItem(b)}),window.tagz=b}},tagger:{sanitize:function(b){return a.trim(b).replace(/,/g,"")},addLockedItem:function(b){b=a.trim(b);var c=i.get(b),d=c&&!c.locked;c&&i.deleteItem(c.id),i.addItem({id:a.uid("item-"),title:b,key:i.getItemKey(b),locked:!0,assigned:d},!0)}},"{textfield} keydown":function(a,f){var i=f.which,j=h.activeItem;switch(i){case c.UP:case c.DOWN:case c.LEFT:case c.RIGHT:var k=d[i];(j.length>0||"down"==k)&&(g.navigate(k),f.preventDefault());
break;case c.ESCAPE:j.length>0?h.deactivate(j):b.suggestions().hasClass("is-showing")?g.collapse():a.val("");break;case c.ENTER:if(j.length>0)return h.use(j),f.preventDefault(),void 0;e.readOnly&&f.preventDefault();break;default:g.populateFromTextfield()}},"{item} mouseover":function(a){h.deactivate(),h.activate(a)},"{item} mouseout":function(){h.deactivate()},"{item} click":function(a){h.use(a)},"{textboxlist} addItem":function(b,c,d){a(h.get(d.title)).addClass("is-used")},"{textboxlist} removeItem":function(b,c,d){d.assigned?i.addItem(d.title):a(h.get(d.title)).removeClass("is-used")
},"{textboxlist} listChange":a.debounce(function(){g.refresh();var a=b.tagger.getAddedItems().length;b.count().text(a)},15),"{self} categoryselect":function(b,c,d){if(!(d.tags.length<=0)){var e=(d.tags||"").split(",");a.each(e,function(a,b){i.addLockedItem(b)})}},"{self} categorydeselect":function(c,d,e){if(!(e.tags.length<=0)){var f=b.composer.category.toArray(),g=(e.tags||"").split(","),h=a.pluck(f,"tags").join(",").split(","),j=a.without.apply(null,[g].concat(h));a.each(j,function(a,b){var c=i.get(b);c&&i.removeItem(c.id)
})}},"{toggleButton} click":function(){g[b.suggestions().hasClass("is-showing")?"collapse":"expand"]()},"{autofillButton} click":function(c){var d=b.composer.document.getText(),e=a(c).parent();a(e).addClass("is-loading"),EasyBlog.ajax("site/views/composer/suggestKeywords",{data:d}).done(function(b){a(e).removeClass("is-loading"),b&&a.each(b,function(a,b){i.addItem(b.title)})}).fail(function(b){a(e).removeClass("is-loading"),EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/errorSuggestTagAutoFill",{errorMsg:b})})
})},suggestions:{index:0,tags:[],expand:function(){g.tick++,b.suggestions().addClass("is-showing")},collapse:function(){g.tick++,b.suggestions().removeClass("is-showing")},refresh:function(){var a=b.item(":not(.is-used)");b.suggestions().toggleClass("is-empty",a.length<1),g.count()},show:function(){g.tick++,g.refresh(),g.expand()},hide:function(){var a=++g.tick;g.collapse(),setTimeout(function(){a===g.tick&&g.reset()},500)},set:function(a){a.length<1?(g.hide(),g.tags=[]):(g.reset(),g.tags=a)},reset:function(){g.tags=[],g.i=0,b.itemgroup().empty()
},pid:0,tick:0,currentQuery:null,query:a.memoize(function(a){return EasyBlog.ajax("site/views/tags/suggest",{search:a}).fail(function(){g.query.cache.delete(a)})}),populate:function(a,c){g.tick++;var d=++g.pid;g.currentQuery&&g.currentQuery.abort(),a=i.sanitize(a),b.suggestions().addClass("is-busy"),g.currentQuery=g.query(a).done(function(a){g.pid===d&&(g.set(a),g.suggest(c))}).fail(function(){g.pid!==d}).always(function(){b.suggestions().removeClass("is-busy"),g.currentQuery=null})},populateTimer:null,populateFromTextfield:function(){g.tick++,clearTimeout(g.populateTimer),setTimeout(function(){var a=b.textfield(),c=i.sanitize(a.val());
""===c?(g.hide(),g.populate("",!0)):g.query.cache.hasOwnProperty(c)?g.populate(c):g.populateTimer=setTimeout(function(){g.populate(c)},250)},1)},suggest:function(c){var d=g.tags;if(!(d.length<1)){for(var j,k,m,e=0,f=d.length,l=[];f>e&&(j=d[g.i]);)k=j.title,m=h.get(k)||h.create(k),l.push(m),i.get(k)?a(m).addClass("is-used"):e++,g.i++;b.itemgroup().append(l),c?g.refresh():g.show()}},navigate:function(c){var d=b.item(),e=b.itemgroup(),f=h.activeItem,i=a(f[0]||b.textfield()[0]).nearest(d,c);i.length>0?(h.activate(i),e.scrollIntoView(i)):f.length>0&&("down"==c&&(g.suggest(),e.scrollIntoView(f)),"up"==c&&h.deactivate())
},count:function(){var c=a.pluck(g.tags,"title"),d=a.keys(i.itemsByTitle),e=a.without.apply(null,[c].concat(d)),f=e.length;b.total().text(f+"")}},selection:{items:{},activeItem:a(),create:function(a){var b=document.createElement("div");return b.innerHTML=a,h.items[a]=b},get:function(a){return h.items[a]},activate:function(a){h.deactivate(),h.activeItem=a.addClass("active")},deactivate:function(){h.activeItem.removeClass("active"),h.activeItem=a()},use:function(c){var c=a(c),d=c.text(),e=i.addItem(d);e&&(b.textfield().focus(),c.is(h.activeItem)&&(nextItem=c.next(b.item)[0]||c.prev(b.item)[0],h.deactivate(c),nextItem&&h.activate(a(nextItem))),g.refresh(),b.textfield().val(""))
}},"{self} composerSave":function(c,d,e){if("0"!=EasyBlog.Composer.options.tags.enabled){var f=b.tagger.getAddedItems();e.data.tags=a.pluck(f,"title").join(","),b.tagsInput().val(e.data.tags)}}}}),b.resolve()})}),EasyBlog.module("composer/templates",function(a){var b=this;EasyBlog.Controller("Composer.Templates",{defaultOptions:{"{updateTemplate}":"[data-eb-composer-update-template-button]","{templateId}":"[data-eb-composer-template-id]","{saveNewTemplate}":"[data-eb-composer-save-template-button]","{closeTemplateSelector}":"[data-template-close-popup]","{selectTemplate}":"[data-template-item]","{templateBlocks}":"[data-template-blocks]","{deleteTemplate}":"[data-template-delete]","{posts}":"[data-eb-composer-posts]","{searchTextfield}":"[data-eb-composer-posts-search-textfield]","{itemGroup}":"[data-eb-composer-posts-item-group]","{list}":"[data-eb-composer-templates-list]"}},function(b,c,d,e){return{init:function(){e=b.composer
},"{closeTemplateSelector} click":function(){var c=b.selectTemplate("[data-blank=1]"),d=c.data("uid");b.trigger("composerSelectTemplate",[d])},"{selectTemplate} click":function(c){var d=c.data("uid"),f=c.data("blank");return f?(b.trigger("composerSelectTemplate",[d]),void 0):(EasyBlog.ajax("site/views/composer/renderTemplate",{uid:d}).done(function(c,f,g,h){a("[data-eb-composer-views]").data("post-template-is-locked",h),a("[data-eb-composer-post-template-id]").val(d),g&&(e.document.isLegacy()?e.document.insertContent(g):e.document.loadDocument(g)),h&&(a("[data-toolbar-blocks-wrapper]").remove(),a("[data-eb-composer-media]").remove(),a('[data-toolbar-view][data-type="posts"]').remove()),b.trigger("composerSelectTemplate",[d,c,f,g])
}),void 0)},"{deleteTemplate} click":function(a,c){c.stopPropagation();var d=a.parents(b.selectTemplate.selector),e=d.data("uid");EasyBlog.dialog({content:EasyBlog.ajax("site/views/templates/confirmDelete",{id:e,deleteAction:"ajax"}),bindings:{"{submitButton} click":function(){EasyBlog.ajax("site/controllers/templates/delete",{ids:[e]}).done(function(){EasyBlog.dialog().close(),d.remove()})}}})}}}),b.resolve()}),EasyBlog.module("composer/vendors/colorpicker",function(a){var b=".colorpicker-hsb-panel",c=".colorpicker-h-panel",d=".colorpicker-sb-panel",e=".colorpicker-h-handle",f=".colorpicker-sb-handle",g=".colorpicker-preview",h=".colorpicker-hex-input",i={color:"#000000",document:document};
a.fn.colorpicker=function(b){var c=this.data("colorpicker");if(c||(c=new j(this,b)),a.isString(b)){var d=b;return c[d].apply(c,a.makeArray(arguments).slice(1))}return this};var j=function(b,c){this.options=a.extend({},i,c),this.element=b,this.init(),b.data("colorpicker",this)};a.extend(j.prototype,{init:function(){this.initHPanel(),this.initSBPanel(),this.initHexInput(),this.silent=!0,this.setHex(this.options.color),this.silent=!1},initHPanel:function(){var b=this;b.generateHueColors(),b.element.on(a.ns("mousedown",".colorpicker.h"),c,function(c){c.preventDefault();
var d=b.hsbPanel(),e=b.hPanel(),f=b.hHandle(),g=e.offset(),h=g.top,i=e.height(),j=function(c){var d=a.getPointerPosition(c),e=d.y-h,g=e/i;0>g&&(g=0),g>1&&(g=1),f.css({top:100*g+"%"});var j=b.getHsb();b.setHsb(j)};d.addClass("adjusting-h"),j(c);var k=a(b.options.document);k.on(a.ns("mousemove touchmove",".colorpicker.h"),function(a){a.preventDefault(),j(a)}).on(a.ns("mouseup touchend",".colorpicker.h"),function(b){b.preventDefault(),d.removeClass("adjusting-h"),k.off(a.ns("mousemove mouseup touchend",".colorpicker.h"))
})})},destroyHPanel:function(){this.element.off(a.ns("mousedown",".colorpicker.h"))},generateHueColors:function(){var b=this.hPanel(),c=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(a.IE<=9){var d,e;for(d=0;11>=d;d++)e=a('<div class="colorpicker-hue-stop"></div>').attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+c[d]+", endColorstr="+c[d+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+c[d]+", endColorstr="+c[d+1]+')";'),b.append(e)
}else stopList=c.join(","),b.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ")},initSBPanel:function(){var b=this;b.element.on(a.ns("mousedown",".colorpicker.sb"),d,function(c){var d=b.hsbPanel(),e=b.sbPanel(),f=b.sbHandle(),g=e.offset(),h=g.left,i=g.top,j=e.width(),k=e.height(),l=function(c){var d=a.getPointerPosition(c),e=d.x-h,g=d.y-i,l=e/j,m=g/k;
0>l&&(l=0),l>1&&(l=1),0>m&&(m=0),m>1&&(m=1),f.css({top:100*m+"%",left:100*l+"%"});var n=b.getHsb();b.setHsb(n)};d.addClass("adjusting-sb"),l(c);var m=a(b.options.document);m.on(a.ns("mousemove touchmove",".colorpicker.sb"),function(a){a.preventDefault(),l(a)}).on(a.ns("mouseup touchend",".colorpicker.sb"),function(){c.preventDefault(),d.removeClass("adjusting-sb"),m.off(a.ns("mousemove mouseup touchend",".colorpicker.sb"))})})},destroySBPanel:function(){this.element.off(a.ns("mousedown",".colorpicker.sb"))},initHexInput:function(){var b=this;
b.element.on("input",h,function(){var d=a.fixHex(a.trim(b.hexInput().val().replace(/\#/g,"")));b.setHex(d)}).on("focusin",h,function(){b.hexInput().addClass("is-focused")}).on("focusout",h,function(){var c=b.hexInput(),d=c.data("value");c.removeClass("is-focused").val(d)})},setHsb:function(b){var c=this.hsbPanel();c.hasClass("adjusting-h")||c.hasClass("adjusting-sb")||this.hHandle().css({top:100*(1-b.h/360)+"%"}),c.hasClass("adjusting-sb")||this.sbPanel().css({background:"#"+a.hsbToHex({h:b.h,s:100,b:100})}),this.sbHandle().css({left:b.s+"%",top:100-b.b+"%"});
var d="#"+a.hsbToHex(b),e=this.hexInput();e.data("value",d),!e.hasClass("is-focused")&&e.val(d),this.colorPreview().css("background",d),!this.silent&&this.element.trigger("colorpickerChange",d,b)},getHsb:function(){var b=this.hHandle();sbHandle=this.sbHandle();var c={h:360*(1-parseFloat(b[0].style.top)/100),s:parseFloat(sbHandle[0].style.left),b:100-parseFloat(sbHandle[0].style.top)};return a.fixHsb(c)},setHex:function(b){var b=b.replace(/\#/g,"");this.setHsb(a.hexToHsb(b))},getHex:function(){return"#"+a.hsbToHex(this.getHsb())
},setRgb:function(b){if(a.isString(b)){var c=b.match(/\d+/g);b={r:c[0]||0,g:c[1]||0,b:c[2]||0}}this.setHsb(a.rgbToHsb(b))},getRgb:function(){return a.hsbToRgb(this.getHsb())},setColor:function(a){a.match(/^rgb/i)&&this.setRgb(a),a.match(/^\#/)&&this.setHex(a)},hsbPanel:function(){return this.element.find(b)},hPanel:function(){return this.element.find(c)},sbPanel:function(){return this.element.find(d)},hHandle:function(){return this.element.find(e)},sbHandle:function(){return this.element.find(f)},colorPreview:function(){return this.element.find(g)
},hexInput:function(){return this.element.find(h)},widget:function(){return this}}),this.resolve()}),EasyBlog.module("composer/vendors/expanding",function(a){function g(){var b=a(this).data("textareaClone");b.find("div").text(this.value.replace(/\r\n/g,"\n")+" "),a(this).trigger("resize.expanding")}var b=this;a.expandingTextarea=a.extend({autoInitialize:!0,initialSelector:"textarea.expanding",opts:{resize:function(){}}},a.expandingTextarea||{});var c=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","wordWrap","word-break","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","boxSizing","webkitBoxSizing","mozBoxSizing","msBoxSizing"],d={position:"absolute",height:"100%",resize:"none"},e={visibility:"hidden",border:"0 solid",whiteSpace:"pre-wrap"},f={position:"relative"};
a.fn.expandingTextarea=function(b){var h=a.extend({},a.expandingTextarea.opts,b);return"resize"===b?this.trigger("input.expanding"):"destroy"===b?(this.filter(".expanding-init").each(function(){var b=a(this).removeClass("expanding-init");b.attr("style",b.data("expanding-styles")||"").removeData("expanding-styles")}),this):(this.filter("textarea").not(".expanding-init").addClass("expanding-init").each(function(){var b=a(this),i=b.parent(),j=a(a.parseHTML("<pre class='textareaClone'><div></div></pre>"));b.after(j).data("textareaClone",j),i.css(f),b.data("expanding-styles",b.attr("style")),b.css(d),j.css(e),a.each(c,function(a,c){var d=b.css(c);
j.css(c)!==d&&j.css(c,d)}),b.bind("input.expanding propertychange.expanding keyup.expanding",g),g.apply(this),h.resize&&b.bind("resize.expanding",h.resize)}),this)},a(function(){a.expandingTextarea.autoInitialize&&a(a.expandingTextarea.initialSelector).expandingTextarea()}),b.resolve()}),EasyBlog.module("composer/vendors/history",function(a){var b=this,c=a;!function(a,b){"use strict";var d=a.History=a.History||{};return"undefined"!=typeof d.Adapter?(console.log("History.js Adapter has already been loaded..."),void 0):(d.Adapter={bind:function(a,b,d){c(a).bind(b,d)
},trigger:function(a,b,d){c(a).trigger(b,d)},extractEventData:function(a,c,d){var e=c&&c.originalEvent&&c.originalEvent[a]||d&&d[a]||b;return e},onDomLoad:function(a){c(a)}},"undefined"!=typeof d.init&&d.init(),void 0)}(window),function(a){"use strict";var c=a.document,d=a.setTimeout||d,e=a.clearTimeout||e,f=a.setInterval||f,g=a.History=a.History||{};return"undefined"!=typeof g.initHtml4?(console.log("History.js HTML4 Support has already been loaded..."),void 0):(g.initHtml4=function(){return"undefined"!=typeof g.initHtml4.initialized?!1:(g.initHtml4.initialized=!0,g.enabled=!0,g.savedHashes=[],g.isLastHash=function(a){var c,b=g.getHashByIndex();
return c=a===b},g.saveHash=function(a){return g.isLastHash(a)?!1:(g.savedHashes.push(a),!0)},g.getHashByIndex=function(a){var b=null;return b="undefined"==typeof a?g.savedHashes[g.savedHashes.length-1]:0>a?g.savedHashes[g.savedHashes.length+a]:g.savedHashes[a]},g.discardedHashes={},g.discardedStates={},g.discardState=function(a,b,c){var e,d=g.getHashByState(a);return e={discardedState:a,backState:c,forwardState:b},g.discardedStates[d]=e,!0},g.discardHash=function(a,b,c){var d={discardedHash:a,backState:c,forwardState:b};
return g.discardedHashes[a]=d,!0},g.discardedState=function(a){var c,b=g.getHashByState(a);return c=g.discardedStates[b]||!1},g.discardedHash=function(a){var b=g.discardedHashes[a]||!1;return b},g.recycleState=function(a){var b=g.getHashByState(a);return g.discardedState(a)&&delete g.discardedStates[b],!0},g.emulated.hashChange&&(g.hashChangeInit=function(){g.checkerFunction=null;var d,e,h,i,b="";return g.isInternetExplorer()?(d="historyjs-iframe",e=c.createElement("iframe"),e.setAttribute("id",d),e.style.display="none",c.body.appendChild(e),e.contentWindow.document.open(),e.contentWindow.document.close(),h="",i=!1,g.checkerFunction=function(){if(i)return!1;
i=!0;var c=g.getHash()||"",d=g.unescapeHash(e.contentWindow.document.location.hash)||"";return c!==b?(b=c,d!==c&&(h=d=c,e.contentWindow.document.open(),e.contentWindow.document.close(),e.contentWindow.document.location.hash=g.escapeHash(c)),g.Adapter.trigger(a,"hashchange")):d!==h&&(h=d,g.setHash(d,!1)),i=!1,!0}):g.checkerFunction=function(){var c=g.getHash();return c!==b&&(b=c,g.Adapter.trigger(a,"hashchange")),!0},g.intervalList.push(f(g.checkerFunction,g.options.hashChangeInterval)),!0},g.Adapter.onDomLoad(g.hashChangeInit)),g.emulated.pushState&&(g.onHashChange=function(b){var j,d=b&&b.newURL||c.location.href,e=g.getHashByUrl(d),f=null,h=null;
return g.isLastHash(e)?(g.busy(!1),!1):(g.doubleCheckComplete(),g.saveHash(e),e&&g.isTraditionalAnchor(e)?(g.Adapter.trigger(a,"anchorchange"),g.busy(!1),!1):(f=g.extractState(g.getFullUrl(e||c.location.href,!1),!0),g.isLastSavedState(f)?(g.busy(!1),!1):(h=g.getHashByState(f),(j=g.discardedState(f))?(g.getHashByIndex(-2)===g.getHashByState(j.forwardState)?g.back(!1):g.forward(!1),!1):(g.pushState(f.data,f.title,f.url,!1),!0))))},g.Adapter.bind(a,"hashchange",g.onHashChange),g.pushState=function(b,d,e,f){if(g.getHashByUrl(e))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
if(f!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.pushState,args:arguments,queue:f}),!1;g.busy(!0);var h=g.createStateObject(b,d,e),i=g.getHashByState(h),j=g.getState(!1),k=g.getHashByState(j),l=g.getHash();return g.storeState(h),g.expectedStateId=h.id,g.recycleState(h),g.setTitle(h),i===k?(g.busy(!1),!1):i!==l&&i!==g.getShortUrl(c.location.href)?(g.setHash(i,!1),!1):(g.saveState(h),g.Adapter.trigger(a,"statechange"),g.busy(!1),!0)},g.replaceState=function(a,b,c,d){if(g.getHashByUrl(c))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
if(d!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.replaceState,args:arguments,queue:d}),!1;g.busy(!0);var e=g.createStateObject(a,b,c),f=g.getState(!1),h=g.getStateByIndex(-2);return g.discardState(f,e,h),g.pushState(e.data,e.title,e.url,!1),!0}),g.emulated.pushState&&g.getHash()&&!g.emulated.hashChange&&g.Adapter.onDomLoad(function(){g.Adapter.trigger(a,"hashchange")}),void 0)},"undefined"!=typeof g.init&&g.init(),void 0)}(window),function(a,b){"use strict";var c=a.console||b,d=a.document,e=a.navigator,f=a.sessionStorage||!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;
return k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode,"undefined"!=typeof m.init?(c.log("History.js Core has already been loaded..."),void 0):(m.init=function(){return"undefined"==typeof m.Adapter?!1:("undefined"!=typeof m.initCore&&m.initCore(),"undefined"!=typeof m.initHtml4&&m.initHtml4(),!0)},m.initCore=function(){if("undefined"!=typeof m.initCore.initialized)return!1;if(m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;
if("undefined"!=typeof b&&null!==b){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){m.options.debug&&m.log.apply(m,arguments)},m.log=function(){var e,f,g,h,i,a=!("undefined"==typeof c||"undefined"==typeof c.log||"undefined"==typeof c.log.apply),b=d.getElementById("log");for(a?(h=Array.prototype.slice.call(arguments),e=h.shift(),"undefined"!=typeof c.debug?c.debug.apply(c,[e,h]):c.log.apply(c,[e,h])):e="\n"+arguments[0]+"\n",f=1,g=arguments.length;g>f;++f){if(i=arguments[f],"object"==typeof i&&"undefined"!=typeof k)try{i=k.stringify(i)
}catch(j){}e+="\n"+i+"\n"}return b?(b.value+=e+"\n-----\n",b.scrollTop=b.scrollHeight-b.clientHeight):a||l(e),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached="undefined"!=typeof m.getInternetExplorerMajorVersion.cached?m.getInternetExplorerMajorVersion.cached:function(){for(var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");(b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c[0];);return a>4?a:!1}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached="undefined"!=typeof m.isInternetExplorer.cached?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());
return a},m.emulated={pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent))),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)return!1;
return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);return d.location.port&&(a+=":"+d.location.port),a+="/"},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return 1===a.length&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var c,a=m.getState(!1,!1),b=(a||{}).url||d.location.href;
return c=b.replace(/\/+$/,"").replace(/[^\/]+$/,function(a){return/\./.test(a)?a:a+"/"})},m.getBasePageUrl=function(){var a=d.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b="undefined"==typeof b?!0:b,/[a-z]+\:\/\//.test(a)||(c="/"===d?m.getRootUrl()+a.replace(/^\/+/,""):"#"===d?m.getPageUrl().replace(/#.*/,"")+a:"?"===d?m.getPageUrl().replace(/[\?#].*/,"")+a:b?m.getBaseUrl()+a.replace(/^(\.\/)+/,""):m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")
},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}
},m.getState=function(a,b){"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var c,b=m.extractId(a.url);if(!b)if(c=m.getStateString(a),"undefined"!=typeof m.stateToId[c])b=m.stateToId[c];else if("undefined"!=typeof m.store.stateToId[c])b=m.store.stateToId[c];else{for(;;)if(b=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"==typeof m.idToState[b]&&"undefined"==typeof m.store.idToState[b])break;
m.stateToId[c]=b,m.idToState[b]=a}return b},m.normalizeState=function(a){var b,c;return a&&"object"==typeof a||(a={}),"undefined"!=typeof a.normalized?a:(a.data&&"object"==typeof a.data||(a.data={}),b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(m.unescapeString(a.url||d.location.href)),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data),(b.title||c)&&(b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id),b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b)
},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d)},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c)},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),c=b.hash},m.extractId=function(a){var b,c,d;return c=/(.*)\&_suid=([0-9]+)$/.exec(a),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1
},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var d,e,c=null;return b=b||!1,d=m.extractId(a),d&&(c=m.getStateById(d)),c||(e=m.getFullUrl(a),d=m.getIdByUrl(e)||!1,d&&(c=m.getStateById(d)),c||!b||m.isTraditionalAnchor(a)||(c=m.createStateObject(null,null,e))),c},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b
},m.hasUrlDuplicate=function(a){var c,b=!1;return c=m.extractState(a.url),b=c&&c.id!==a.id},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var c,d,e,b=!1;return m.savedStates.length&&(c=a.id,d=m.getLastSavedState(),e=d.id,b=c===e),b},m.saveState=function(a){return m.isLastSavedState(a)?!1:(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return b="undefined"==typeof a?m.savedStates[m.savedStates.length-1]:0>a?m.savedStates[m.savedStates.length+a]:m.savedStates[a]
},m.getHash=function(){var a=m.unescapeHash(d.location.hash);return a},m.unescapeString=function(b){for(var d,c=b;;){if(d=a.unescape(c),d===c)break;c=d}return c},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=m.unescapeString(b)},m.normalizeHash=function(a){var b=a.replace(/[^#]*#/,"").replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e,f;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(c=m.escapeHash(a),m.busy(!0),e=m.extractState(a,!0),e&&!m.emulated.pushState?m.pushState(e.data,e.title,e.url,!1):d.location.hash!==c&&(m.bugs.setHash?(f=m.getPageUrl(),m.pushState(null,null,f+"#"+c,!1)):d.location.hash=c),m)
},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.escape(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b)},m.setTitle=function(a){var c,b=a.title;b||(c=m.getStateByIndex(0),c&&c.url===a.url&&(b=c.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=b.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")
}catch(e){}return d.title=b,m},m.queues=[],m.busy=function(a){if("undefined"!=typeof a?m.busy.flag=a:"undefined"==typeof m.busy.flag&&(m.busy.flag=!1),!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(!m.busy.flag)for(a=m.queues.length-1;a>=0;--a)c=m.queues[a],0!==c.length&&(d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay))};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m
},m.queue=function(a,b){return"function"==typeof a&&(a={callback:a}),"undefined"!=typeof b&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0
},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var c,b=m.extractState(d.location.href);if(!m.isLastSavedState(b))return c=b,c||(c=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)
}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;a>=c;++c)m.forward(b);else{if(!(0>a))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m},m.emulated.pushState){var o=function(){};m.pushState=m.pushState||o,m.replaceState=m.replaceState||o}else m.onPopState=function(b,c){var g,h,e=!1,f=!1;return m.doubleCheckComplete(),(g=m.getHash())?(h=m.extractState(g||d.location.href,!0),h?m.replaceState(h.data,h.title,h.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(e=m.Adapter.extractEventData("state",b,c)||!1,f=e?m.getStateById(e):m.expectedStateId?m.getStateById(m.expectedStateId):m.extractState(d.location.href),f||(f=m.createStateObject(null,null,d.location.href)),m.expectedStateId=!1,m.isLastSavedState(f)?(m.busy(!1),!1):(m.storeState(f),m.saveState(f),m.setTitle(f),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))
},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(p){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"beforeunload",m.clearAllIntervals),m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(d.location.href,!0))),f&&(m.onUnload=function(){var a,b;
try{a=k.parse(f.getItem("History.store"))||{}}catch(c){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState)m.idToState.hasOwnProperty(b)&&(a.idToState[b]=m.idToState[b]);for(b in m.urlToId)m.urlToId.hasOwnProperty(b)&&(a.urlToId[b]=m.urlToId[b]);for(b in m.stateToId)m.stateToId.hasOwnProperty(b)&&(a.stateToId[b]=m.stateToId[b]);m.store=a,m.normalizeStore(),f.setItem("History.store",k.stringify(a))},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload)),m.emulated.pushState||(m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval)),("Apple Computer, Inc."===e.vendor||"Mozilla"===(e.appCodeName||""))&&(m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")
}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})))},m.init(),void 0)}(window);var d=[];a.fn.route=function(b){if(this.is("a")){var c=this.attr("title"),e=a.joomla.appendTitle;"before"===e&&(c=a.joomla.sitename+(c?" - "+c:"")),"after"===e&&(c=(c?c+" - ":"")+a.joomla.sitename);var f=(new Date).getTime();d[f]=f,History.pushState(a.extend({timestamp:f,refresh:!0},b),c,this.attr("href"))}return this},History.Adapter.bind(window,"statechange",function(){var a=History.getState();a.id===History.savedStates[0].id&&(window.location=a.url),a.data.timestamp in d?delete d[a.data.timestamp]:a.data.refresh&&(window.location=a.url)
}),b.resolve()}),EasyBlog.module("composer/vendors/nearest",function(a){var b={left:[-1,0],up:[0,-1],right:[1,0],down:[0,1]};a.distance=function(a,c,d){function e(a,b){return Math.floor(Math.sqrt(a*a+b*b))}d=b[d];var x,y,z,f=a.offset(),g=a.outerWidth(),h=a.outerHeight(),i=f.left,j=f.top,k=i+g,l=j+h,m=i+g/2,n=j+h/2,o=c.offset(),p=c.outerWidth(),q=c.outerHeight(),r=o.left,s=o.top,t=r+p,u=s+q,v=r+p/2,w=s+q/2;return 0==d[1]?(d[0]<0?(i>=t&&(y=i-t),i>=v&&(y=void 0!=y?Math.min(y,i-v):i-v),i>=t&&(y=void 0!=y?Math.min(y,i-t):i-t)):(r>=k&&(y=r-k),v>=k&&(y=void 0!=y?Math.min(y,v-k):v-k),r>i&&(y=void 0!=y?Math.min(y,r-i):r-i)),z=2*Math.min(Math.abs(n-s),Math.abs(n-w),Math.abs(n-u))):0==d[0]&&(d[1]<0?(j>=u&&(z=j-u),j>=w&&(z=void 0!=z?Math.min(z,j-w):j-w),j>=u&&(z=void 0!=z?Math.min(z,j-u):j-u)):(s>=l&&(z=s-l),w>=l&&(z=void 0!=z?Math.min(z,w-l):w-l),s>j&&(z=void 0!=z?Math.min(z,s-j):s-j)),y=2*Math.min(Math.abs(m-r),Math.abs(m-v),Math.abs(m-t))),x=void 0==y||void 0==z?-1:e(y,z)
},a.fn.nearest=function(b,c){for(var e,g,d=this,f=a(),h=null,i=-1,j=b.length;++i<j;)e=a(b[i]),d[0]!=e[0]&&(g=a.distance(d,e,c),g>=0&&(null===h||h>g)&&(h=g,f=e));return f},this.resolve()}),EasyBlog.module("composer/vendors/nouislider",function(a){!function(){"use strict";function b(a){return a.split("").reverse().join("")}function c(a,b){return a.substring(0,b.length)===b}function d(a,b){return a.slice(-1*b.length)===b}function e(a,b,c){if((a[b]||a[c])&&a[b]===a[c])throw new Error(b)}function f(a){return"number"==typeof a&&isFinite(a)
}function g(a,b){var c=Math.pow(10,b);return(Math.round(a*c)/c).toFixed(b)}function h(a,c,d,e,h,i,j,k,l,m,n,o){var q,r,s,p=o,t="",u="";return i&&(o=i(o)),f(o)?(a!==!1&&0===parseFloat(o.toFixed(a))&&(o=0),0>o&&(q=!0,o=Math.abs(o)),a!==!1&&(o=g(o,a)),o=o.toString(),-1!==o.indexOf(".")?(r=o.split("."),s=r[0],d&&(t=d+r[1])):s=o,c&&(s=b(s).match(/.{1,3}/g),s=b(s.join(b(c)))),q&&k&&(u+=k),e&&(u+=e),q&&l&&(u+=l),u+=s,u+=t,h&&(u+=h),m&&(u=m(u,p)),u):!1}function i(a,b,e,g,h,i,j,k,l,m,n,o){var q,r="";return n&&(o=n(o)),o&&"string"==typeof o?(k&&c(o,k)&&(o=o.replace(k,""),q=!0),g&&c(o,g)&&(o=o.replace(g,"")),l&&c(o,l)&&(o=o.replace(l,""),q=!0),h&&d(o,h)&&(o=o.slice(0,-1*h.length)),b&&(o=o.split(b).join("")),e&&(o=o.replace(e,".")),q&&(r+="-"),r+=o,r=r.replace(/[^0-9\.\-.]/g,""),""===r?!1:(r=Number(r),j&&(r=j(r)),f(r)?r:!1)):!1
}function j(b){var c,d,f,g={};for(c=0;c<a.length;c+=1)if(d=a[c],f=b[d],void 0===f)g[d]="negative"!==d||g.negativeBefore?"mark"===d&&"."!==g.thousand?".":!1:"-";else if("decimals"===d){if(!(f>=0&&8>f))throw new Error(d);g[d]=f}else if("encoder"===d||"decoder"===d||"edit"===d||"undo"===d){if("function"!=typeof f)throw new Error(d);g[d]=f}else{if("string"!=typeof f)throw new Error(d);g[d]=f}return e(g,"mark","thousand"),e(g,"prefix","negative"),e(g,"prefix","negativeBefore"),g}function k(b,c,d){var e,f=[];for(e=0;e<a.length;e+=1)f.push(b[a[e]]);
return f.push(d),c.apply("",f)}function l(a){return this instanceof l?("object"==typeof a&&(a=j(a),this.to=function(b){return k(a,h,b)},this.from=function(b){return k(a,i,b)}),void 0):new l(a)}var a=["decimals","thousand","mark","prefix","postfix","encoder","decoder","negativeBefore","negative","edit","undo"];window.wNumb=l}(),function(a){"use strict";function b(b){return b instanceof a||a.zepto&&a.zepto.isZ(b)}function c(b,c){return"string"==typeof b&&0===b.indexOf("-inline-")?(this.method=c||"html",this.target=this.el=a(b.replace("-inline-","")||"<div/>"),!0):void 0
}function d(b){if("string"==typeof b&&0!==b.indexOf("-")){this.method="val";var c=document.createElement("input");return c.name=b,c.type="hidden",this.target=this.el=a(c),!0}}function e(a){return"function"==typeof a?(this.target=!1,this.method=a,!0):void 0}function f(a,c){return b(a)&&!c?(a.is("input, select, textarea")?(this.method="val",this.target=a.on("change.liblink",this.changeHandler)):(this.target=a,this.method="html"),!0):void 0}function g(a,c){return b(a)&&("function"==typeof c||"string"==typeof c&&a[c])?(this.method=c,this.target=a,!0):void 0
}function i(b,c,d){var e=this,f=!1;if(this.changeHandler=function(b){var c=e.formatInstance.from(a(this).val());return c===!1||isNaN(c)?(a(this).val(e.lastSetValue),!1):(e.changeHandlerMethod.call("",b,c),void 0)},this.el=!1,this.formatInstance=d,a.each(h,function(a,d){return f=d.call(e,b,c),!f}),!f)throw new RangeError("(Link) Invalid Link.")}function j(a){this.items=[],this.elements=[],this.origin=a}function k(b,c,d,e){0===b&&(b=this.LinkDefaultFlag),this.linkAPI||(this.linkAPI={}),this.linkAPI[b]||(this.linkAPI[b]=new j(this));
var f=new i(c,d,e||this.LinkDefaultFormatter);f.target||(f.target=a(this)),f.changeHandlerMethod=this.LinkConfirm(b,f.el),this.linkAPI[b].push(f,f.el),this.LinkUpdate(b)}var h=[c,d,e,f,g];i.prototype.set=function(a){var b=Array.prototype.slice.call(arguments),c=b.slice(1);this.lastSetValue=this.formatInstance.to(a),c.unshift(this.lastSetValue),("function"==typeof this.method?this.method:this.target[this.method]).apply(this.target,c)},j.prototype.push=function(a,b){this.items.push(a),b&&this.elements.push(b)},j.prototype.reconfirm=function(a){var b;
for(b=0;b<this.elements.length;b+=1)this.origin.LinkConfirm(a,this.elements[b])},j.prototype.remove=function(){var b;for(b=0;b<this.items.length;b+=1)this.items[b].target.off(".liblink");for(b=0;b<this.elements.length;b+=1)this.elements[b].remove()},j.prototype.change=function(a){if(this.origin.LinkIsEmitting)return!1;this.origin.LinkIsEmitting=!0;var c,b=Array.prototype.slice.call(arguments,1);for(b.unshift(a),c=0;c<this.items.length;c+=1)this.items[c].set.apply(this.items[c],b);this.origin.LinkIsEmitting=!1
},a.fn.Link=function(b){var c=this;if(b===!1)return c.each(function(){this.linkAPI&&(a.map(this.linkAPI,function(a){a.remove()}),delete this.linkAPI)});if(void 0===b)b=0;else if("string"!=typeof b)throw new Error("Flag must be string.");return{to:function(a,d,e){return c.each(function(){k.call(this,b,a,d,e)})}}}}(a),function(a){"use strict";function b(b){return a.grep(b,function(c,d){return d===a.inArray(c,b)})}function c(a,b){return Math.round(a/b)*b}function d(a){return"number"==typeof a&&!isNaN(a)&&isFinite(a)
}function e(a){var b=Math.pow(10,7);return Number((Math.round(a*b)/b).toFixed(7))}function f(a,b,c){a.addClass(b),setTimeout(function(){a.removeClass(b)},c)}function g(a){return Math.max(Math.min(a,100),0)}function h(b){return a.isArray(b)?b:[b]}function i(a){var b=a.split(".");return b.length>1?b[1].length:0}function o(a,b){return 100/(b-a)}function p(a,b){return 100*b/(a[1]-a[0])}function q(a,b){return p(a,a[0]<0?b+Math.abs(a[0]):b-a[0])}function r(a,b){return b*(a[1]-a[0])/100+a[0]}function s(a,b){for(var c=1;a>=b[c];)c+=1;
return c}function t(a,b,c){if(c>=a.slice(-1)[0])return 100;var e,f,g,h,d=s(c,a);return e=a[d-1],f=a[d],g=b[d-1],h=b[d],g+q([e,f],c)/o(g,h)}function u(a,b,c){if(c>=100)return a.slice(-1)[0];var e,f,g,h,d=s(c,b);return e=a[d-1],f=a[d],g=b[d-1],h=b[d],r([e,f],(c-g)*o(g,h))}function v(a,b,d,e){if(100===e)return e;var g,h,f=s(e,a);return d?(g=a[f-1],h=a[f],e-g>(h-g)/2?h:g):b[f-1]?a[f-1]+c(e-a[f-1],b[f-1]):e}function w(a,b,c){var e;if("number"==typeof b&&(b=[b]),"[object Array]"!==Object.prototype.toString.call(b))throw new Error("noUiSlider: 'range' contains invalid value.");
if(e="min"===a?0:"max"===a?100:parseFloat(a),!d(e)||!d(b[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");c.xPct.push(e),c.xVal.push(b[0]),e?c.xSteps.push(isNaN(b[1])?!1:b[1]):isNaN(b[1])||(c.xSteps[0]=b[1])}function x(a,b,c){return b?(c.xSteps[a]=p([c.xVal[a],c.xVal[a+1]],b)/o(c.xPct[a],c.xPct[a+1]),void 0):!0}function y(a,b,c,d){this.xPct=[],this.xVal=[],this.xSteps=[d||!1],this.xNumSteps=[!1],this.snap=b,this.direction=c;var e,f=[];for(e in a)a.hasOwnProperty(e)&&f.push([a[e],e]);for(f.sort(function(a,b){return a[0]-b[0]
}),e=0;e<f.length;e++)w(f[e][1],f[e][0],this);for(this.xNumSteps=this.xSteps.slice(0),e=0;e<this.xNumSteps.length;e++)x(e,this.xNumSteps[e],this)}function A(a,b){if(!d(b))throw new Error("noUiSlider: 'step' is not numeric.");a.singleStep=b}function B(b,c){if("object"!=typeof c||a.isArray(c))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===c.min||void 0===c.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");b.spectrum=new y(c,b.snap,b.dir,b.singleStep)}function C(b,c){if(c=h(c),!a.isArray(c)||!c.length||c.length>2)throw new Error("noUiSlider: 'start' option is incorrect.");
b.handles=c.length,b.start=c}function D(a,b){if(a.snap=b,"boolean"!=typeof b)throw new Error("noUiSlider: 'snap' option must be a boolean.")}function E(a,b){if(a.animate=b,"boolean"!=typeof b)throw new Error("noUiSlider: 'animate' option must be a boolean.")}function F(a,b){if("lower"===b&&1===a.handles)a.connect=1;else if("upper"===b&&1===a.handles)a.connect=2;else if(b===!0&&2===a.handles)a.connect=3;else{if(b!==!1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");a.connect=0}}function G(a,b){switch(b){case"horizontal":a.ort=0;
break;case"vertical":a.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function H(a,b){if(!d(b))throw new Error("noUiSlider: 'margin' option must be numeric.");if(a.margin=a.spectrum.getMargin(b),!a.margin)throw new Error("noUiSlider: 'margin' option is only supported on linear sliders.")}function I(a,b){if(!d(b))throw new Error("noUiSlider: 'limit' option must be numeric.");if(a.limit=a.spectrum.getMargin(b),!a.limit)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders.")
}function J(a,b){switch(b){case"ltr":a.dir=0;break;case"rtl":a.dir=1,a.connect=[0,2,1,3][a.connect];break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function K(a,b){if("string"!=typeof b)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var c=b.indexOf("tap")>=0,d=b.indexOf("drag")>=0,e=b.indexOf("fixed")>=0,f=b.indexOf("snap")>=0;a.events={tap:c||f,drag:d,fixed:e,snap:f}}function L(a,b){if(a.format=b,"function"==typeof b.to&&"function"==typeof b.from)return!0;
throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.")}function M(b){var d,c={margin:0,limit:0,animate:!0,format:z};return d={step:{r:!1,t:A},start:{r:!0,t:C},connect:{r:!0,t:F},direction:{r:!0,t:J},snap:{r:!1,t:D},animate:{r:!1,t:E},range:{r:!0,t:B},orientation:{r:!1,t:G},margin:{r:!1,t:H},limit:{r:!1,t:I},behaviour:{r:!0,t:K},format:{r:!1,t:L}},b=a.extend({connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal"},b),a.each(d,function(a,d){if(void 0===b[a]){if(d.r)throw new Error("noUiSlider: '"+a+"' is required.");
return!0}d.t(c,b[a])}),c.style=c.ort?"top":"left",c}function N(a,b,c){var d=a+b[0],e=a+b[1];return c?(0>d&&(e+=Math.abs(d)),e>100&&(d-=e-100),[g(d),g(e)]):[d,e]}function O(a){a.preventDefault();var e,f,b=0===a.type.indexOf("touch"),c=0===a.type.indexOf("mouse"),d=0===a.type.indexOf("pointer"),g=a;return 0===a.type.indexOf("MSPointer")&&(d=!0),a.originalEvent&&(a=a.originalEvent),b&&(e=a.changedTouches[0].pageX,f=a.changedTouches[0].pageY),(c||d)&&(d||void 0!==window.pageXOffset||(window.pageXOffset=document.documentElement.scrollLeft,window.pageYOffset=document.documentElement.scrollTop),e=a.clientX+window.pageXOffset,f=a.clientY+window.pageYOffset),g.points=[e,f],g.cursor=c,g
}function P(b,c){var d=a("<div><div/></div>").addClass(n[2]),e=["-lower","-upper"];return b&&e.reverse(),d.children().addClass(n[3]+" "+n[3]+e[c]),d}function Q(a,b,c){switch(a){case 1:b.addClass(n[7]),c[0].addClass(n[6]);break;case 3:c[1].addClass(n[6]);case 2:c[0].addClass(n[7]);case 0:b.addClass(n[6])}}function R(a,b,c){var d,e=[];for(d=0;a>d;d+=1)e.push(P(b,d).appendTo(c));return e}function S(b,c,d){return d.addClass([n[0],n[8+b],n[4+c]].join(" ")),a("<div/>").appendTo(d).addClass(n[1])}function T(b,c,d){function t(){return o[["width","height"][c.ort]]()
}function u(a){var b,c=[j.val()];for(b=0;b<a.length;b+=1)j.trigger(a[b],c)}function v(a){return 1===a.length?a[0]:c.dir?a.reverse():a}function w(a){return function(b,c){j.val([a?null:c,a?c:null],!0)}}function x(b){var c=a.inArray(b,s);j[0].linkAPI&&j[0].linkAPI[b]&&j[0].linkAPI[b].change(r[c],p[c].children(),j)}function y(b,d){var e=a.inArray(b,s);return d&&d.appendTo(p[e].children()),c.dir&&c.handles>1&&(e=1===e?0:1),w(e)}function z(){var a,b;for(a=0;a<s.length;a+=1)this.linkAPI&&this.linkAPI[b=s[a]]&&this.linkAPI[b].reconfirm(b)
}function A(a,b,d,e){return a=a.replace(/\s/g,l+" ")+l,b.on(a,function(a){return j.attr("disabled")?!1:j.hasClass(n[14])?!1:(a=O(a),a.calcPoint=a.points[c.ort],d(a,e),void 0)})}function B(a,b){var d,c=b.handles||p,e=!1,f=100*(a.calcPoint-b.start)/t(),g=c[0][0]!==p[0][0]?1:0;d=N(f,b.positions,c.length>1),e=G(c[0],d[g],1===c.length),c.length>1&&(e=G(c[1],d[g?0:1],!1)||e),e&&u(["nouislide"])}function C(b){a("."+n[15]).removeClass(n[15]),b.cursor&&a("body").css("cursor","").off(l),e.off(l),j.removeClass(n[12]),u(["set","change"])
}function D(b,c){1===c.handles.length&&c.handles[0].children().addClass(n[15]),b.stopPropagation(),A(m.move,e,B,{start:b.calcPoint,handles:c.handles,positions:[k[0],k[p.length-1]]}),A(m.end,e,C,null),b.cursor&&(a("body").css("cursor",a(b.target).css("cursor")),p.length>1&&j.addClass(n[12]),a("body").on("selectstart"+l,!1))}function E(b){var g,d=b.calcPoint,e=0;b.stopPropagation(),a.each(p,function(){e+=this.offset()[c.style]}),e=e/2>d||1===p.length?0:1,d-=o.offset()[c.style],g=100*d/t(),c.events.snap||f(j,n[14],300),G(p[e],g),u(["nouislide","set","change"]),c.events.snap&&D(b,{handles:[p[e]]})
}function F(a){var b,c;if(!a.fixed)for(b=0;b<p.length;b+=1)A(m.start,p[b].children(),D,{handles:[p[b]]});a.tap&&A(m.start,o,E,{handles:p}),a.drag&&(c=o.find("."+n[7]).addClass(n[10]),a.fixed&&(c=c.add(o.children().not(c).children())),A(m.start,c,D,{handles:p}))}function G(a,b,d){var e=a[0]!==p[0][0]?1:0,f=k[0]+c.margin,h=k[1]-c.margin,i=k[0]+c.limit,j=k[1]-c.limit;return p.length>1&&(b=e?Math.max(b,f):Math.min(b,h)),d!==!1&&c.limit&&p.length>1&&(b=e?Math.min(b,i):Math.max(b,j)),b=q.getStep(b),b=g(parseFloat(b.toFixed(7))),b===k[e]?!1:(a.css(c.style,b+"%"),a.is(":first-child")&&a.toggleClass(n[17],b>50),k[e]=b,r[e]=q.fromStepping(b),x(s[e]),!0)
}function H(a,b){var d,e,f;for(c.limit&&(a+=1),d=0;a>d;d+=1)e=d%2,f=b[e],null!==f&&f!==!1&&("number"==typeof f&&(f=String(f)),f=c.format.from(f),(f===!1||isNaN(f)||G(p[e],q.toStepping(f),d===3-c.dir)===!1)&&x(s[e]))}function I(a){if(j[0].LinkIsEmitting)return this;var b,d=h(a);return c.dir&&c.handles>1&&d.reverse(),c.animate&&-1!==k[0]&&f(j,n[14],300),b=p.length>1?3:1,1===d.length&&(b=1),H(b,d),this}function J(){var a,b=[];for(a=0;a<c.handles;a+=1)b[a]=c.format.to(r[a]);return v(b)}function K(){return a(this).off(l).removeClass(n.join(" ")).empty(),delete this.LinkUpdate,delete this.LinkConfirm,delete this.LinkDefaultFormatter,delete this.LinkDefaultFlag,delete this.reappend,delete this.vGet,delete this.vSet,delete this.getCurrentStep,delete this.getInfo,delete this.destroy,d
}function L(){var b=a.map(k,function(a,b){var c=q.getApplicableStep(a),d=i(String(c[2])),e=r[b],f=100===a?null:c[2],g=Number((e-c[2]).toFixed(d)),h=0===a?null:g>=c[1]?c[2]:c[0]||!1;return[[h,f]]});return v(b)}function M(){return d}var o,p,e=a(d.document||document),j=a(b),k=[-1,-1],q=c.spectrum,r=[],s=["lower","upper"].slice(0,c.handles);if(c.dir&&s.reverse(),b.LinkUpdate=x,b.LinkConfirm=y,b.LinkDefaultFormatter=c.format,b.LinkDefaultFlag="lower",b.reappend=z,j.hasClass(n[0]))throw new Error("Slider was already initialized.");
o=S(c.dir,c.ort,j),p=R(c.handles,c.dir,o),Q(c.connect,j,p),F(c.events),b.vSet=I,b.vGet=J,b.destroy=K,b.getCurrentStep=L,b.getOriginalOptions=M,b.getInfo=function(){return[q,c.style,c.ort]},j.val(c.start)}function U(a){var b=M(a,this);return this.each(function(){T(this,b,a)})}function V(b){return this.each(function(){if(!this.hasOwnProperty("destroy"))return a(this).noUiSlider(b),void 0;var c=a(this).val(),d=this.destroy(),e=a.extend({},d,b);a(this).noUiSlider(e),this.reappend(),d.start===e.start&&a(this).val(c)
})}function W(){return this[0][arguments.length?"vSet":"vGet"].apply(this[0],arguments)}function X(b,c,d,e){if("range"===c||"steps"===c)return b.xVal;if("count"===c){var g,f=100/(d-1),h=0;for(d=[];(g=h++*f)<=100;)d.push(g);c="positions"}return"positions"===c?a.map(d,function(a){return b.fromStepping(e?b.getStep(a):a)}):"values"===c?e?a.map(d,function(a){return b.fromStepping(b.getStep(b.toStepping(a)))}):d:void 0}function Y(c,d,e,f){var g=c.direction,h={},i=c.xVal[0],j=c.xVal[c.xVal.length-1],k=!1,l=!1,m=0;return c.direction=0,f=b(f.slice().sort(function(a,b){return a-b
})),f[0]!==i&&(f.unshift(i),k=!0),f[f.length-1]!==j&&(f.push(j),l=!0),a.each(f,function(b){var g,i,j,p,q,r,s,t,u,v,n=f[b],o=f[b+1];if("steps"===e&&(g=c.xNumSteps[b]),g||(g=o-n),n!==!1&&void 0!==o)for(i=n;o>=i;i+=g){for(p=c.toStepping(i),q=p-m,t=q/d,u=Math.round(t),v=q/u,j=1;u>=j;j+=1)r=m+j*v,h[r.toFixed(5)]=["x",0];s=a.inArray(i,f)>-1?1:"steps"===e?2:0,!b&&k&&(s=0),i===o&&l||(h[p.toFixed(5)]=[i,s]),m=p}}),c.direction=g,h}function Z(b,c,d,e,f,g){function j(a){return["-normal","-large","-sub"][a]}function k(a,c,d){return'class="'+c+" "+c+"-"+h+" "+c+j(d[1],d[0])+'" style="'+b+": "+a+'%"'
}function l(a,b){d&&(a=100-a),b[1]=b[1]&&f?f(b[0],b[1]):b[1],i.append("<div "+k(a,"noUi-marker",b)+"></div>"),b[1]&&i.append("<div "+k(a,"noUi-value",b)+">"+g.to(b[0])+"</div>")}var h=["horizontal","vertical"][c],i=a("<div/>");return i.addClass("noUi-pips noUi-pips-"+h),a.each(e,l),i}var k=(a(document),a.fn.val),l=".nui",m=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},n=["noUi-target","noUi-base","noUi-origin","noUi-handle","noUi-horizontal","noUi-vertical","noUi-background","noUi-connect","noUi-ltr","noUi-rtl","noUi-dragable","","noUi-state-drag","","noUi-state-tap","noUi-active","","noUi-stacking"];
y.prototype.getMargin=function(a){return 2===this.xPct.length?p(this.xVal,a):!1},y.prototype.toStepping=function(a){return a=t(this.xVal,this.xPct,a),this.direction&&(a=100-a),a},y.prototype.fromStepping=function(a){return this.direction&&(a=100-a),e(u(this.xVal,this.xPct,a))},y.prototype.getStep=function(a){return this.direction&&(a=100-a),a=v(this.xPct,this.xSteps,this.snap,a),this.direction&&(a=100-a),a},y.prototype.getApplicableStep=function(a){var b=s(a,this.xPct),c=100===a?2:1;return[this.xNumSteps[b-2],this.xVal[b-c],this.xNumSteps[b-c]]
},y.prototype.convert=function(a){return this.getStep(this.toStepping(a))};var z={to:function(a){return a.toFixed(2)},from:Number};a.fn.val=function(b){function c(a){return a.hasClass(n[0])?W:k}if(!arguments.length){var d=a(this[0]);return c(d).call(d)}var e=a.isFunction(b);return this.each(function(d){var f=b,g=a(this);e&&(f=b.call(this,d,g.val())),c(g).call(g,f)})},a.fn.noUiSlider=function(a,b){switch(a){case"step":return this[0].getCurrentStep();case"options":return this[0].getOriginalOptions()}return(b?V:U).call(this,a)
},a.fn.noUiSlider_pips=function(b){var c=b.mode,d=b.density||1,e=b.filter||!1,f=b.values||!1,g=b.format||{to:Math.round},h=b.stepped||!1;return this.each(function(){var b=this.getInfo(),i=X(b[0],c,f,h),j=Y(b[0],d,c,i);return a(this).append(Z(b[1],b[2],b[0].direction,j,e,g))})}}(a),this.resolve()}),EasyBlog.module("composer/vendors/redactor10",function(a){function d(a,b){return new d.prototype.init(a,b)}var b=this;Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a)
}});var c=0;a.fn.composer=function(b){var c=[],e=Array.prototype.slice.call(arguments,1);return"string"==typeof b?this.each(function(){var f,d=a.data(this,"redactor");if("-1"!=b.search(/\./)?(f=b.split("."),"undefined"!=typeof d[f[0]]&&(f=d[f[0]][f[1]])):f=d[b],"undefined"!=typeof d&&a.isFunction(f)){var g=f.apply(d,e);void 0!==g&&g!==d&&c.push(g)}else a.error('No such method "'+b+'" for Redactor')}):this.each(function(){a.data(this,"redactor",{}),a.data(this,"redactor",d(this,b))}),0===c.length?this:1===c.length?c[0]:c
},a.Redactor=d,a.Redactor.VERSION="10.0.6",a.Redactor.modules=["alignment","block","buffer","build","caret","clean","core","focus","indent","inline","insert","keydown","keyup","list","paragraphize","paste","selection","shortcuts","tabifier","tidy","utils"],a.Redactor.opts={direction:"ltr",plugins:!1,focus:!1,focusEnd:!1,visual:!0,tabindex:!1,linebreaks:!1,replaceDivs:!0,paragraphize:!0,cleanStyleOnEnter:!1,enterKey:!0,cleanOnPaste:!0,cleanSpaces:!0,pastePlainText:!1,preSpaces:4,tabAsSpaces:!1,tabKey:!0,scrollTarget:!1,formatting:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],formattingAdd:!1,tabifier:!0,deniedTags:["html","head","link","body","meta","script","style","applet"],allowedTags:!1,removeComments:!1,replaceTags:[["strike","del"]],replaceStyles:[["font-weight:\\s?bold","strong"],["font-style:\\s?italic","em"],["text-decoration:\\s?underline","u"],["text-decoration:\\s?line-through","del"]],removeDataAttr:!1,removeAttr:!1,allowedAttr:!1,removeWithoutAttr:["span"],removeEmpty:["p"],shortcuts:{"ctrl+shift+m, meta+shift+m":{func:"inline.removeFormat"},"ctrl+b, meta+b":{func:"inline.format",params:["bold"]},"ctrl+i, meta+i":{func:"inline.format",params:["italic"]},"ctrl+h, meta+h":{func:"inline.format",params:["superscript"]},"ctrl+l, meta+l":{func:"inline.format",params:["subscript"]},"ctrl+shift+7":{func:"list.toggle",params:["orderedlist"]},"ctrl+shift+8":{func:"list.toggle",params:["unorderedlist"]}},shortcutsAdd:!1,buffer:[],rebuffer:[],emptyHtml:"<p>&#x200b;</p>",invisibleSpace:"&#x200b;",imageTypes:["image/png","image/jpeg","image/gif"],indentValue:20,verifiedTags:["a","img","b","strong","sub","sup","i","em","u","small","strike","del","cite","ul","ol","li"],inlineTags:["strong","b","u","em","i","code","del","ins","samp","kbd","sup","sub","mark","var","cite","small"],alignmentTags:["P","H1","H2","H3","H4","H5","H6","DL","DT","DD","DIV","TD","BLOCKQUOTE","OUTPUT","FIGCAPTION","ADDRESS","SECTION","HEADER","FOOTER","ASIDE","ARTICLE"],blockLevelElements:["PRE","UL","OL","LI"]},d.fn=a.Redactor.prototype={keyCode:{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,SPACE:32,ESC:27,TAB:9,CTRL:17,META:91,SHIFT:16,ALT:18,RIGHT:39,LEFT:37,LEFT_WIN:91},init:function(b,d){this.$element=a(b),this.uuid=c++,this.rtePaste=!1,this.$pasteBox=!1,this.loadOptions(d),this.loadModules(),this.formatting={},a.merge(this.opts.blockLevelElements,this.opts.alignmentTags),this.reIsBlock=new RegExp("^("+this.opts.blockLevelElements.join("|")+")$","i"),this.tidy.setupAllowed(),a.extend(this.opts.shortcuts,this.opts.shortcutsAdd),this.core.setCallback("start"),this.start=!0,this.build.run()
},loadOptions:function(b){this.opts=a.extend({},a.extend(!0,{},a.Redactor.opts),this.$element.data(),b)},getModuleMethods:function(a){return Object.getOwnPropertyNames(a).filter(function(b){return"function"==typeof a[b]})},loadModules:function(){for(var b=a.Redactor.modules.length,c=0;b>c;c++)this.bindModuleMethods(a.Redactor.modules[c])},bindModuleMethods:function(a){if("undefined"!=typeof this[a]){this[a]=this[a]();for(var b=this.getModuleMethods(this[a]),c=b.length,d=0;c>d;d++)this[a][b[d]]=this[a][b[d]].bind(this)
}},block:function(){return{formatting:function(a){this.block.clearStyle=!1;var b,c;"undefined"!=typeof this.formatting[a].data?b="data":"undefined"!=typeof this.formatting[a].attr?b="attr":"undefined"!=typeof this.formatting[a].class&&(b="class"),"undefined"!=typeof this.formatting[a].clear&&(this.block.clearStyle=!0),b&&(c=this.formatting[a][b]),this.block.format(this.formatting[a].tag,b,c)},format:function(b,c,d){"quote"==b&&(b="blockquote");var e=["p","pre","blockquote","h1","h2","h3","h4","h5","h6"];-1!=a.inArray(b,e)&&(this.block.isRemoveInline="pre"==b||-1!=b.search(/h[1-6]/i),this.utils.browser("msie")||this.$editor.focus(),this.block.blocks=this.selection.getBlocks(),this.block.blocksSize=this.block.blocks.length,this.block.type=c,this.block.value=d,this.buffer.set(),this.selection.save(),this.block.set(b),this.selection.restore())
},set:function(a){this.selection.get(),this.block.containerTag=this.range.commonAncestorContainer.tagName,this.range.collapsed?this.block.setCollapsed(a):this.block.setMultiple(a)},setCollapsed:function(b){var c=this.block.blocks[0];if(c!==!1){if("LI"==c.tagName){if("blockquote"!=b)return;return this.block.formatListToBlockquote(),void 0}var d="TD"==this.block.containerTag||"TH"==this.block.containerTag;if(d&&!this.opts.linebreaks)document.execCommand("formatblock",!1,"<"+b+">"),c=this.selection.getBlock(),this.block.toggle(a(c));
else if(c.tagName.toLowerCase()!=b)if(this.opts.linebreaks&&"p"==b)a(c).prepend("<br>").append("<br>"),this.utils.replaceWithContents(c);else{var e=this.utils.replaceToTag(c,b);this.block.toggle(e),"p"!=b&&"blockquote"!=b&&e.find("img").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags(e),("p"==b||this.block.headTag)&&e.find("p").contents().unwrap(),this.block.formatTableWrapping(e)}else if("blockquote"==b&&c.tagName.toLowerCase()==b)if(this.opts.linebreaks)a(c).prepend("<br>").append("<br>"),this.utils.replaceWithContents(c);
else{var f=this.utils.replaceToTag(c,"p");this.block.toggle(f)}else c.tagName.toLowerCase()==b&&this.block.toggle(a(c))}},setMultiple:function(b){var c=this.block.blocks[0],d="TD"==this.block.containerTag||"TH"==this.block.containerTag;if(c!==!1&&1===this.block.blocksSize)if(c.tagName.toLowerCase()==b&&"blockquote"==b)if(this.opts.linebreaks)a(c).prepend("<br>").append("<br>"),this.utils.replaceWithContents(c);else{var e=this.utils.replaceToTag(c,"p");this.block.toggle(e)}else if("LI"==c.tagName){if("blockquote"!=b)return;
this.block.formatListToBlockquote()}else if("BLOCKQUOTE"==this.block.containerTag)this.block.formatBlockquote(b);else if(this.opts.linebreaks&&(d||this.range.commonAncestorContainer!=c))this.block.formatWrap(b);else if(this.opts.linebreaks&&"p"==b)a(c).prepend("<br>").append("<br>"),this.utils.replaceWithContents(c);else if("TD"===c.tagName)this.block.formatWrap(b);else{var f=this.utils.replaceToTag(c,b);this.block.toggle(f),this.block.isRemoveInline&&this.utils.removeInlineTags(f),("p"==b||this.block.headTag)&&f.find("p").contents().unwrap()
}else if(this.opts.linebreaks||"p"!=b){if("blockquote"==b){for(var g=0,h=0;h<this.block.blocksSize;h++)"BLOCKQUOTE"==this.block.blocks[h].tagName&&g++;if(g==this.block.blocksSize)return a.each(this.block.blocks,a.proxy(function(b,c){this.opts.linebreaks?(a(c).prepend("<br>").append("<br>"),this.utils.replaceWithContents(c)):this.utils.replaceToTag(c,"p")},this)),void 0}this.block.formatWrap(b)}else{var i=0,j=!1;"class"==this.block.type&&(j="toggle",i=a(this.block.blocks).filter("."+this.block.value).size(),this.block.blocksSize==i?j="toggle":this.block.blocksSize>i?j="set":0===i&&(j="set"));
var k=["ul","ol","li","td","th","dl","dt","dd"];a.each(this.block.blocks,a.proxy(function(c,d){if(-1==a.inArray(d.tagName.toLowerCase(),k)){var e=this.utils.replaceToTag(d,b);j?"toggle"==j?this.block.toggle(e):"remove"==j?this.block.remove(e):"set"==j&&this.block.setForce(e):this.block.toggle(e),"p"!=b&&"blockquote"!=b&&e.find("img").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags(e),("p"==b||this.block.headTag)&&e.find("p").contents().unwrap()}},this))}},setForce:function(a){return this.block.clearStyle&&a.removeAttr("class").removeAttr("style"),"class"==this.block.type?(a.addClass(this.block.value),void 0):"attr"==this.block.type||"data"==this.block.type?(a.attr(this.block.value.name,this.block.value.value),void 0):void 0
},toggle:function(a){return this.block.clearStyle&&a.removeAttr("class").removeAttr("style"),"class"==this.block.type?(a.toggleClass(this.block.value),void 0):"attr"==this.block.type||"data"==this.block.type?(a.attr(this.block.value.name)==this.block.value.value?a.removeAttr(this.block.value.name):a.attr(this.block.value.name,this.block.value.value),void 0):(a.removeAttr("style class"),void 0)},remove:function(a){a.removeClass(this.block.value)},formatListToBlockquote:function(){var b=a(this.block.blocks[0]).closest("ul, ol");
a(b).find("ul, ol").contents().unwrap(),a(b).find("li").append(a("<br>")).contents().unwrap();var c=this.utils.replaceToTag(b,"blockquote");this.block.toggle(c)},formatBlockquote:function(b){document.execCommand("outdent"),document.execCommand("formatblock",!1,b),this.clean.clearUnverified(),this.$editor.find("p:empty").remove();var c=this.selection.getBlock();"p"!=b&&a(c).find("img").remove(),this.opts.linebreaks||this.block.toggle(a(c)),this.$editor.find("ul, ol, tr, blockquote, p").each(a.proxy(this.utils.removeEmpty,this)),this.opts.linebreaks&&"p"==b&&this.utils.replaceWithContents(c)
},formatWrap:function(b){if("UL"==this.block.containerTag||"OL"==this.block.containerTag){if("blockquote"!=b)return;this.block.formatListToBlockquote()}var c=this.selection.wrap(b);if(c!==!1){var d=a(c);this.block.formatTableWrapping(d);var e=d.find(this.opts.blockLevelElements.join(",")+", td, table, thead, tbody, tfoot, th, tr");(this.opts.linebreaks&&"p"==b||"pre"==b||"blockquote"==b)&&e.append("<br />"),e.contents().unwrap(),"p"!=b&&"blockquote"!=b&&d.find("img").remove(),a.each(this.block.blocks,a.proxy(this.utils.removeEmpty,this)),d.append(this.selection.getMarker(2)),this.opts.linebreaks||this.block.toggle(d),this.$editor.find("ul, ol, tr, blockquote, p").each(a.proxy(this.utils.removeEmpty,this)),d.find("blockquote:empty").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags(d),this.opts.linebreaks&&"p"==b&&this.utils.replaceWithContents(d)
}},formatTableWrapping:function(a){0!==a.closest("table").size()&&(0===a.closest("tr").size()&&a.wrap("<tr>"),0===a.closest("td").size()&&0===a.closest("th").size()&&a.wrap("<td>"))},removeData:function(b){var d=this.selection.getBlocks();a(d).removeAttr("data-"+b)},setData:function(b,c){var d=this.selection.getBlocks();a(d).attr("data-"+b,c)},toggleData:function(b,c){var d=this.selection.getBlocks();a.each(d,function(){a(this).attr("data-"+b)?a(this).removeAttr("data-"+b):a(this).attr("data-"+b,c)})},removeAttr:function(b){var d=this.selection.getBlocks();
a(d).removeAttr(b)},setAttr:function(b,c){var d=this.selection.getBlocks();a(d).attr(b,c)},toggleAttr:function(b,c){var d=this.selection.getBlocks();a.each(d,function(){a(this).attr(name)?a(this).removeAttr(name):a(this).attr(name,c)})},removeClass:function(b){var c=this.selection.getBlocks();a(c).removeClass(b),this.utils.removeEmptyAttr(c,"class")},setClass:function(b){var c=this.selection.getBlocks();a(c).addClass(b)},toggleClass:function(b){var c=this.selection.getBlocks();a(c).toggleClass(b)}}},buffer:function(){return{set:function(a){"undefined"==typeof a||"undo"==a?this.buffer.setUndo():this.buffer.setRedo()
},setUndo:function(){this.selection.save(),this.opts.buffer.push(this.$editor.html()),this.selection.restore()},setRedo:function(){this.selection.save(),this.opts.rebuffer.push(this.$editor.html()),this.selection.restore()},getUndo:function(){this.$editor.html(this.opts.buffer.pop())},getRedo:function(){this.$editor.html(this.opts.rebuffer.pop())},add:function(){this.opts.buffer.push(this.$editor.html())},undo:function(){0!==this.opts.buffer.length&&(this.buffer.set("redo"),this.buffer.getUndo(),this.selection.restore())
},redo:function(){0!==this.opts.rebuffer.length&&(this.buffer.set("undo"),this.buffer.getRedo(),this.selection.restore())}}},build:function(){return{run:function(){this.build.createContainerBox(),this.build.loadEditor(),this.build.enableEditor(),this.build.setCodeAndCall()},createContainerBox:function(){this.$box=this.$element},enableEditor:function(){this.$editor.attr({dir:this.opts.direction})},loadEditor:function(){this.$editor=this.$element},setCodeAndCall:function(){this.build.setOptions(),this.build.callEditor()
},callEditor:function(){this.build.disableMozillaEditing(),this.build.setEvents(),this.build.setHelpers(),this.opts.toolbar&&(this.opts.toolbar=this.toolbar.init(),this.toolbar.build()),this.build.plugins(),this.core.setCallback("init")},setOptions:function(){this.opts.linebreaks&&this.$editor.addClass("redactor-linebreaks"),this.opts.tabindex&&this.$editor.attr("tabindex",this.opts.tabindex)},setEvents:function(){this.$editor.on("drop.redactor",a.proxy(function(b){if(b=b.originalEvent||b,void 0===window.FormData||!b.dataTransfer)return!0;
var c=b.dataTransfer.files.length;return 0===c?(setTimeout(a.proxy(this.clean.clearUnverified,this),1),this.core.setCallback("drop",b),!0):(b.preventDefault(),setTimeout(a.proxy(this.clean.clearUnverified,this),1),this.core.setCallback("drop",b),void 0)},this)),this.$editor.on("click.redactor",a.proxy(function(a){var b="click";("click"==this.core.getEvent()||"arrow"==this.core.getEvent())&&(b=!1),this.core.addEvent(b),this.core.setCallback("click",a)},this)),this.$editor.on("paste.redactor",a.proxy(this.paste.init,this)),this.$editor.on("keydown.redactor",a.proxy(this.keydown.init,this)),this.$editor.on("keyup.redactor",a.proxy(this.keyup.init,this)),this.$editor.on("dragstart.redactor",function(a,b){b||(a.preventDefault(),a.stopPropagation())
}),a.isFunction(this.opts.focusCallback)&&this.$editor.on("focus.redactor",a.proxy(this.opts.focusCallback,this));var b;a(document).on("mousedown",function(c){b=a(c.target)})},setHelpers:function(){this.opts.focus&&setTimeout(a.proxy(this.focus.setStart,this),100),this.opts.focusEnd&&setTimeout(a.proxy(this.focus.setEnd,this),100)},plugins:function(){this.opts.plugins&&RedactorPlugins&&a.each(this.opts.plugins,a.proxy(function(b,c){if("undefined"!=typeof RedactorPlugins[c]){if(-1!==a.inArray(c,a.Redactor.modules))return a.error('Plugin name "'+c+"\" matches the name of the Redactor's module."),void 0;
if(a.isFunction(RedactorPlugins[c])){this[c]=RedactorPlugins[c]();for(var d=this.getModuleMethods(this[c]),e=d.length,f=0;e>f;f++)this[c][d[f]]=this[c][d[f]].bind(this);a.isFunction(this[c].init)&&this[c].init()}}},this))},disableMozillaEditing:function(){if(this.utils.browser("mozilla")){document.designMode="on";try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(a){}document.designMode="off"}}}},caret:function(){return{setStart:function(b){if(this.utils.isBlock(b))this.caret.set(b,0,b,0);
else{var c=this.utils.createSpaceElement();a(b).prepend(c),this.caret.setEnd(c)}},setEnd:function(a){this.caret.set(a,1,a,1)},set:function(b,c,d,e){if(this.utils.browser("msie")||this.$editor.focus(),b=b[0]||b,d=d[0]||d,this.utils.isBlockTag(b.tagName)&&""===b.innerHTML&&(b.innerHTML=this.opts.invisibleSpace),"BR"==b.tagName&&this.opts.linebreaks===!1){var f=a(this.opts.emptyHtml)[0];a(b).replaceWith(f),b=f,d=b}this.selection.get();try{this.range.setStart(b,c),this.range.setEnd(d,e)}catch(g){}this.selection.addRange()
},setAfter:function(b){try{var c=a(b)[0].tagName;if("BR"==c||this.utils.isBlock(b))"BR"!=c&&this.utils.browser("msie")?this.caret.setStart(a(b).next()):this.caret.setAfterOrBefore(b,"after");else{var d=this.utils.createSpaceElement();a(b).after(d),this.caret.setEnd(d)}}catch(e){var d=this.utils.createSpaceElement();a(b).after(d),this.caret.setEnd(d)}},setBefore:function(b){this.utils.isBlock(b)?this.caret.setEnd(a(b).prev()):this.caret.setAfterOrBefore(b,"before")},setAfterOrBefore:function(a,b){if(this.utils.browser("msie")||this.$editor.focus(),a=a[0]||a,this.selection.get(),"after"==b)try{this.range.setStartAfter(a),this.range.setEndAfter(a)
}catch(c){}else try{this.range.setStartBefore(a),this.range.setEndBefore(a)}catch(c){}this.range.collapse(!1),this.selection.addRange()},getOffsetOfElement:function(b){b=b[0]||b,this.selection.get();var c=this.range.cloneRange();return c.selectNodeContents(b),c.setEnd(this.range.endContainer,this.range.endOffset),a.trim(c.toString()).length},getOffset:function(){var a=0,b=window.getSelection();if(b.rangeCount>0){var c=window.getSelection().getRangeAt(0),d=c.cloneRange();d.selectNodeContents(this.$editor[0]),d.setEnd(c.endContainer,c.endOffset),a=d.toString().length
}return a},setOffset:function(a,b){"undefined"==typeof b&&(b=a),this.focus.isFocused()||this.focus.setStart();for(var d,e=(this.selection.get(),0),f=document.createTreeWalker(this.$editor[0],NodeFilter.SHOW_TEXT,null,null);d=f.nextNode();)if(e+=d.nodeValue.length,e>a&&(this.range.setStart(d,d.nodeValue.length+a-e),a=1/0),e>=b){this.range.setEnd(d,d.nodeValue.length+b-e);break}this.range.collapse(!1),this.selection.addRange()},setToPoint:function(a,b){this.caret.setOffset(a,b)},getCoords:function(){return this.caret.getOffset()
}}},clean:function(){return{onSet:function(b){b=this.clean.savePreCode(b),b=b.replace(/<script(.*?[^>]?)>([\w\W]*?)<\/script>/gi,'<pre class="redactor-script-tag" style="display: none;" $1>$2</pre>'),b=b.replace(/\$/g,"&#36;"),b=b.replace(/\u201d/g,'"'),b=b.replace(/\u2018/g,"'"),b=b.replace(/\u2019/g,"'"),this.opts.replaceDivs&&(b=this.clean.replaceDivs(b)),this.opts.linebreaks&&(b=this.clean.replaceParagraphsToBr(b)),b=this.clean.saveFormTags(b);var c=a("<div>");c.html(b);var d=c.find("font[style]");return 0!==d.length&&(d.replaceWith(function(){var b=a(this),c=a("<span>").attr("style",b.attr("style"));
return c.append(b.contents())}),b=c.html()),c.remove(),b=b.replace(/<font(.*?[^<])>/gi,""),b=b.replace(/<\/font>/gi,""),b=this.tidy.load(b),this.opts.paragraphize&&(b=this.paragraphize.load(b)),b=this.clean.setVerified(b),b=this.clean.convertInline(b)},onSync:function(b){if(b=b.replace(/[\u200B-\u200D\uFEFF]/g,""),b=b.replace(/&#x200b;/gi,""),this.opts.cleanSpaces&&(b=b.replace(/&nbsp;/gi," ")),-1!=b.search(/^<p>(||\s||<br\s?\/?>||&nbsp;)<\/p>$/i))return"";b=b.replace(/<pre class="redactor-script-tag" style="display: none;"(.*?[^>]?)>([\w\W]*?)<\/pre>/gi,"<script$1>$2</script>"),b=this.clean.restoreFormTags(b);
var c={"\u2122":"&trade;","\xa9":"&copy;","\u2026":"&hellip;","\u2014":"&mdash;","\u2010":"&dash;"};return a.each(c,function(a,c){b=b.replace(new RegExp(a,"g"),c)}),b=b.replace(new RegExp("<br\\s?/?></li>","gi"),"</li>"),b=b.replace(new RegExp("</li><br\\s?/?>","gi"),"</li>"),b=b.replace(new RegExp('<div(.*?[^>]) data-tagblock="redactor"(.*?[^>])>',"gi"),"<div$1$2>"),b=b.replace(new RegExp('<(.*?) data-verified="redactor"(.*?[^>])>',"gi"),"<$1$2>"),b=b.replace(new RegExp('<span(.*?[^>])srel="(.*?[^>])"(.*?[^>])>',"gi"),"<span$1$3>"),b=b.replace(new RegExp('<img(.*?[^>])srel="(.*?[^>])"(.*?[^>])>',"gi"),"<img$1$3>"),b=b.replace(new RegExp('<img(.*?[^>])sstyle="" (.*?[^>])>',"gi"),"<img$1 $2>"),b=b.replace(new RegExp("<img(.*?[^>])sstyle (.*?[^>])>","gi"),"<img$1 $2>"),b=b.replace(new RegExp('<span class="redactor-invisible-space">(.*?)</span>',"gi"),"$1"),b=b.replace(/ data-save-url="(.*?[^>])"/gi,""),b=b.replace(/<span(.*?)id="redactor-image-box"(.*?[^>])>([\w\W]*?)<img(.*?)><\/span>/gi,"$3<img$4>"),b=b.replace(/<span(.*?)id="redactor-image-resizer"(.*?[^>])>(.*?)<\/span>/gi,""),b=b.replace(/<span(.*?)id="redactor-image-editter"(.*?[^>])>(.*?)<\/span>/gi,""),b=b.replace(/<font(.*?[^<])>/gi,""),b=b.replace(/<\/font>/gi,""),b=this.tidy.load(b),this.opts.linkNofollow&&(b=b.replace(/<a(.*?)rel="nofollow"(.*?[^>])>/gi,"<a$1$2>"),b=b.replace(/<a(.*?[^>])>/gi,'<a$1 rel="nofollow">')),b=b.replace(/<(.*?) data-redactor-tag="(.*?)"(.*?[^>])>/gi,"<$1$3>"),b=b.replace(/<(.*?) data-redactor-class="(.*?)"(.*?[^>])>/gi,"<$1$3>"),b=b.replace(/<(.*?) data-redactor-style="(.*?)"(.*?[^>])>/gi,"<$1$3>"),b=b.replace(new RegExp('<(.*?) data-verified="redactor"(.*?[^>])>',"gi"),"<$1$2>"),b=b.replace(new RegExp('<(.*?) data-verified="redactor">',"gi"),"<$1>")
},onPaste:function(b,c){if(b=a.trim(b),b=b.replace(/\$/g,"&#36;"),b=b.replace(/\u201d/g,'"'),b=b.replace(/\u201c/g,'"'),b=b.replace(/\u2018/g,"'"),b=b.replace(/\u2019/g,"'"),b=b.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),b=b.replace(/<span class="Apple-tab-span"[^>]*>\t<\/span>/gi,"	"),b=b.replace(/<span[^>]*>(\s|&nbsp;)<\/span>/gi," "),this.opts.pastePlainText)return b=this.clean.getPlainText(b),b=this.clean.onPasteTidy(b,"all");if("undefined"==typeof c){if(this.utils.isCurrentOrParent(["FIGCAPTION","A"]))return this.clean.getPlainText(b,!1);
if(this.utils.isCurrentOrParent("PRE"))return this.clean.getPreCode(b);if(this.utils.isCurrentOrParent(["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"])){if(b=this.clean.getOnlyImages(b),b=this.clean.onPasteWord(b),b=this.clean.onPasteExtra(b),b=this.clean.onPasteTidy(b,"all"),!this.utils.browser("msie")){var d=this.selection.getBlock();d&&"P"==d.tagName&&(b=b.replace(/<img(.*?)>/gi,"<p><img$1></p>"))}return b}if(this.utils.isCurrentOrParent(["TD"]))return b=this.clean.onPasteTidy(b,"td"),this.opts.linebreaks&&(b=this.clean.replaceParagraphsToBr(b)),b=this.clean.replaceDivsToBr(b);
if(this.utils.isCurrentOrParent(["LI"]))return this.clean.onPasteTidy(b,"li")}return b=this.clean.isSingleLine(b,c),this.clean.singleLine||(this.opts.linebreaks&&(b=this.clean.replaceParagraphsToBr(b)),this.opts.replaceDivs&&(b=this.clean.replaceDivs(b)),b=this.clean.saveFormTags(b)),b=this.clean.onPasteWord(b),b=this.clean.onPasteExtra(b),b=this.clean.onPasteTidy(b,"all"),!this.clean.singleLine&&this.opts.paragraphize&&(b=this.paragraphize.load(b)),b=this.clean.removeDirtyStyles(b),b=this.clean.onPasteRemoveSpans(b),b=this.clean.onPasteRemoveEmpty(b),b=this.clean.convertInline(b)
},onPasteWord:function(a){return a=a.replace(/<!--[\s\S]*?-->/gi,""),a=a.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,""),/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(a)&&(a=this.clean.onPasteIeFixLinks(a),a=a.replace(/<img(.*?)v:shapes=(.*?)>/gi,""),a=a.replace(/src="file\:\/\/(.*?)"/,'src=""'),a=a.replace(/<p(.*?)class="MsoListParagraphCxSpFirst"([\w\W]*?)<\/p>/gi,"<ul><li$2</li>"),a=a.replace(/<p(.*?)class="MsoListParagraphCxSpMiddle"([\w\W]*?)<\/p>/gi,"<li$2</li>"),a=a.replace(/<p(.*?)class="MsoListParagraphCxSpLast"([\w\W]*?)<\/p>/gi,"<li$2</li></ul>"),a=a.replace(/<p(.*?)class="MsoListParagraph"([\w\W]*?)<\/p>/gi,"<ul><li$2</li></ul>"),a=a.replace(/\xb7/g,""),a=a.replace(/<p class="Mso(.*?)"/gi,"<p"),a=a.replace(/ class=\"(mso[^\"]*)\"/gi,""),a=a.replace(/ class=(mso\w+)/gi,""),a=a.replace(/<o:p(.*?)>([\w\W]*?)<\/o:p>/gi,"$2"),a=a.replace(/\n/g," "),a=a.replace(/<p>\n?<li>/gi,"<li>")),this.opts.cleanSpaces&&(a=a.replace(/(\s|&nbsp;)+/g," ")),a
},onPasteExtra:function(a){return a=a.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),a=a.replace(/<b(.*?)id="docs-internal-guid(.*?)">([\w\W]*?)<\/b>/gi,"$3"),a=a.replace(/<span[^>]*(font-style: italic; font-weight: bold|font-weight: bold; font-style: italic)[^>]*>/gi,'<span style="font-weight: bold;"><span style="font-style: italic;">'),a=a.replace(/<span[^>]*font-style: italic[^>]*>/gi,'<span style="font-style: italic;">'),a=a.replace(/<span[^>]*font-weight: bold[^>]*>/gi,'<span style="font-weight: bold;">'),a=a.replace(/<span[^>]*text-decoration: underline[^>]*>/gi,'<span style="text-decoration: underline;">'),a=a.replace(/<img>/gi,""),a=a.replace(/\n{3,}/gi,"\n"),a=a.replace(/<font(.*?)>([\w\W]*?)<\/font>/gi,"$2"),a=a.replace(/<p><p>/gi,"<p>"),a=a.replace(/<\/p><\/p>/gi,"</p>"),a=a.replace(/<li>(\s*|\t*|\n*)<p>/gi,"<li>"),a=a.replace(/<\/p>(\s*|\t*|\n*)<\/li>/gi,"</li>"),a=a.replace(/<\/p>\s<p/gi,"</p><p"),a=a.replace(/<img src="webkit-fake-url\:\/\/(.*?)"(.*?)>/gi,""),a=a.replace(/<p>\u2022([\w\W]*?)<\/p>/gi,"<li>$1</li>"),this.utils.browser("mozilla")&&(a=a.replace(/<br\s?\/?>$/gi,"")),a
},onPasteTidy:function(a,b){var c=["span","a","pre","blockquote","small","em","strong","code","kbd","mark","address","cite","var","samp","dfn","sup","sub","b","i","u","del","ol","ul","li","dl","dt","dd","p","br","video","audio","iframe","embed","param","object","img","table","td","th","tr","tbody","tfoot","thead","h1","h2","h3","h4","h5","h6"],d=!1,e=[["a","*"],["img",["src","alt"]],["span",["class","rel","data-verified"]],["iframe","*"],["video","*"],["audio","*"],["embed","*"],["object","*"],["param","*"],["source","*"]];
"all"==b?(d=["p","span","h1","h2","h3","h4","h5","h6"],e=[["table","class"],["td",["colspan","rowspan"]],["a","*"],["img",["src","alt","data-redactor-inserted-image"]],["span",["class","rel","data-verified"]],["iframe","*"],["video","*"],["audio","*"],["embed","*"],["object","*"],["param","*"],["source","*"]]):"td"==b?c=["ul","ol","li","span","a","small","em","strong","code","kbd","mark","cite","var","samp","dfn","sup","sub","b","i","u","del","ol","ul","li","dl","dt","dd","br","iframe","video","audio","embed","param","object","img","h1","h2","h3","h4","h5","h6"]:"li"==b&&(c=["ul","ol","li","span","a","small","em","strong","code","kbd","mark","cite","var","samp","dfn","sup","sub","b","i","u","del","br","iframe","video","audio","embed","param","object","img"]);
var f={deniedTags:!1,allowedTags:c,removeComments:!0,removePhp:!0,removeAttr:!1,allowedAttr:e,removeEmpty:d};return this.tidy.load(a,f)},onPasteRemoveEmpty:function(a){return a=a.replace(/<(p|h[1-6])>(|\s|\n|\t|<br\s?\/?>)<\/(p|h[1-6])>/gi,""),this.opts.linebreaks||(a=a.replace(/<br>$/i,"")),a},onPasteRemoveSpans:function(a){return a=a.replace(/<span>(.*?)<\/span>/gi,"$1"),a=a.replace(/<span[^>]*>\s|&nbsp;<\/span>/gi," ")},onPasteIeFixLinks:function(b){if(!this.utils.browser("msie"))return b;var c=a.trim(b);
return 0===c.search(/^<a(.*?)>(.*?)<\/a>$/i)&&(b=b.replace(/^<a(.*?)>(.*?)<\/a>$/i,"$2")),b},isSingleLine:function(a,b){if(this.clean.singleLine=!1,"undefined"==typeof b){var c=this.opts.blockLevelElements.join("|").replace("P|","").replace("DIV|",""),d=a.match(new RegExp("</("+c+")>","gi")),e=a.match(/<\/(p|div)>/gi);if(!d&&(null===e||e&&e.length<=1)){var f=a.match(/<br\s?\/?>/gi),g=a.match(/<img(.*?[^>])>/gi);f||g||(this.clean.singleLine=!0,a=a.replace(/<\/?(p|div)(.*?)>/gi,""))}}return a},stripTags:function(a,b){b=(((b||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");
var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return a.replace(c,function(a,c){return b.indexOf("<"+c.toLowerCase()+">")>-1?a:""})},savePreCode:function(b){var c=b.match(/<(pre|code)(.*?)>([\w\W]*?)<\/(pre|code)>/gi);return null!==c&&a.each(c,a.proxy(function(a,c){var d=c.match(/<(pre|code)(.*?)>([\w\W]*?)<\/(pre|code)>/i);d[3]=d[3].replace(/<br\s?\/?>/g,"\n"),d[3]=d[3].replace(/&nbsp;/g," "),this.opts.preSpaces&&(d[3]=d[3].replace(/\t/g,Array(this.opts.preSpaces+1).join(" "))),d[3]=this.clean.encodeEntities(d[3]),d[3]=d[3].replace(/\$/g,"&#36;"),b=b.replace(c,"<"+d[1]+d[2]+">"+d[3]+"</"+d[1]+">")
},this)),b},getTextFromHtml:function(b){b=b.replace(/<br\s?\/?>|<\/H[1-6]>|<\/p>|<\/div>|<\/li>|<\/td>/gi,"\n");var c=document.createElement("div");return c.innerHTML=b,b=c.textContent||c.innerText,a.trim(b)},getPlainText:function(a){return a=this.clean.getTextFromHtml(a),a=a.replace(/\n/g,"<br />")},getPreCode:function(a){return a=a.replace(/<img(.*?) style="(.*?)"(.*?[^>])>/gi,"<img$1$3>"),a=a.replace(/<img(.*?)>/gi,"&lt;img$1&gt;"),a=this.clean.getTextFromHtml(a),this.opts.preSpaces&&(a=a.replace(/\t/g,Array(this.opts.preSpaces+1).join(" "))),a=this.clean.encodeEntities(a)
},getOnlyImages:function(a){return a=a.replace(/<img(.*?)>/gi,"[img$1]"),a=a.replace(/<([Ss]*?)>/gi,""),a=a.replace(/\[img(.*?)\]/gi,"<img$1>")},getOnlyLinksAndImages:function(a){return a=a.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]'),a=a.replace(/<img(.*?)>/gi,"[img$1]"),a=a.replace(/<(.*?)>/gi,""),a=a.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>'),a=a.replace(/\[img(.*?)\]/gi,"<img$1>")},encodeEntities:function(a){return a=String(a).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'),a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")
},removeDirtyStyles:function(b){if(this.utils.browser("msie"))return b;var c=document.createElement("div");return c.innerHTML=b,this.clean.clearUnverifiedRemove(a(c)),b=c.innerHTML,a(c).remove(),b},clearUnverified:function(){this.utils.browser("msie")||this.clean.clearUnverifiedRemove(this.$editor)},clearUnverifiedRemove:function(b){b.find("span").not('[data-verified="redactor"]').removeAttr("style"),b.find('span[data-verified="redactor"], img[data-verified="redactor"]').each(function(b,c){var d=a(c);d.attr("style",d.attr("rel"))
})},setVerified:function(a){if(this.utils.browser("msie"))return a;a=a.replace(new RegExp("<img(.*?[^>])>","gi"),'<img$1 data-verified="redactor">'),a=a.replace(new RegExp("<span(.*?)>","gi"),'<span$1 data-verified="redactor">');var b=a.match(new RegExp('<(span|img)(.*?)style="(.*?)"(.*?[^>])>',"gi"));if(b)for(var c=b.length,d=0;c>d;d++)try{var e=b[d].replace(/style="(.*?)"/i,'style="$1" rel="$1"');a=a.replace(new RegExp(b[d],"gi"),e)}catch(f){}return a},convertInline:function(b){var c=a("<div />").html(b),d=this.opts.inlineTags;
return d.push("span"),c.find(d.join(",")).each(function(){var b=a(this),c=this.tagName.toLowerCase();b.attr("data-redactor-tag",c),"span"==c&&(b.attr("style")?b.attr("data-redactor-style",b.attr("style")):b.attr("class")&&b.attr("data-redactor-class",b.attr("class")))}),b=c.html(),c.remove(),b},normalizeLists:function(){this.$editor.find("li").each(function(b,c){var d=a(c).next();0===d.length||"UL"!=d[0].tagName&&"OL"!=d[0].tagName||a(c).append(d)})},removeSpaces:function(a){return a=a.replace(/\n/g,""),a=a.replace(/[\t]*/g,""),a=a.replace(/\n\s*\n/g,"\n"),a=a.replace(/^[\s\n]*/g," "),a=a.replace(/[\s\n]*$/g," "),a=a.replace(/>\s{2,}</g,"> <"),a=a.replace(/\n\n/g,"\n"),a=a.replace(/[\u200B-\u200D\uFEFF]/g,"")
},replaceDivs:function(a){return this.opts.linebreaks?(a=a.replace(/<div><br\s?\/?><\/div>/gi,"<br />"),a=a.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"$2<br />")):a=a.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p$1>$2</p>"),a},replaceDivsToBr:function(a){return a=a.replace(/<div\s(.*?)>/gi,"<p>"),a=a.replace(/<div><br\s?\/?><\/div>/gi,"<br /><br />"),a=a.replace(/<div>([\w\W]*?)<\/div>/gi,"$1<br /><br />")},replaceParagraphsToBr:function(a){return a=a.replace(/<p\s(.*?)>/gi,"<p>"),a=a.replace(/<p><br\s?\/?><\/p>/gi,"<br />"),a=a.replace(/<p>([\w\W]*?)<\/p>/gi,"$1<br /><br />"),a=a.replace(/(<br\s?\/?>){1,}\n?<\/blockquote>/gi,"</blockquote>")
},saveFormTags:function(a){return a.replace(/<form(.*?)>([\w\W]*?)<\/form>/gi,'<section$1 rel="redactor-form-tag">$2</section>')},restoreFormTags:function(a){return a.replace(/<section(.*?) rel="redactor-form-tag"(.*?)>([\w\W]*?)<\/section>/gi,"<form$1$2>$3</form>")}}},core:function(){return{getObject:function(){return a.extend({},this)},getEditor:function(){return this.$editor},getBox:function(){return this.$box},getElement:function(){return this.$element},addEvent:function(a){this.core.event=a},getEvent:function(){return this.core.event
},setCallback:function(b,c,d){var e=this.opts[b+"Callback"];return a.isFunction(e)?"undefined"==typeof d?e.call(this,c):e.call(this,c,d):"undefined"==typeof d?c:d},destroy:function(){this.core.setCallback("destroy"),this.$element.off(".redactor").removeData("redactor"),this.$editor.off(".redactor"),this.$pasteBox&&this.$pasteBox.remove(),a(".redactor-toolbar-tooltip").remove()}}},focus:function(){return{setStart:function(){this.$editor.focus();var a=this.$editor.children().first();if(0!==a.size()&&0!==a[0].length&&"BR"!=a[0].tagName&&3!=a[0].nodeType){if("UL"==a[0].tagName||"OL"==a[0].tagName){a=a.find("li").first();
var b=a.children().first();if(!this.utils.isBlock(b)&&""===b.text())return this.caret.setStart(b),void 0}return this.opts.linebreaks&&!this.utils.isBlockTag(a[0].tagName)?(this.selection.get(),this.range.setStart(this.$editor[0],0),this.range.setEnd(this.$editor[0],0),this.selection.addRange(),void 0):(this.caret.setStart(a),void 0)}},setEnd:function(){if(this.utils.browser("mozilla")||this.utils.browser("msie")){var a=this.$editor.children().last();this.caret.setEnd(a)}else{this.selection.get();try{this.range.selectNodeContents(this.$editor[0]),this.range.collapse(!1),this.selection.addRange()
}catch(b){}}},isFocused:function(){var a=document.getSelection().focusNode;return null===a?!1:this.utils.isRedactorParent(a.parentNode)?this.$editor.is(":focus"):!1}}},indent:function(){return{increase:function(){this.utils.browser("msie")||this.$editor.focus(),this.buffer.set(),this.selection.save();var b=this.selection.getBlock();b&&"LI"==b.tagName?this.indent.increaseLists():b===!1&&this.opts.linebreaks?this.indent.increaseText():this.indent.increaseBlocks(),setTimeout(a.proxy(function(){this.selection.restore()
},this),1)},increaseLists:function(){document.execCommand("indent"),this.indent.fixEmptyIndent(),this.clean.normalizeLists(),this.clean.clearUnverified()},increaseBlocks:function(){a.each(this.selection.getBlocks(),a.proxy(function(a,b){if("TD"!==b.tagName&&"TH"!==b.tagName){var c=this.utils.getAlignmentElement(b),d=this.utils.normalize(c.css("margin-left"))+this.opts.indentValue;c.css("margin-left",d+"px")}},this))},increaseText:function(){var b=this.selection.wrap("div");a(b).attr("data-tagblock","redactor"),a(b).css("margin-left",this.opts.indentValue+"px")
},decrease:function(){this.buffer.set(),this.selection.save();var a=this.selection.getBlock();a&&"LI"==a.tagName?this.indent.decreaseLists():this.indent.decreaseBlocks(),this.selection.restore()},decreaseLists:function(){document.execCommand("outdent");var b=this.selection.getCurrent(),c=a(b).closest("li"),d=c.parent();0!==c.size()&&0!==d.size()&&"LI"==d[0].tagName&&d.after(c),this.indent.fixEmptyIndent(),this.opts.linebreaks||0!==c.size()||(document.execCommand("formatblock",!1,"p"),this.$editor.find("ul, ol, blockquote, p").each(a.proxy(this.utils.removeEmpty,this))),this.clean.clearUnverified()
},decreaseBlocks:function(){a.each(this.selection.getBlocks(),a.proxy(function(a,b){var c=this.utils.getAlignmentElement(b),d=this.utils.normalize(c.css("margin-left"))-this.opts.indentValue;0>=d?this.opts.linebreaks&&"undefined"!=typeof c.data("tagblock")?c.replaceWith(c.html()+"<br />"):(c.css("margin-left",""),this.utils.removeEmptyAttr(c,"style")):c.css("margin-left",d+"px")},this))},fixEmptyIndent:function(){var b=this.selection.getBlock();if(this.range.collapsed&&b&&"LI"==b.tagName&&this.utils.isEmpty(a(b).text())){var c=a(b);
c.find("span").not(".redactor-selection-marker").contents().unwrap(),c.append("<br>")}}}},inline:function(){return{formatting:function(a){var b,c;"undefined"!=typeof this.formatting[a].style?b="style":"undefined"!=typeof this.formatting[a].class&&(b="class"),b&&(c=this.formatting[a][b]),this.inline.format(this.formatting[a].tag,b,c)},format:function(a,b,c,d){if(!this.utils.isCurrentOrParent("PRE")){void 0==d&&(d=!0);for(var e=["b","bold","i","italic","underline","strikethrough","deleted","superscript","subscript"],f=["strong","strong","em","em","u","del","del","sup","sub"],g=0;g<e.length;g++)a==e[g]&&(a=f[g]);
this.inline.type=b||!1,this.inline.value=c||!1,this.buffer.set(),this.$editor.focus(),this.selection.get(),this.range.collapsed?this.inline.formatCollapsed(a):this.inline.formatMultiple(a,d)}},formatCollapsed:function(b){var c=this.selection.getCurrent(),d=a(c).closest(b+"[data-redactor-tag="+b+"]");if(0!==d.size())return this.caret.setAfter(d[0]),this.utils.isEmpty(d.text())&&d.remove(),void 0;var e=a("<"+b+">").attr("data-verified","redactor").attr("data-redactor-tag",b);e.html(this.opts.invisibleSpace),e=this.inline.setFormat(e);
var e=this.insert.node(e);this.caret.setEnd(e)},formatMultiple:function(b,c){if(this.inline.formatConvert(b),void 0==c&&(c=!0),c&&this.selection.save(),document.execCommand("strikethrough"),this.$editor.find("strike").each(a.proxy(function(c,d){var e=a(d),f="";"span"==b&&"style"==this.inline.type&&(f=this.inline.formatGetSelectionStyling(e,b)),this.inline.formatRemoveSameChildren(e,b);var g;if(this.inline.type?(g=a("<span>").attr("data-redactor-tag",b).attr("data-verified","redactor"),g=this.inline.setFormat(g)):g=a("<"+b+">").attr("data-redactor-tag",b).attr("data-verified","redactor"),f){var h=this.inline.value+"; "+f;
g[0].style.cssText=h,g.attr("data-redactor-style",h)}if(e.replaceWith(g.html(e.contents())),"span"==b){var i=g.parent();if(i&&"SPAN"==i[0].tagName&&"style"==this.inline.type)for(var j=this.inline.value.split(";"),k=0;k<j.length;k++){if(""===j[k])return;var l=j[k].split(":");i.css(l[0],""),this.utils.removeEmptyAttr(i,"style")&&i.replaceWith(i.contents())}}},this)),"span"!=b&&this.$editor.find(this.opts.inlineTags.join(", ")).each(a.proxy(function(b,c){var d=a(c),e=d.css("text-decoration");"line-through"==e&&(d.css("text-decoration",""),this.utils.removeEmptyAttr(d,"style"))
},this)),"del"!=b){var d=this;this.$editor.find("inline").each(function(a,b){d.utils.replaceToTag(b,"del")})}c&&this.selection.restore()},formatGetSelectionStyling:function(b,c){var d="",e=[],f='[data-redactor-tag="'+c+'"][data-redactor-style]',g=this.inline.value.split(":")[0];return b.children(f).each(function(){var b=a(this),c=b.data("redactor-style"),d=c.split(";");a.each(d,function(a,b){-1===b.indexOf(g)&&e.push(b)})}),e.length>0&&(d=e.join("; ")),d},formatRemoveSameChildren:function(b,c){b.children(c).each(function(){var b=a(this);
b.hasClass("redactor-selection-marker")||b.contents().unwrap()})},formatConvert:function(b){this.selection.save();var c="";if("class"==this.inline.type?c="[data-redactor-class="+this.inline.value+"]":"style"==this.inline.type&&(c='[data-redactor-style="'+this.inline.value+'"]'),"del"!=b){var d=this;this.$editor.find("del").each(function(a,b){d.utils.replaceToTag(b,"inline")})}this.$editor.find('[data-redactor-tag="'+b+'"]'+c).each(function(){if(""!==c||"span"!=b||this.tagName.toLowerCase()!=b){var d=a(this);
d.replaceWith(a("<strike />").html(d.contents()))}}),this.selection.restore()},setFormat:function(a){switch(this.inline.type){case"class":a.hasClass(this.inline.value)?(a.removeClass(this.inline.value),a.removeAttr("data-redactor-class")):(a.addClass(this.inline.value),a.attr("data-redactor-class",this.inline.value));break;case"style":a[0].style.cssText=this.inline.value,a.attr("data-redactor-style",this.inline.value)}return a},removeStyle:function(){this.buffer.set();var b=this.selection.getCurrent(),c=this.selection.getInlines();
if(this.selection.save(),b&&"SPAN"===b.tagName){var d=a(b);d.removeAttr("style"),0===d[0].attributes.length&&d.replaceWith(d.contents())}a.each(c,a.proxy(function(b,c){var d=a(c);-1==a.inArray(c.tagName.toLowerCase(),this.opts.inlineTags)||d.hasClass("redactor-selection-marker")||(d.removeAttr("style"),0===d[0].attributes.length&&d.replaceWith(d.contents()))},this)),this.selection.restore()},removeStyleRule:function(b){this.buffer.set();var c=this.selection.getParent(),d=this.selection.getInlines();if(this.selection.save(),c&&"SPAN"===c.tagName){var e=a(c);
e.css(b,""),this.utils.removeEmptyAttr(e,"style"),0===e[0].attributes.length&&e.replaceWith(e.contents())}a.each(d,a.proxy(function(c,d){var e=a(d);-1==a.inArray(d.tagName.toLowerCase(),this.opts.inlineTags)||e.hasClass("redactor-selection-marker")||(e.css(b,""),this.utils.removeEmptyAttr(e,"style"),0===e[0].attributes.length&&e.replaceWith(e.contents()))},this)),this.selection.restore()},removeFormat:function(){this.buffer.set();var b=this.selection.getCurrent();this.selection.save(),document.execCommand("removeFormat"),b&&"SPAN"===b.tagName&&a(b).replaceWith(a(b).contents()),a.each(this.selection.getNodes(),a.proxy(function(b,c){var d=a(c);
-1==a.inArray(c.tagName.toLowerCase(),this.opts.inlineTags)||d.hasClass("redactor-selection-marker")||d.replaceWith(d.contents())},this)),this.selection.restore()},toggleClass:function(a){this.inline.format("span","class",a)},toggleStyle:function(a,b){void 0==b&&(b=!0),this.inline.format("span","style",a,b)}}},insert:function(){return{set:function(b,c){b=this.clean.setVerified(b),"undefined"==typeof c&&(b=this.clean.onPaste(b,!1)),this.$editor.html(b),this.selection.remove(),this.focus.setEnd(),this.clean.normalizeLists(),"undefined"==typeof c&&setTimeout(a.proxy(this.clean.clearUnverified,this),10)
},text:function(b){if(b=b.toString(),b=a.trim(b),b=this.clean.getPlainText(b,!1),this.$editor.focus(),this.utils.browser("msie"))this.insert.htmlIe(b);else{this.selection.get(),this.range.deleteContents();var c=document.createElement("div");c.innerHTML=b;for(var e,f,d=document.createDocumentFragment();e=c.firstChild;)f=d.appendChild(e);if(this.range.insertNode(d),f){var g=this.range.cloneRange();g.setStartAfter(f),g.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(g)}}this.clean.clearUnverified()},htmlWithoutClean:function(a){this.insert.html(a,!1)
},html:function(b,c){"undefined"==typeof c&&(c=!0),this.$editor.focus(),b=this.clean.setVerified(b),c&&(b=this.clean.onPaste(b)),this.utils.browser("msie")?this.insert.htmlIe(b):(this.clean.singleLine?this.insert.execHtml(b):document.execCommand("insertHTML",!1,b),this.insert.htmlFixMozilla()),this.clean.normalizeLists(),this.opts.linebreaks||this.$editor.find("p").each(a.proxy(this.utils.removeEmpty,this)),c&&this.clean.clearUnverified()},htmlFixMozilla:function(){if(this.utils.browser("mozilla")){var b=a(this.selection.getBlock()).next();
b.length>0&&"P"==b[0].tagName&&""===b.html()&&b.remove()}},htmlIe:function(b){if(this.utils.isIe11()){var c=this.utils.isCurrentOrParent("P"),d=a("<div>").append(b),e=d.contents().is("p, :header, dl, ul, ol, div, table, td, blockquote, pre, address, section, header, footer, aside, article");return c&&e?this.insert.ie11FixInserting(c,b):this.insert.ie11PasteFrag(b),void 0}document.selection.createRange().pasteHTML(b)},execHtml:function(a){a=this.clean.setVerified(a),this.selection.get(),this.range.deleteContents();
var b=document.createElement("div");b.innerHTML=a;for(var d,e,c=document.createDocumentFragment();d=b.firstChild;)e=c.appendChild(d);this.range.insertNode(c),this.range.collapse(!0),this.caret.setAfter(e)},node:function(b,c){b=b[0]||b;var d=this.utils.getOuterHtml(b);return d=this.clean.setVerified(d),b=a(d)[0],this.selection.get(),c!==!1&&this.range.deleteContents(),this.range.insertNode(b),this.range.collapse(!1),this.selection.addRange(),b},nodeToPoint:function(a,b,c){a=a[0]||a,this.selection.get();var d;
if(document.caretPositionFromPoint){var e=document.caretPositionFromPoint(b,c);this.range.setStart(e.offsetNode,e.offset),this.range.collapse(!0),this.range.insertNode(a)}else if(document.caretRangeFromPoint)d=document.caretRangeFromPoint(b,c),d.insertNode(a);else if("undefined"!=typeof document.body.createTextRange){d=document.body.createTextRange(),d.moveToPoint(b,c);var f=d.duplicate();f.moveToPoint(b,c),d.setEndPoint("EndToEnd",f),d.select()}},nodeToCaretPositionFromPoint:function(a,b){b=b[0]||b;var c,d=a.clientX,e=a.clientY;
if(document.caretPositionFromPoint){var f=document.caretPositionFromPoint(d,e),g=document.getSelection();c=g.getRangeAt(0),c.setStart(f.offsetNode,f.offset),c.collapse(!0),c.insertNode(b)}else if(document.caretRangeFromPoint)c=document.caretRangeFromPoint(d,e),c.insertNode(b);else if("undefined"!=typeof document.body.createTextRange){c=document.body.createTextRange(),c.moveToPoint(d,e);var h=c.duplicate();h.moveToPoint(d,e),c.setEndPoint("EndToEnd",h),c.select()}},ie11FixInserting:function(b,c){var d=document.createElement("span");
d.className="redactor-ie-paste",this.insert.node(d);var e=a(b).html();e="<p>"+e.replace(/<span class="redactor-ie-paste"><\/span>/gi,"</p>"+c+"<p>")+"</p>",a(b).replaceWith(e)},ie11PasteFrag:function(a){this.selection.get(),this.range.deleteContents();var b=document.createElement("div");b.innerHTML=a;for(var d,e,c=document.createDocumentFragment();d=b.firstChild;)e=c.appendChild(d);this.range.insertNode(c)}}},keydown:function(){return{init:function(b){if(!a(b.target).is("input, textarea")&&!this.rtePaste){var c=b.which,d=c>=37&&40>=c;
this.keydown.ctrl=b.ctrlKey||b.metaKey,this.keydown.current=this.selection.getCurrent(),this.keydown.parent=this.selection.getParent(),this.keydown.block=this.selection.getBlock(),this.keydown.pre=this.utils.isTag(this.keydown.current,"pre"),this.keydown.blockquote=this.utils.isTag(this.keydown.current,"blockquote"),this.keydown.figcaption=this.utils.isTag(this.keydown.current,"figcaption"),this.shortcuts.init(b,c),this.keydown.checkEvents(d,c),this.keydown.setupBuffer(b,c),this.keydown.addArrowsEvent(d);var e=this.core.setCallback("keydown",b);
if(e===!1)return b.preventDefault(),!1;if(this.opts.enterKey&&(this.utils.browser("msie")||this.utils.browser("mozilla"))&&(c===this.keyCode.DOWN||c===this.keyCode.RIGHT)){var f=!1,g=!1;if(this.keydown.block&&"TD"===this.keydown.block.tagName&&(g=a(this.keydown.block).closest("table")),g&&g.find("td").last()[0]===this.keydown.block&&(f=!0),this.utils.isEndOfElement()&&f){var h=a(this.opts.emptyHtml);g.after(h),this.caret.setStart(h)}}if(this.opts.enterKey&&c===this.keyCode.DOWN&&this.keydown.onArrowDown(),!this.opts.enterKey&&c===this.keyCode.ENTER)return b.preventDefault(),this.range.collapsed||this.range.deleteContents(),void 0;
if(c==this.keyCode.ENTER&&!b.shiftKey&&!b.ctrlKey&&!b.metaKey){var i=this.core.setCallback("enter",b);if(i===!1)return b.preventDefault(),!1;var j,k;if(this.keydown.pre)return this.keydown.insertNewLine(b);if("text"==this.utils.getEditableContentType(this.keydown.block))return j=this.selection.getEndNode(),k=a(j).next(),0!==k.size()&&"BR"==k[0].tagName?this.keydown.insertBreakLine(b):this.utils.isEndOfElement()&&j&&"SPAN"!=j?this.keydown.insertDblBreakLine(b):this.keydown.insertBreakLine(b);if(this.opts.linebreaks&&!this.keydown.block)return j=this.selection.getCurrent(),k=a(this.keydown.current).next(),j!==!1&&a(j).hasClass("redactor-invisible-space")?(a(j).remove(),this.keydown.insertDblBreakLine(b)):0===k.length&&j===!1&&"undefined"!=typeof k.context?this.keydown.insertDblBreakLine(b):this.keydown.insertBreakLine(b);
if(this.opts.linebreaks&&this.keydown.block)setTimeout(a.proxy(this.keydown.replaceDivToBreakLine,this),1);else if(!this.opts.linebreaks&&this.keydown.block&&"LI"!==this.keydown.block.tagName)setTimeout(a.proxy(this.keydown.replaceDivToParagraph,this),1);else if(!this.opts.linebreaks&&!this.keydown.block)return this.keydown.insertParagraph(b)}return c===this.keyCode.ENTER&&(b.ctrlKey||b.shiftKey)?this.keydown.onShiftEnter(b):(c===this.keyCode.BACKSPACE&&(this.keydown.removeInvisibleSpace(),this.keydown.removeEmptyListInTable(b),this.keyup.formatEmpty(b)),void 0)
}},checkEvents:function(a,b){a||"click"!=this.core.getEvent()&&"arrow"!=this.core.getEvent()||(this.core.addEvent(!1),this.keydown.checkKeyEvents(b)&&this.buffer.set())},checkKeyEvents:function(b){var c=this.keyCode,d=[c.BACKSPACE,c.DELETE,c.ENTER,c.SPACE,c.ESC,c.TAB,c.CTRL,c.META,c.ALT,c.SHIFT];return-1==a.inArray(b,d)?!0:!1},addArrowsEvent:function(a){return a?"click"==this.core.getEvent()||"arrow"==this.core.getEvent()?(this.core.addEvent(!1),void 0):(this.core.addEvent("arrow"),void 0):void 0},setupBuffer:function(a,b){return this.keydown.ctrl&&90===b&&!a.shiftKey&&!a.altKey&&this.opts.buffer.length?(a.preventDefault(),this.buffer.undo(),void 0):this.keydown.ctrl&&90===b&&a.shiftKey&&!a.altKey&&0!==this.opts.rebuffer.length?(a.preventDefault(),this.buffer.redo(),void 0):(this.keydown.ctrl||(b==this.keyCode.BACKSPACE||b==this.keyCode.DELETE||b==this.keyCode.ENTER&&!a.ctrlKey&&!a.shiftKey||b==this.keyCode.SPACE)&&this.buffer.set(),void 0)
},onArrowDown:function(){for(var a=[this.keydown.blockquote,this.keydown.pre,this.keydown.figcaption],b=0;b<a.length;b++)if(a[b])return this.keydown.insertAfterLastElement(a[b]),!1},onShiftEnter:function(a){return this.buffer.set(),this.utils.isEndOfElement()?this.keydown.insertDblBreakLine(a):this.keydown.insertBreakLine(a)},onTab:function(a,b){if(!this.opts.tabKey)return!0;a.preventDefault();if((!this.keydown.pre||a.shiftKey)&&this.opts.tabAsSpaces===!1)return a.metaKey&&219===b?this.indent.decrease():a.metaKey&&221===b?this.indent.increase():a.shiftKey?this.indent.decrease():this.indent.increase(),!1
},replaceDivToBreakLine:function(){var b=this.selection.getBlock(),c=b.innerHTML.replace(/<br\s?\/?>/gi,"");if(("DIV"===b.tagName||"P"===b.tagName)&&""===c&&!a(b).hasClass("redactor-editor")){var d=document.createElement("br");return a(b).replaceWith(d),this.caret.setBefore(d),!1}},replaceDivToParagraph:function(){var b=this.selection.getBlock(),c=b.innerHTML.replace(/<br\s?\/?>/gi,"");if("DIV"===b.tagName&&""===c&&!a(b).hasClass("redactor-editor")){var d=document.createElement("p");return d.innerHTML=this.opts.invisibleSpace,a(b).replaceWith(d),this.caret.setStart(d),!1
}this.opts.cleanStyleOnEnter&&"P"==b.tagName&&a(b).removeAttr("class").removeAttr("style")},insertParagraph:function(a){a.preventDefault(),this.selection.get();var b=document.createElement("p");return b.innerHTML=this.opts.invisibleSpace,this.range.deleteContents(),this.range.insertNode(b),this.caret.setStart(b),!1},exitFromBlockquote:function(b){if(this.utils.isEndOfElement()){var c=a.trim(a(this.keydown.block).html());if(-1!=c.search(/(<br\s?\/?>){2}$/i)){if(b.preventDefault(),this.opts.linebreaks){var d=document.createElement("br");
a(this.keydown.blockquote).after(d),this.caret.setBefore(d),a(this.keydown.block).html(c.replace(/<br\s?\/?>$/i,""))}else{var e=a(this.opts.emptyHtml);a(this.keydown.blockquote).after(e),this.caret.setStart(e)}return!0}}},insertAfterLastElement:function(b){if(this.utils.isEndOfElement())if(this.buffer.set(),this.opts.linebreaks){var c=a("<div>").append(a.trim(this.$editor.html())).contents(),d=c.last()[0];if("SPAN"==d.tagName&&""===d.innerHTML&&(d=c.prev()[0]),this.utils.getOuterHtml(d)!=this.utils.getOuterHtml(b))return;
var e=document.createElement("br");a(b).after(e),this.caret.setAfter(e)}else{if(this.$editor.contents().last()[0]!==b)return;var f=a(this.opts.emptyHtml);a(b).after(f),this.caret.setStart(f)}},insertNewLine:function(a){a.preventDefault();var b=document.createTextNode("\n");return this.selection.get(),this.range.deleteContents(),this.range.insertNode(b),this.caret.setAfter(b),!1},insertBreakLine:function(a){return this.keydown.insertBreakLineProcessing(a)},insertDblBreakLine:function(a){return this.keydown.insertBreakLineProcessing(a,!0)
},insertBreakLineProcessing:function(a,b){a.stopPropagation(),this.selection.get();var c=document.createElement("br");if(this.range.deleteContents(),this.range.insertNode(c),b===!0){var d=document.createElement("br");this.range.insertNode(d),this.caret.setAfter(d)}else this.caret.setAfter(c);return!1},removeInvisibleSpace:function(){var b=a(this.keydown.current);0===b.text().search(/^\u200B$/g)&&b.is(":not([contenteditable])")&&b.remove()},removeEmptyListInTable:function(b){var c=a(this.keydown.current),d=a(this.keydown.parent),e=c.closest("td");
if(0!==e.size()&&c.closest("li")&&1===d.children("li").size()){if(!this.utils.isEmpty(c.text()))return;b.preventDefault(),c.remove(),d.remove(),this.caret.setStart(e)}}}},keyup:function(){return{init:function(b){if(!a(b.target).is("input, textarea")&&!this.rtePaste){var c=b.which;this.keyup.current=this.selection.getCurrent(),this.keyup.parent=this.selection.getParent();var d=this.utils.isRedactorParent(a(this.keyup.parent).parent()),e=this.core.setCallback("keyup",b);if(e===!1)return b.preventDefault(),!1;if(!this.opts.linebreaks&&3==this.keyup.current.nodeType&&this.keyup.current.length<=1&&(this.keyup.parent===!1||"BODY"==this.keyup.parent.tagName)&&this.keyup.replaceToParagraph(),!this.opts.linebreaks&&this.utils.isRedactorParent(this.keyup.current)&&"DIV"===this.keyup.current.tagName&&this.keyup.replaceToParagraph(!1),this.opts.linebreaks||!a(this.keyup.parent).hasClass("redactor-invisible-space")||d!==!1&&"BODY"!=d[0].tagName||(a(this.keyup.parent).contents().unwrap(),this.keyup.replaceToParagraph()),c===this.keyCode.DELETE||c===this.keyCode.BACKSPACE)return this.clean.clearUnverified(),this.$editor.find("p:not([contenteditable])").each(a.proxy(this.utils.removeEmpty,this)),this.keyup.current&&"DIV"==this.keyup.current.tagName&&this.utils.isEmpty(this.keyup.current.innerHTML)&&this.opts.linebreaks&&(a(this.keyup.current).after(this.selection.getMarkerAsHtml()),this.selection.restore(),a(this.keyup.current).remove()),this.keyup.formatEmpty(b);
{var f=this.utils.getEditableContainer(b.target),g=this.utils.getEditableContentType(b.target);a(f)}"text"==g&&""==a(f).text()&&(f.innerHTML=this.opts.invisibleSpace,this.caret.setEnd(f))}},replaceToParagraph:function(){},formatEmpty:function(b){var c=this.utils.getEditableContainer(b.target),d=this.utils.getEditableContentType(b.target),e=a(c);if("html"===d){var f=a.trim(e.html());if(this.utils.isEmpty(f)){if(b.preventDefault(),this.opts.linebreaks)e.html(this.selection.getMarkerAsHtml()),this.selection.restore();
else{var g=document.createElement("p");g.innerHTML=this.opts.invisibleSpace,e.empty().append(g),this.caret.setEnd(g)}return!1}}}}},list:function(){return{toggle:function(b){this.utils.browser("msie")||this.$editor.focus(),this.buffer.set(),this.selection.save();var c=this.selection.getParent(),d=a(c).closest("ol, ul"),e=a(c).closest(EBD.block);this.utils.isRedactorParent(d)||0===d.size()||(d=!1);var f,g,h=!1;if(d&&d.length){h=!0;var i=d[0].tagName;f="orderedlist"===b&&"UL"===i,g="unorderedlist"===b&&"OL"===i
}f?this.utils.replaceToTag(d,"ol"):g?this.utils.replaceToTag(d,"ul"):h?this.list.remove(b):this.list.insert(b),this.$editor.trigger("composerListFormat",[e]),this.selection.restore()},insert:function(b){var c=this.selection.getParent(),d=this.selection.getCurrent(),e=a(d).closest("td, th");this.utils.browser("msie")&&this.opts.linebreaks?this.list.insertInIe(b):document.execCommand("insert"+b);var f=a(this.selection.getParent()).closest("ol, ul");if(0!==e.size()){var g=e.prev(),h=e.html();e.html(""),!g||1!==g.length||"TD"!==g[0].tagName&&"TH"!==g[0].tagName?a(c).prepend(e):a(g).after(e),e.html(h)
}if(this.utils.isEmpty(f.find("li").text())){var i=f.children("li");i.find("br").remove(),i.append(this.selection.getMarkerAsHtml())}if(f.length){var j=f.parent();this.utils.isRedactorParent(j)&&"LI"!=j[0].tagName&&this.utils.isBlock(j[0])&&j.replaceWith(j.contents())}this.utils.browser("msie")||this.$editor.focus(),this.clean.clearUnverified()},insertInIe:function(b){var c=this.selection.wrap("div"),d=a(c).html(),e="orderedlist"==b?a("<ol>"):a("<ul>"),f=a("<li>");if(""===a.trim(d))f.append(this.selection.getMarkerAsHtml()),e.append(f),this.$editor.find("#selection-marker-1").replaceWith(e);
else{var g=d.split(/<br\s?\/?>/gi);if(g)for(var h=0;h<g.length;h++)""!==a.trim(g[h])&&e.append(a("<li>").html(g[h]));else f.append(d),e.append(f);a(c).replaceWith(e)}},remove:function(b){document.execCommand("insert"+b);var c=a(this.selection.getCurrent());this.indent.fixEmptyIndent(),this.opts.linebreaks||0!==c.closest("li, th, td").size()||(document.execCommand("formatblock",!1,"p"),this.$editor.find("ul, ol, blockquote").each(a.proxy(this.utils.removeEmpty,this)));var d=a(this.selection.getCurrent()).closest("table"),e=d.prev();
this.opts.linebreaks||0===d.size()||0===e.size()||"BR"!=e[0].tagName||e.remove(),this.clean.clearUnverified()}}},paragraphize:function(){return{load:function(b){return this.opts.linebreaks?b:""===b||"<p></p>"===b?this.opts.emptyHtml:(this.paragraphize.blocks=["table","div","pre","form","ul","ol","h1","h2","h3","h4","h5","h6","dl","blockquote","figcaption","address","section","header","footer","aside","article","object","style","script","iframe","select","input","textarea","button","option","map","area","math","hr","fieldset","legend","hgroup","nav","figure","details","menu","summary","p"],b+="\n",this.paragraphize.safes=[],this.paragraphize.z=0,b=b.replace(/(<br\s?\/?>){1,}\n?<\/blockquote>/gi,"</blockquote>"),b=this.paragraphize.getSafes(b),b=this.paragraphize.getSafesComments(b),b=this.paragraphize.replaceBreaksToNewLines(b),b=this.paragraphize.replaceBreaksToParagraphs(b),b=this.paragraphize.clear(b),b=this.paragraphize.restoreSafes(b),b=b.replace(new RegExp("<br\\s?/?>\n?<("+this.paragraphize.blocks.join("|")+")(.*?[^>])>","gi"),"<p><br /></p>\n<$1$2>"),a.trim(b))
},getSafes:function(b){var c=a("<div />").append(b);return c.find("blockquote p").replaceWith(function(){return a(this).append("<br />").contents()}),b=c.html(),c.find(this.paragraphize.blocks.join(", ")).each(a.proxy(function(a,c){this.paragraphize.z++,this.paragraphize.safes[this.paragraphize.z]=c.outerHTML,b=b.replace(c.outerHTML,"\n{replace"+this.paragraphize.z+"}")},this)),b},getSafesComments:function(b){var c=b.match(/<!--([\w\W]*?)-->/gi);return c?(a.each(c,a.proxy(function(a,c){this.paragraphize.z++,this.paragraphize.safes[this.paragraphize.z]=c,b=b.replace(c,"\n{replace"+this.paragraphize.z+"}")
},this)),b):b},restoreSafes:function(b){return a.each(this.paragraphize.safes,function(a,c){b=b.replace("{replace"+a+"}",c)}),b},replaceBreaksToParagraphs:function(a){var b=a.split(new RegExp("\n","g"),-1);if(a="",b)for(var c=b.length,d=0;c>d;d++){if(!b.hasOwnProperty(d))return;-1==b[d].search("{replace")?(b[d]=b[d].replace(/<p>\n\t?<\/p>/gi,""),b[d]=b[d].replace(/<p><\/p>/gi,""),""!==b[d]&&(a+="<p>"+b[d].replace(/^\n+|\n+$/g,"")+"</p>")):a+=b[d]}return a},replaceBreaksToNewLines:function(a){return a=a.replace(/<br \/>\s*<br \/>/gi,"\n\n"),a=a.replace(/<br\s?\/?>\n?<br\s?\/?>/gi,"\n<br /><br />"),a=a.replace(new RegExp("\r\n","g"),"\n"),a=a.replace(new RegExp("\r","g"),"\n"),a=a.replace(new RegExp("/\n\n+/"),"g","\n\n")
},clear:function(a){return a=a.replace(new RegExp("</blockquote></p>","gi"),"</blockquote>"),a=a.replace(new RegExp("<p></blockquote>","gi"),"</blockquote>"),a=a.replace(new RegExp("<p><blockquote>","gi"),"<blockquote>"),a=a.replace(new RegExp("<blockquote></p>","gi"),"<blockquote>"),a=a.replace(new RegExp("<p><p ","gi"),"<p "),a=a.replace(new RegExp("<p><p>","gi"),"<p>"),a=a.replace(new RegExp("</p></p>","gi"),"</p>"),a=a.replace(new RegExp("<p>\\s?</p>","gi"),""),a=a.replace(new RegExp("\n</p>","gi"),"</p>"),a=a.replace(new RegExp("<p>	?	?\n?<p>","gi"),"<p>"),a=a.replace(new RegExp("<p>	*</p>","gi"),"")
}}},paste:function(){return{init:function(b){if(!a(b.target).is("input, textarea")&&this.opts.cleanOnPaste){this.rtePaste=!0,this.buffer.set(),this.selection.save();var c=b.originalEvent.clipboardData;if(c){var d=c.types,e="",f="";a.indexOf(d,"text/html")>-1?(e=c.getData("text/html"),f="html"):a.indexOf(d,"text/plain")>-1&&(e=c.getData("text/plain"),f="text"),this.selection.restore();var g=a("<div>").html(e);this.$editor.trigger("composerPaste",[g]),g.find("h1,h2,h3,h4,h5,h6,img,iframe").each(function(){a(this).replaceWith(a(this).text())
}),e=g.html(),this.paste.insert(e,f),b.preventDefault()}else this.utils.saveScroll(),this.paste.createPasteBox(),a(window).on("scroll.redactor-freeze",a.proxy(function(){a(window).scrollTop(this.saveBodyScroll)},this)),setTimeout(a.proxy(function(){var b=this.$pasteBox.html();this.$pasteBox.remove(),this.selection.restore(),this.utils.restoreScroll(),this.paste.insert(b),a(window).off("scroll.redactor-freeze")},this),1)}},createPasteBox:function(){this.$pasteBox=a("<div>").html("").attr("contenteditable","true").css({position:"fixed",width:0,top:0,left:"-9999px"}),this.$box.parent().append(this.$pasteBox),this.$pasteBox.focus()
},insert:function(b,c){b=this.core.setCallback("pasteBefore",b);var d=this.selection.getCurrent(),e=this.utils.getEditableContentType(d);void 0!=c&&""!=c&&(e=c),"text"==e&&(this.opts.pastePlainText=!0),b=this.clean.onPaste(b),"text"==e&&(b=this.clean.replaceParagraphsToBr(b)),b=this.core.setCallback("paste",b),this.insert.html(b,!1),this.opts.pastePlainText=!1,this.rtePaste=!1,setTimeout(a.proxy(this.clean.clearUnverified,this),10),setTimeout(a.proxy(function(){var b=this.$editor.find("span");a.each(b,function(b,c){var d=c.innerHTML.replace(/[\u200B-\u200D\uFEFF]/,"");
""===d&&0===c.attributes.length&&a(c).remove()})},this),10)}}},selection:function(){return{get:function(){return this.sel=document.getSelection(),this.range=document.getSelection&&this.sel.getRangeAt&&this.sel.rangeCount?this.sel.getRangeAt(0):document.createRange(),this.sel},addRange:function(){try{this.sel.removeAllRanges()}catch(a){}this.sel.addRange(this.range)},getCurrent:function(){var a=!1;return this.selection.get(),this.sel&&this.sel.rangeCount>0&&(a=this.sel.getRangeAt(0).startContainer),this.utils.isRedactorParent(a)
},getStartNode:function(){var a=!1;return this.selection.get(),this.sel&&this.sel.rangeCount>0&&(a=this.range.startContainer,/3|4|8/.test(a.nodeType)||(a=a.childNodes[this.range.startOffset])),this.utils.isRedactorParent(a)},getEndNode:function(){var a=!1;return this.sel&&this.sel.rangeCount>0&&(a=this.range.endContainer,/3|4|8/.test(a.nodeType)||(a=a.childNodes[this.range.endOffset])),this.utils.isRedactorParent(a)},getParent:function(b){return b=b||this.selection.getCurrent(),b?this.utils.isRedactorParent(a(b).parent()[0]):!1
},getBlock:function(b){for(b=b||this.selection.getCurrent();b;){if(this.utils.isBlockTag(b.tagName))return a(b).hasClass("ebd")?!1:b;b=b.parentNode}return!1},getInlines:function(b){if(this.selection.get(),this.range&&this.range.collapsed)return!1;var c=[];b="undefined"==typeof b?this.selection.getNodes():b;var d=this.opts.inlineTags;return d.push("span"),a.each(b,a.proxy(function(b,e){-1!=a.inArray(e.tagName.toLowerCase(),d)&&c.push(e)},this)),0===c.length?!1:c},getBlocks:function(b){if(this.selection.get(),this.range&&this.range.collapsed)return[this.selection.getBlock()];
var c=[];return b="undefined"==typeof b?this.selection.getNodes():b,a.each(b,a.proxy(function(b,d){return 0==a(d).parents("div.ebd").size()?!1:(this.utils.isBlock(d)&&(this.selection.lastBlock=d,c.push(d)),void 0)},this)),0===c.length?[this.selection.getBlock()]:c},getLastBlock:function(){return this.selection.lastBlock},getNodes:function(){this.selection.get();var b=this.selection.getNodesMarker(1),c=this.selection.getNodesMarker(2);this.selection.setNodesMarker(this.range,b,!0),this.range.collapsed===!1?this.selection.setNodesMarker(this.range,c,!1):c=b;
var d=[],e=0,f=this;this.$editor.find("*").each(function(){if(this==b){var g=a(this).parent();0!==g.length&&"BODY"!=g[0].tagName&&f.utils.isRedactorParent(g[0])&&d.push(g[0]),d.push(this),e=1}else e>0&&(d.push(this),e+=1);return this==c?!1:void 0});for(var g=[],h=d.length,i=0;h>i;i++)"nodes-marker-1"!=d[i].id&&"nodes-marker-2"!=d[i].id&&g.push(d[i]);return this.selection.removeNodesMarkers(),g},getNodesInRange:function(b){function c(a){if(a.firstChild)return a.firstChild;for(;a;){if(a.nextSibling)return a.nextSibling;
a=a.parentNode}}var i,b=b||this.range,d=b.startContainer.childNodes[b.startOffset]||b.endContainer.childNodes[b.endOffset],e=b.startContainer.childNodes[b.startOffset]||b.startContainer,f=b.endContainer.childNodes[b.endOffset]||b.endContainer,g=b.commonAncestorContainer,h=[];for(i=e.parentNode;i&&(h.push(i),i!=g);i=i.parentNode);for(h.reverse(),i=e;i&&(!d||a(i.parentNode).closest(g)[0])&&(h.push(i),i!=f);i=c(i));return h},getNodesMarker:function(b){return a('<span id="nodes-marker-'+b+'" class="redactor-nodes-marker" data-verified="redactor">'+this.opts.invisibleSpace+"</span>")[0]
},setNodesMarker:function(a,b,c){a=a.cloneRange();try{a.collapse(c),a.insertNode(b)}catch(d){}},removeNodesMarkers:function(){a(document).find("span.redactor-nodes-marker").remove(),this.$editor.find("span.redactor-nodes-marker").remove()},fromPoint:function(a,b){this.caret.setOffset(a,b)},wrap:function(a){if(this.selection.get(),this.range.collapsed)return!1;var b=document.createElement(a);return b.appendChild(this.range.extractContents()),this.range.insertNode(b),b},selectElement:function(a){this.caret.set(a,0,a,1)
},selectAll:function(){this.selection.get(),this.range.selectNodeContents(this.$editor[0]),this.selection.addRange()},remove:function(){this.selection.get(),this.sel.removeAllRanges()},save:function(){this.selection.createMarkers()},createMarkers:function(){this.selection.get();var a=this.selection.getMarker(1);if(this.selection.setMarker(this.range,a,!0),this.range.collapsed===!1){var b=this.selection.getMarker(2);this.selection.setMarker(this.range,b,!1),this.utils.browser("chrome")&&this.caret.set(a,0,b,0)
}this.savedSel=this.$editor.html()},getMarker:function(b){return"undefined"==typeof b&&(b=1),a('<span id="selection-marker-'+b+'" class="redactor-selection-marker"  data-verified="redactor">'+this.opts.invisibleSpace+"</span>")[0]},getMarkerAsHtml:function(a){return this.utils.getOuterHtml(this.selection.getMarker(a))},setMarker:function(a,b,c){a=a.cloneRange();try{a.collapse(c),a.insertNode(b)}catch(d){this.focus.setStart()}},restore:function(){var a=this.$editor.find("span#selection-marker-1"),b=this.$editor.find("span#selection-marker-2");
0!==a.length&&0!==b.length?this.caret.set(a,0,b,0):0!==a.length?this.caret.set(a,0,a,0):this.$editor.focus(),this.selection.removeMarkers(),this.savedSel=!1},removeMarkers:function(){this.$editor.find("span.redactor-selection-marker").remove()},getText:function(){return this.selection.get(),this.sel.toString()},getHtml:function(){var a="";if(this.selection.get(),this.sel.rangeCount){for(var b=document.createElement("div"),c=this.sel.rangeCount,d=0;c>d;++d)b.appendChild(this.sel.getRangeAt(d).cloneContents());
a=b.innerHTML}return this.clean.onSync(a)}}},shortcuts:function(){return{init:function(b,c){return this.opts.shortcuts?(a.each(this.opts.shortcuts,a.proxy(function(c,d){for(var e=c.split(","),f=e.length,g=0;f>g;g++)"string"==typeof e[g]&&this.shortcuts.handler(b,a.trim(e[g]),a.proxy(function(){var a;"-1"!=d.func.search(/\./)?(a=d.func.split("."),"undefined"!=typeof this[a[0]]&&this[a[0]][a[1]].apply(this,d.params)):this[d.func].apply(this,d.params)},this))},this)),void 0):(!b.ctrlKey&&!b.metaKey||66!==c&&73!==c||b.preventDefault(),!1)
},handler:function(b,c,d){var e={8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},f={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"};
c=c.toLowerCase().split(" ");var g=e[b.keyCode],h=String.fromCharCode(b.which).toLowerCase(),i="",j={};a.each(["alt","ctrl","meta","shift"],function(a,c){b[c+"Key"]&&g!==c&&(i+=c+"+")}),g&&(j[i+g]=!0),h&&(j[i+h]=!0,j[i+f[h]]=!0,"shift+"===i&&(j[f[h]]=!0));for(var k=0,l=c.length;l>k;k++)if(j[c[k]])return b.preventDefault(),d.apply(this,arguments)}}},tabifier:function(){return{get:function(a){if(!this.opts.tabifier)return a;var b=["area","body","head","hr","i?frame","link","meta","noscript","style","script","table","tbody","thead","tfoot"],c=["li","dt","dt","h[1-6]","option","script"],d=["blockquote","div","dl","fieldset","form","frameset","map","ol","p","pre","select","td","th","tr","ul"];
this.tabifier.lineBefore=new RegExp("^<(/?"+b.join("|/?")+"|"+c.join("|")+")[ >]"),this.tabifier.lineAfter=new RegExp("^<(br|/?"+b.join("|/?")+"|/"+c.join("|/")+")[ >]"),this.tabifier.newLevel=new RegExp("^</?("+d.join("|")+")[ >]");var e=0,f=a.length,g=0,h=null,i=null,j="",k="",l="";for(this.tabifier.cleanlevel=0;f>e;e++){if(g=e,-1==a.substr(e).indexOf("<"))return k+=a.substr(e),this.tabifier.finish(k);for(;f>g&&"<"!=a.charAt(g);)g++;for(e!=g&&(l=a.substr(e,g-e),l.match(/^\s{2,}$/g)||("\n"==k.charAt(k.length-1)?k+=this.tabifier.getTabs():"\n"==l.charAt(0)&&(k+="\n"+this.tabifier.getTabs(),l=l.replace(/^\s+/,"")),k+=l),l.match(/\n/)&&(k+="\n"+this.tabifier.getTabs())),h=g;f>g&&">"!=a.charAt(g);)g++;
j=a.substr(h,g-h),e=g;var m;if("!--"==j.substr(1,3)){if(!j.match(/--$/)){for(;"-->"!=a.substr(g,3);)g++;g+=2,j=a.substr(h,g-h),e=g}"\n"!=k.charAt(k.length-1)&&(k+="\n"),k+=this.tabifier.getTabs(),k+=j+">\n"}else"!"==j[1]?k=this.tabifier.placeTag(j+">",k):"?"==j[1]?k+=j+">\n":(m=j.match(/^<(script|style|pre)/i))?(m[1]=m[1].toLowerCase(),j=this.tabifier.cleanTag(j),k=this.tabifier.placeTag(j,k),i=String(a.substr(e+1)).toLowerCase().indexOf("</"+m[1]),i&&(l=a.substr(e+1,i),e+=i,k+=l)):(j=this.tabifier.cleanTag(j),k=this.tabifier.placeTag(j,k))
}return this.tabifier.finish(k)},getTabs:function(){for(var a="",b=0;b<this.tabifier.cleanlevel;b++)a+="	";return a},finish:function(a){return a=a.replace(/\n\s*\n/g,"\n"),a=a.replace(/^[\s\n]*/,""),a=a.replace(/[\s\n]*$/,""),a=a.replace(/<script(.*?)>\n<\/script>/gi,"<script$1></script>"),this.tabifier.cleanlevel=0,a},cleanTag:function(a){var b="";a=a.replace(/\n/g," "),a=a.replace(/\s{2,}/g," "),a=a.replace(/^\s+|\s+$/g," ");var c="";a.match(/\/$/)&&(c="/",a=a.replace(/\/+$/,""));for(var d;d=/\s*([^= ]+)(?:=((['"']).*?\3|[^ ]+))?/.exec(a);)d[2]?b+=d[1].toLowerCase()+"="+d[2]:d[1]&&(b+=d[1].toLowerCase()),b+=" ",a=a.substr(d[0].length);
return b.replace(/\s*$/,"")+c+">"},placeTag:function(a,b){var c=a.match(this.tabifier.newLevel);return(a.match(this.tabifier.lineBefore)||c)&&(b=b.replace(/\s*$/,""),b+="\n"),c&&"/"==a.charAt(1)&&this.tabifier.cleanlevel--,"\n"==b.charAt(b.length-1)&&(b+=this.tabifier.getTabs()),c&&"/"!=a.charAt(1)&&this.tabifier.cleanlevel++,b+=a,(a.match(this.tabifier.lineAfter)||a.match(this.tabifier.newLevel))&&(b=b.replace(/ *$/,""),b+="\n"),b}}},tidy:function(){return{setupAllowed:function(){if(this.opts.allowedTags&&(this.opts.deniedTags=!1),this.opts.allowedAttr&&(this.opts.removeAttr=!1),!this.opts.linebreaks){var a=["p","section"];
this.opts.allowedTags&&this.tidy.addToAllowed(a),this.opts.deniedTags&&this.tidy.removeFromDenied(a)}},addToAllowed:function(b){for(var c=b.length,d=0;c>d;d++)-1==a.inArray(b[d],this.opts.allowedTags)&&this.opts.allowedTags.push(b[d])},removeFromDenied:function(b){for(var c=b.length,d=0;c>d;d++){var e=a.inArray(b[d],this.opts.deniedTags);-1!=e&&this.opts.deniedTags.splice(e,1)}},load:function(b,c){return this.tidy.settings={deniedTags:this.opts.deniedTags,allowedTags:this.opts.allowedTags,removeComments:this.opts.removeComments,replaceTags:this.opts.replaceTags,replaceStyles:this.opts.replaceStyles,removeDataAttr:this.opts.removeDataAttr,removeAttr:this.opts.removeAttr,allowedAttr:this.opts.allowedAttr,removeWithoutAttr:this.opts.removeWithoutAttr,removeEmpty:this.opts.removeEmpty},a.extend(this.tidy.settings,c),b=this.tidy.removeComments(b),this.tidy.$div=a("<div />").append(b),this.tidy.replaceTags(),this.tidy.replaceStyles(),this.tidy.removeTags(),this.tidy.removeAttr(),this.tidy.removeEmpty(),this.tidy.removeParagraphsInLists(),this.tidy.removeDataAttr(),this.tidy.removeWithoutAttr(),b=this.tidy.$div.html(),this.tidy.$div.remove(),b
},removeComments:function(a){return this.tidy.settings.removeComments?a.replace(/<!--[\s\S]*?-->/gi,""):a},replaceTags:function(b){if(!this.tidy.settings.replaceTags)return b;for(var c=this.tidy.settings.replaceTags.length,d=[],e=[],f=0;c>f;f++)e.push(this.tidy.settings.replaceTags[f][1]),d.push(this.tidy.settings.replaceTags[f][0]);return this.tidy.$div.find(d.join(",")).each(a.proxy(function(b,c){var d=e[b];a(c).replaceWith(function(){for(var b=a("<"+d+" />").append(a(this).contents()),c=0;c<this.attributes.length;c++)b.attr(this.attributes[c].name,this.attributes[c].value);
return b})},this)),b},replaceStyles:function(){if(this.tidy.settings.replaceStyles){var b=this.tidy.settings.replaceStyles.length;this.tidy.$div.find("span").each(a.proxy(function(c,d){for(var e=a(d),f=e.attr("style"),g=0;b>g;g++)if(f&&f.match(new RegExp("^"+this.tidy.settings.replaceStyles[g][0],"i"))){var h=this.tidy.settings.replaceStyles[g][1];e.replaceWith(function(){var b=document.createElement(h);return a(b).append(a(this).contents())})}},this))}},removeTags:function(){!this.tidy.settings.deniedTags&&this.tidy.settings.allowedTags&&this.tidy.$div.find("*").not(this.tidy.settings.allowedTags.join(",")).each(function(b,c){""===c.innerHTML?a(c).remove():a(c).contents().unwrap()
}),this.tidy.settings.deniedTags&&this.tidy.$div.find(this.tidy.settings.deniedTags.join(",")).each(function(b,c){""===c.innerHTML?a(c).remove():a(c).contents().unwrap()})},removeAttr:function(){var b;if(!this.tidy.settings.removeAttr&&this.tidy.settings.allowedAttr){var c=[],d=[];b=this.tidy.settings.allowedAttr.length;for(var e=0;b>e;e++)c.push(this.tidy.settings.allowedAttr[e][0]),d.push(this.tidy.settings.allowedAttr[e][1]);this.tidy.$div.find("*").each(a.proxy(function(b,e){var f=a(e),g=a.inArray(f[0].tagName.toLowerCase(),c),h=this.tidy.removeAttrGetRemoves(g,d,f);
h&&a.each(h,function(a,b){f.removeAttr(b)})},this))}if(this.tidy.settings.removeAttr){b=this.tidy.settings.removeAttr.length;for(var e=0;b>e;e++){var f=this.tidy.settings.removeAttr[e][1];a.isArray(f)&&(f=f.join(" ")),this.tidy.$div.find(this.tidy.settings.removeAttr[e][0]).removeAttr(f)}}},removeAttrGetRemoves:function(b,c,d){var e=[];return-1==b?a.each(d[0].attributes,function(a,b){e.push(b.name)}):"*"==c[b]?e=[]:a.each(d[0].attributes,function(d,f){a.isArray(c[b])?-1==a.inArray(f.name,c[b])&&e.push(f.name):c[b]!=f.name&&e.push(f.name)
}),e},removeAttrs:function(b,c){return c=new RegExp(c,"g"),b.each(function(){for(var b=a(this),d=this.attributes.length-1,e=d;e>=0;e--){var f=this.attributes[e];f&&f.specified&&f.name.search(c)>=0&&b.removeAttr(f.name)}})},removeEmpty:function(){this.tidy.settings.removeEmpty&&this.tidy.$div.find(this.tidy.settings.removeEmpty.join(",")).each(function(){var b=a(this),c=b.text();c=c.replace(/[\u200B-\u200D\uFEFF]/g,""),c=c.replace(/&nbsp;/gi,""),c=c.replace(/\s/g,""),""===c&&0===b.children().length&&b.remove()
})},removeParagraphsInLists:function(){this.tidy.$div.find("li p").contents().unwrap()},removeDataAttr:function(){if(this.tidy.settings.removeDataAttr){var b=this.tidy.settings.removeDataAttr;a.isArray(this.tidy.settings.removeDataAttr)&&(b=this.tidy.settings.removeDataAttr.join(",")),this.tidy.removeAttrs(this.tidy.$div.find(b),"^(data-)")}},removeWithoutAttr:function(){this.tidy.settings.removeWithoutAttr&&this.tidy.$div.find(this.tidy.settings.removeWithoutAttr.join(",")).each(function(){0===this.attributes.length&&a(this).contents().unwrap()
})}}},utils:function(){return{isMobile:function(){return/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)},isDesktop:function(){return!/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)},isString:function(a){return"[object String]"==Object.prototype.toString.call(a)},isEmpty:function(b,c){return b=b.replace(/[\u200B-\u200D\uFEFF]/g,""),b=b.replace(/&nbsp;/gi,""),b=b.replace(/<\/?br\s?\/?>/g,""),b=b.replace(/\s/g,""),b=b.replace(/^<p>[^\W\w\D\d]*?<\/p>$/i,""),b=b.replace(/<iframe(.*?[^>])>$/i,"iframe"),c!==!1&&(b=b.replace(/<[^\/>][^>]*><\/[^>]+>/gi,""),b=b.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")),b=a.trim(b),""===b
},normalize:function(a){return"undefined"==typeof a?0:parseInt(a.replace("px",""),10)},hexToRgb:function(a){if("undefined"!=typeof a){if(-1==a.search(/^#/))return a;var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return"rgb("+parseInt(c[1],16)+", "+parseInt(c[2],16)+", "+parseInt(c[3],16)+")"}},getOuterHtml:function(b){return a("<div>").append(a(b).eq(0).clone()).html()},getAlignmentElement:function(b){return-1!==a.inArray(b.tagName,this.opts.alignmentTags)?a(b):a(b).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0])
},removeEmptyAttr:function(b,c){var d=a(b);return"undefined"==typeof d.attr(c)?!0:""===d.attr(c)?(d.removeAttr(c),!0):!1},removeEmpty:function(b,c){var d=a(c);if(d.find(".redactor-invisible-space").removeAttr("style").removeAttr("class"),0===d.find("hr, br, img, iframe").length){var e=a.trim(d.text());this.utils.isEmpty(e,!1)&&d.remove()}},saveScroll:function(){this.saveEditorScroll=this.$editor.scrollTop(),this.saveBodyScroll=a(window).scrollTop(),this.opts.scrollTarget&&(this.saveTargetScroll=a(this.opts.scrollTarget).scrollTop())
},restoreScroll:function(){("undefined"!=typeof this.saveScroll||"undefined"!=typeof this.saveBodyScroll)&&(a(window).scrollTop(this.saveBodyScroll),this.$editor.scrollTop(this.saveEditorScroll),this.opts.scrollTarget&&a(this.opts.scrollTarget).scrollTop(this.saveTargetScroll))},createSpaceElement:function(){var a=document.createElement("span");return a.className="redactor-invisible-space",a.innerHTML=this.opts.invisibleSpace,a},removeInlineTags:function(b){var c=this.opts.inlineTags;c.push("span"),"PRE"==b.tagName&&c.push("a"),a(b).find(c.join(",")).not("span.redactor-selection-marker").contents().unwrap()
},replaceWithContents:function(b,c){var d=this;a(b).replaceWith(function(){return c===!0&&d.utils.removeInlineTags(this),a(this).contents()})},replaceToTag:function(b,c,d){var e,f=this;return a(b).replaceWith(function(){e=a("<"+c+" />").append(a(this).contents());for(var b=0;b<this.attributes.length;b++)e.attr(this.attributes[b].name,this.attributes[b].value);return d===!0&&f.utils.removeInlineTags(e),e}),e},isStartOfElement:function(){var a=this.selection.getBlock();if(!a)return!1;var b=this.caret.getOffsetOfElement(a);
return 0===b?!0:!1},isEndOfElement:function(){var b=this.selection.getBlock();if(!b)return!1;var c=this.caret.getOffsetOfElement(b),d=a.trim(a(b).text()).replace(/\n\r\n/g,"");return c==d.length?!0:!1},isBlock:function(a){return a=a[0]||a,a&&this.utils.isBlockTag(a.tagName)},isBlockTag:function(a){return"undefined"==typeof a?!1:this.reIsBlock.test(a)},isTag:function(b,c){var d=a(b).closest(c);return 1==d.size()?d[0]:!1},isRedactorParent:function(b){return b?0===a(b).parents(".ebd").length||a(b).hasClass("ebd")?!1:b:!1
},isCurrentOrParentHeader:function(){return this.utils.isCurrentOrParent(["H1","H2","H3","H4","H5","H6"])},isCurrentOrParent:function(b){var c=this.selection.getParent(),d=this.selection.getCurrent();if(a.isArray(b)){var e=0;return a.each(b,a.proxy(function(a,b){this.utils.isCurrentOrParentOne(d,c,b)&&e++},this)),0===e?!1:!0}return this.utils.isCurrentOrParentOne(d,c,b)},isCurrentOrParentOne:function(a,b,c){return c=c.toUpperCase(),b&&b.tagName===c?b:a&&a.tagName===c?a:!1},isOldIe:function(){return this.utils.browser("msie")&&parseInt(this.utils.browser("version"),10)<9?!0:!1
},isLessIe10:function(){return this.utils.browser("msie")&&parseInt(this.utils.browser("version"),10)<10?!0:!1},isIe11:function(){return!!navigator.userAgent.match(/Trident\/7\./)},browser:function(a){var b=navigator.userAgent.toLowerCase(),c=/(opr)[\/]([\w.]+)/.exec(b)||/(chrome)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||b.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(b)||b.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b)||[];
return"version"==a?c[2]:"webkit"==a?"chrome"==c[1]||"webkit"==c[1]:"rv"==c[1]?"msie"==a:"opr"==c[1]?"webkit"==a:a==c[1]},getEditableContainer:function(b){var c=a(b).parentsUntil(this.$editor).andSelf().closest("[contenteditable=true]")[0];return this.utils.isRedactorParent(c)},isEditableContent:function(a){return!!this.utils.getEditableContainer(a)},getEditableContentType:function(b){var c=this.utils.getEditableContainer(b),d=a(c).attr("data-content-type");return"html"==d?"html":"text"==d?"text":"text"}}}},d.prototype.init.prototype=d.prototype,b.resolve()
}),EasyBlog.module("composer/vendors/scrolly",function($){var module=this;!function(){var isWin=navigator.appVersion.indexOf("Win")>-1,doco=$(document),scrolly="[data-scrolly]",viewport="[data-scrolly-viewport]",disabled="scrolly-disabled",activeScrolly="[data-scrolly]:not(.scrolly-disabled)",ns=function(a){return a.split(" ").join(".scrolly ")+".scrolly"},percent=function(a){return 100*a+"%"},toggle_=function(a){return 1>a?"block":"none"},self={axis:function(a,b){var c=$(a).data("axis");if(c&&!b)return c;b=(b||$(a).data("scrolly")||"xy").split("");
for(var d,c={};d=b.shift();)c[d]=!0;return $(a).data("axis",c),c},viewport:function(a){return $(a).find("> "+viewport)[0]||$(a).wrapInner("<div data-scrolly-viewport>").find("> "+viewport)[0]},x:function(a){return $(a).find("> s[data-scrolly-axis=x]")[0]||$('<s data-scrolly-axis="x">').appendTo(a)[0]},y:function(a){return $(a).find("> s[data-scrolly-axis=y]")[0]||$('<s data-scrolly-axis="y">').appendTo(a)[0]},update:function(node,dx,dy,fromScrollbar){var axis=self.axis(node),acceleration=isWin?28:1;with(self.viewport(node)){var a=fromScrollbar?scrollHeight/offsetHeight:1;
axis.y&&(scrollTop-=(dy||0)*a*acceleration),axis.x&&(scrollLeft-=(dx||0)*a*acceleration);var scrollbarTop=scrollTop/scrollHeight,scrollbarLeft=scrollLeft/scrollWidth,scrollbarHeight=offsetHeight/scrollHeight,scrollbarWidth=offsetWidth/scrollWidth}if(axis.x)with(self.x(node).style)left=percent(scrollbarLeft),width=percent(scrollbarWidth),display=toggle_(scrollbarWidth);if(axis.y)with(self.y(node).style)top=percent(scrollbarTop),height=percent(scrollbarHeight),display=toggle_(scrollbarHeight);var elem=$(node);
clearTimeout(elem.data("scrolly_timer")),elem.data("scrolly_timer",setTimeout(function(){elem.removeData("scrolly_timer")},1e3)).trigger("scrolly")},enable:function(a){$(a).removeClass(disabled)},disable:function(a){$(a).addClass(disabled)},reset:function(a){$(a).removeData("axis")}};$.fn.scrolly=function(a){if($.isString(a)){var b=self[a]([this[0]].concat($.makeArray(arguments).slice(1)));return b||this}return $(this).eq(0).attr("data-scrolly",(a||{}).axis)},doco.on(ns("mouseover"),scrolly,function(a){var b=$(a.target).closest(activeScrolly)[0];
b&&!$(b).data("scrolly_timer")&&self.update(b)}).on(ns("mousewheel"),scrolly,function(a,b,c,d){var e=$(a.target).closest(activeScrolly)[0];e&&self.update(e,c,d)}).on(ns("mousedown"),scrolly+" > s",function(a){var b=$(this).parent(scrolly).addClass("scrolling");doco.on(ns("mousemove"),function(c){self.update(b[0],a.pageX-c.pageX,a.pageY-c.pageY,!0),a=c,c.preventDefault()}).on(ns("mouseup"),function(){b.removeClass("scrolling"),doco.off(ns("mousemove mouseup"))})})}(),module.resolve()}),EasyBlog.module("composer/vendors/selectionchange",function(a){var b=this;
a.selectionchange=function(a){function e(b){var c=b.onselectionchange;if(c!==a)try{return b.onselectionchange=0,null===b.onselectionchange}catch(d){}finally{b.onselectionchange=c}return!1}function f(){return"undefined"!=typeof WeakMap?new WeakMap:(console.error("selectionchange: WeakMap not supported"),null)}function g(a){var b=a.getSelection();return b.rangeCount?b.getRangeAt(0):null}function h(a,b,c){a.addEventListener(b,c,!0)}function i(a,b,c){a.removeEventListener(b,c,!0)}function j(a){var c=a.keyCode;(65===c&&a[b]&&!a.shiftKey&&!a.altKey||40>=c&&c>=37&&a.shiftKey)&&setTimeout(o.bind(null,this),0)
}function k(a){0===a.button&&(h(this,"mousemove",l),setTimeout(o.bind(null,this),0))}function l(a){1&a.buttons?o(this):i(this,"mousemove",l)}function m(a){0===a.button?setTimeout(o.bind(null,this),0):i(this,"mousemove",l)}function n(){setTimeout(o.bind(null,this.document),0)}function o(a){var b=d.get(a),c=g(a);p(c,b)||(d.set(a,c),setTimeout(a.dispatchEvent.bind(a,new Event("selectionchange")),0))}function p(a,b){return a===b||a&&b&&c.every(function(c){return a[c]===b[c]})}var d,b=/^Mac/.test(navigator.platform)?"metaKey":"ctrlKey",c=["startContainer","startOffset","endContainer","endOffset"];
return{start:function(a){var b=a||document;(d||!e(b)&&(d=f()))&&(d.has(b)||(d.set(b,g(b)),h(b,"keydown",j),h(b,"mousedown",k),h(b,"mousemove",l),h(b,"mouseup",m),h(b.defaultView,"focus",n)))},stop:function(a){var b=a||document;d&&d.has(b)&&(d["delete"](b),i(b,"keydown",j),i(b,"mousedown",k),i(b,"mousemove",l),i(b,"mouseup",m),i(b.defaultView,"focus",n))}}}(),b.resolve()})});